var jn=Object.defineProperty;var F=(e,t)=>()=>(e&&(t=e(e=0)),t);var Ge=(e,t)=>{for(var n in t)jn(e,n,{get:t[n],enumerable:!0})};function te(e){Object.assign(Ye,e),Rn.forEach(t=>t(Ye))}var Ye,Rn,v,U=F(()=>{Ye={view:"movies",movies:[],shows:[],facets:{},filtered:[],cfg:{}},Rn=new Set,v=()=>Ye});function A(e,t,n){let r=document.createElement(e);return t&&(r.className=t),n!=null&&(r.textContent=n),r}var k,Le=F(()=>{k=(e,t=document)=>t.querySelector(e)});function qt(e,t,n=864e5){try{let r=ne+e,o={value:t,timestamp:Date.now(),ttl:n};localStorage.setItem(r,JSON.stringify(o)),Hn()}catch(r){if(r.name==="QuotaExceededError"){Ot();try{let o=ne+e,a={value:t,timestamp:Date.now(),ttl:n};localStorage.setItem(o,JSON.stringify(a))}catch{}}}}function Kt(e){try{let t=ne+e,n=localStorage.getItem(t);if(!n)return null;let r=JSON.parse(n),o=Date.now();return r.timestamp+r.ttl<o?(localStorage.removeItem(t),null):r.value}catch{return null}}function zt(){try{Object.keys(localStorage).forEach(t=>{t.startsWith(ne)&&localStorage.removeItem(t)})}catch{}}function Me(){try{let e=Object.keys(localStorage),t=Date.now(),n=0;e.forEach(r=>{if(r.startsWith(ne))try{let o=JSON.parse(localStorage.getItem(r));o.timestamp+o.ttl<t&&(localStorage.removeItem(r),n++)}catch{localStorage.removeItem(r),n++}}),n>0}catch{}}function Qe(){try{let t=Object.keys(localStorage).filter(s=>s.startsWith(ne)),n=Date.now(),r=0,o=0,a=0;return t.forEach(s=>{let i=localStorage.getItem(s);r+=i.length*2;try{let c=JSON.parse(i);c.timestamp+c.ttl>=n?o++:a++}catch{a++}}),{totalEntries:t.length,validEntries:o,expiredEntries:a,totalSize:r,totalSizeMB:(r/1024/1024).toFixed(2)}}catch{return null}}function Hn(){try{let e=Qe();e&&e.totalSize>5242880&&Ot(.3)}catch{}}function Ot(e=.3){try{let t=Object.keys(localStorage),n=[];t.forEach(o=>{if(o.startsWith(ne))try{let a=JSON.parse(localStorage.getItem(o));n.push({key:o,timestamp:a.timestamp})}catch{n.push({key:o,timestamp:0})}}),n.sort((o,a)=>o.timestamp-a.timestamp);let r=Math.ceil(n.length*e);for(let o=0;o<r;o++)localStorage.removeItem(n[o].key)}catch{}}var ne,qn,et=F(()=>{ne="plex_cache_";qn=null;typeof window!="undefined"&&typeof window.document!="undefined"&&window===globalThis&&(Me(),qn=setInterval(Me,5*60*1e3))});async function tt(e,t=2,n=!0){if(n){let o=Kt(e);if(o!==null)return o}let r=null;for(let o=0;o<=t;o++){try{let a=await fetch(e,{cache:"no-store"});if(a&&a.ok){let s=await a.json();return n&&s&&qt(e,s,Kn),s}if(a&&a.status===404)return null;r=new Error(`HTTP ${a.status}: ${a.statusText}`)}catch(a){r=a}if(o<t){let a=Math.min(1e3*Math.pow(2,o),5e3);await new Promise(s=>setTimeout(s,a))}}return null}function Wn(e){try{let t=document.getElementById(e);if(t&&t.textContent)return JSON.parse(t.textContent)}catch{}return null}function Un(e){try{let t=window.__PLEX_EXPORTER__;return(t&&Array.isArray(t[e])?t[e]:null)||null}catch{return null}}function Jn(e){try{return(Array.isArray(window[e])?window[e]:null)||null}catch{return null}}async function Jt(e,t){let n=await tt(e);if(Array.isArray(n)&&n.length)return ue(t==null?void 0:t.label,`primary:${e}`),n;if(t!=null&&t.embedId){let r=Wn(t.embedId);if(Array.isArray(r)&&r.length)return ue(t==null?void 0:t.label,`embedded:${t.embedId}`),r}if(t!=null&&t.exportKey){let r=Un(t.exportKey);if(Array.isArray(r)&&r.length)return ue(t==null?void 0:t.label,`globalBag:${t.exportKey}`),r}if(t!=null&&t.globalVar){let r=Jn(t.globalVar);if(Array.isArray(r)&&r.length)return ue(t==null?void 0:t.label,`window:${t.globalVar}`),r}for(let r of(t==null?void 0:t.altUrls)||[]){let o=await tt(r);if(Array.isArray(o)&&o.length)return ue(t==null?void 0:t.label,`alt:${r}`),o}return ue(t==null?void 0:t.label,"empty"),Array.isArray(n)?n:[]}function Gn(e,t){let n=e==null?"":String(e).trim();if(!n)return"";if(n.startsWith("//")||n.startsWith("/")||Vn.test(n))return n;let r=t?t.endsWith("/")?t:`${t}/`:"",o=n.replace(/^\.\/+/,""),a=l=>l.split("/").map(d=>{if(!d)return"";try{return encodeURIComponent(decodeURIComponent(d))}catch{return encodeURIComponent(d)}}).join("/");if(o.startsWith("data/"))return a(o);let s=o.replace(/^\/+/,""),i=s;if(r){let l=u=>u.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),d=r.replace(/\/+$/,"").split("/").pop();if(d){let u=new RegExp(`^${l(d)}/`);i=s.replace(u,"")}}let c=a(i);return`${r}${c}`}function Gt(e,t){var o,a;if(!e||typeof e!="object")return e;let n=(a=(o=e.thumbFile)!=null?o:e.thumb)!=null?a:"",r=Gn(n,t);if(r)e.thumbFile=r,e.thumb=r;else if(n){let s=String(n);e.thumbFile=s,e.thumb==null&&(e.thumb=s)}return e}function Yn(e){return Gt(e,zn)}function _(e){return Gt(e,On)}function Yt(e){return!e||typeof e!="object"||(_(e),Array.isArray(e.seasons)&&e.seasons.forEach(Xt)),e}function Xt(e){return!e||typeof e!="object"||(_(e),Array.isArray(e.episodes)&&e.episodes.forEach(t=>_(t))),e}function Xn(e){return Array.isArray(e)?(e.forEach(t=>{t&&typeof t=="object"&&Yn(t)}),e):[]}function Zn(e){return Array.isArray(e)?(e.forEach(t=>{t&&typeof t=="object"&&Yt(t)}),e):[]}async function nt(){try{let e=await Jt("data/movies/movies.json",{label:"movies",embedId:"movies-json",exportKey:"movies",globalVar:"__PLEX_MOVIES__",altUrls:["movies/movies.json","data/movies.json","Filme/movies.json","movies.json"]});return G.movies=0,Xn(e)}catch(e){if(G.movies<Ut)return G.movies++,await new Promise(t=>setTimeout(t,1e3*G.movies)),nt();throw e}}async function rt(){try{let e=await Jt("data/series/series_index.json",{label:"shows",embedId:"series-json",exportKey:"shows",globalVar:"__PLEX_SHOWS__",altUrls:["series/series_index.json","data/shows.json","data/series.json","Serien/series.json","series/series.json","series.json","shows.json"]});return G.shows=0,Zn(e)}catch(e){if(G.shows<Ut)return G.shows++,await new Promise(t=>setTimeout(t,1e3*G.shows)),rt();throw e}}async function Zt(e){if(!e)return null;let t=Qn(e),n=er(t);if(n!==void 0)return n;let r=tr(e),o=null;for(let a of r)try{let s=await tt(a);if(s&&typeof s=="object"){let i=nr(s);return Vt(t,i,e),en(i)}}catch(s){o=s}return Vt(t,null,e),null}function ue(e,t){if(e)try{Wt[e]=t}catch{}}function Qt(){return{...Wt}}function Qn(e){let t=[];(e==null?void 0:e.ratingKey)!==void 0&&(e==null?void 0:e.ratingKey)!==null&&(e==null?void 0:e.ratingKey)!==""&&t.push(`rk:${String(e.ratingKey)}`);let n=$e(e==null?void 0:e.href);return n&&t.push(`href:${n}`),t}function $e(e){return e?String(e).trim().replace(/^\.\//,"").replace(/^\/+/,""):""}function er(e){for(let t of e)if(re.has(t)){let n=re.get(t);return n?en(n):null}}function Vt(e,t,n){let r=t;e.forEach(c=>{re.set(c,r)});let o=n==null?void 0:n.ratingKey;o!=null&&re.set(`rk:${String(o)}`,r);let a=t&&typeof t=="object"?t.ratingKey:void 0;a!=null&&re.set(`rk:${String(a)}`,r);let s=$e(n==null?void 0:n.href);s&&re.set(`href:${s}`,r);let i=t&&typeof t=="object"?$e(t.href):"";i&&re.set(`href:${i}`,r)}function tr(e){let t=new Set,n=$e(e==null?void 0:e.href);if(n)if(/^https?:/i.test(n))t.add(n);else{n.startsWith("data/")?t.add(n):t.add(`data/${n}`);let o=n.replace(/^data\//,"");o.startsWith("series/")||t.add(`data/series/${o}`);let a=o.replace(/^series\//,"").replace(/^details\//,"").replace(/\.json$/,"");a&&t.add(`data/series/details/${a}.json`)}let r=e==null?void 0:e.ratingKey;return r!=null&&t.add(`data/series/details/${String(r)}.json`),Array.from(t)}function nr(e){if(!e||typeof e!="object")return null;let t={...e};_(t),t.genres=ot(t.genres);let n=ar(t.cast||t.roles||[]);return t.cast=n,t.roles=n,t.seasons=Array.isArray(t.seasons)?t.seasons.map(rr).filter(Boolean):[],t.seasonCount=Number.isFinite(t.seasonCount)?t.seasonCount:t.seasons.length,Yt(t),t}function rr(e){if(!e||typeof e!="object")return null;let t={...e};return _(t),t.genres=ot(t.genres),t.episodes=Array.isArray(t.episodes)?t.episodes.map(or).filter(Boolean):[],Xt(t),t}function or(e){if(!e||typeof e!="object")return null;let t={...e};return _(t),t.genres=ot(t.genres),t}function ot(e){if(!Array.isArray(e))return[];let t=new Set,n=[];return e.forEach(r=>{let o=null;if(typeof r=="string"){let a=r.trim();a&&(o={tag:a})}else if(r&&typeof r=="object"){let a=String(r.tag||r.title||r.name||r.label||"").trim();a&&(o={...r,tag:a})}o&&!t.has(o.tag)&&(t.add(o.tag),n.push(o))}),n}function ar(e){return Array.isArray(e)?e.map(t=>{if(!t)return null;if(typeof t=="string"){let n=t.trim();return n?{tag:n}:null}if(typeof t=="object"){let n=String(t.tag||t.name||t.role||"").trim();return n?{...t,tag:n}:{...t}}return null}).filter(Boolean):[]}function en(e){if(e==null)return e;try{return structuredClone(e)}catch{}try{return JSON.parse(JSON.stringify(e))}catch{}return e}var Wt,re,G,Ut,Kn,zn,On,Vn,fe=F(()=>{et();Wt={movies:null,shows:null},re=new Map,G={movies:0,shows:0},Ut=3,Kn=1e3*60*30,zn="data/movies/",On="data/series/",Vn=/^[a-z][a-z0-9+.-]*:/i});function oe(e){let t=new Set,n=[];return(e||[]).forEach(r=>{let o="";typeof r=="string"?o=r:r&&typeof r=="object"&&(o=r.tag||r.title||r.name||"");let a=String(o||"").trim();a&&!t.has(a)&&(t.add(a),n.push(a))}),n}function st(e,t,n=6){if(!e)return;let r=(t||[]).filter(Boolean),o=r.slice(0,n),a=r.slice(n),s=o.map(i=>at(i));if(a.length){let i=at(`+${a.length} mehr`);i.classList.add("more"),i._extraChips=a.map(c=>at(c)),s.push(i)}e.replaceChildren(...s),ir(e)}function ir(e=document){try{e.querySelectorAll(".chips .chip.more").forEach(t=>{t.dataset.bound||(t.dataset.bound="1",t.addEventListener("click",()=>{let n=t._extraChips||[];try{n.forEach(r=>t.before(r))}catch{}t.remove()}))})}catch{}}function q(e){return e!=null&&e.year?e.year:e!=null&&e.originallyAvailableAt?String(e.originallyAvailableAt).slice(0,4):""}function P(e){if(e==null||e==="")return"";let t=Number(e);if(Number.isFinite(t)){let n=t.toFixed(1);return n.endsWith(".0")?n.slice(0,-2):n}return String(e).trim()}function at(e){let t=document.createElement("span");return t.className="chip",t.textContent=String(e||""),t}function _e(e){if(!(e!=null&&e.addedAt))return!1;let t=new Date(e.addedAt).getTime();if(!Number.isFinite(t))return!1;let n=v().cfg||{},r=Number(n.newDays||30);return Date.now()-t<=r*24*60*60*1e3}function ae(){try{return localStorage.getItem("useTmdb")==="1"}catch{return!1}}var ye=F(()=>{U()});function cr(){try{K=new Set(JSON.parse(localStorage.getItem(rn)||"[]"))}catch{K=new Set}}function on(){try{localStorage.setItem(rn,JSON.stringify(Array.from(K.values())))}catch{}}function ct(e){var r,o;if(!e)return"";let t=e.type==="tv"||e.libraryType==="show"?"show":"movie",n=((r=e.ids)==null?void 0:r.imdb)||((o=e.ids)==null?void 0:o.tmdb)||String(e.ratingKey||"");return n?`${t}:${n}`:""}function an(e){return K.has(ct(e))}function lr(){return K.size}function lt(e){let t=ct(e);t&&(K.has(t)?K.delete(t):K.add(t),on(),dt())}function dt(){let e=document.getElementById("watchlistCount");e&&(e.textContent=String(lr()))}function tn(){let e=document.getElementById("watchlistPanel");e&&(e.hidden=!1,e.setAttribute("aria-hidden","false"),ut(),document.dispatchEvent(new CustomEvent("watchlist:open")))}function nn(){let e=document.getElementById("watchlistPanel");e&&(e.hidden=!0,e.setAttribute("aria-hidden","true"),document.dispatchEvent(new CustomEvent("watchlist:close"))),it(!1)}function dr(){K.clear(),on(),dt(),ut()}function ur(){let e=sn(),t=JSON.stringify(e,null,2),n=new Blob([t],{type:"application/json"}),r=document.createElement("a");r.href=URL.createObjectURL(n),r.download="watchlist.json",document.body.append(r),r.click(),r.remove(),setTimeout(()=>URL.revokeObjectURL(r.href),1e3)}function sn(){let e=v(),t=(e.movies||[]).concat(e.shows||[]),n=new Map(t.map(r=>[ct(r),r]));return Array.from(K.values()).map(r=>n.get(r)).filter(Boolean)}function ut(){let e=document.getElementById("watchlistItems"),t=document.getElementById("watchlistEmpty");if(!e||!t)return;let n=sn();if(n.length===0){e.replaceChildren(),t.hidden=!1;return}t.hidden=!0;let r=document.createDocumentFragment();n.forEach(o=>{let a=document.createElement("li");a.className="watchlist-item";let s=document.createElement("span");s.className="title",s.textContent=o.title||"";let i=document.createElement("button");i.textContent="Entfernen",i.addEventListener("click",()=>{lt(o),ut()});let c=document.createElement("button");c.textContent="\xD6ffnen",c.addEventListener("click",()=>{var u,g;let l=o.type==="tv"?"show":"movie",d=((u=o.ids)==null?void 0:u.imdb)||((g=o.ids)==null?void 0:g.tmdb)||String(o.ratingKey||"");d&&(location.hash=`#/${l}/${d}`)}),a.append(s,c,i),r.append(a)}),e.replaceChildren(r)}function cn(){cr(),dt();let e=document.getElementById("openWatchlist"),t=document.getElementById("watchlistToggle"),n=document.getElementById("closeWatchlist"),r=document.getElementById("clearWatchlist"),o=document.getElementById("exportWatchlist");e&&e.addEventListener("click",()=>{tn(),it(!0)}),t&&t.addEventListener("click",()=>{let a=document.getElementById("watchlistPanel");a&&!a.hidden?nn():(tn(),it(!0))}),n&&n.addEventListener("click",()=>{nn()}),r&&r.addEventListener("click",()=>{dr()}),o&&o.addEventListener("click",()=>{ur()})}function it(e){let t=document.getElementById("watchlistToggle");t&&t.setAttribute("aria-expanded",e?"true":"false")}var rn,K,ft=F(()=>{U();rn="watchlist:v1",K=new Set});function dn(e,t){let n=fr(e,t);if(!n)return;let r=Array.isArray(e)&&!ht(e)?e||[]:Array.isArray(t)?t:[];n.replaceChildren(),(r||[]).forEach((o,a)=>n.append(hr(o,a)))}function ht(e){return e instanceof Element||typeof e=="string"}function fr(e,t){if(ht(e)){if(e instanceof Element)return e;if(typeof e=="string")return document.querySelector(e)}if(ht(t)){if(t instanceof Element)return t;if(typeof t=="string")return document.querySelector(t)}return document.getElementById("seasonsAccordion")}function hr(e,t){_(e);let n=document.createElement("article");n.className="season-card";let r=document.createElement("div");r.className="season-head";let o=document.createElement("div");o.className="season-thumb";let a=new Image;a.loading="lazy",a.decoding="async",a.src=e.thumbFile||"",a.alt=e.title||`Staffel ${e.seasonNumber||t+1}`,o.append(a);let s=document.createElement("div"),i=document.createElement("div");i.className="season-title",i.textContent=e.title||`Staffel ${e.seasonNumber||t+1}`;let c=document.createElement("div");c.className="season-sub";let l=e.year||e.releaseYear||"",d=Array.isArray(e.episodes)?e.episodes.length:e.episodeCount||0;c.textContent=[l,d?`${d} Episoden`:""].filter(Boolean).join(" \u2022 "),s.append(i,c);let u=document.createElement("div");u.className="chev",u.textContent="\u203A",r.append(o,s,u);let g=document.createElement("div");return g.className="season-body",(e.episodes||[]).forEach(f=>{_(f),g.append(gr(f))}),r.addEventListener("click",()=>n.classList.toggle("open")),n.append(r,g),n}function gr(e){var g;let t=document.createElement("div");t.className="episode";let n=document.createElement("div");n.className="ep-title";let r=e.seasonNumber!=null?Number(e.seasonNumber):null,o=e.episodeNumber!=null?Number(e.episodeNumber):null,a=e.seasonEpisode&&String(e.seasonEpisode).toUpperCase()||(Number.isFinite(r)&&Number.isFinite(o)?`S${String(r).padStart(2,"0")}E${String(o).padStart(2,"0")}`:"");n.textContent=`${a?a+" \u2022 ":""}${e.title||""}`;let s=document.createElement("div");s.className="badges";let i=Number((g=e.audienceRating)!=null?g:e.rating);if(Number.isFinite(i)){let f=document.createElement("span");f.className="badge",f.textContent=`${i.toFixed(1)}`,s.append(f)}let c=document.createElement("div");c.className="ep-meta";let l=e.durationMin||(e.duration?Math.round(Number(e.duration)/6e4):null),d=e.durationHuman||(l?`${l} min`:null),u=e.originallyAvailableAt||e.date||"";return c.textContent=[d,u].filter(Boolean).join(" \u2022 "),t.append(n,s,c),t}var un=F(()=>{fe()});function we(e){if(e==null||typeof e!="object")return e;if(typeof structuredClone=="function")try{return structuredClone(e)}catch{}try{return JSON.parse(JSON.stringify(e))}catch{}if(Array.isArray(e))return e.map(n=>we(n));let t={};for(let n of Object.keys(e))t[n]=we(e[n]);return t}function Pe(e){if(!e||typeof e!="object")return null;let t=we(e);return t.type==="show"&&(t.type="tv"),t.type||(t.type="movie"),t}function De(e){if(!e||typeof e!="object")return null;let t=we(e);return t.type!=="tv"&&(t.type="tv"),gt(t),t}function pr(e){if(!e||typeof e!="object")return null;let t=we(e);return gt(t),t}function fn(e){let t=Array.isArray(e==null?void 0:e.seasons)?e.seasons:[],n=t.some(o=>Array.isArray(o==null?void 0:o.episodes)&&o.episodes.length),r=Array.isArray(e==null?void 0:e.cast)?e.cast:Array.isArray(e==null?void 0:e.roles)?e.roles:[];return!t.length||!n||!r.length}function hn(e,t){if(!e)return e;if(t&&typeof t=="object"){let n=pr(t);Object.assign(e,n)}return gt(e),e}function gt(e){if(!e||typeof e!="object")return;pt(e),e.genres=bt(e.genres);let t=mr(e.cast||e.roles||[]);e.cast=t,e.roles=t,e.seasons=Array.isArray(e.seasons)?e.seasons.map(br).filter(Boolean):[];let n=Number(e.seasonCount);e.seasonCount=Number.isFinite(n)&&n>0?n:e.seasons.length}function br(e){if(!e||typeof e!="object")return null;let t={...e};return pt(t),t.genres=bt(t.genres),t.episodes=Array.isArray(t.episodes)?t.episodes.map(vr).filter(Boolean):[],t}function vr(e){if(!e||typeof e!="object")return null;let t={...e};return pt(t),t.genres=bt(t.genres),t}function pt(e){_(e)}function bt(e){if(!Array.isArray(e))return[];let t=new Set,n=[];return e.forEach(r=>{let o=null;if(typeof r=="string"){let a=r.trim();a&&(o={tag:a})}else if(r&&typeof r=="object"){let a=String(r.tag||r.title||r.name||r.label||"").trim();a&&(o={...r,tag:a})}o&&!t.has(o.tag)&&(t.add(o.tag),n.push(o))}),n}function mr(e){return Array.isArray(e)?e.map(t=>{if(!t)return null;if(typeof t=="string"){let n=t.trim();return n?{tag:n}:null}if(typeof t=="object"){let n=String(t.tag||t.name||t.role||"").trim();return n?{...t,tag:n}:{...t}}return null}).filter(Boolean):[]}var gn=F(()=>{fe()});function Ar(){if(M)return M;let e=document.getElementById("modal-root-v2");if(!e)return null;if(V=e,e.classList.add("modalv2-overlay"),e.hasAttribute("hidden")||e.setAttribute("hidden",""),e.dataset.modalv2Ready||(e.innerHTML=`
      <div class="modalv2-backdrop" data-modalv2-backdrop="1"></div>
      <div class="modalv2-dialog" role="dialog" aria-modal="true">
        <div class="modalv2-scroll" data-modalv2-scroll></div>
      </div>
    `,e.dataset.modalv2Ready="1",e.addEventListener("click",kr)),I=e.querySelector(".modalv2-dialog"),I&&!I.hasAttribute("tabindex")&&I.setAttribute("tabindex","-1"),X=e.querySelector("[data-modalv2-scroll]"),X&&!M){let t=X.querySelector(".modalv2");t?M=t:(M=document.createElement("div"),M.className="modalv2",M.setAttribute("hidden",""),X.appendChild(M))}return M}function kr(e){if(!V)return;let t=e.target;(t===V||t&&t.dataset&&t.dataset.modalv2Backdrop)&&mt()}function bn(){return I?Array.from(I.querySelectorAll('a[href], button:not([disabled]), textarea, input, select, [tabindex]:not([tabindex="-1"])')).filter(t=>t.hasAttribute("disabled")||t.getAttribute("aria-hidden")==="true"||t.hasAttribute("hidden")?!1:t.offsetParent!==null):[]}function Cr(){I&&(ie&&I.removeEventListener("keydown",ie),ie=e=>{if(e.key!=="Tab")return;let t=bn();if(!t.length)return;let n=t[0],r=t[t.length-1];e.shiftKey?document.activeElement===n&&(e.preventDefault(),r.focus()):document.activeElement===r&&(e.preventDefault(),n.focus())},I.addEventListener("keydown",ie))}function xr(){!I||!ie||(I.removeEventListener("keydown",ie),ie=null)}function Tr(){ge||(ge=e=>{e.key==="Escape"&&(e.preventDefault(),mt())},window.addEventListener("keydown",ge))}function Ir(){ge&&(window.removeEventListener("keydown",ge),ge=null)}function je(){let e=Ar();return!e||!V?null:(V.hidden=!1,V.setAttribute("aria-hidden","false"),document.body.classList.add("modalv2-open"),X&&(X.scrollTop=0),Cr(),Tr(),document.dispatchEvent(new CustomEvent("modal:open")),e)}function vt(){if(!I)return;let e=I.querySelector("#v2Close"),t=bn(),n=e&&!e.hasAttribute("hidden")?e:t[0];if(n||(n=I),n){let r=()=>{try{n.focus()}catch{}};(window.requestAnimationFrame||setTimeout)(r,0)}}function Lr(e){var r;let t=((r=e==null?void 0:e.tmdb)==null?void 0:r.poster)||(e==null?void 0:e.tmdbPoster),n=(e==null?void 0:e.poster)||(e==null?void 0:e.thumbFile)||(e==null?void 0:e.art)||"";return ae()&&t?t:n}function vn(e){let t=(e==null?void 0:e.runtimeMin)||(e==null?void 0:e.durationMin)||(e!=null&&e.duration?Math.round(Number(e.duration)/6e4):null);return Number.isFinite(t)?(e==null?void 0:e.type)==="tv"?`~${t} min/Ep`:`${t} min`:""}function Nr(e){var n;let t=Number((n=e==null?void 0:e.rating)!=null?n:e==null?void 0:e.audienceRating);return Number.isFinite(t)?`\u2605 ${P(t)}`:""}function mn(e){return(e==null?void 0:e.studio)||(e==null?void 0:e.network)||(e==null?void 0:e.studioName)||""}function Br(e){let t=[e==null?void 0:e.originallyAvailableAt,e==null?void 0:e.releaseDate,e==null?void 0:e.premiereDate,e==null?void 0:e.firstAired,e==null?void 0:e.airDate];for(let r of t){let o=r==null?"":String(r).trim();if(!o)continue;let a=new Date(o);if(Number.isFinite(a.getTime()))try{return a.toLocaleDateString("de-DE",{year:"numeric",month:"2-digit",day:"2-digit"})}catch{}let s=o.match(/^\d{4}-\d{2}-\d{2}/);if(s&&s[0])return s[0];if(o.length>=4)return o.slice(0,10)}let n=q(e);return n?String(n):""}function se(e){return Array.isArray(e)?e.map(t=>t?typeof t=="string"?t:t.tag||t.title||t.name||"":"").filter(Boolean):[]}function Fr(e){let n=(Array.isArray(e==null?void 0:e.genres)?e.genres:[]).map(r=>r?typeof r=="string"?r:r.tag||r.title||r.name||"":"").filter(Boolean);return Array.from(new Set(n))}function Mr(e){let t=[];return _e(e)&&t.push("Neu"),(e==null?void 0:e.type)==="tv"&&Number.isFinite(Number(e==null?void 0:e.seasonCount))&&t.push(`Staffeln: ${e.seasonCount}`),((e==null?void 0:e.genres)||[]).map(r=>r?typeof r=="string"?r:r.tag||r.title||r.name||"":"").filter(Boolean).forEach(r=>t.push(r)),t}function $r(e){return(Array.isArray(e==null?void 0:e.cast)?e.cast:Array.isArray(e==null?void 0:e.roles)?e.roles:[]).map(n=>{var i,c,l;if(!n)return null;if(typeof n=="string"){let d=String(n).trim();return d?{name:d,role:"",thumb:"",tmdbProfile:"",raw:null}:null}let r=String(n.tag||n.name||n.role||"").trim();if(!r)return null;let o=(()=>{let d=String(n.role||"").trim();return d?d.toLowerCase()===r.toLowerCase()?"":d:""})(),a=[(i=n==null?void 0:n.tmdb)==null?void 0:i.profile,(c=n==null?void 0:n.tmdb)==null?void 0:c.profile_path,(l=n==null?void 0:n.tmdb)==null?void 0:l.profilePath,n==null?void 0:n.tmdbProfile,n==null?void 0:n.profile,n==null?void 0:n.profile_path,n==null?void 0:n.profilePath].find(d=>typeof d=="string"&&d.trim()),s=[n==null?void 0:n.thumb,n==null?void 0:n.photo,n==null?void 0:n.image].find(d=>typeof d=="string"&&d.trim())||"";return{name:r,role:o,thumb:s,tmdbProfile:a?String(a).trim():"",raw:n}}).filter(Boolean)}function _r(e){let t=String(e||"").trim();if(!t)return"";if(/^https?:\/\//i.test(t))return t;if(t.startsWith("//"))return`https:${t}`;let n=t.startsWith("/")?t:`/${t}`;return`${yr}${wr}${n}`}function Pr(e){let t=String(e||"").trim();return t?/^https?:\/\//i.test(t)||t.startsWith("data:")?t:t.startsWith("//")?`https:${t}`:t:""}function Dr(e,t){var o,a,s;if(!e)return"";let n=e.raw||{};if(t){let i=[e.tmdbProfile,(o=n==null?void 0:n.tmdb)==null?void 0:o.profile,(a=n==null?void 0:n.tmdb)==null?void 0:a.profile_path,(s=n==null?void 0:n.tmdb)==null?void 0:s.profilePath,n==null?void 0:n.tmdbProfile,n==null?void 0:n.profile,n==null?void 0:n.profile_path,n==null?void 0:n.profilePath];for(let c of i){let l=_r(c);if(l)return l}}let r=[e.thumb,n==null?void 0:n.thumb,n==null?void 0:n.photo,n==null?void 0:n.image];for(let i of r){let c=Pr(i);if(c)return c}return""}function jr(e){let t=String(e||"").trim();if(!t)return"?";let r=t.split(/\s+/).slice(0,2).map(o=>o.charAt(0)).filter(Boolean);return r.length?r.join("").toUpperCase():t.charAt(0).toUpperCase()}function Rr(e){let t=e.querySelector(".v2-tabs");if(!t)return;let n=Array.from(t.querySelectorAll("button[data-t]")),r=s=>{n.forEach(i=>{let c=i.dataset.t===s;i.classList.toggle("active",c),i.setAttribute("aria-selected",c?"true":"false"),i.tabIndex=c?0:-1;let l=e.querySelector(`.v2-pane[data-pane="${i.dataset.t}"]`);l&&(l.hidden=!c,l.setAttribute("aria-hidden",l.hidden?"true":"false"))})},o=(s,i)=>{if(!n.length)return;let c=n.indexOf(s),l=i>0?0:n.length-1,d=c===-1?l:(c+i+n.length)%n.length,u=n[d];u&&(u.focus(),r(u.dataset.t))};t.addEventListener("click",s=>{let i=s.target.closest("button[data-t]");i&&(s.preventDefault(),r(i.dataset.t))}),t.addEventListener("keydown",s=>{let i=s.target.closest("button[data-t]");if(i)switch(s.key){case"ArrowLeft":case"ArrowUp":s.preventDefault(),o(i,-1);break;case"ArrowRight":case"ArrowDown":s.preventDefault(),o(i,1);break;case"Home":s.preventDefault(),n[0]&&(n[0].focus(),r(n[0].dataset.t));break;case"End":if(s.preventDefault(),n.length){let c=n[n.length-1];c.focus(),r(c.dataset.t)}break;default:break}});let a=n.find(s=>s.classList.contains("active"))||n[0];a&&r(a.dataset.t)}function Hr(e,t){let n=e.querySelector(".v2-cast");if(!n)return;n.innerHTML='<div class="v2-cast-scroll"></div>';let r=n.querySelector(".v2-cast-scroll");if(!r)return;let o=Array.isArray(t)?t.slice(0,12):[];if(!o.length){r.innerHTML='<span class="modalv2-loading">Keine Besetzungsdaten verf\xFCgbar.</span>',r.removeAttribute("role");return}r.setAttribute("role","list");let a=ae();o.forEach(s=>{let i=s&&typeof s=="object"&&"name"in s?s:(()=>{let f=String(s||"").trim();return f?{name:f,role:"",thumb:"",tmdbProfile:"",raw:null}:null})();if(!i||!i.name)return;let c=document.createElement("article");c.className="v2-cast-card",c.tabIndex=0,c.setAttribute("role","listitem");let l=String(i.role||"").trim();c.setAttribute("aria-label",l?`${i.name} \u2013 ${l}`:i.name);let d=document.createElement("div");d.className="v2-cast-avatar";let u=Dr(i,a);if(u){d.classList.add("has-image");let f=document.createElement("img");f.src=u,f.alt=i.name,f.loading="lazy",f.decoding="async",d.appendChild(f)}else{let f=document.createElement("span");f.className="v2-cast-initials",f.textContent=jr(i.name),f.setAttribute("aria-hidden","true"),d.appendChild(f)}let g=document.createElement("p");if(g.className="v2-cast-name",g.textContent=i.name,c.append(d,g),l){let f=document.createElement("p");f.className="v2-cast-role",f.textContent=l,c.append(f)}else c.classList.add("v2-cast-card--no-role");r.appendChild(c)}),r.children.length||(r.innerHTML='<span class="modalv2-loading">Keine Besetzungsdaten verf\xFCgbar.</span>',r.removeAttribute("role"))}function qr(e,t){let n=e.querySelector(".v2-overview");if(!n)return;let r=typeof t=="string"?t:"";if(!r){n.textContent="";return}let o=document.createElement("p");o.className="v2-overview-text line-clamp line-clamp-5",o.textContent=r;let a=document.createElement("button");a.type="button",a.className="v2-overview-toggle";let s=l=>{o.classList.toggle("is-expanded",l),a.setAttribute("aria-expanded",String(l)),a.textContent=l?"Weniger anzeigen":"Mehr anzeigen"};a.addEventListener("click",()=>{let l=a.getAttribute("aria-expanded")==="true";s(!l)}),n.replaceChildren(o,a),s(!1),(typeof requestAnimationFrame=="function"?requestAnimationFrame:l=>setTimeout(l,0))(()=>{o.scrollHeight>o.clientHeight+1||(o.classList.add("is-expanded"),a.hidden=!0)})}function Kr(e,t){let n=e.querySelector(".v2-details");if(!n)return;n.replaceChildren();let r=document.createElement("div");r.className="v2-details-grid";let o=[],a=Br(t);a&&o.push(["Ver\xF6ffentlichung",a]);let s=vn(t);s&&o.push(["Laufzeit",s]);let i=mn(t);i&&o.push(["Studio",i]);let c=((t==null?void 0:t.contentRating)||"").trim();c&&o.push(["Freigabe",c]);let l=P(t==null?void 0:t.rating),d=P(t==null?void 0:t.audienceRating),u=P(t==null?void 0:t.userRating);if(l?(o.push(["Bewertung",`\u2605 ${l}`]),d&&d!==l&&o.push(["Publikum",`\u2605 ${d}`])):d&&o.push(["Bewertung",`\u2605 ${d}`]),u&&o.push(["Eigene Wertung",`\u2605 ${u}`]),(t==null?void 0:t.type)==="tv"){let E=Number(t==null?void 0:t.seasonCount),x=Number.isFinite(E)?E:Array.isArray(t==null?void 0:t.seasons)?t.seasons.length:null;Number.isFinite(x)&&x>0&&o.push(["Staffeln",String(x)]);let S=Array.isArray(t==null?void 0:t.seasons)?t.seasons.reduce((N,L)=>{if(!L)return N;let m=Array.isArray(L.episodes)?L.episodes.length:0;return N+(Number.isFinite(m)?m:0)},0):null;Number.isFinite(S)&&S>0&&o.push(["Episoden",String(S)])}let g=se(t==null?void 0:t.countries);g.length&&o.push(["L\xE4nder",g.join(", ")]);let f=se(t==null?void 0:t.collections);f.length&&o.push(["Sammlungen",f.join(", ")]);let C=se(t==null?void 0:t.labels);if(C.length&&o.push(["Labels",C.join(", ")]),t!=null&&t.editionTitle&&o.push(["Edition",t.editionTitle]),t!=null&&t.originalTitle&&t.originalTitle!==t.title&&o.push(["Originaltitel",t.originalTitle]),o.length){let E=document.createElement("section");E.className="v2-details-section",E.dataset.section="general";let x=document.createElement("h3");x.className="v2-details-heading",x.textContent="Allgemein";let S=document.createElement("dl");S.className="v2-details-list",o.forEach(([N,L])=>{if(!N||!L)return;let m=document.createElement("dt");m.textContent=N;let B=document.createElement("dd");B.textContent=L,S.append(m,B)}),S.childElementCount&&(E.append(x,S),r.append(E))}let w=Fr(t);if(w.length){let E=document.createElement("section");E.className="v2-details-section",E.dataset.section="genres";let x=document.createElement("h3");x.className="v2-details-heading",x.textContent="Genres";let S=document.createElement("div");S.className="v2-chip-group",w.forEach(N=>{let L=document.createElement("span");L.className="chip",L.textContent=N,S.appendChild(L)}),E.append(x,S),r.append(E)}let T=[],j=se(t==null?void 0:t.directors);j.length&&T.push(["Regie",j.join(", ")]);let R=se(t==null?void 0:t.writers);R.length&&T.push(["Drehbuch",R.join(", ")]);let Q=se(t==null?void 0:t.producers);Q.length&&T.push(["Produktion",Q.join(", ")]);let ee=se((t==null?void 0:t.creators)||(t==null?void 0:t.showrunners));if((t==null?void 0:t.type)==="tv"&&ee.length&&T.push(["Creator",ee.join(", ")]),T.length){let E=document.createElement("section");E.className="v2-details-section",E.dataset.section="crew";let x=document.createElement("h3");x.className="v2-details-heading",x.textContent="Credits";let S=document.createElement("dl");S.className="v2-details-list",T.forEach(([N,L])=>{if(!N||!L)return;let m=document.createElement("dt");m.textContent=N;let B=document.createElement("dd");B.textContent=L,S.append(m,B)}),S.childElementCount&&(E.append(x,S),r.append(E))}if(r.childElementCount)n.appendChild(r);else{let E=document.createElement("p");E.className="v2-details-empty",E.textContent="Keine zus\xE4tzlichen Details verf\xFCgbar.",n.appendChild(E)}}function zr(e,t){let n=e.querySelector(".v2-seasons");if(!n)return;let r=Array.isArray(t==null?void 0:t.seasons)?t.seasons:[];if(!r.length){n.innerHTML='<p class="modalv2-loading">Keine Staffel-Informationen verf\xFCgbar.</p>';return}n.innerHTML="",dn(n,r)}function Or(e,t){var l,d;let n=e.querySelector("#v2Tmdb"),r=e.querySelector("#v2Imdb"),o=e.querySelector("#v2Trailer"),a=((l=t==null?void 0:t.ids)==null?void 0:l.tmdb)||(t==null?void 0:t.tmdbId),s=((d=t==null?void 0:t.ids)==null?void 0:d.imdb)||(t==null?void 0:t.imdbId),i=(t==null?void 0:t.trailer)||(t==null?void 0:t.trailerUrl),c=(t==null?void 0:t.type)==="tv"?"tv":"movie";n&&(a?(n.hidden=!1,n.href=`https://www.themoviedb.org/${c}/${a}`):(n.hidden=!0,n.removeAttribute("href"))),r&&(s?(r.hidden=!1,r.href=`https://www.imdb.com/title/${s}/`):(r.hidden=!0,r.removeAttribute("href"))),o&&(i?(o.hidden=!1,o.onclick=()=>window.open(i,"_blank","noopener")):(o.hidden=!0,o.onclick=null))}function Vr(e,t){let n=e.querySelector(".v2-title");n&&(n.textContent=(t==null?void 0:t.title)||(t==null?void 0:t.name)||"");let r=((t==null?void 0:t.tagline)||"").trim(),o=e.querySelector(".v2-meta"),a=e.querySelector(".v2-subline"),s=q(t),i=vn(t),c=Nr(t),l=mn(t),d=[s,i,c,l].filter(Boolean);if(a){let w=d.join(" \u2022 ");a.textContent=r||w,a.hidden=!(r||w)}o&&(o.textContent=r&&d.length?d.join(" \u2022 "):"",o.hidden=!(r&&d.length));let u=e.querySelector(".v2-chips");u&&(u.replaceChildren(),Mr(t).forEach(w=>{let T=document.createElement("span");T.className="chip",T.textContent=w,u.appendChild(T)}),u.hidden=!u.childElementCount);let g=e.querySelector(".v2-facts"),f=e.querySelector(".v2-facts-list");if(g&&f){let w=[];s&&w.push(["Jahr",s]);let T=((t==null?void 0:t.contentRating)||"").trim();T&&w.push(["Freigabe",T]),i&&w.push(["Laufzeit",i]),c&&w.push(["Bewertung",c]),l&&w.push(["Studio",l]),f.replaceChildren(),w.forEach(([j,R])=>{let Q=document.createElement("dt");Q.textContent=j;let ee=document.createElement("dd");ee.textContent=R,f.append(Q,ee)}),g.hidden=!w.length}let C=e.querySelector(".v2-poster img");if(C){let w=Lr(t);C.src=w||"",C.alt=t!=null&&t.title?`Poster: ${t.title}`:"",C.loading="lazy",C.decoding="async",C.classList.remove("is-ready"),w?(C.addEventListener("load",pn,{once:!0}),C.addEventListener("error",pn,{once:!0})):C.classList.add("is-ready")}}function pn(e){var t;(t=e.currentTarget)==null||t.classList.add("is-ready")}function Wr(e="Details werden geladen \u2026"){let t=je();if(!t)return;t.hidden=!1;let n=document.createElement("div");n.className="modalv2-loading",n.textContent=String(e||"Details werden geladen \u2026"),t.replaceChildren(n)}function yn(e){let t=je();if(!t)return;t.hidden=!1;let n=(e==null?void 0:e.type)==="tv";t.innerHTML=`
    <section class="v2-layout">
      <aside class="v2-side">
        <div class="v2-poster"><img alt=""></div>
        <div class="v2-facts" aria-label="Schnellinfos" hidden>
          <h3 class="v2-facts-title">Schnellinfos</h3>
          <dl class="v2-facts-list"></dl>
        </div>
      </aside>
      <div class="v2-info">
        <header class="v2-head">
          <div class="v2-titlebar">
            <div class="v2-title-wrap">
              <h2 class="v2-title" id="modalV2Title"></h2>
              <div class="v2-subline"></div>
              <div class="v2-meta"></div>
            </div>
            <div class="v2-actions" aria-label="Externe Aktionen">
              <button class="v2-icon-btn" id="v2Close" type="button" aria-label="Schlie\xDFen">
                <svg class="v2-icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                  <path d="M6 6l12 12M6 18L18 6" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"></path>
                </svg>
              </button>
              <a class="v2-icon-btn" id="v2Tmdb" target="_blank" rel="noopener noreferrer" aria-label="Auf TMDB \xF6ffnen" hidden>
                <svg class="v2-icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                  <path d="M4 9h16v10a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V9z" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linejoin="round"></path>
                  <path d="M4 9V7a2 2 0 0 1 2-2h1l2 4 2-4 2 4 2-4h1a2 2 0 0 1 2 2v2" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"></path>
                </svg>
              </a>
              <a class="v2-icon-btn" id="v2Imdb" target="_blank" rel="noopener noreferrer" aria-label="Auf IMDb \xF6ffnen" hidden>
                <svg class="v2-icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                  <path d="M12 4l2.4 4.9 5.4.8-3.9 3.8.9 5.4-4.8-2.5-4.8 2.5.9-5.4-3.9-3.8 5.4-.8z" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linejoin="round"></path>
                </svg>
              </a>
              <button class="v2-icon-btn" id="v2Trailer" type="button" aria-label="Trailer abspielen" hidden>
                <svg class="v2-icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                  <path d="M9 6l8 6-8 6V6z" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linejoin="round" stroke-linecap="round"></path>
                </svg>
              </button>
            </div>
          </div>
          <div class="v2-chips" aria-label="Attribute"></div>
        </header>
        <nav class="v2-tabs" aria-label="Details Navigation" role="tablist">
          <button type="button" data-t="overview" class="active" id="v2TabOverview" role="tab" aria-controls="v2PaneOverview" aria-selected="true">\xDCberblick</button>
          <button type="button" data-t="details" id="v2TabDetails" role="tab" aria-controls="v2PaneDetails" aria-selected="false">Details</button>
          ${n?'<button type="button" data-t="seasons" id="v2TabSeasons" role="tab" aria-controls="v2PaneSeasons" aria-selected="false">Staffeln</button>':""}
          <button type="button" data-t="cast" id="v2TabCast" role="tab" aria-controls="v2PaneCast" aria-selected="false">Cast</button>
        </nav>
        <section class="v2-body">
          <div class="v2-pane v2-overview" data-pane="overview" id="v2PaneOverview" role="tabpanel" aria-labelledby="v2TabOverview"></div>
          <div class="v2-pane v2-details" data-pane="details" id="v2PaneDetails" role="tabpanel" aria-labelledby="v2TabDetails" hidden></div>
          ${n?'<div class="v2-pane v2-seasons" data-pane="seasons" id="v2PaneSeasons" role="tabpanel" aria-labelledby="v2TabSeasons" hidden></div>':""}
          <div class="v2-pane v2-cast" data-pane="cast" id="v2PaneCast" role="tabpanel" aria-labelledby="v2TabCast" hidden></div>
        </section>
      </div>
    </section>
  `,Vr(t,e),Or(t,e),qr(t,(e==null?void 0:e.overview)||(e==null?void 0:e.summary)||""),Kr(t,e),(e==null?void 0:e.type)==="tv"&&zr(t,e),Hr(t,$r(e)),Rr(t);let r=t.querySelector("#v2Close");r&&r.addEventListener("click",mt),I&&I.setAttribute("aria-labelledby","modalV2Title"),vt()}async function Se(e){let t=++Y;he=document.activeElement instanceof HTMLElement?document.activeElement:null;let n=je();if(!n)return;let r=Ur(e);if(t===Y){if(!r){n.hidden=!1;let o=document.createElement("div");o.className="modalv2-loading",o.textContent="Film konnte nicht geladen werden.",n.replaceChildren(o),pe=null,Ee=null,vt();return}pe=r,Ee="movie",yn(r)}}async function Ae(e){let t=++Y;he=document.activeElement instanceof HTMLElement?document.activeElement:null;let n=Jr(e),r=je();if(!r||t!==Y)return;if(!n){r.hidden=!1;let a=document.createElement("div");a.className="modalv2-loading",a.textContent="Seriendetails konnten nicht geladen werden.",r.replaceChildren(a),pe=null,Ee=null,vt();return}pe=n,Ee="show";let o=n;if(fn(o)){if(Wr(),t!==Y)return;let a=null;try{a=await Zt(o)}catch{a=null}if(t!==Y)return;a&&(hn(o,a),pe=o)}t===Y&&yn(o)}function mt(){if(Y++,!!V){if(V.hidden=!0,V.setAttribute("aria-hidden","true"),document.body.classList.remove("modalv2-open"),xr(),Ir(),M&&(M.innerHTML="",M.setAttribute("hidden","")),X&&(X.scrollTop=0),he&&typeof he.focus=="function")try{he.focus()}catch{}he=null,pe=null,Ee=null,document.dispatchEvent(new CustomEvent("modal:close"))}}function Ur(e){if(e==="demo")return Pe(Er);if(e&&typeof e=="object")return Pe(e);let t=e==null?"":String(e).trim();if(!t)return null;let n=v(),o=(Array.isArray(n==null?void 0:n.movies)?n.movies:[]).find(a=>wn(a,t));return o?Pe(o):null}function Jr(e){if(e==="demo")return De(Sr);if(e&&typeof e=="object")return De(e);let t=e==null?"":String(e).trim();if(!t)return null;let n=v(),o=(Array.isArray(n==null?void 0:n.shows)?n.shows:[]).find(a=>wn(a,t));return o?De(o):null}function wn(e,t){var r,o;if(!e)return!1;let n=String(t||"").trim();return n?!!((r=e==null?void 0:e.ids)!=null&&r.imdb&&String(e.ids.imdb)===n||(o=e==null?void 0:e.ids)!=null&&o.tmdb&&String(e.ids.tmdb)===n||(e==null?void 0:e.ratingKey)!=null&&String(e.ratingKey)===n):!1}var yr,wr,V,I,X,M,he,ie,ge,Y,Ee,pe,Er,Sr,yt=F(()=>{un();ye();U();fe();gn();yr="https://image.tmdb.org/t/p/",wr="w185",V=null,I=null,X=null,M=null,he=null,ie=null,ge=null,Y=0,Ee=null,pe=null,Er={type:"movie",title:"Lumen: Der Aufbruch",tagline:"Eine cineastische Demo f\xFCr das neue Modal",overview:"Die Crew der Lumen wagt den Sprung in unerforschte Welten und enth\xFCllt dabei eine Energiequelle, die alles ver\xE4ndern k\xF6nnte. Zwischen Loyalit\xE4t, Intrigen und berauschenden Bildern entfaltet sich ein Abenteuer, das f\xFCr das Cinematic-Layout entworfen wurde.",summary:"Die Crew der Lumen entdeckt eine Energiequelle, die das Schicksal der Menschheit ver\xE4ndern k\xF6nnte.",runtimeMin:142,contentRating:"FSK 12",studio:"Aurora Pictures",rating:8.4,audienceRating:8,userRating:8.7,originallyAvailableAt:"2024-05-17",countries:[{tag:"Deutschland"},{tag:"Kanada"}],genres:[{tag:"Science-Fiction"},{tag:"Drama"},{tag:"Abenteuer"}],cast:[{name:"Mara Lenz",role:"Captain Alys Vega",tmdbProfile:"/3rxeQHiuCYaXJqfyUG8yt0YdHtH.jpg"},{name:"Tariq Benassi",role:"Navigator Elian Soh",tmdbProfile:"/wGl8DCycJ2U0FvJbLABd8R4FS3X.jpg"},{name:"Hannah Ko",role:"Wissenschaftlerin Dr. Mira Han",tmdbProfile:"/hJuDvwzS0SPlsE6MN4pF2UYDGtt.jpg"}],directors:[{tag:"Jonas Falk"}],writers:[{tag:"Lea Winter"}],producers:[{tag:"Studio Atlas"}],labels:[{tag:"Dolby Atmos"},{tag:"4K"}],collections:[{tag:"Aurora-Saga"}],trailer:"https://www.youtube.com/watch?v=dQw4w9WgXcQ",tmdbPoster:"https://image.tmdb.org/t/p/w500/2lUYbD2C3XSuwqMUbDVDQuz9mqz.jpg",ids:{tmdb:"demo-lumen",imdb:"tt0000001"},addedAt:"2024-06-01T12:00:00Z"},Sr={type:"tv",title:"Aurora Station",tagline:"Neue Horizonte in Serie",overview:"Die Besatzung der Aurora Station sch\xFCtzt eine Au\xDFenposten an der Grenze des bekannten Raums. Jede Episode verbindet kosmische R\xE4tsel mit pers\xF6nlichen Geschichten \u2013 perfekt geeignet, um das Cinematic-Modal auszuprobieren.",summary:"Ein orbitaler Au\xDFenposten ringt um Hoffnung und Zusammenhalt, w\xE4hrend eine fremde Macht erwacht.",contentRating:"TV-14",studio:"Nebula Network",originallyAvailableAt:"2023-09-14",seasonCount:2,genres:[{tag:"Science-Fiction"},{tag:"Drama"}],countries:[{tag:"USA"},{tag:"Island"}],creators:[{tag:"Elina S\xF8rensen"}],cast:[{name:"Noah Adler",role:"Commander Ivar Hale",tmdbProfile:"/4MqUjb1SYrzHmFSVoKHSKP5MGGm.jpg"},{name:"Sofia Idris",role:"Ingenieurin Kaia Rhee",tmdbProfile:"/tHMgWz6EpRdbgoMJ2JfzFzjg3QB.jpg"},{name:"Helena Ruiz",role:"Strategin Tala Voss",tmdbProfile:"/ziEuG1ESSofxDCspotYlrwz3Tq.png"}],seasons:[{title:"Staffel 1",seasonNumber:1,year:2023,thumbFile:"https://image.tmdb.org/t/p/w300/4dO2YpC8S9nLmQAXoJLRV8LZRxn.jpg",episodes:[{title:"Kapitel Eins: Erwachen",seasonNumber:1,episodeNumber:1,durationMin:54,originallyAvailableAt:"2023-09-14",audienceRating:8.6},{title:"Kapitel Zwei: Grenzwelten",seasonNumber:1,episodeNumber:2,durationMin:52,originallyAvailableAt:"2023-09-21",audienceRating:8.2}]},{title:"Staffel 2",seasonNumber:2,year:2024,thumbFile:"https://image.tmdb.org/t/p/w300/bSL4hY8SgdKzac8AUbWQm74y87C.jpg",episodes:[{title:"Kapitel Dreizehn: Resonanz",seasonNumber:2,episodeNumber:1,durationMin:56,originallyAvailableAt:"2024-02-08",audienceRating:8.9},{title:"Kapitel Vierzehn: Echo",seasonNumber:2,episodeNumber:2,durationMin:55,originallyAvailableAt:"2024-02-15",audienceRating:8.7}]}],tmdbPoster:"https://image.tmdb.org/t/p/w500/a4I481szRmycyreQTLrRe4f4YJe.jpg",ids:{tmdb:"demo-aurora-station",imdb:"tt0000002"}}});var kn={};Ge(kn,{renderGrid:()=>$});function Gr(e){let t=A("article","cardv2");t.style.contentVisibility="auto",t.dataset.kind=(e==null?void 0:e.type)==="tv"?"show":"movie",t.tabIndex=0,t.setAttribute("role","button"),e!=null&&e.title&&t.setAttribute("aria-label",e.title);let n=ro(e),r=An(e,n,io(e)),o=A("div","cardv2__body"),a=document.createElement("h3");a.className="cardv2__title",a.textContent=(e==null?void 0:e.title)||"";let s=A("div","cardv2__meta"),i=ao(e);s.textContent=i.join(" \u2022 ");let c=A("div","cardv2__tags"),l=oe(e==null?void 0:e.genres);st(c,l,3);let d=A("div","cardv2__actions"),u=document.createElement("button");return u.type="button",u.className="watch-btn btn",En(u,e),u.addEventListener("click",g=>{g.stopPropagation(),lt(e),En(u,e)}),d.append(u),o.append(a,s,c,d),t.append(r,o),t.addEventListener("click",()=>Sn(e)),t.addEventListener("keydown",g=>{g.target===t&&(g.key==="Enter"||g.key===" ")&&(g.preventDefault(),Sn(e))}),t}function Yr(e){return(e&&e.collections||[]).map(t=>t&&(t.tag||t.title||t.name||"")).filter(Boolean)}function Xr(e,t){let n=(t||[]).slice().sort((u,g)=>{let f=Number(q(u))||0,C=Number(q(g))||0;return f!==C?f-C:(u.title||"").localeCompare(g.title||"","de")}),r=n.map(u=>Number(q(u))||0).filter(Boolean),o=r.length?Math.min(...r):"",a=n.map(u=>new Date(u.addedAt||0).getTime()).filter(Number.isFinite),s=a.length?new Date(Math.max(...a)).toISOString():null,i=n.map(u=>{var g;return Number((g=u.rating)!=null?g:u.audienceRating)}).filter(Number.isFinite),c=i.length?i.reduce((u,g)=>u+g,0)/i.length:null,l=n.find(u=>u.thumbFile)||n[0]||null,d=Array.from(new Set(n.flatMap(u=>oe(u.genres)))).slice(0,4);return{isCollectionGroup:!0,type:"collection",title:e,collectionName:e,items:n,itemCount:n.length,year:o||"",addedAt:s,rating:c,posterItem:l,genres:d}}function Zr(e){let t=document.getElementById("groupCollections"),n=document.getElementById("collectionFilter"),r=n&&n.value;if(!t||!t.checked||r)return e;let o=new Map;e.forEach(s=>{Yr(s).forEach(i=>{o.has(i)||o.set(i,[]),o.get(i).push(s)})});let a=[];return o.forEach((s,i)=>{a.push(Xr(i,s))}),a.sort((s,i)=>s.title.localeCompare(i.title,"de")),a}function Qr(e){let t=A("article","cardv2 collection");t.style.contentVisibility="auto",t.dataset.kind="collection",t.tabIndex=0,t.setAttribute("role","button"),e!=null&&e.title&&t.setAttribute("aria-label",e.title);let n=e.posterItem||{},r=An(n,oo(e),0,e.title||""),o=A("div","cardv2__body"),a=document.createElement("h3");a.className="cardv2__title",a.textContent=e.title||"";let s=A("div","cardv2__meta"),i=[e.year,`${e.itemCount} Titel`];Number.isFinite(e.rating)&&i.push(`\u2605 ${P(e.rating)}`),s.textContent=i.filter(Boolean).join(" \u2022 ");let c=A("div","cardv2__tags");return st(c,e.genres||[],3),o.append(a,s,c),t.append(r,o),t.addEventListener("click",()=>{let l=document.getElementById("collectionFilter");l&&(l.value=e.collectionName||e.title||"",l.dispatchEvent(new Event("change",{bubbles:!0})))}),t.addEventListener("keydown",l=>{if(l.target===t&&(l.key==="Enter"||l.key===" ")){l.preventDefault();let d=document.getElementById("collectionFilter");d&&(d.value=e.collectionName||e.title||"",d.dispatchEvent(new Event("change",{bubbles:!0})))}}),t}function $(e){let{movies:t,shows:n,filtered:r}=v(),o=(e==="shows"?n:t)||[],a=Array.isArray(r)?r:o,s=Zr(a),i=document.getElementById("grid");if(!i)return;eo(i);let c=document.createDocumentFragment();s.forEach(d=>c.append(d.isCollectionGroup?Qr(d):Gr(d))),i.replaceChildren(c),to(i);let l=document.getElementById("empty");l&&(l.hidden=s.length>0)}function eo(e){e&&(e.classList.remove("is-entering","is-ready"),e.classList.add("is-leaving"))}function to(e){e&&(e.classList.remove("is-leaving"),e.classList.add("is-entering"),requestAnimationFrame(()=>{e.classList.add("is-ready"),setTimeout(()=>e.classList.remove("is-entering","is-ready"),240)}))}function An(e,t=[],n=0,r=""){let o=A("div","cardv2__thumb"),a=new Image;a.loading="lazy",a.decoding="async",a.alt=r||(e==null?void 0:e.title)||"";let s=no(e);if(s&&(a.src=s),o.append(a),Array.isArray(t)&&t.length){let l=A("div","cardv2__badge-group");t.forEach(d=>{d instanceof HTMLElement&&l.append(d)}),l.childElementCount&&o.append(l)}let i=document.createElement("div");i.className="cardv2__thumb-overlay",i.setAttribute("aria-hidden","true"),o.append(i);let c=Number(n)||0;if(c>0){let l=A("div","cardv2__progress"),d=document.createElement("span");d.style.width=`${Math.max(0,Math.min(100,c))}%`,l.append(d),o.append(l)}return o}function no(e){var r;if(!e)return"";let t=ae()&&(((r=e==null?void 0:e.tmdb)==null?void 0:r.poster)||(e==null?void 0:e.tmdbPoster)),n=(e==null?void 0:e.thumbFile)||(e==null?void 0:e.poster)||(e==null?void 0:e.art)||(e==null?void 0:e.thumb)||"";return t||n||""}function ro(e){var o;let t=[];_e(e)&&t.push(ke("Neu"));let n=String((e==null?void 0:e.contentRating)||"").trim();n&&t.push(ke(n));let r=Number((o=e==null?void 0:e.rating)!=null?o:e==null?void 0:e.audienceRating);return Number.isFinite(r)&&t.push(ke(`\u2605 ${P(r)}`)),t.slice(0,3)}function oo(e){let t=[];return Number.isFinite(e==null?void 0:e.itemCount)&&e.itemCount>0&&t.push(ke(`${e.itemCount} Titel`)),e!=null&&e.year&&t.push(ke(String(e.year))),t}function ke(e){let t=document.createElement("span");return t.className="badge",t.textContent=String(e||""),t}function En(e,t){if(!e)return;let n=an(t);e.textContent=n?"Gemerkt":"Merken",e.classList.toggle("active",n),e.setAttribute("aria-pressed",n?"true":"false")}function ao(e){var s;let t=[],n=q(e);n&&t.push(String(n));let r=so(e);r&&t.push(r);let o=Number((s=e==null?void 0:e.rating)!=null?s:e==null?void 0:e.audienceRating);Number.isFinite(o)&&t.push(`\u2605 ${P(o)}`);let a=(e==null?void 0:e.studio)||(e==null?void 0:e.network)||"";return a&&t.push(a),t}function so(e){var r,o;let t=(o=(r=e==null?void 0:e.runtimeMin)!=null?r:e==null?void 0:e.durationMin)!=null?o:e!=null&&e.duration?Math.round(Number(e.duration)/6e4):null,n=Number(t);return!Number.isFinite(n)||n<=0?"":(e==null?void 0:e.type)==="tv"?`~${n} min/Ep`:`${n} min`}function io(e){var r;let t=Number((r=e==null?void 0:e.viewOffset)!=null?r:e==null?void 0:e.viewoffset),n=Number(e==null?void 0:e.duration);return!Number.isFinite(t)||!Number.isFinite(n)||n<=0?0:Math.max(1,Math.min(100,Math.round(t/n*100)))}function co(e){var n,r;if(!e)return"";let t=((n=e==null?void 0:e.ids)==null?void 0:n.imdb)||((r=e==null?void 0:e.ids)==null?void 0:r.tmdb);return t?String(t):e!=null&&e.ratingKey?String(e.ratingKey):""}function lo(e,t){if(!e||!t)return;let n=`#/${e}/${t}`;try{if(history&&typeof history.pushState=="function"){location.hash===n&&typeof history.replaceState=="function"?history.replaceState(null,"",n):history.pushState(null,"",n);return}}catch{}try{window.__skipNextHashNavigation=!0}catch{}location.hash=n}function Sn(e){if(!e)return;let t=(e==null?void 0:e.type)==="tv"?"show":"movie",n=co(e);n&&lo(t,n),t==="show"?Ae(e):Se(e)}var wt=F(()=>{U();Re();Le();ye();ft();yt()});var Tt={};Ge(Tt,{applyFilters:()=>be,computeFacets:()=>kt,initFilters:()=>xt,renderFacets:()=>Ct,updateFiltersAndGrid:()=>xe});function Ce(e){return e.year?e.year:e.originallyAvailableAt?String(e.originallyAvailableAt).slice(0,4):""}function St(e){return(e&&e.collections||[]).map(t=>t&&(t.tag||t.title||t.name||"")).filter(Boolean)}function uo(e){if(!(e!=null&&e.addedAt))return!1;let t=new Date(e.addedAt).getTime();if(!Number.isFinite(t))return!1;let n=v().cfg||{},r=Number(n.newDays||30);return Date.now()-t<=r*24*60*60*1e3}function Cn(e){return String(e||"").toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")}function fo(e,t){let n=Cn(t.query||""),r=!!t.onlyNew,o=Number(t.yearFrom)||null,a=Number(t.yearTo)||null,s=t.genres||new Set,i=t.collection||"";if(n&&!Cn([e.title,e.originalTitle,e.summary,e.studio,oe(e.genres).join(" "),(e.roles||[]).map(d=>d&&(d.tag||d.role||d.name)).join(" "),St(e).join(" ")].filter(Boolean).join(" ")).includes(n)||r&&!uo(e))return!1;let c=Number(Ce(e))||null;if(o&&(!c||c<o)||a&&(!c||c>a))return!1;if(s.size){let l=new Set(oe(e.genres));for(let d of s)if(!l.has(d))return!1}return!(i&&!new Set(St(e)).has(i))}function ho(e,t){let n=e.slice();switch(t){case"year-desc":n.sort((r,o)=>(Number(Ce(o))||0)-(Number(Ce(r))||0)||String(r.title||"").localeCompare(String(o.title||""),"de"));break;case"year-asc":n.sort((r,o)=>(Number(Ce(r))||0)-(Number(Ce(o))||0)||String(r.title||"").localeCompare(String(o.title||""),"de"));break;case"title-desc":n.sort((r,o)=>String(o.title||"").localeCompare(String(r.title||""),"de"));break;case"added-desc":n.sort((r,o)=>new Date(o.addedAt||0)-new Date(r.addedAt||0));break;case"title-asc":default:n.sort((r,o)=>String(r.title||"").localeCompare(String(o.title||""),"de"))}return n}function kt(e,t){let n=new Set,r=new Set,o=new Set,a=i=>(i||[]).forEach(c=>{oe(c.genres).forEach(d=>n.add(d));let l=c.year||(c.originallyAvailableAt?String(c.originallyAvailableAt).slice(0,4):"");l&&r.add(Number(l)),St(c).forEach(d=>o.add(d))});a(e),a(t);let s=[...r].sort((i,c)=>i-c);return{genres:[...n].sort(),years:s,collections:[...o].sort((i,c)=>i.localeCompare(c,"de"))}}function Ct(e){let t=k("#yearFrom"),n=k("#yearTo");t&&t.replaceChildren(new Option("Ab Jahr",""),...e.years.map(a=>new Option(String(a),String(a)))),n&&n.replaceChildren(new Option("Bis Jahr",""),...e.years.map(a=>new Option(String(a),String(a))));let r=k("#collectionFilter");r&&r.replaceChildren(new Option("Alle Collections",""),...e.collections.map(a=>new Option(a,a)));let o=k("#genreFilters");if(o){let a=e.genres.map(s=>{let i=document.createElement("button");return i.type="button",i.className="chip",i.textContent=s,i.dataset.name=s,i});o.replaceChildren(...a),At()}}function go(){var c,l,d,u,g;let e=document.getElementById("search")||document.getElementById("q"),t=((e==null?void 0:e.value)||"").trim(),n=((c=k("#onlyNew"))==null?void 0:c.checked)||!1,r=((l=k("#yearFrom"))==null?void 0:l.value)||"",o=((d=k("#yearTo"))==null?void 0:d.value)||"",a=((u=k("#collectionFilter"))==null?void 0:u.value)||"",s=((g=k("#sort"))==null?void 0:g.value)||"title-asc",i=new Set;return document.querySelectorAll("#genreFilters .chip.active").forEach(f=>i.add(f.dataset.name)),{query:t,onlyNew:n,yearFrom:r,yearTo:o,collection:a,genres:i,sort:s}}function be(){let e=v(),n=e.view==="shows"?e.shows:e.movies,r=go(),o=(n||[]).filter(s=>fo(s,r)),a=ho(o,r.sort);return te({filtered:a}),a}function po(){Et||(Et=Promise.resolve().then(()=>(wt(),kn))),Et.then(e=>{let t=e&&e.renderGrid;typeof t=="function"&&t(v().view)}).catch(console.error)}function xe(){let e=be();return po(),bo(e),e}function bo(e){try{let n={items:Array.isArray(e)?e.slice():[],view:v().view};window.dispatchEvent(new CustomEvent("filters:updated",{detail:n}))}catch{}}function At(){let e=document.getElementById("genreFilters");if(!e)return;let t=e.querySelectorAll(".chip.active").length;e.dataset.state=t>0?"active":"empty",e.dataset.count=String(t)}function xt(){let e=k("#sort");e&&e.options.length===0&&[["title-asc","Titel A\u2013Z"],["title-desc","Titel Z\u2013A"],["year-desc","Jahr \u2193"],["year-asc","Jahr \u2191"],["added-desc","Zuletzt hinzugef\xFCgt"]].forEach(([o,a])=>e.add(new Option(a,o)));let t=(o,a="input")=>{let s=k(o);s&&(s.addEventListener(a,()=>{xe()}),a==="input"&&s instanceof HTMLInputElement&&s.type==="search"&&s.addEventListener("search",()=>{xe()}))};t("#search"),t("#q"),t("#onlyNew","change"),t("#yearFrom","change"),t("#yearTo","change"),t("#collectionFilter","change"),t("#sort","change"),t("#groupCollections","change");let n=k("#yearReset");n&&n.addEventListener("click",()=>{let o=k("#yearFrom"),a=k("#yearTo");o&&(o.value=""),a&&(a.value=""),xe()});let r=k("#genreFilters");r&&(r.addEventListener("click",o=>{let a=o.target;a instanceof HTMLElement&&a.classList.contains("chip")&&(a.classList.toggle("active"),At(),xe())}),At())}var Et,Re=F(()=>{U();Le();ye();Et=null});var me={};Ge(me,{clearCache:()=>yo,hydrateOptional:()=>Nt,validateToken:()=>xo});function vo(){try{return new Map(JSON.parse(localStorage.getItem("tmdbCache")||"[]"))}catch{return new Map}}function mo(){try{localStorage.setItem("tmdbCache",JSON.stringify(Array.from(ce.entries())))}catch{}}function yo(){try{localStorage.removeItem("tmdbCache"),ce=new Map}catch{}}function wo(e){try{let t=localStorage.getItem("tmdbToken");if(t)return{kind:"bearer",value:t}}catch{}return e!=null&&e.tmdbApiKey?{kind:"apikey",value:String(e.tmdbApiKey)}:{kind:"none",value:""}}function Eo(e){var s,i;let t=e.type==="tv"?"tv":"movie",n=((s=e==null?void 0:e.ids)==null?void 0:s.imdb)||"",r=((i=e==null?void 0:e.ids)==null?void 0:i.tmdb)||"",o=(e.title||"").toLowerCase(),a=String(e.year||"").slice(0,4);return[t,n,r,o,a].filter(Boolean).join("|")}function It(e,t){if(!t||t.kind==="none")return{url:e,init:{}};if(t.kind==="bearer")return{url:e,init:{headers:{Authorization:`Bearer ${t.value}`,Accept:"application/json"}}};let n=e.includes("?")?"&":"?";return{url:`${e}${n}api_key=${encodeURIComponent(t.value)}`,init:{headers:{Accept:"application/json"}}}}async function qe(e,t){let{url:n,init:r}=It(e,t),o=await fetch(n,r);if(!o.ok)throw new Error("HTTP "+o.status);return o.json()}function So(e){return e!=null&&e.file_path?He+xn+e.file_path:""}function Ao(e){return e!=null&&e.file_path?He+Tn+e.file_path:""}async function Lt(e,t,n,r){let o=await qe(`${ve}/${e}/${t}?language=${encodeURIComponent(n||"de-DE")}`,r),a=await qe(`${ve}/${e}/${t}/images`,r).catch(()=>({posters:[],backdrops:[]})),s=So((a.posters||[])[0])||(o.poster_path?He+xn+o.poster_path:""),i=Ao((a.backdrops||[])[0])||(o.backdrop_path?He+Tn+o.backdrop_path:"");return{id:o.id,poster:s,backdrop:i,url:`https://www.themoviedb.org/${e}/${o.id}`}}async function ko(e,t,n,r,o){let a=encodeURIComponent(t||""),s=n?`&year=${encodeURIComponent(String(n))}`:"",c=((await qe(`${ve}/search/${e}?query=${a}${s}&language=${encodeURIComponent(r||"de-DE")}`,o)).results||[])[0];if(!c)throw new Error("not found");return Lt(e,c.id,r,o)}async function Co(e,t,n){var s,i;let r=e.type==="tv"?"tv":"movie",o=Eo(e);if(ce.has(o))return ce.get(o);let a;try{if((s=e==null?void 0:e.ids)!=null&&s.tmdb)a=await Lt(r,e.ids.tmdb,t.lang,n);else if((i=e==null?void 0:e.ids)!=null&&i.imdb){let c=await qe(`${ve}/find/${e.ids.imdb}?external_source=imdb_id&language=${encodeURIComponent(t.lang||"de-DE")}`,n),l=r==="movie"?(c.movie_results||[])[0]:(c.tv_results||[])[0];if(l)a=await Lt(r,l.id,t.lang,n);else throw new Error("not found")}else a=await ko(r,e.title,e.year,t.lang,n)}catch{a=null}return ce.set(o,a),mo(),a}async function Nt(e,t,n={}){try{ce=ce||vo();let r=wo(n);if(!r.value)return;let o=(e||[]).concat(t||[]),a=0,s=40,i=async()=>{let c=o.slice(a,a+4);a+=4,await Promise.all(c.map(async l=>{let d=await Co(l,n,r);d&&(l.tmdb={id:d.id,poster:d.poster,backdrop:d.backdrop,url:d.url},l.ids=l.ids||{},!l.ids.tmdb&&d.id&&(l.ids.tmdb=String(d.id)))}));try{window.dispatchEvent(new CustomEvent("tmdb:chunk",{detail:{updated:c.length,index:a}}))}catch{}if(a<Math.min(o.length,s))(window.requestIdleCallback||setTimeout)(i,250);else try{window.dispatchEvent(new CustomEvent("tmdb:done",{detail:{total:Math.min(o.length,s)}}))}catch{}};i()}catch{}}async function xo(e){let t=String(e||"").trim();if(!t)throw new Error("empty");let n=/^[a-f0-9]{32}$/i.test(t),r=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+$/.test(t),o=a=>{try{let s=a.split(".")[1],c=atob((l=>l+"=".repeat((4-l.length%4)%4))(s.replace(/-/g,"+").replace(/_/g,"/")));return JSON.parse(c)}catch{return null}};if(n){let{url:a,init:s}=It(`${ve}/configuration`,{kind:"apikey",value:t});return(await fetch(a,s)).ok?{ok:!0,as:"apikey",hint:"v3Key"}:{ok:!1,as:"apikey",hint:"looksV3"}}if(r){let a=o(t);if(a&&typeof a=="object"){let c=String(a.iss||"");if(c&&!/themoviedb\.org/i.test(c))return{ok:!1,as:"bearer",hint:"issMismatch"}}let{url:s,init:i}=It(`${ve}/trending/movie/day`,{kind:"bearer",value:t});try{if((await fetch(s,i)).ok)return{ok:!0,as:"bearer",hint:null}}catch{}return{ok:!0,as:"bearer",hint:"structOnly"}}return{ok:!1,as:"bearer",hint:null}}var ve,He,xn,Tn,ce,le=F(()=>{ve="https://api.themoviedb.org/3",He="https://image.tmdb.org/t/p/",xn="w342",Tn="w780"});U();Le();var H,Ne,Be,J;function Xe(){if(!H&&(H=k("#loaderOverlay"),!H)){H=A("div","loader-overlay"),H.id="loaderOverlay",H.hidden=!0;let e=A("div","loader");Be=A("div","msg",""),Ne=A("div","bar"),e.append(Be,Ne),H.append(e),document.body.append(H)}}function Rt(){Xe(),H.hidden=!1}function de(e,t){Xe(),Be&&(Be.textContent=e||""),Ne&&(Ne.style.width=(t||0)+"%")}function Fe(){Xe(),H.hidden=!0}function Ht(e=18){let t=k("#grid");if(t){J=A("div","skeleton");for(let n=0;n<e;n++)J.append(A("div","skel"));t.replaceChildren(J)}}function Ze(){J&&J.parentElement&&J.parentElement.removeChild(J),J=null}fe();Re();wt();yt();le();ft();U();fe();et();function Ln(){let e=document.getElementById("openDebug");e&&e.addEventListener("click",()=>{To()})}function To(){var t,n,r,o;let e=document.getElementById("debugOverlay");e||(e=document.createElement("div"),e.id="debugOverlay",e.className="debug-overlay",e.innerHTML=`
      <div class="debug-dialog">
        <div class="debug-header"><h2>Debug</h2></div>
        <div class="debug-body">
          <pre id="debugPre" class="debug-pre"></pre>
          <div class="debug-cache-controls">
            <h3>Cache-Verwaltung</h3>
            <div id="cacheStats" class="cache-stats"></div>
            <div class="cache-buttons">
              <button id="debugClearExpired" class="btn">Abgelaufene l\xF6schen</button>
              <button id="debugClearAll" class="btn">Alles l\xF6schen</button>
            </div>
          </div>
        </div>
        <div class="debug-actions">
          <button id="debugCopy" class="btn">Copy report</button>
          <button id="debugClose" class="btn">Schlie\xDFen</button>
        </div>
      </div>`,document.body.append(e)),e.hidden=!1,Bt(),e.addEventListener("click",a=>{a.target===e&&In()}),(t=document.getElementById("debugClose"))==null||t.addEventListener("click",In,{once:!0}),(n=document.getElementById("debugCopy"))==null||n.addEventListener("click",Io,{once:!0}),(r=document.getElementById("debugClearExpired"))==null||r.addEventListener("click",()=>{Me(),Bt()},{once:!0}),(o=document.getElementById("debugClearAll"))==null||o.addEventListener("click",()=>{confirm("Wirklich den gesamten Cache l\xF6schen?")&&(zt(),Bt())},{once:!0})}function In(){let e=document.getElementById("debugOverlay");e&&(e.hidden=!0)}function Bt(){let e=document.getElementById("debugPre");if(!e)return;let t=v(),n=Qt(),r=t.cfg||{},o=Qe(),a={view:t.view,counts:{movies:(t.movies||[]).length,shows:(t.shows||[]).length,filtered:(t.filtered||[]).length},dataSources:n,cache:o,tmdb:{enabled:!!r.tmdbEnabled,lang:r.lang,tokenPresent:!!(localStorage.getItem("tmdbToken")||r.tmdbApiKey)},useTmdbImages:localStorage.getItem("useTmdb")==="1",reduceMotion:localStorage.getItem("prefReduceMotion")==="1",locationHash:location.hash,userAgent:navigator.userAgent};e.textContent=JSON.stringify(a,null,2);let s=document.getElementById("cacheStats");s&&o&&(s.innerHTML=`
      <p>Eintr\xE4ge gesamt: <strong>${o.totalEntries}</strong></p>
      <p>G\xFCltig: <strong>${o.validEntries}</strong> | Abgelaufen: <strong>${o.expiredEntries}</strong></p>
      <p>Gr\xF6\xDFe: <strong>${o.totalSizeMB} MB</strong></p>
    `)}function Io(){var n;let e=document.getElementById("debugPre");if(!e)return;let t=e.textContent||"";(n=navigator.clipboard)==null||n.writeText(t).catch(()=>{try{let r=document.createElement("textarea");r.value=t,document.body.append(r),r.select(),document.execCommand("copy"),r.remove()}catch{}})}ye();var D=null;function ze(){D||(D=document.createElement("div"),D.id="errorContainer",D.className="error-container",D.setAttribute("role","alert"),D.setAttribute("aria-live","polite"),document.body.appendChild(D)),window.addEventListener("unhandledrejection",e=>{var t;Ke("Ein unerwarteter Fehler ist aufgetreten",(t=e.reason)==null?void 0:t.message),e.preventDefault()}),window.addEventListener("error",e=>{var t;Ke("Ein Fehler ist aufgetreten",(t=e.error)==null?void 0:t.message)})}function Ke(e,t="",n=5e3){D||ze();let r=document.createElement("div");return r.className="error-toast",r.innerHTML=`
    <div class="error-toast-content">
      <div class="error-toast-icon">\u26A0\uFE0F</div>
      <div class="error-toast-text">
        <div class="error-toast-title">${Ft(e)}</div>
        ${t?`<div class="error-toast-message">${Ft(t)}</div>`:""}
      </div>
      <button class="error-toast-close" aria-label="Schlie\xDFen">\xD7</button>
    </div>
  `,r.querySelector(".error-toast-close").addEventListener("click",()=>{r.classList.add("error-toast-exit"),setTimeout(()=>r.remove(),300)}),D.appendChild(r),n>0&&setTimeout(()=>{r.parentNode&&(r.classList.add("error-toast-exit"),setTimeout(()=>r.remove(),300))},n),requestAnimationFrame(()=>{r.classList.add("error-toast-show")}),r}function Nn(e,t){D||ze();let n=document.createElement("div");n.className="error-toast error-toast-retryable",n.innerHTML=`
    <div class="error-toast-content">
      <div class="error-toast-icon">\u26A0\uFE0F</div>
      <div class="error-toast-text">
        <div class="error-toast-title">${Ft(e)}</div>
      </div>
      <button class="error-toast-retry">Erneut versuchen</button>
      <button class="error-toast-close" aria-label="Schlie\xDFen">\xD7</button>
    </div>
  `;let r=n.querySelector(".error-toast-retry"),o=n.querySelector(".error-toast-close");return r.addEventListener("click",async()=>{n.remove();try{await t()}catch{}}),o.addEventListener("click",()=>{n.classList.add("error-toast-exit"),setTimeout(()=>n.remove(),300)}),D.appendChild(n),requestAnimationFrame(()=>{n.classList.add("error-toast-show")}),n}function Ft(e){let t=document.createElement("div");return t.textContent=e,t.innerHTML}var Mt=0,Oe=!1,$t=!1,z=null;function Bn(){z=document.getElementById("filterBar"),z&&(window.addEventListener("scroll",No,{passive:!0}),document.addEventListener("modal:open",Ve),document.addEventListener("modal:close",We),document.addEventListener("settings:open",Ve),document.addEventListener("settings:close",We),document.addEventListener("watchlist:open",Ve),document.addEventListener("watchlist:close",We))}function No(){$t||(window.requestAnimationFrame(()=>{Bo(),$t=!1}),$t=!0)}function Bo(){let e=window.scrollY;e>Mt&&e>100?Oe||(Oe=!0,Ve()):e<Mt&&Oe&&(Oe=!1,We()),Mt=e}function Ve(){z&&(z.classList.add("filters--hidden"),z.setAttribute("aria-hidden","true"),z.setAttribute("inert",""))}function We(){if(!z)return;let e=document.querySelector('.modalv2-overlay[aria-hidden="false"]'),t=document.querySelector('.settings-overlay[aria-hidden="false"]'),n=document.querySelector('.watchlist-panel[aria-hidden="false"]');e||t||n||(z.classList.remove("filters--hidden"),z.setAttribute("aria-hidden","false"),z.removeAttribute("inert"))}var Ie=null,W=null;function Te(e,t=!0){let n=document.getElementById("footerMeta");if(n){let o=n.querySelector("#footerStatus");o?o.textContent=e:n.textContent=e,n.dataset.state=t?"loading":"ready"}let r=document.getElementById("grid");r&&r.setAttribute("aria-busy",t?"true":"false")}async function Fo(){ze(),Jo(),Rt(),Te("Initialisiere \u2026",!0),de("Initialisiere \u2026",8),Ht(18);let e=await fetch("config.json").then(n=>n.json()).catch(n=>(Ke("Konfiguration konnte nicht geladen werden","Verwende Standardeinstellungen"),{startView:"movies",tmdbEnabled:!1}));te({cfg:e,view:e.startView||"movies"});try{Te("Filme laden \u2026",!0),de("Filme laden \u2026",25);let n=await nt();Te("Serien laden \u2026",!0),de("Serien laden \u2026",45);let r=await rt();Te("Filter vorbereiten \u2026",!0),de("Filter vorbereiten \u2026",60);let o=kt(n,r);te({movies:n,shows:r,facets:o}),Te("Ansicht aufbauen \u2026",!0),de("Ansicht aufbauen \u2026",85),Ze(),Dt(),Ct(o),xt(),be(),Mo(!0),$(v().view),$o(),Fe(),e.tmdbEnabled&&(window.requestIdleCallback||setTimeout)(()=>{var a;return(a=Nt)==null?void 0:a(n,r,e)},400),cn(),Uo(e),Go(),Yo(),Xo(),Zo(),Bn(),Z(),Ln()}catch(n){throw Fe(),Ze(),Nn("Fehler beim Laden der Daten",()=>window.location.reload()),n}let t;window.addEventListener("tmdb:chunk",()=>{t||(t=requestAnimationFrame(()=>{t=null;try{localStorage.getItem("useTmdb")==="1"&&($(v().view),Z())}catch{}}))}),window.addEventListener("tmdb:done",()=>{try{localStorage.getItem("useTmdb")==="1"&&($(v().view),Z())}catch{}})}var _t=null,Pt="";window.addEventListener("hashchange",()=>{if(window.__skipNextHashNavigation){try{window.__skipNextHashNavigation=!1,Pt=location.hash||""}catch{}return}let e=location.hash||"";_t&&clearTimeout(_t),_t=setTimeout(()=>{if(e===Pt)return;Pt=e;let t=e;if(/^#\/(movies|shows)$/.test(t)){let i=t.includes("shows")?"shows":"movies";te({view:i});let c=be();Dt(),$(i),Z(c);return}let n=t.match(/^#\/(movie|show)\/(.+)/);if(!n)return;let[,r,o]=n,s=((r==="movie"?v().movies:v().shows)||[]).find(i=>{var c,l;return((c=i==null?void 0:i.ids)==null?void 0:c.imdb)===o||((l=i==null?void 0:i.ids)==null?void 0:l.tmdb)===o||String(i==null?void 0:i.ratingKey)===o});s&&(r==="show"?Ae(s):Se(s))},50)});function Dt(){let e=document.getElementById("libraryTabs");if(!e)return;let t=Array.from(e.querySelectorAll("[data-lib]")),n=v().view==="shows"?"shows":"movies";t.forEach(r=>{let o=r.dataset.lib==="series"?"shows":"movies",a=n===o;r.classList.toggle("is-active",a),r.setAttribute("aria-pressed",a?"true":"false"),r.dataset.bound!=="true"&&(r.addEventListener("click",()=>{let s=r.dataset.lib==="series"?"shows":"movies";if(v().view===s)return;te({view:s});try{window.__skipNextHashNavigation=!0}catch{}location.hash=s==="movies"?"#/movies":"#/shows",Dt();let i=be();$(s),Z(i)}),r.dataset.bound="true")})}function Mo(e=!1){let t=document.getElementById("heroStats");if(!t)return;let n=v(),r=(n.movies||[]).length,o=(n.shows||[]).length,a=t.querySelector('[data-stat="movies"]'),s=t.querySelector('[data-stat="shows"]');!a||!s||(e?(Fn(a,r),Fn(s,o)):(a.textContent=String(r),s.textContent=String(o)))}function Fn(e,t){if(!e)return;let n=Number(e.textContent)||0,r=Number(t)||0;if(n===r){e.textContent=String(r);return}let o=480,a=performance.now();function s(i){let c=Math.min(1,(i-a)/o),l=Math.round(n+(r-n)*(c<.5?2*c*c:-1+(4-2*c)*c));e.textContent=String(l),c<1?requestAnimationFrame(s):e.textContent=String(r)}requestAnimationFrame(s)}function $o(){let e=document.getElementById("footerMeta");if(!e)return;let t=document.getElementById("footerStatus"),n=v(),r=n.movies||[],o=n.shows||[],a=r.concat(o).map(l=>new Date(l.addedAt||0).getTime()).filter(Number.isFinite),i=(a.length?new Date(Math.max(...a)):new Date).toISOString().slice(0,10);t&&(t.textContent=`Stand: ${i}`),e.dataset.state="ready";let c=document.getElementById("grid");c&&c.setAttribute("aria-busy","false")}function Z(e){let t=document.getElementById("hero"),n=document.getElementById("heroTitle"),r=document.getElementById("heroSubtitle"),o=document.getElementById("heroCta");if(!t||!n||!r||!o)return;_o();let a=Po(e);if(!a){Ie=null,n.textContent=W.title,r.textContent=W.subtitle,r.dataset.taglinePaused="0",delete r.dataset.heroBound,r.classList.remove("is-fading"),o.textContent=W.cta,o.disabled=!0,o.setAttribute("aria-disabled","true"),o.removeAttribute("aria-label"),o.onclick=null,t.style.backgroundImage="",t.classList.remove("has-poster"),t.dataset.heroKind="",t.dataset.heroId="";return}Ie=a;let s=a.type==="tv"?"show":"movie",i=zo(a);n.textContent=a.title||W.title,r.textContent=jo(a),r.dataset.taglinePaused="1",r.dataset.heroBound="1",r.classList.remove("is-fading");let c=s==="show"?"Serien-Details \xF6ffnen":"Film-Details \xF6ffnen";o.textContent=c,o.disabled=!1,o.setAttribute("aria-disabled","false"),o.setAttribute("aria-label",a.title?`${c}: ${a.title}`:c),o.onclick=()=>Oo(a,s,i),t.dataset.heroKind=s,t.dataset.heroId=i||"";let l=Wo(a);l?(t.style.backgroundImage=`url(${l})`,t.classList.add("has-poster")):(t.style.backgroundImage="",t.classList.remove("has-poster"))}function _o(){var e,t,n;W||(W={title:((e=document.getElementById("heroTitle"))==null?void 0:e.textContent)||"",subtitle:((t=document.getElementById("heroSubtitle"))==null?void 0:t.textContent)||"",cta:((n=document.getElementById("heroCta"))==null?void 0:n.textContent)||""})}function Po(e){if(Array.isArray(e)){let r=e.filter($n);return r.length?Mn(r):null}let n=Do().filter($n);return n.length?Mn(n):null}function Mn(e){if(e.length===1)return e[0];let t=Math.floor(Math.random()*e.length),n=e[t];return Ie&&e.length>1&&n===Ie&&e.find(o=>o!==Ie)||n}function Do(){let e=v(),t=e.view==="shows"?"shows":"movies",r=(Array.isArray(e.filtered)&&e.filtered.length?e.filtered:null)||(t==="shows"?e.shows:e.movies)||[];return Array.isArray(r)?r:[]}function $n(e){return!!e&&typeof e=="object"&&!e.isCollectionGroup&&e.type!=="collection"}function jo(e){var i;let t=[],n=q(e);n&&t.push(String(n));let r=Ro(e);r&&t.push(r);let o=Number((i=e==null?void 0:e.rating)!=null?i:e==null?void 0:e.audienceRating);Number.isFinite(o)&&t.push(`\u2605 ${P(o)}`);let a=Ho(e,2);a.length&&t.push(a.join(", "));let s=qo(e);return s?t.length?`${t.join(" \u2022 ")} \u2014 ${s}`:s:t.length?t.join(" \u2022 "):(W==null?void 0:W.subtitle)||""}function Ro(e){var r,o;let t=(o=(r=e==null?void 0:e.runtimeMin)!=null?r:e==null?void 0:e.durationMin)!=null?o:e!=null&&e.duration?Math.round(Number(e.duration)/6e4):null,n=Number(t);return!Number.isFinite(n)||n<=0?"":(e==null?void 0:e.type)==="tv"?`~${n} min/Ep`:`${n} min`}function Ho(e,t=3){let n=Array.isArray(e==null?void 0:e.genres)?e.genres:[],r=[];return n.forEach(a=>{if(!a)return;if(typeof a=="string"){r.push(a);return}let s=a.tag||a.title||a.name||a.label||"";s&&r.push(s)}),Array.from(new Set(r)).slice(0,Math.max(0,t))}function qo(e){let t=[e==null?void 0:e.tagline,e==null?void 0:e.summary,e==null?void 0:e.plot,e==null?void 0:e.overview];for(let n of t){if(typeof n!="string")continue;let r=n.trim();if(r)return Ko(r,220)}return""}function Ko(e,t){let n=String(e||"").trim();return n?n.length<=t?n:`${n.slice(0,Math.max(0,t-1)).trimEnd()}\u2026`:""}function zo(e){var t,n;return e?(t=e==null?void 0:e.ids)!=null&&t.imdb?String(e.ids.imdb):(n=e==null?void 0:e.ids)!=null&&n.tmdb?String(e.ids.tmdb):(e==null?void 0:e.ratingKey)!=null?String(e.ratingKey):"":""}function Oo(e,t,n){n&&Vo(t,n),t==="show"?Ae(e):Se(e)}function Vo(e,t){if(!e||!t)return;let n=`#/${e}/${t}`;try{if(history&&typeof history.pushState=="function"){location.hash===n&&typeof history.replaceState=="function"?history.replaceState(null,"",n):history.pushState(null,"",n);return}}catch{}try{window.__skipNextHashNavigation=!0}catch{}location.hash=n}function Wo(e){var a,s,i,c,l;if(!e)return"";let t=ae(),n=[(a=e==null?void 0:e.tmdb)==null?void 0:a.backdrop,(s=e==null?void 0:e.tmdb)==null?void 0:s.backdrop_path,(i=e==null?void 0:e.tmdb)==null?void 0:i.backdropPath,(c=e==null?void 0:e.tmdb)==null?void 0:c.background,(l=e==null?void 0:e.tmdb)==null?void 0:l.art],r=[e==null?void 0:e.art,e==null?void 0:e.background,e==null?void 0:e.thumbBackground,e==null?void 0:e.coverArt,e==null?void 0:e.thumb,e==null?void 0:e.thumbFile];if(t){let d=n.find(_n);if(d)return d}return r.find(_n)||""}function _n(e){return typeof e=="string"&&e.trim().length>0}window.addEventListener("filters:updated",e=>{let t=e==null?void 0:e.detail,n=Array.isArray(t==null?void 0:t.items)?t.items:null;Z(n)});Fo();window.addEventListener("load",()=>{try{Fe()}catch{}});function Uo(e){let t=document.getElementById("settingsOverlay"),n=t==null?void 0:t.querySelector(".settings-dialog"),r=document.getElementById("settingsBtn"),o=document.getElementById("openSettings"),a=document.getElementById("settingsClose2"),s=document.getElementById("tmdbTokenInput"),i=document.getElementById("tmdbSave"),c=document.getElementById("tmdbTest"),l=document.getElementById("tmdbStatus"),d=document.getElementById("tmdbClearCache"),u=document.getElementById("tmdbStatusBadge"),g=document.getElementById("prefReduceMotion"),f=document.getElementById("useTmdbSetting"),C=document.getElementById("resetFilters");t&&t.hidden&&t.setAttribute("aria-hidden","true");let w=null,T="",j=!1,R=new Map,Q='a[href], button:not([disabled]), input:not([disabled]), select:not([disabled]), textarea:not([disabled]), [tabindex]:not([tabindex="-1"])';function ee(){return t?Array.from(t.querySelectorAll(Q)).filter(h=>!h.hasAttribute("disabled")&&h.getAttribute("aria-hidden")!=="true"):[]}function E(){n&&typeof n.focus=="function"?n.focus({preventScroll:!0}):t&&typeof t.focus=="function"&&t.focus({preventScroll:!0})}function x(h){if(!t)return;let y=Array.from(document.body.children).filter(p=>p!==t);h?y.forEach(p=>{R.has(p)||R.set(p,{ariaHidden:p.hasAttribute("aria-hidden")?p.getAttribute("aria-hidden"):null,inert:p.hasAttribute("inert")}),p.setAttribute("aria-hidden","true"),p.setAttribute("inert","")}):(y.forEach(p=>{let b=R.get(p);b?(b.ariaHidden===null||b.ariaHidden===void 0?p.removeAttribute("aria-hidden"):p.setAttribute("aria-hidden",b.ariaHidden),b.inert?p.setAttribute("inert",""):p.removeAttribute("inert"),R.delete(p)):(p.removeAttribute("aria-hidden"),p.removeAttribute("inert"))}),R.clear())}function S(){!t||j||(j=!0,t.hidden=!1,t.setAttribute("aria-hidden","false"),w=document.activeElement instanceof HTMLElement?document.activeElement:null,T=document.body.style.overflow,document.body.style.overflow="hidden",x(!0),Pn(),requestAnimationFrame(E),document.dispatchEvent(new CustomEvent("settings:open")))}function N(){!t||!j||(j=!1,t.hidden=!0,t.setAttribute("aria-hidden","true"),x(!1),document.body.style.overflow=T,w&&typeof w.focus=="function"&&w.focus(),w=null,document.dispatchEvent(new CustomEvent("settings:close")))}function L(h){if(!j)return;if(h.key==="Escape"){h.preventDefault(),N();return}if(h.key!=="Tab")return;let y=ee();if(!y.length){h.preventDefault(),E();return}let p=y[0],b=y[y.length-1],O=document.activeElement;h.shiftKey?(O===p||!t.contains(O))&&(h.preventDefault(),b.focus()):O===b&&(h.preventDefault(),p.focus())}r&&r.addEventListener("click",S),o&&o.addEventListener("click",()=>{S()}),a&&a.addEventListener("click",N),t&&t.addEventListener("click",h=>{h.target===t&&N()}),t&&t.addEventListener("keydown",L);function m(h="",y=""){if(l){l.textContent=h,l.dataset.kind=y,u&&(u.dataset.kind=y||"",u.title=h||"");try{if(y==="error"&&e&&e.tmdbApiKey){let p=String(localStorage.getItem("tmdbToken")||"").trim(),b=String((s==null?void 0:s.value)||"").trim();if(p&&b){try{localStorage.removeItem("tmdbToken")}catch{}s&&(s.value=""),B(!0);let O="Ung\xFCltiger Token entfernt. Verwende API Key aus config.json.";l.textContent=O,l.dataset.kind="info",u&&(u.dataset.kind="info",u.title=O)}}}catch{}}}function B(h){if(f&&(f.disabled=!h,f.title=f.disabled?"Nur verf\xFCgbar mit g\xFCltigem Token oder API Key.":"",!h&&f.checked)){try{localStorage.setItem("useTmdb","0")}catch{}f.checked=!1,$(v().view)}}function Pn(){let h="";try{s&&(s.value=h=localStorage.getItem("tmdbToken")||"")}catch{}try{g&&(g.checked=localStorage.getItem("prefReduceMotion")==="1")}catch{}try{f&&(f.checked=localStorage.getItem("useTmdb")==="1",f.disabled=!h,f.title=f.disabled?"Nur verf\xFCgbar mit g\xFCltigem Token.":"")}catch{}try{B(!!h||!!(e&&e.tmdbApiKey))}catch{}m("",""),h||m("Kein Token hinterlegt. TMDB ist deaktiviert.","info"),e!=null&&e.tmdbEnabled||m("Hinweis: TMDB in config.json deaktiviert (tmdbEnabled=false).","info"),h?(async()=>{var y;m("Pr\xFCfe Token...","pending");try{let p=await Promise.resolve().then(()=>(le(),me)),b=await((y=p.validateToken)==null?void 0:y.call(p,h));b&&b.ok?(B(!0),b.as==="bearer"?m("Token g\xFCltig (v4 Bearer).","success"):b.as==="apikey"&&m('API Key g\xFCltig (v3). Tipp: dauerhaft in site/config.json unter "tmdbApiKey" eintragen.',"success")):(B(!1),(b==null?void 0:b.hint)==="looksV3"?m('Eingegebener Wert sieht wie ein v3 API Key aus. Bitte in config.json als "tmdbApiKey" eintragen oder v4 Bearer Token verwenden.',"error"):m("Token ung\xFCltig oder keine Berechtigung (401).","error"))}catch{m("Pr\xFCfung fehlgeschlagen. Netzwerk/Browser-Konsole pr\xFCfen.","error")}})():B(!!(e&&e.tmdbApiKey))}i&&i.addEventListener("click",async()=>{var y;let h=String((s==null?void 0:s.value)||"").trim();try{localStorage.setItem("tmdbToken",h)}catch{}if(!h){m("Kein Token hinterlegt. TMDB ist deaktiviert.","info"),B(!!(e&&e.tmdbApiKey));return}m("Pr\xFCfe Token...","pending");try{let p=await Promise.resolve().then(()=>(le(),me)),b=await((y=p.validateToken)==null?void 0:y.call(p,h));b&&b.ok?(B(!0),b.as==="bearer"?m("Token g\xFCltig (v4 Bearer).","success"):b.as==="apikey"&&m('API Key g\xFCltig (v3). Tipp: dauerhaft in site/config.json unter "tmdbApiKey" eintragen.',"success")):(B(!1),(b==null?void 0:b.hint)==="looksV3"?m('Eingegebener Wert sieht wie ein v3 API Key aus. Bitte in config.json als "tmdbApiKey" eintragen oder v4 Bearer Token verwenden.',"error"):m("Token ung\xFCltig oder keine Berechtigung (401).","error"))}catch{m("Pr\xFCfung fehlgeschlagen. Netzwerk/Browser-Konsole pr\xFCfen.","error")}}),c&&c.addEventListener("click",async()=>{var y;let h=String((s==null?void 0:s.value)||"").trim();if(!h){m("Bitte Token eingeben.","error");return}m("Pr\xFCfe Token...","pending");try{let p=await Promise.resolve().then(()=>(le(),me)),b=await((y=p.validateToken)==null?void 0:y.call(p,h));b&&b.ok?b.as==="bearer"?m("Token g\xFCltig (v4 Bearer).","success"):b.as==="apikey"&&m('API Key g\xFCltig (v3). Tipp: dauerhaft in site/config.json unter "tmdbApiKey" eintragen.',"success"):(b==null?void 0:b.hint)==="looksV3"?m('Eingegebener Wert sieht wie ein v3 API Key aus. Dieser funktioniert hier nicht als Bearer. Bitte in config.json als "tmdbApiKey" eintragen oder v4 Bearer Token verwenden.',"error"):m("Token ung\xFCltig oder keine Berechtigung (401).","error")}catch{m("Pr\xFCfung fehlgeschlagen. Netzwerk/Browser-Konsole pr\xFCfen.","error")}}),d&&d.addEventListener("click",()=>{Promise.resolve().then(()=>(le(),me)).then(h=>{var y;return(y=h.clearCache)==null?void 0:y.call(h)})}),g&&g.addEventListener("change",()=>{try{localStorage.setItem("prefReduceMotion",g.checked?"1":"0")}catch{}document.documentElement.classList.toggle("reduce-motion",g.checked)}),f&&f.addEventListener("change",()=>{try{localStorage.setItem("useTmdb",f.checked?"1":"0")}catch{}f.checked&&!window.__tmdbHydrationStarted&&(window.__tmdbHydrationStarted=1,Promise.resolve().then(()=>(le(),me)).then(h=>{var p;let y=v();(p=h.hydrateOptional)==null||p.call(h,y.movies,y.shows,y.cfg)}).catch(()=>{}),setTimeout(()=>{f.checked&&$(v().view)},1200),setTimeout(()=>{f.checked&&$(v().view)},3e3)),$(v().view),Z()}),C&&C.addEventListener("click",()=>{let h=document.getElementById("search");h&&(h.value="");let y=document.getElementById("q");y&&(y.value="");let p=document.getElementById("onlyNew");p&&(p.checked=!1);let b=document.getElementById("yearFrom"),O=document.getElementById("yearTo");b&&(b.value=""),O&&(O.value="");let jt=document.getElementById("collectionFilter");jt&&(jt.value=""),document.querySelectorAll("#genreFilters .chip.active").forEach(Je=>Je.classList.remove("active"));let Ue=document.getElementById("genreFilters");Ue&&(Ue.dataset.state="empty",Ue.dataset.count="0"),Promise.resolve().then(()=>(Re(),Tt)).then(Je=>{let Dn=Je.applyFilters();$(v().view),Z(Dn)})})}function Jo(){try{let e=localStorage.getItem("prefReduceMotion")==="1";document.documentElement.classList.toggle("reduce-motion",e)}catch{}}function Go(){let e=document.getElementById("toggleAdvanced"),t=document.getElementById("advancedFilters");if(!e||!t)return;let n=!1,r=0,o=()=>{n=!1,r&&(clearTimeout(r),r=0),t.dataset.state==="closing"?(t.dataset.state="closed",t.hidden=!0,t.style.removeProperty("--advanced-max")):t.dataset.state==="open"?t.style.removeProperty("--advanced-max"):t.dataset.state==="expanding"&&(t.dataset.state="open",t.style.removeProperty("--advanced-max"))},a=()=>{r&&clearTimeout(r),r=window.setTimeout(o,320)};t.addEventListener("transitionend",c=>{c.target!==t||c.propertyName!=="max-height"||o()});let s=()=>{n||(n=!0,t.hidden=!1,t.dataset.state="expanding",t.setAttribute("aria-hidden","false"),t.style.setProperty("--advanced-max","0px"),requestAnimationFrame(()=>{let c=t.scrollHeight;t.style.setProperty("--advanced-max",c+"px"),t.dataset.state="open",a()}))},i=()=>{if(n)return;n=!0;let c=t.scrollHeight;t.style.setProperty("--advanced-max",c+"px"),t.dataset.state="closing",t.setAttribute("aria-hidden","true"),requestAnimationFrame(()=>{t.style.setProperty("--advanced-max","0px"),a()})};e.addEventListener("click",()=>{e.getAttribute("aria-expanded")==="true"?(e.setAttribute("aria-expanded","false"),i()):(e.setAttribute("aria-expanded","true"),s())})}function Yo(){let e=document.getElementById("siteLogo");e&&e.addEventListener("error",()=>{e.classList.add("logo-missing");let a=document.querySelector(".site-header__brand-text .site-header__label");a&&a.classList.remove("sr-only")});let t=document.getElementById("heroSubtitle"),n=["Offline st\xF6bern & Wunschlisten teilen","Filter. Finden. Freuen.","Filme & Serien \u2013 stressfrei sichtbar","Schneller als jeder SMB-Share","Merkliste zuerst, Streit sp\xE4ter"],r=0;t&&(t.textContent=n[r]);function o(){!t||t.dataset.taglinePaused==="1"||(t.classList.add("is-fading"),setTimeout(()=>{if(!t||t.dataset.taglinePaused==="1"){t&&t.classList.remove("is-fading");return}r=(r+1)%n.length,t.textContent=n[r],t.classList.remove("is-fading")},280))}t&&(t.dataset.taglinePaused="0",window.__taglineTicker||(window.__taglineTicker=setInterval(o,6e3),setTimeout(o,3e3)))}function Xo(){let e=document.getElementById("scrollProgress");if(!e)return;let t=()=>{let n=document.documentElement.scrollTop||document.body.scrollTop||0,r=document.documentElement.scrollHeight-document.documentElement.clientHeight||1,o=Math.max(0,Math.min(100,n/r*100));e.style.width=o+"%"};addEventListener("scroll",t,{passive:!0}),t()}function Zo(){let e=document.getElementById("scrollTop");if(!e)return;let t=()=>{let n=window.scrollY||0;e.style.display=n>300?"block":"none"};addEventListener("scroll",t,{passive:!0}),t(),e.addEventListener("click",()=>window.scrollTo({top:0,behavior:"smooth"}))}
//# sourceMappingURL=main.js.map
