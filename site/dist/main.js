var Gl=Object.defineProperty;var I=(e,t)=>()=>(e&&(t=e(e=0)),t);var rt=(e,t)=>{for(var n in t)Gl(e,n,{get:t[n],enumerable:!0})};function $e(e){Object.assign(Br,e),Nr.forEach(t=>t(Br))}function To(e){return Nr.add(e),()=>Nr.delete(e)}var Br,Nr,x,ie=I(()=>{Br={view:"movies",movies:[],shows:[],facets:{},filtered:[],cfg:{},heroPolicy:null,heroPolicyIssues:[]},Nr=new Set,x=()=>Br});function w(e,t,n){let r=document.createElement(e);return t&&(r.className=t),n!=null&&(r.textContent=n),r}var K,Sn=I(()=>{K=(e,t=document)=>t.querySelector(e)});function Hr(){if(!ge&&(ge=K("#loaderOverlay"),!ge)){ge=w("div","loader-overlay"),ge.id="loaderOverlay",ge.hidden=!0;let e=w("div","loader");vn=w("div","msg",""),En=w("div","bar"),e.append(vn,En),ge.append(e),document.body.append(ge)}}function Co(){Hr(),ge.hidden=!1}function De(e,t){Hr(),vn&&(vn.textContent=e||""),En&&(En.style.width=(t||0)+"%")}function An(){Hr(),ge.hidden=!0}function Io(e=18){let t=K("#grid");if(t){xe=w("div","skeleton");for(let n=0;n<e;n++)xe.append(w("div","skel"));t.replaceChildren(xe)}}function $r(){xe&&xe.parentElement&&xe.parentElement.removeChild(xe),xe=null}var ge,En,vn,xe,xo=I(()=>{Sn()});function Lo(e,t,n=864e5){try{let r=Oe+e,i={value:t,timestamp:Date.now(),ttl:n};localStorage.setItem(r,JSON.stringify(i)),ql()}catch(r){if(r.name==="QuotaExceededError"){Ro();try{let i=Oe+e,o={value:t,timestamp:Date.now(),ttl:n};localStorage.setItem(i,JSON.stringify(o))}catch{}}}}function Fo(e){try{let t=Oe+e,n=localStorage.getItem(t);if(!n)return null;let r=JSON.parse(n);if(typeof r.timestamp!="number"||typeof r.ttl!="number")return localStorage.removeItem(t),null;let i=Date.now();return r.timestamp+r.ttl<i?(localStorage.removeItem(t),null):r.value}catch{return null}}function Po(){try{Object.keys(localStorage).forEach(t=>{t.startsWith(Oe)&&localStorage.removeItem(t)})}catch{}}function _n(){try{let e=Object.keys(localStorage),t=Date.now(),n=0;e.forEach(r=>{if(r.startsWith(Oe))try{let i=JSON.parse(localStorage.getItem(r));i.timestamp+i.ttl<t&&(localStorage.removeItem(r),n++)}catch{localStorage.removeItem(r),n++}}),n>0}catch{}}function Dr(){try{let t=Object.keys(localStorage).filter(s=>s.startsWith(Oe)),n=Date.now(),r=0,i=0,o=0;return t.forEach(s=>{let a=localStorage.getItem(s);r+=a.length*2;try{let c=JSON.parse(a);c.timestamp+c.ttl>=n?i++:o++}catch{o++}}),{totalEntries:t.length,validEntries:i,expiredEntries:o,totalSize:r,totalSizeMB:(r/1024/1024).toFixed(2)}}catch{return null}}function ql(){try{let e=Dr();e&&e.totalSize>5242880&&Ro(.3)}catch{}}function Ro(e=.3){try{let t=Object.keys(localStorage),n=[];t.forEach(i=>{if(i.startsWith(Oe))try{let o=JSON.parse(localStorage.getItem(i));n.push({key:i,timestamp:o.timestamp})}catch{n.push({key:i,timestamp:0})}}),n.sort((i,o)=>i.timestamp-o.timestamp);let r=Math.ceil(n.length*e);for(let i=0;i<r;i++)localStorage.removeItem(n[i].key)}catch{}}var Oe,Xl,Or=I(()=>{Oe="plex_cache_";Xl=null;typeof window!="undefined"&&typeof window.document!="undefined"&&window===globalThis&&(_n(),Xl=setInterval(_n,5*60*1e3))});function it(e){return e!==null&&typeof e=="object"&&!Array.isArray(e)}function tu(e,t){switch(t){case"string":return typeof e=="string";case"number":return typeof e=="number"&&Number.isFinite(e);case"boolean":return typeof e=="boolean";case"array":return Array.isArray(e);case"object":return it(e);default:return!1}}function zr(e,t,n="value"){if(!t)return;if(e==null){if(t.nullable)return;throw new Error(`${n} darf nicht null oder undefined sein.`)}let r=Array.isArray(t.type)?t.type:[t.type];if(r&&r.length&&!r.some(o=>tu(e,o))){let o=r.join(" oder ");throw new Error(`${n} erwartet Typ ${o}, erhielt ${typeof e}.`)}if(r.includes("array")){if(!Array.isArray(e))throw new Error(`${n} erwartet eine Liste.`);t.items&&e.forEach((i,o)=>{n.includes(".genres")||n.includes("List")&&t.items.type&&Array.isArray(t.items.type)&&t.items.type.includes("string")&&t.items.type.includes("object")||zr(i,t.items,`${n}[${o}]`)});return}if(r.includes("object")){if(!it(e))throw new Error(`${n} erwartet ein Objekt.`);let i=t.required||[];for(let s of i){let a=e[s];if(a==null||typeof a=="string"&&!a.trim())throw new Error(`${n}.${s} ist ein Pflichtfeld.`)}let o=t.properties||{};for(let[s,a]of Object.entries(o))e[s]!=null&&zr(e[s],a,`${n}.${s}`)}}function wo(e){return Array.isArray(e)?e.map(t=>typeof t=="string"?t.trim():t&&typeof t=="object"&&typeof t.tag=="string"?t.tag.trim():null).filter(t=>t&&t.length>0):[]}function Bo(e,t){let n={...e};for(let[r,i]of Object.entries(t))n[r]==null?n[r]=Array.isArray(i)?[...i]:i:Array.isArray(i)&&(n[r]=Array.isArray(n[r])?[...n[r]]:[...i]);return n}function No(e){if(!it(e)||typeof e.title!="string"||!e.title.trim())return!1;let t=e.ratingKey;return typeof t=="string"||typeof t=="number"}function nu(e){return No(e)?e.seasons==null?!0:Array.isArray(e.seasons)?e.seasons.every(t=>it(t)):!1:!1}function ru(e){let t=Bo(e,Vl);t.title=t.title.trim(),t.ratingKey=String(e.ratingKey).trim();let n=typeof t.thumb=="string"?t.thumb:"",r=typeof t.thumbFile=="string"?t.thumbFile:"";return t.thumb=n,t.thumbFile=r||n,t.summary=typeof t.summary=="string"?t.summary:"",t.href=typeof t.href=="string"?t.href:"",t.tagline=typeof t.tagline=="string"?t.tagline:"",t.genres=wo(t.genres),t}function iu(e){let t=Bo(e,Wl);t.title=t.title.trim(),t.ratingKey=String(e.ratingKey).trim();let n=typeof t.thumb=="string"?t.thumb:"",r=typeof t.thumbFile=="string"?t.thumbFile:"";return t.thumb=n,t.thumbFile=r||n,t.summary=typeof t.summary=="string"?t.summary:"",t.href=typeof t.href=="string"?t.href:"",t.tagline=typeof t.tagline=="string"?t.tagline:"",t.genres=wo(t.genres),Array.isArray(e.seasons)?t.seasons=e.seasons.filter(it).map(i=>{let o={...i};return o.episodes=Array.isArray(i.episodes)?i.episodes.filter(it).map(s=>({...s})):[],typeof o.thumb!="string"&&(o.thumb=""),typeof o.thumbFile!="string"&&(o.thumbFile=""),o}):t.seasons=[],t}function jr(e,t="movie"){if(zr(e,t==="show"?eu:Zl,`${t}List`),!Array.isArray(e))throw new Error("Datensatz ist keine Liste.");let r=t==="show"?nu:No,i=t==="show"?iu:ru;return e.map((o,s)=>{if(!r(o))throw new Error(`Ung\xFCltiger ${t}-Eintrag an Index ${s}.`);return i(o)})}var Vl,Wl,Yl,Jl,Ql,Zl,eu,Ho=I(()=>{Vl=Object.freeze({thumb:"",thumbFile:"",summary:"",href:"",tagline:"",genres:[]}),Wl=Object.freeze({thumb:"",thumbFile:"",summary:"",href:"",tagline:"",genres:[],seasons:[]}),Yl=Object.freeze({type:"object",required:["title","ratingKey"],properties:{title:{type:"string"},ratingKey:{type:["string","number"]},thumb:{type:"string",nullable:!0},thumbFile:{type:"string",nullable:!0},summary:{type:"string",nullable:!0},href:{type:"string",nullable:!0},tagline:{type:"string",nullable:!0},genres:{type:"array",items:{type:["string","object"]},nullable:!0}}}),Jl=Object.freeze({type:"object",properties:{episodes:{type:"array",items:{type:"object"},nullable:!0},thumb:{type:"string",nullable:!0},thumbFile:{type:"string",nullable:!0}}}),Ql=Object.freeze({type:"object",required:["title","ratingKey"],properties:{title:{type:"string"},ratingKey:{type:["string","number"]},thumb:{type:"string",nullable:!0},thumbFile:{type:"string",nullable:!0},summary:{type:"string",nullable:!0},href:{type:"string",nullable:!0},tagline:{type:"string",nullable:!0},genres:{type:"array",items:{type:["string","object"]},nullable:!0},seasons:{type:"array",items:Jl,nullable:!0}}}),Zl=Object.freeze({type:"array",items:Yl}),eu=Object.freeze({type:"array",items:Ql})});var $o={};rt($o,{clearErrors:()=>su,initErrorHandler:()=>Dt,showError:()=>Q,showRetryableError:()=>Mr,withErrorHandling:()=>ou});function Dt(){J||(J=document.createElement("div"),J.id="errorContainer",J.className="error-container",J.setAttribute("role","alert"),J.setAttribute("aria-live","polite"),document.body.appendChild(J)),window.addEventListener("unhandledrejection",e=>{var t;Q("Ein unerwarteter Fehler ist aufgetreten",(t=e.reason)==null?void 0:t.message),e.preventDefault()}),window.addEventListener("error",e=>{var t;Q("Ein Fehler ist aufgetreten",(t=e.error)==null?void 0:t.message)})}function Q(e,t="",n=5e3){J||Dt();let r=document.createElement("div");return r.className="error-toast",r.innerHTML=`
    <div class="error-toast-content">
      <div class="error-toast-icon">\u26A0\uFE0F</div>
      <div class="error-toast-text">
        <div class="error-toast-title">${Kr(e)}</div>
        ${t?`<div class="error-toast-message">${Kr(t)}</div>`:""}
      </div>
      <button class="error-toast-close" aria-label="Schlie\xDFen">\xD7</button>
    </div>
  `,r.querySelector(".error-toast-close").addEventListener("click",()=>{r.classList.add("error-toast-exit"),setTimeout(()=>r.remove(),300)}),J.appendChild(r),n>0&&setTimeout(()=>{r.parentNode&&(r.classList.add("error-toast-exit"),setTimeout(()=>r.remove(),300))},n),requestAnimationFrame(()=>{r.classList.add("error-toast-show")}),r}function ou(e,t="Ein Fehler ist aufgetreten"){return async(...n)=>{try{return await e(...n)}catch(r){throw Q(t,r.message),r}}}function Mr(e,t){J||Dt();let n=document.createElement("div");n.className="error-toast error-toast-retryable",n.innerHTML=`
    <div class="error-toast-content">
      <div class="error-toast-icon">\u26A0\uFE0F</div>
      <div class="error-toast-text">
        <div class="error-toast-title">${Kr(e)}</div>
      </div>
      <button class="error-toast-retry">Erneut versuchen</button>
      <button class="error-toast-close" aria-label="Schlie\xDFen">\xD7</button>
    </div>
  `;let r=n.querySelector(".error-toast-retry"),i=n.querySelector(".error-toast-close");return r.addEventListener("click",async()=>{n.remove();try{await t()}catch{}}),i.addEventListener("click",()=>{n.classList.add("error-toast-exit"),setTimeout(()=>n.remove(),300)}),J.appendChild(n),requestAnimationFrame(()=>{n.classList.add("error-toast-show")}),n}function su(){J&&(J.innerHTML="")}function Kr(e){let t=document.createElement("div");return t.textContent=e,t.innerHTML}var J,kn=I(()=>{J=null});async function Ur(e,t=2,n=!0){if(n){let s=Fo(e);if(s!==null)return s}let r=null;for(let s=0;s<=t;s++){try{let a=await fetch(e,{cache:"no-store"});if(a&&a.ok){let c=await a.json();return n&&c&&Lo(e,c,au),c}if(a&&a.status===404)return null;r=new Error(`HTTP ${a.status}: ${a.statusText}`)}catch(a){r=a}if(s<t){let a=Math.min(1e3*Math.pow(2,s),5e3);await new Promise(c=>setTimeout(c,a))}}let i=(r==null?void 0:r.message)||"Unbekannter Fehler",o=new Error(`Daten konnten nicht geladen werden: ${e} (${i})`);throw r&&typeof r=="object"&&(o.cause=r),o}function fu(e){try{let t=document.getElementById(e);if(t&&t.textContent)return JSON.parse(t.textContent)}catch{}return null}function gu(e){try{let t=cu;return(t&&Array.isArray(t[e])?t[e]:null)||null}catch{return null}}function hu(e){try{return(Array.isArray(window[e])?window[e]:null)||null}catch{return null}}async function zo(e,t){let n=null;try{n=await Ur(e)}catch{n=null}if(Array.isArray(n)&&n.length)return ot(t==null?void 0:t.label,`primary:${e}`),n;if(t!=null&&t.embedId){let r=fu(t.embedId);if(Array.isArray(r)&&r.length)return ot(t==null?void 0:t.label,`embedded:${t.embedId}`),r}if(t!=null&&t.exportKey){let r=gu(t.exportKey);if(Array.isArray(r)&&r.length)return ot(t==null?void 0:t.label,`globalBag:${t.exportKey}`),r}if(t!=null&&t.globalVar){let r=hu(t.globalVar);if(Array.isArray(r)&&r.length)return ot(t==null?void 0:t.label,`window:${t.globalVar}`),r}for(let r of(t==null?void 0:t.altUrls)||[]){let i=null;try{i=await Ur(r)}catch{i=null}if(Array.isArray(i)&&i.length)return ot(t==null?void 0:t.label,`alt:${r}`),i}return ot(t==null?void 0:t.label,"empty"),Array.isArray(n)?n:[]}function Gr(e,t){typeof window=="undefined"||typeof document=="undefined"||typeof document.createElement!="function"||Promise.resolve().then(()=>(kn(),$o)).then(n=>{var r;try{(r=n.showError)==null||r.call(n,e,t,8e3)}catch{}}).catch(n=>{})}function mu(e,t){let n=e==null?"":String(e).trim();if(!n)return"";if(n.startsWith("//")||n.startsWith("/")||du.test(n))return n;let r=n.replace(/\\/g,"/"),i=t?t.endsWith("/")?t:`${t}/`:"",o=!1,s=g=>g.split("/").map(m=>{if(!m)return"";try{return encodeURIComponent(decodeURIComponent(m))}catch{return o||(o=!0),encodeURIComponent(m)}}).join("/"),c=r.replace(/^\/+/,"").split("/"),l=[];for(let g of c)if(!(!g||g===".")){if(g===".."){l.length&&l.pop();continue}l.push(g)}let u=l.join("/");if(u.startsWith("data/"))return s(u);let d=l;if(i&&d.length){let g=i.replace(/\/+$/,"").split("/").pop();g&&d[0]===g&&(d=d.slice(1))}let h=d.join("/"),f=s(h);return`${i}${f}`}function jo(e,t){var i,o;if(!e||typeof e!="object")return e;let n=(o=(i=e.thumbFile)!=null?i:e.thumb)!=null?o:"",r=mu(n,t);if(r)e.thumbFile=r,e.thumb=r;else if(n){let s=String(n);e.thumbFile=s,e.thumb==null&&(e.thumb=s)}return e}function pu(e){return jo(e,lu)}function he(e){return jo(e,uu)}function Ko(e){return!e||typeof e!="object"||(he(e),Array.isArray(e.seasons)&&e.seasons.forEach(Mo)),e}function Mo(e){return!e||typeof e!="object"||(he(e),Array.isArray(e.episodes)&&e.episodes.forEach(t=>he(t))),e}function bu(e){return Array.isArray(e)?(e.forEach(t=>{t&&typeof t=="object"&&pu(t)}),e):[]}function yu(e){return Array.isArray(e)?(e.forEach(t=>{t&&typeof t=="object"&&Ko(t)}),e):[]}async function In(){try{let e=await zo("data/movies/movies.json",{label:"movies",embedId:"movies-json",exportKey:"movies",globalVar:"__PLEX_MOVIES__",altUrls:["movies/movies.json","data/movies.json","Filme/movies.json","movies.json"]}),t;try{t=jr(e,"movie")}catch(n){let r=(n==null?void 0:n.message)||"Unbekannte Validierungsfehler",i=new Error(`Ung\xFCltige Filmdaten: ${r}`);throw n instanceof Error&&(i.cause=n),i}return bu(t)}catch(e){return Gr("Filme konnten nicht geladen werden",(e==null?void 0:e.message)||"Unbekannter Fehler"),[]}}async function xn(){try{let e=await zo("data/series/series_index.json",{label:"shows",embedId:"series-json",exportKey:"shows",globalVar:"__PLEX_SHOWS__",altUrls:["series/series_index.json","data/shows.json","data/series.json","Serien/series.json","series/series.json","series.json","shows.json"]}),t;try{t=jr(e,"show")}catch(n){let r=(n==null?void 0:n.message)||"Unbekannte Validierungsfehler",i=new Error(`Ung\xFCltige Seriendaten: ${r}`);throw n instanceof Error&&(i.cause=n),i}return yu(t)}catch(e){return Gr("Serien konnten nicht geladen werden",(e==null?void 0:e.message)||"Unbekannter Fehler"),[]}}async function Uo(e){if(!e)return null;let t=Su(e),n=Eu(t);if(n!==void 0)return n;let r=vu(e),i=null;for(let o of r)try{let s=await Ur(o);if(s&&typeof s=="object"){let a=Au(s);return Do(t,a,e),qo(a)}}catch(s){i=s}return i&&Gr("Details konnten nicht geladen werden",(i==null?void 0:i.message)||"Bitte sp\xE4ter erneut versuchen."),Do(t,null,e),null}function ot(e,t){if(e)try{Oo[e]=t}catch{}}function Go(){return{...Oo}}function Su(e){let t=[];(e==null?void 0:e.ratingKey)!==void 0&&(e==null?void 0:e.ratingKey)!==null&&(e==null?void 0:e.ratingKey)!==""&&t.push(`rk:${String(e.ratingKey)}`);let n=Cn(e==null?void 0:e.href);return n&&t.push(`href:${n}`),t}function Cn(e){return e?String(e).trim().replace(/^\.\//,"").replace(/^\/+/,""):""}function Eu(e){for(let t of e)if(ze.has(t)){let n=ze.get(t);return n?qo(n):null}}function Do(e,t,n){let r=t;e.forEach(c=>{ze.set(c,r)});let i=n==null?void 0:n.ratingKey;i!=null&&ze.set(`rk:${String(i)}`,r);let o=t&&typeof t=="object"?t.ratingKey:void 0;o!=null&&ze.set(`rk:${String(o)}`,r);let s=Cn(n==null?void 0:n.href);s&&ze.set(`href:${s}`,r);let a=t&&typeof t=="object"?Cn(t.href):"";a&&ze.set(`href:${a}`,r)}function vu(e){let t=new Set,n=Cn(e==null?void 0:e.href);if(n)if(/^https?:/i.test(n))t.add(n);else{n.startsWith("data/")?t.add(n):t.add(`data/${n}`);let i=n.replace(/^data\//,"");i.startsWith("series/")||t.add(`data/series/${i}`);let o=i.replace(/^series\//,"").replace(/^details\//,"").replace(/\.json$/,"");o&&t.add(`data/series/details/${o}.json`)}let r=e==null?void 0:e.ratingKey;return r!=null&&t.add(`data/series/details/${String(r)}.json`),Array.from(t)}function Au(e){if(!e||typeof e!="object")return null;let t={...e};he(t),t.genres=qr(t.genres);let n=Tu(t.cast||t.roles||[]);return t.cast=n,t.roles=n,t.seasons=Array.isArray(t.seasons)?t.seasons.map(_u).filter(Boolean):[],t.seasonCount=Number.isFinite(t.seasonCount)?t.seasonCount:t.seasons.length,Ko(t),t}function _u(e){if(!e||typeof e!="object")return null;let t={...e};return he(t),t.genres=qr(t.genres),t.episodes=Array.isArray(t.episodes)?t.episodes.map(ku).filter(Boolean):[],Mo(t),t}function ku(e){if(!e||typeof e!="object")return null;let t={...e};return he(t),t.genres=qr(t.genres),t}function qr(e){if(!Array.isArray(e))return[];let t=new Set,n=[];return e.forEach(r=>{let i=null;if(typeof r=="string"){let o=r.trim();o&&(i={tag:o})}else if(r&&typeof r=="object"){let o=String(r.tag||r.title||r.name||r.label||"").trim();o&&(i={...r,tag:o})}i&&!t.has(i.tag)&&(t.add(i.tag),n.push(i))}),n}function Tu(e){return Array.isArray(e)?e.map(t=>{if(!t)return null;if(typeof t=="string"){let n=t.trim();return n?{tag:n}:null}if(typeof t=="object"){let n=String(t.tag||t.name||t.role||"").trim();return n?{...t,tag:n}:{...t}}return null}).filter(Boolean):[]}function qo(e){if(e==null)return e;try{return structuredClone(e)}catch{}try{return JSON.parse(JSON.stringify(e))}catch{}return e}var Oo,ze,au,Tn,cu,lu,uu,du,Ot=I(()=>{Or();Ho();Oo={movies:null,shows:null},ze=new Map,au=1e3*60*30,Tn="__PLEX_EXPORTER__",cu=(()=>{try{if(typeof globalThis!="undefined"){if(globalThis[Tn])return globalThis[Tn];if(globalThis.window&&globalThis.window[Tn])return globalThis.window[Tn]}}catch{}return null})(),lu="data/movies/",uu="data/series/",du=/^[a-z][a-z0-9+.-]*:/i});var Vo={};rt(Vo,{clearHeroCache:()=>xu,collectionTags:()=>je,enableMoreChipBehavior:()=>Xo,formatRating:()=>Z,getGenreNames:()=>Se,humanYear:()=>q,isNew:()=>zt,renderChipsLimited:()=>Fn,useTmdbForCards:()=>Pn,useTmdbForHero:()=>jt,useTmdbOn:()=>Kt});function Se(e){let t=new Set,n=[];return(e||[]).forEach(r=>{let i="";typeof r=="string"?i=r:r&&typeof r=="object"&&(i=r.tag||r.title||r.name||"");let o=String(i||"").trim();o&&!t.has(o)&&(t.add(o),n.push(o))}),n}function Fn(e,t,n=3){if(!e)return;let r=(t||[]).filter(Boolean);if(r.length>n){let i=r.slice(0,n),o=r.slice(n),s=i.map(c=>Ln(c)),a=Ln(`+ ${o.length}`);a.classList.add("more","card__chip--more"),a.setAttribute("data-more",o.length),a.setAttribute("title",`${o.length} weitere Genres: ${o.join(", ")}`),a._extraChips=o.map(c=>Ln(c)),s.push(a),e.replaceChildren(...s)}else{let i=r.map(o=>Ln(o));e.replaceChildren(...i)}Xo(e)}function Xo(e=document){try{e.querySelectorAll(".chip.more, .card__chip--more").forEach(t=>{t.dataset.bound||(t.dataset.bound="1",t.addEventListener("click",n=>{n.stopPropagation();let r=t.closest(".card");if(r)r.click();else{let i=t._extraChips||[];try{i.forEach(o=>t.before(o))}catch{}t.remove()}}))})}catch{}}function je(e){return(e&&e.collections||[]).map(t=>t&&(t.tag||t.title||t.name||"")).filter(Boolean)}function q(e){if(!e)return"";let t=[e.originallyAvailableAt,e.year,e.releaseDate,e.premiereDate];for(let n of t){if(n==null)continue;let r=String(n);if(!r)continue;let i=r.match(/\d{4}/);if(i)return i[0]}return""}function Z(e){if(e instanceof Number)return Z(e.valueOf());if(typeof e=="number")return Number.isFinite(e)?e.toFixed(1):"0.0";if(typeof e=="string"){let t=e.trim();if(!t)return"0.0";let n=Number(t);return Number.isFinite(n)?n.toFixed(1):"0.0"}return"0.0"}function Ln(e){let t=document.createElement("span");return t.className="chip",t.textContent=String(e||""),t}function zt(e){if(!(e!=null&&e.addedAt))return!1;let t=new Date(e.addedAt).getTime();if(!Number.isFinite(t))return!1;let n=x().cfg||{},r=Number(n.newDays||30);return Date.now()-t<=r*24*60*60*1e3}function Iu(){var e,t;try{let n=localStorage.getItem("tmdbToken");if(n&&n.trim())return!0;let r=x();return!!((e=r.cfg)!=null&&e.tmdbToken||(t=r.cfg)!=null&&t.tmdbApiKey)}catch{return!1}}function Pn(){try{return localStorage.getItem("useTmdb")==="1"}catch{return!1}}function jt(){return Iu()}function Kt(){return Pn()}function xu(){try{let e={tmdbToken:localStorage.getItem("tmdbToken"),useTmdb:localStorage.getItem("useTmdb"),prefReduceMotion:localStorage.getItem("prefReduceMotion"),watchlist:localStorage.getItem("watchlist:v1"),modalLayout:localStorage.getItem("modalLayout"),scrollOrchestratorEnabled:localStorage.getItem("scrollOrchestratorEnabled")},t=Object.keys(localStorage).filter(r=>r.startsWith("hero")||r.startsWith("Hero")),n=Object.keys(localStorage).filter(r=>r.includes("tmdbCache")||r==="hero.tmdbCache.v1");return t.forEach(r=>localStorage.removeItem(r)),n.forEach(r=>localStorage.removeItem(r)),Object.entries(e).forEach(([r,i])=>{i!==null&&localStorage.setItem(r,i)}),{heroEntries:t.length,tmdbCacheEntries:n.length,preserved:Object.keys(e).filter(r=>e[r]!==null)}}catch(e){return{error:e.message}}}var Ee=I(()=>{ie()});function Lu(){try{me=new Set(JSON.parse(localStorage.getItem(Jo)||"[]"))}catch{me=new Set}}function Qo(){try{localStorage.setItem(Jo,JSON.stringify(Array.from(me.values())))}catch{}}function Vr(e){var r,i;if(!e)return"";let t=e.type==="tv"||e.libraryType==="show"?"show":"movie",n=((r=e.ids)==null?void 0:r.imdb)||((i=e.ids)==null?void 0:i.tmdb)||String(e.ratingKey||"");return n?`${t}:${n}`:""}function Wr(e){return me.has(Vr(e))}function Fu(){return me.size}function Yr(e){let t=Vr(e);if(!t)return;me.has(t)?me.delete(t):me.add(t),Qo(),Jr();let n=document.getElementById("watchlistPanel");n&&!n.hidden&&Rn()}function Jr(){let e=document.getElementById("watchlistCount");e&&(e.textContent=String(Fu()))}function Wo(){let e=document.getElementById("watchlistPanel");e&&(e.hidden=!1,e.setAttribute("aria-hidden","false"),Rn())}function Yo(){let e=document.getElementById("watchlistPanel");e&&(e.hidden=!0,e.setAttribute("aria-hidden","true")),Xr(!1)}function Pu(){me.clear(),Qo(),Jr(),Rn()}function Ru(){let e=Zo(),t=JSON.stringify(e,null,2),n=new Blob([t],{type:"application/json"}),r=document.createElement("a");r.href=URL.createObjectURL(n),r.download="watchlist.json",document.body.append(r),r.click(),r.remove(),setTimeout(()=>URL.revokeObjectURL(r.href),1e3)}function Zo(){let e=x(),t=(e.movies||[]).concat(e.shows||[]),n=new Map(t.map(r=>[Vr(r),r]));return Array.from(me.values()).map(r=>n.get(r)).filter(Boolean)}function Rn(){let e=document.getElementById("watchlistItems"),t=document.getElementById("watchlistEmpty");if(!e||!t)return;let n=Zo();if(n.length===0){e.replaceChildren(),t.hidden=!1;return}t.hidden=!0;let r=document.createDocumentFragment();n.forEach(i=>{let o=document.createElement("li");o.className="watchlist-item";let s=document.createElement("span");s.className="title",s.textContent=i.title||"";let a=document.createElement("button");a.textContent="Entfernen",a.addEventListener("click",()=>{Yr(i),Rn()});let c=document.createElement("button");c.textContent="\xD6ffnen",c.addEventListener("click",()=>{var d,h;let l=i.type==="tv"?"show":"movie",u=((d=i.ids)==null?void 0:d.imdb)||((h=i.ids)==null?void 0:h.tmdb)||String(i.ratingKey||"");u&&(location.hash=`#/${l}/${u}`)}),o.append(s,c,a),r.append(o)}),e.replaceChildren(r)}function es(){Lu(),Jr();let e=document.getElementById("openWatchlist"),t=document.getElementById("watchlistToggle"),n=document.getElementById("closeWatchlist"),r=document.getElementById("clearWatchlist"),i=document.getElementById("exportWatchlist");e&&e.addEventListener("click",()=>{Wo(),Xr(!0)}),t&&t.addEventListener("click",()=>{let o=document.getElementById("watchlistPanel");o&&!o.hidden?Yo():(Wo(),Xr(!0))}),n&&n.addEventListener("click",()=>{Yo()}),r&&r.addEventListener("click",()=>{Pu()}),i&&i.addEventListener("click",()=>{Ru()})}function Xr(e){let t=document.getElementById("watchlistToggle");t&&t.setAttribute("aria-expanded",e?"true":"false")}var Jo,me,Qr=I(()=>{ie();Jo="watchlist:v1",me=new Set});function Bu(e){return!(!e||e.hasAttribute("disabled")||e.getAttribute("aria-hidden")==="true"||e.hasAttribute("hidden")||e.offsetParent===null)}function Zr(e){let t=typeof HTMLElement!="undefined"?HTMLElement:null;return!t||!(e instanceof t)?[]:Array.from(e.querySelectorAll(wu)).filter(Bu)}function ns(e){let t=typeof HTMLElement!="undefined"?HTMLElement:null;if(!t||!(e instanceof t))return;st&&at&&st.removeEventListener("keydown",at);let n=r=>{if(r.key!=="Tab")return;let i=Zr(e);if(!i.length)return;let o=i[0],s=i[i.length-1],a=typeof document!="undefined"?document.activeElement:null;if(r.shiftKey){a===o&&(r.preventDefault(),s.focus());return}a===s&&(r.preventDefault(),o.focus())};e.addEventListener("keydown",n),st=e,at=n}function rs(){st&&at&&st.removeEventListener("keydown",at),st=null,at=null}function is(e){if(typeof window=="undefined")return;ct&&window.removeEventListener("keydown",ct),wn=typeof e=="function"?e:null;let t=n=>{if(n.key==="Escape"&&(n.preventDefault(),wn))try{wn(n)}catch{}};ct=t,window.addEventListener("keydown",t)}function os(){typeof window!="undefined"&&(ct&&window.removeEventListener("keydown",ct),ct=null,wn=null)}function ss(e){let t=typeof HTMLElement!="undefined"?HTMLElement:null;if(!t||!(e instanceof t))return;let n=e.querySelector("#action-close"),r=Zr(e),i=n&&!n.hasAttribute("hidden")?n:r[0];i||(i=e);let o=()=>{try{i.focus()}catch{}};(typeof window!="undefined"&&window.requestAnimationFrame?window.requestAnimationFrame:setTimeout)(o,0)}var wu,st,at,ct,wn,as=I(()=>{wu='a[href], button:not([disabled]), textarea, input, select, [tabindex]:not([tabindex="-1"])',st=null,at=null,ct=null,wn=null});function Nu(){if(typeof document=="undefined")return null;if(Ke)return Ke;let e=document.getElementById("modal-root");return e?(Ke=e,e.classList.add("modalv3-overlay"),e.hasAttribute("hidden")||e.setAttribute("hidden",""),e.hasAttribute("aria-hidden")||e.setAttribute("aria-hidden","true"),e.dataset.modalv3Ready="1",e.querySelector(".modalv3-dialog")||(e.innerHTML=`
      <div class="modalv3-backdrop"></div>
      <div class="modalv3-dialog" role="dialog" aria-modal="true">
        <div class="modalv3-scroll" data-modalv3-scroll></div>
      </div>
    `),Le=e.querySelector(".modalv3-dialog"),Le&&!Le.hasAttribute("tabindex")&&Le.setAttribute("tabindex","-1"),Me=e.querySelector("[data-modalv3-scroll]"),cs=e.querySelector(".modalv3-backdrop"),Me&&(oe=Me.querySelector("[data-modalv3-root]"),oe||(oe=document.createElement("div"),oe.dataset.modalv3Root="1",oe.className="modalv3",oe.setAttribute("hidden",""),Me.appendChild(oe))),Ke):null}function ls(){let e=Nu();return!e||!Le||!oe?null:{overlay:e,dialog:Le,scroll:Me,backdrop:cs,root:oe}}function ei({onRequestClose:e}={}){let t=ls();if(!t)return null;let{overlay:n,scroll:r,dialog:i}=t;return n.hidden=!1,n.setAttribute("aria-hidden","false"),typeof document!="undefined"&&document.body&&document.body.classList.add("modalv3-open"),r&&(r.scrollTop=0),ns(i),is(e),t}function us(){Ke&&(Ke.hidden=!0,Ke.setAttribute("aria-hidden","true"),typeof document!="undefined"&&document.body&&document.body.classList.remove("modalv3-open"),rs(),os(),oe&&(oe.innerHTML="",oe.setAttribute("hidden","")),Me&&(Me.scrollTop=0))}function ti(){return ls()}function ni(){Le&&ss(Le)}var Ke,Le,Me,cs,oe,ds=I(()=>{as();Ke=null,Le=null,Me=null,cs=null,oe=null});function ri(e=null,t=null){return $.renderSequence+=1,$.activeRenderToken=$.renderSequence,$.activeKind=e||null,$.activeItem=t||null,$.activeRenderToken}function lt(e){return e?e===$.activeRenderToken:!1}function fs(){return $.renderSequence+=1,$.activeRenderToken=0,$.renderSequence}function gs(e=null,t=null){$.activeKind=e||null,$.activeItem=t||null}function hs(){return{kind:$.activeKind,item:$.activeItem}}function ii(){$.activeKind=null,$.activeItem=null}function oi(){if(typeof document=="undefined")return $.lastFocused=null,null;let e=document.activeElement,t=typeof HTMLElement!="undefined"?HTMLElement:null;return $.lastFocused=t&&e instanceof t?e:null,$.lastFocused}function ms(){let e=$.lastFocused;$.lastFocused=null;let t=typeof HTMLElement!="undefined"?HTMLElement:null;if(e&&(!t||e instanceof t)&&typeof e.focus=="function")try{e.focus()}catch{}}var $,ps=I(()=>{$={renderSequence:0,activeRenderToken:0,activeKind:null,activeItem:null,lastFocused:null}});function ve(e){var r;let t=[e==null?void 0:e.runtimeMin,e==null?void 0:e.durationMin,(r=e==null?void 0:e.tmdbDetail)==null?void 0:r.runtime,e!=null&&e.duration?Math.round(Number(e.duration)/6e4):null],n=null;for(let i of t){let o=Number(i);if(Number.isFinite(o)&&o>0){n=o;break}}return n===null?"":(e==null?void 0:e.type)==="tv"?`~${n} min/Ep`:`${n} min`}function Ue(e){var n;let t=Number((n=e==null?void 0:e.rating)!=null?n:e==null?void 0:e.audienceRating);return Number.isFinite(t)?`\u2605 ${Z(t)}`:""}function Ge(e){var t,n;if(e!=null&&e.studio)return e.studio;if(e!=null&&e.network)return e.network;if(e!=null&&e.studioName)return e.studioName;if((t=e==null?void 0:e.tmdbDetail)!=null&&t.productionCompanies){let r=e.tmdbDetail.productionCompanies.find(i=>i==null?void 0:i.name);if(r&&r.name)return r.name}if((n=e==null?void 0:e.tmdbDetail)!=null&&n.networks){let r=e.tmdbDetail.networks.find(i=>i==null?void 0:i.name);if(r&&r.name)return r.name}return""}var Mt=I(()=>{Ee()});function Fe(e){if(!e)return"";let t=String(e).trim();return t?/^https?:\/\//i.test(t)||/^data:image\//i.test(t)?t:t.startsWith("//")?`https:${t}`:t.startsWith("data/")?t:t.replace(/["'()]/g,""):""}function si(e){return e?typeof e=="string"?e:e.url||e.file_path||e.filePath||e.path||e.logo||e.logoPath||e.poster||e.backdrop||"":""}function Hu(e){if(!e||typeof e!="object")return"";let t=e.iso6391||e.iso_639_1||e.language||"";return typeof t=="string"?t.toLowerCase():""}function $u(e){if(!e)return null;let t=e.item||{},n=e.tmdb||t.tmdbDetail||null,r=e.kind==="show"?"tv":t.type;return{...t,tmdbDetail:n,type:r}}function Es(e){var c,l,u,d,h,f,g;let t=$u(e),n=((c=e==null?void 0:e.meta)==null?void 0:c.runtime)||(t?ve(t):""),r=((l=e==null?void 0:e.meta)==null?void 0:l.rating)||(t?Ue(t):""),i=((u=e==null?void 0:e.meta)==null?void 0:u.tmdbRating)||"",o=((d=e==null?void 0:e.meta)==null?void 0:d.studio)||(t?Ge(t):""),s=((h=e==null?void 0:e.meta)==null?void 0:h.contentRating)||"",a=(g=(f=e==null?void 0:e.meta)==null?void 0:f.seasonCount)!=null?g:null;return{runtime:n,rating:r,tmdbRating:i,studio:o,contentRating:s,seasonCount:a}}function vs(e){var t,n;return e&&(e.tmdb||((t=e.item)==null?void 0:t.tmdbDetail)||((n=e.item)==null?void 0:n.tmdb))||null}function Du(e){var i;let t=vs(e),n=Array.isArray((i=t==null?void 0:t.images)==null?void 0:i.logos)?t.images.logos:[];if(!n.length)return"";let r=["de","en",""];for(let o of r){let s=n.find(c=>{let l=Hu(c);return o?l===o:!l}),a=Fe(si(s));if(a)return a}for(let o of n){let s=Fe(si(o));if(s)return s}return""}function Ou(e,t=""){var c,l,u,d;let n=vs(e),r=[],i=new Set,o=Fe(t);o&&i.add(o);let s=h=>{let f=Fe(si(h));!f||i.has(f)||(i.add(f),r.push(f))};Array.isArray((c=n==null?void 0:n.images)==null?void 0:c.logos)&&n.images.logos.forEach(s),Array.isArray(n==null?void 0:n.networks)&&n.networks.forEach(s),Array.isArray(n==null?void 0:n.productionCompanies)&&n.productionCompanies.forEach(s),n!=null&&n.collection&&s(n.collection);let a=(d=(u=(l=e==null?void 0:e.item)==null?void 0:l.tmdbDetail)==null?void 0:u.images)==null?void 0:d.logos;return Array.isArray(a)&&a.forEach(s),r[0]||""}function bs(e){return Number.isFinite(e)?e>=7.5?"high":e>=5.5?"medium":e>0?"low":"":""}function zu(e){var i,o,s,a,c,l,u,d,h;if(!e)return null;let t=e.tmdb||((i=e.item)==null?void 0:i.tmdbDetail)||null,n=Number((o=t==null?void 0:t.voteAverage)!=null?o:t==null?void 0:t.vote_average);if(Number.isFinite(n)&&n>0)return{label:"TMDB",text:Z(n),value:n,bucket:bs(n)};let r=Number((h=(u=(c=(s=e.item)==null?void 0:s.rating)!=null?c:(a=e.item)==null?void 0:a.audienceRating)!=null?u:(l=e.item)==null?void 0:l.userRating)!=null?h:(d=e.item)==null?void 0:d.ratingKey);return Number.isFinite(r)&&r>0?{label:"Bewertung",text:Z(r),value:r,bucket:bs(r)}:null}function qe(e){e&&e.replaceChildren()}function F(e,t){if(typeof document=="undefined")return null;let n=document.createElement(e);return t&&(n.className=t),n}function ju(){let e=F("header","v3-head");if(!e)return null;let t=F("div","v3-head__actions"),n=F("button","v3-head__close");if(t&&n){n.id="action-close",n.type="button",n.setAttribute("aria-label","Schlie\xDFen");let p=F("span","v3-head__close-icon");p&&(p.setAttribute("aria-hidden","true"),p.textContent="\xD7",n.append(p)),n.hidden=!1,n.removeAttribute("hidden"),t.append(n)}let r=F("div","v3-head__visual");r.dataset.v3HeadVisual="1";let i=F("div","v3-head__hero");i.dataset.v3HeadHero="1";let o=F("div","v3-head__backdrop");o.dataset.v3HeadBackdrop="1";let s=F("div","v3-head__overlay-logo");s.dataset.v3HeadOverlayLogo="1",s.hidden=!0;let a=F("div","v3-head__overlay-meta");a.dataset.v3HeadOverlayMeta="1",a.hidden=!0,i.append(o,s,a);let c=F("div","v3-head__logo");c.dataset.v3HeadLogo="1",c.hidden=!0,r.append(i,c);let l=F("p","v3-head__status");l.dataset.v3HeadStatus="1",l.hidden=!0,l.setAttribute("aria-live","polite"),l.setAttribute("aria-atomic","true");let u=F("div","v3-head__titlebar"),d=F("div","v3-head__titlewrap"),h=F("div","v3-badges");h.dataset.v3HeadBadges="1",h.hidden=!0;let f=F("h1","v3-title");f.dataset.v3HeadTitle="1";let g=F("p","v3-subtitle");g.dataset.v3HeadSubtitle="1",g.hidden=!0;let m=F("p","v3-submeta");return m.dataset.v3HeadMeta="1",m.hidden=!0,d.append(h,f,g,m),u.append(d),t&&t.childElementCount&&e.append(t),e.append(r,l,u),e}function Ku(){let e=F("div","v3-poster-card");if(!e)return null;let t=F("div","v3-poster-media");t.dataset.v3PosterMedia="1",t.dataset.state="empty";let n=F("div","v3-poster-skeleton");n.dataset.v3PosterSkeleton="1",n.setAttribute("aria-hidden","true");let r=F("img","");r.dataset.v3PosterImage="1",r.alt="",r.loading="lazy",r.decoding="async",r.referrerPolicy="no-referrer",t.append(n,r);let i=F("section","v3-quickfacts");i.dataset.v3Quickfacts="1",i.hidden=!0,i.setAttribute("aria-label","Schnellinfos");let o=F("h3","v3-quickfacts-title");o.textContent="Schnellinfos";let s=F("dl","v3-quickfacts-list");return s.dataset.v3QuickfactsList="1",i.append(o,s),e.append(t,i),e}function ai(e){return e?{root:e,elements:{heroBackdrop:e.querySelector("[data-v3-head-backdrop]"),overlayLogo:e.querySelector("[data-v3-head-overlay-logo]"),overlayMeta:e.querySelector("[data-v3-head-overlay-meta]"),logo:e.querySelector("[data-v3-head-logo]"),status:e.querySelector("[data-v3-head-status]"),badges:e.querySelector("[data-v3-head-badges]"),title:e.querySelector("[data-v3-head-title]"),subtitle:e.querySelector("[data-v3-head-subtitle]"),meta:e.querySelector("[data-v3-head-meta]"),close:e.querySelector("#action-close")}}:null}function ci(e){if(!e)return null;let t=e.querySelector("[data-v3-poster-media]"),n=e.querySelector("[data-v3-quickfacts]");return{root:e,media:t,img:(t==null?void 0:t.querySelector("[data-v3-poster-image]"))||(t==null?void 0:t.querySelector("img")),skeleton:(t==null?void 0:t.querySelector("[data-v3-poster-skeleton]"))||null,quickfactsRoot:n,quickfactsList:(n==null?void 0:n.querySelector("[data-v3-quickfacts-list]"))||(n==null?void 0:n.querySelector("dl"))}}function Ut(e){if(!e)return null;if(e.root&&e.elements)return e;if(e.root){let n=ai(e.root);return n?{...n}:null}let t=typeof HTMLElement!="undefined"?HTMLElement:null;return t&&e instanceof t?ai(e):null}function As(e){if(!e)return null;if(e.root&&e.media)return e;if(e.root){let n=ci(e.root);return n?{...n}:null}let t=typeof HTMLElement!="undefined"?HTMLElement:null;return t&&e instanceof t?ci(e):null}function ys(e){e&&(e.style.backgroundImage="",e.dataset&&(e.dataset.state="",e.dataset.src="",e.dataset.source=""))}function Mu(e,t){var s,a,c,l,u,d;if(!e)return;let n=((s=t==null?void 0:t.backdrop)==null?void 0:s.source)||"",r=((a=t==null?void 0:t.backdrop)==null?void 0:a.url)||((c=t==null?void 0:t.item)==null?void 0:c.art)||((l=t==null?void 0:t.item)==null?void 0:l.background)||"",i=Fe(r);if(e.dataset&&(e.dataset.source=n||""),!i){ys(e);return}if(typeof Image=="undefined"){e.style.backgroundImage=`url("${i}")`,e.dataset&&(e.dataset.state="ready",e.dataset.src=i);return}if(((u=e.dataset)==null?void 0:u.src)===i&&((d=e.dataset)==null?void 0:d.state)==="ready")return;e.dataset&&(e.dataset.state="loading",e.dataset.src=i),e.style.backgroundImage="";let o=new Image;o.decoding="async",o.referrerPolicy="no-referrer",o.addEventListener("load",()=>{var h;((h=e.dataset)==null?void 0:h.src)===i&&(e.style.backgroundImage=`url("${i}")`,e.dataset&&(e.dataset.state="ready"))},{once:!0}),o.addEventListener("error",()=>{var h;((h=e.dataset)==null?void 0:h.src)===i&&ys(e)},{once:!0}),o.src=i}function Uu(e,t,n){if(!e)return"";let r=Fe(Du(t));if(e.dataset.src="",!r)return e.hidden=!0,e.dataset.state="",qe(e),"";let i=F("img","v3-head__overlay-image");return i.alt=t!=null&&t.title?`Hero Logo: ${t.title}`:"Hero Logo",i.decoding="async",i.loading="lazy",i.referrerPolicy="no-referrer",qe(e),e.appendChild(i),e.dataset.src=r,typeof Image=="undefined"?(i.src=r,e.hidden=!1,e.dataset.state="ready",r):(e.hidden=!0,e.dataset.state="loading",i.addEventListener("load",()=>{var o;((o=e.dataset)==null?void 0:o.src)===r&&(e.hidden=!1,e.dataset.state="ready")},{once:!0}),i.addEventListener("error",()=>{var o;((o=e.dataset)==null?void 0:o.src)===r&&(e.hidden=!0,e.dataset.state="",e.dataset.src="",qe(e),typeof n=="function"&&n())},{once:!0}),i.src=r,r)}function Ss(e,t,n=""){if(!e)return;let r=Fe(Ou(t,n));if(!r){e.hidden=!0,qe(e);return}let i=e.querySelector("img");i||(i=F("img","v3-head__logo-image"),e.replaceChildren(i)),i.alt=t!=null&&t.title?`Logo: ${t.title}`:"Logo",i.decoding="async",i.loading="lazy",i.referrerPolicy="no-referrer",i.src=r,e.hidden=!1}function Gu(e,t){if(!e)return;qe(e);let n=zu(t);if(!n){e.hidden=!0,e.dataset.state="";return}let r=F("span","v3-head__rating-chip");n.bucket&&(r.dataset.score=n.bucket);let i=F("span","v3-head__rating-label");i.textContent=n.label;let o=F("strong","v3-head__rating-value");o.textContent=n.text,r.append(i,o),r.setAttribute("aria-label",`${n.label} Bewertung ${n.text} von 10`),e.appendChild(r),e.hidden=!1,e.dataset.state="ready"}function qu(e,t){let n=Ut(e);if(!n)return;let{title:r,subtitle:i,meta:o}=n.elements,s=Es(t);r&&(r.textContent=(t==null?void 0:t.title)||"");let a=(t==null?void 0:t.tagline)||"",c=[];t!=null&&t.year&&c.push(t.year),s.runtime&&c.push(s.runtime);let l=s.rating||s.tmdbRating;l&&c.push(l);let u=s.studio;u&&c.push(u);let d=c.join(" \u2022 ");if(i){let h=a||d;i.textContent=h,i.hidden=!h}if(o){let h=a&&d?d:"";o.textContent=h,o.hidden=!h}}function Xu(e,t){let n=Ut(e);if(!n)return;let r=n.elements.badges;if(!r)return;qe(r),(Array.isArray(t)?t.filter(Boolean):[]).forEach(o=>{let s=F("span","v3-badge");s.dataset.source=o.source||"";let a=F("span","v3-badge__label");a.textContent=o.label||"";let c=F("strong","v3-badge__value");c.textContent=o.text||"",s.append(a,c),s.setAttribute("aria-label",`${o.label||"Badge"}: ${o.text||""}`),r.appendChild(s)}),r.hidden=!r.childElementCount}function Vu(e,t){let n=Ut(e);if(!n)return;let{heroBackdrop:r,overlayLogo:i,overlayMeta:o,logo:s}=n.elements;Mu(r,t);let a=Uu(i,t,()=>Ss(s,t,""));Gu(o,t),Ss(s,t,a)}function Bn(e,t){e&&e.dataset&&(e.dataset.state=t||"")}function Wu(e,t){var d,h,f,g,m;let n=As(e);if(!n||!n.media)return;let{media:r}=n,i=((d=t==null?void 0:t.poster)==null?void 0:d.source)||"";r.dataset&&(r.dataset.source=i||"");let o=Fe((h=t==null?void 0:t.poster)==null?void 0:h.url),s=o||"",a=(t==null?void 0:t.title)||((f=t==null?void 0:t.item)==null?void 0:f.title)||"",c=((g=t==null?void 0:t.poster)==null?void 0:g.alt)||(a?`Poster: ${a}`:"Poster"),l=F("img","");l.dataset.v3PosterImage="1",l.dataset.posterUrl=s,l.alt=c,l.loading="lazy",l.decoding="async",l.referrerPolicy="no-referrer",l.className=((m=n.img)==null?void 0:m.className)||"",l.classList.remove("is-ready"),r.querySelectorAll("[data-v3-poster-image]").forEach(p=>{p!==l&&p.remove()});let u=n.skeleton;r.dataset&&(r.dataset.posterUrl=s),o?(Bn(r,"loading"),l.addEventListener("load",()=>{var p;((p=r.dataset)==null?void 0:p.posterUrl)!==s||l.dataset.posterUrl!==s||(l.classList.add("is-ready"),Bn(r,"ready"))},{once:!0}),l.addEventListener("error",()=>{var p;((p=r.dataset)==null?void 0:p.posterUrl)!==s||l.dataset.posterUrl!==s||(l.classList.add("is-ready"),Bn(r,"error"))},{once:!0}),l.src=o):(l.classList.add("is-ready"),Bn(r,"empty")),u&&!r.contains(u)&&r.prepend(u),r.appendChild(l),n.img=l}function Yu(e){if(!Number.isFinite(Number(e)))return"";let t=Number(e);return t<=0?"":t===1?"1 Staffel":`${t} Staffeln`}function Ju(e,t){let n=As(e);if(!n)return;let{quickfactsRoot:r,quickfactsList:i}=n;if(!r||!i)return;qe(i);let o=Es(t),s=[];t!=null&&t.year&&s.push(["Jahr",t.year]),t!=null&&t.releaseDate&&s.push(["Ver\xF6ffentlichung",t.releaseDate]),o.contentRating&&s.push(["Freigabe",o.contentRating]),o.runtime&&s.push(["Laufzeit",o.runtime]),o.rating&&s.push(["Bewertung",o.rating]),o.tmdbRating&&s.push(["TMDB",o.tmdbRating]),o.studio&&s.push([(t==null?void 0:t.kind)==="show"?"Netzwerk":"Studio",o.studio]);let a=Yu(o.seasonCount);a&&s.push(["Staffeln",a]);let c=t==null?void 0:t.originalTitle;c&&c!==(t==null?void 0:t.title)&&s.push(["Original",c]),Array.isArray(t==null?void 0:t.genres)&&t.genres.length&&s.push(["Genres",t.genres.join(", ")]),s.forEach(([u,d])=>{let h=F("dt","");h.textContent=u;let f=F("dd","");f.textContent=d,i.append(h,f)});let l=s.length>0;r.hidden=!l,r.setAttribute("aria-hidden",l?"false":"true")}function _s(e=null){let t=ju();if(!t)return null;let n=ai(t);return e&&Qu(n,e),n}function ks(e=null){let t=Ku();if(!t)return null;let n=ci(t);return e&&(Wu(n,e),Zu(n,e)),n}function Qu(e,t){let n=Ut(e);return n?(Vu(n,t),qu(n,t),Xu(n,(t==null?void 0:t.badges)||[]),ed(n,null),n):null}function Zu(e,t){Ju(e,t)}function ed(e,t){var a;let n=Ut(e),r=(a=n==null?void 0:n.elements)==null?void 0:a.status;if(!r)return;if(!t){r.hidden=!0,r.textContent="",r.dataset&&(r.dataset.state=""),r.setAttribute("aria-hidden","true");return}let i=t.message?String(t.message).trim():"",o=t.state?String(t.state).trim():"";r.textContent=i,r.dataset&&(r.dataset.state=o);let s=!!i;r.hidden=!s,r.setAttribute("aria-hidden",s?"false":"true")}var Ts=I(()=>{Ee();Mt()});function td(){return Cs+=1,`modalv3-overview-${Cs}`}function nd(e){if(!e)return null;let t=typeof HTMLElement!="undefined"?HTMLElement:null;return e instanceof t?e:t&&e.content instanceof t?e.content:t&&e.root instanceof t?e.root:null}function li(e){return e==null?"":String(e).trim()}function rd(){var n,r,i;let e=typeof x=="function"?x():null,t=((n=e==null?void 0:e.cfg)==null?void 0:n.lang)||((r=e==null?void 0:e.cfg)==null?void 0:r.iso)||((i=e==null?void 0:e.cfg)==null?void 0:i.locale);return typeof t=="string"&&t.trim()?t.trim():"de-DE"}function id(e){var r,i,o,s,a;let t=(e==null?void 0:e.tmdb)||((r=e==null?void 0:e.item)==null?void 0:r.tmdbDetail)||((i=e==null?void 0:e.item)==null?void 0:i.tmdb)||null,n=[t==null?void 0:t.originalLanguage,t==null?void 0:t.original_language,(o=e==null?void 0:e.item)==null?void 0:o.originalLanguage,(s=e==null?void 0:e.item)==null?void 0:s.original_language,(a=t==null?void 0:t.languages)==null?void 0:a[0]];for(let c of n){if(!c)continue;let l=li(c).toLowerCase();if(l)return l}return""}function od(e){let t=id(e);if(!t)return"";let n=rd().toLowerCase();return t==="en"&&n&&!n.startsWith("en")?"EN":""}function sd(){let e=document.createElement("p");return e.textContent="Keine Inhaltsangabe verf\xFCgbar.",e.className="v3-overview__fallback",e}function ad(e,t){let n=li(t==null?void 0:t.overview)||li(t==null?void 0:t.summary),r={items:[]},i=od(t);if(i){let c=document.createElement("span");c.className="v3-chip",c.dataset.badge="language",c.textContent=i,c.setAttribute("aria-label",`Sprache: ${i}`),r.items.push(c)}if(!n)return r.items.push(sd()),r;let o=td(),s=document.createElement("p");s.className="v3-overview__text line-clamp line-clamp-5",s.id=o,s.textContent=n;let a=document.createElement("button");return a.type="button",a.className="v3-overview__toggle",a.setAttribute("aria-controls",o),a.dataset.overviewToggle="1",r.paragraph=s,r.toggle=a,r.items.push(s,a),r}function cd(e){return typeof requestAnimationFrame=="function"?requestAnimationFrame(e):setTimeout(e,0)}function Is(e,t,n,r){let i=!!r;t.classList.toggle("is-expanded",i),n.setAttribute("aria-expanded",i?"true":"false"),n.textContent=i?"Weniger anzeigen":"Mehr anzeigen",e!=null&&e.dataset&&(e.dataset.overviewExpanded=i?"true":"false")}function ld(e,t){if(!(!e||!t))try{let n=e.scrollHeight>e.clientHeight+1;if(t.hidden=!n,!n){e.classList.add("is-expanded"),t.setAttribute("aria-expanded","true");let r=e.parentElement;r!=null&&r.dataset&&(r.dataset.overviewExpanded="true")}}catch{}}function xs(e,t){var c;if(typeof document=="undefined")return;let n=nd(e);if(!n)return;let r=((c=n.dataset)==null?void 0:c.overviewExpanded)==="true";n.replaceChildren();let i=ad(n,t||{});if(i.items.forEach(l=>n.appendChild(l)),!i.paragraph||!i.toggle)return;let{paragraph:o,toggle:s}=i,a=r&&!s.hidden;Is(n,o,s,a),s.addEventListener("click",()=>{let l=s.getAttribute("aria-expanded")==="true";Is(n,o,s,!l)}),cd(()=>ld(o,s))}var Cs,Ls=I(()=>{ie();Cs=0});function ud(e){if(!e)return null;let t=typeof HTMLElement!="undefined"?HTMLElement:null;return t&&e instanceof t?e:t&&e.content instanceof t?e.content:t&&e.root instanceof t?e.root:null}function Pe(e){return Array.isArray(e)?e:e==null?[]:[e]}function M(e){return e==null?"":String(e).trim()}function dd(e){if(!e)return null;let t=e.item||{},n=e.tmdb||t.tmdbDetail||null,r=e.kind==="show"?"tv":t.type;return{...t,tmdbDetail:n,type:r}}function Fs(e){var n,r,i,o,s,a,c;let t=dd(e);return{runtime:M((n=e==null?void 0:e.meta)==null?void 0:n.runtime)||(t?ve(t):""),rating:M((r=e==null?void 0:e.meta)==null?void 0:r.rating)||(t?Ue(t):""),tmdbRating:M((i=e==null?void 0:e.meta)==null?void 0:i.tmdbRating),studio:M((o=e==null?void 0:e.meta)==null?void 0:o.studio)||(t?Ge(t):""),contentRating:M((s=e==null?void 0:e.meta)==null?void 0:s.contentRating),seasonCount:(c=(a=e==null?void 0:e.meta)==null?void 0:a.seasonCount)!=null?c:null}}function ut(...e){let t=[],n=new Set;return e.forEach(r=>{Pe(r).forEach(i=>{let o=M(i);if(!o)return;let s=o.toLowerCase();n.has(s)||(n.add(s),t.push(o))})}),t}function Gt(e){return e?ut(Pe(e).map(t=>t==null?"":typeof t=="string"?t:(t==null?void 0:t.name)||(t==null?void 0:t.title)||(t==null?void 0:t.tag)||(t==null?void 0:t.label)||"")):[]}function ui(e,t){var o;let n=new Set(Pe(t).map(s=>M(s).toLowerCase()).filter(Boolean));if(!n.size)return[];let i=Pe((o=e==null?void 0:e.credits)==null?void 0:o.crew).filter(s=>{if(!s)return!1;let a=M(s.job).toLowerCase();return a&&n.has(a)}).map(s=>(s==null?void 0:s.name)||(s==null?void 0:s.original_name)||(s==null?void 0:s.originalName)||"");return ut(i)}function fd(e){let t=(e==null?void 0:e.createdBy)||(e==null?void 0:e.created_by);return Gt(t)}function gd(e){let t=Number(e);return!Number.isFinite(t)||t<=0?"":t===1?"1 Staffel":`${t} Staffeln`}function hd(e){var s,a,c,l,u;let t=[],n=new Set,r=d=>{let h=M(d);if(!h)return;let f=h.toLowerCase();n.has(f)||(n.add(f),t.push(h))},i=(e==null?void 0:e.tmdb)||((s=e==null?void 0:e.item)==null?void 0:s.tmdbDetail)||null,o=(i==null?void 0:i.spokenLanguages)||(i==null?void 0:i.spoken_languages);return Pe(o).forEach(d=>{d&&r((d==null?void 0:d.name)||(d==null?void 0:d.englishName)||(d==null?void 0:d.iso_639_1)||d)}),Pe((a=e==null?void 0:e.item)==null?void 0:a.languages).forEach(r),Pe((c=e==null?void 0:e.item)==null?void 0:c.audioLanguages).forEach(r),Pe((l=e==null?void 0:e.item)==null?void 0:l.audio_language).forEach(r),r((u=e==null?void 0:e.item)==null?void 0:u.language),t}function md(e){let t=[],n=Fs(e),r=n.studio;r&&t.push({label:(e==null?void 0:e.kind)==="show"?"Netzwerk":"Studio",value:r,key:"studio"});let i=M(e==null?void 0:e.releaseDate)||M(e==null?void 0:e.year);i&&t.push({label:"Ver\xF6ffentlichung",value:i,key:"release"});let o=n.rating||n.tmdbRating;if(o&&t.push({label:"Bewertung",value:o,key:"rating"}),!t.length)return null;let s=document.createElement("div");return s.className="v3-chip-group",s.dataset.v3DetailHighlights="1",t.forEach(a=>{let c=document.createElement("span");c.className="v3-chip",c.dataset.detailKey=a.key,c.textContent=`${a.label}: ${a.value}`,c.setAttribute("aria-label",`${a.label}: ${a.value}`),s.appendChild(c)}),s}function di(e,t){if(!t||!t.length)return null;let n=document.createElement("section");n.dataset.v3DetailsSection=e.toLowerCase();let r=document.createElement("h3");r.textContent=e,n.appendChild(r);let i=document.createElement("dl"),o=typeof Node!="undefined"?Node:null;return t.forEach(s=>{let{term:a,value:c}=s,l=document.createElement("dt");l.textContent=a;let u=document.createElement("dd");o&&c instanceof o?u.appendChild(c):u.textContent=String(c!=null?c:""),i.append(l,u)}),n.appendChild(i),n}function pd(e){let t=[],n=Fs(e),r=M(e==null?void 0:e.releaseDate)||M(e==null?void 0:e.year);r&&t.push({term:"Ver\xF6ffentlichung",value:r}),n.runtime&&t.push({term:"Laufzeit",value:n.runtime}),n.contentRating&&t.push({term:"Freigabe",value:n.contentRating});let i=gd(n.seasonCount);i&&t.push({term:"Staffeln",value:i});let o=Array.isArray(e==null?void 0:e.genres)?e.genres.filter(Boolean):[];o.length&&t.push({term:"Genres",value:o.join(", ")});let s=M(e==null?void 0:e.originalTitle);return s&&s!==M(e==null?void 0:e.title)&&t.push({term:"Originaltitel",value:s}),t}function bd(e){let t=[],n=(e==null?void 0:e.item)||{},r=(e==null?void 0:e.tmdb)||(n==null?void 0:n.tmdbDetail)||null,i=ut(Gt(n==null?void 0:n.directors),ui(r,["Director"]));i.length&&t.push({term:"Regie",value:i.join(", ")});let o=ut(Gt(n==null?void 0:n.writers),ui(r,["Writer","Screenplay","Story"]));o.length&&t.push({term:"Drehbuch",value:o.join(", ")});let s=ut(Gt(n==null?void 0:n.producers),ui(r,["Producer","Executive Producer"]));if(s.length&&t.push({term:"Produktion",value:s.join(", ")}),(e==null?void 0:e.kind)==="show"){let a=ut(Gt((n==null?void 0:n.creators)||(n==null?void 0:n.showrunners)),fd(r));a.length&&t.push({term:"Creator",value:a.join(", ")})}return t}function yd(e){let t=document.createElement("a");return t.href=e,t.target="_blank",t.rel="noopener noreferrer",t.textContent=e,t}function Sd(e){var a,c,l,u,d,h,f,g,m,p,b,S,E;let t=[],n=M(e==null?void 0:e.tmdbUrl);n&&t.push({term:"TMDB",value:yd(n)});let r=M(((a=e==null?void 0:e.tmdb)==null?void 0:a.id)||((c=e==null?void 0:e.item)==null?void 0:c.tmdbId)||((u=(l=e==null?void 0:e.item)==null?void 0:l.ids)==null?void 0:u.tmdb));r&&t.push({term:"TMDB-ID",value:r});let i=M(((d=e==null?void 0:e.item)==null?void 0:d.imdbId)||((f=(h=e==null?void 0:e.item)==null?void 0:h.ids)==null?void 0:f.imdb)||((g=e==null?void 0:e.tmdb)==null?void 0:g.imdbId)||((p=(m=e==null?void 0:e.tmdb)==null?void 0:m.externalIds)==null?void 0:p.imdbId));i&&t.push({term:"IMDb-ID",value:i});let o=M(((b=e==null?void 0:e.item)==null?void 0:b.ratingKey)||((S=e==null?void 0:e.item)==null?void 0:S.rating_key)||((E=e==null?void 0:e.item)==null?void 0:E.id));o&&t.push({term:"Plex-ID",value:o});let s=hd(e);return s.length&&t.push({term:"Sprachen",value:s.join(", ")}),t}function Ps(e,t){if(typeof document=="undefined")return;let n=ud(e);if(!n)return;n.replaceChildren();let r=md(t||{});r&&n.appendChild(r);let i=di("Allgemein",pd(t||{}));i&&n.appendChild(i);let o=di("Credits",bd(t||{}));o&&n.appendChild(o);let s=di("Metadaten",Sd(t||{}));if(s&&n.appendChild(s),!n.childElementCount){let a=document.createElement("p");a.textContent="Keine Details verf\xFCgbar.",n.appendChild(a)}}var Rs=I(()=>{Mt()});function Ed(e){var o,s,a;if(!e)return null;if(typeof e=="string"){let c=String(e).trim();return c?{name:c,role:"",thumb:"",tmdbProfile:"",raw:null}:null}let t=String(e.tag||e.name||e.role||"").trim();if(!t)return null;let n=(()=>{let c=String(e.role||"").trim();return c?c.toLowerCase()===t.toLowerCase()?"":c:""})(),r=[(o=e==null?void 0:e.tmdb)==null?void 0:o.profile,(s=e==null?void 0:e.tmdb)==null?void 0:s.profile_path,(a=e==null?void 0:e.tmdb)==null?void 0:a.profilePath,e==null?void 0:e.tmdbProfile,e==null?void 0:e.profile,e==null?void 0:e.profile_path,e==null?void 0:e.profilePath].find(c=>typeof c=="string"&&c.trim()),i=[e==null?void 0:e.thumb,e==null?void 0:e.photo,e==null?void 0:e.image].find(c=>typeof c=="string"&&c.trim())||"";return{name:t,role:n,thumb:i,tmdbProfile:r?String(r).trim():"",raw:e}}function vd(e){if(!e)return null;let t=String(e.name||e.original_name||"").trim();if(!t)return null;let n=String(e.character||"").trim();return{name:t,role:n,thumb:"",tmdbProfile:e.profile||e.profile_path||e.profilePath||"",raw:{tmdb:e}}}function ws(e){var o,s;let t=new Map,n=[];return(Array.isArray(e==null?void 0:e.cast)?e.cast:Array.isArray(e==null?void 0:e.roles)?e.roles:[]).forEach(a=>{let c=Ed(a);if(!c)return;let l=c.name.toLowerCase();t.has(l)||(t.set(l,!0),n.push(c))}),(Array.isArray((s=(o=e==null?void 0:e.tmdbDetail)==null?void 0:o.credits)==null?void 0:s.cast)?e.tmdbDetail.credits.cast:[]).forEach(a=>{let c=vd(a);if(!c)return;let l=c.name.toLowerCase();t.has(l)||(t.set(l,!0),n.push(c))}),n}var Bs=I(()=>{});function _d(e){if(!e)return null;let t=typeof HTMLElement!="undefined"?HTMLElement:null;return t&&e instanceof t?e:t&&e.content instanceof t?e.content:t&&e.root instanceof t?e.root:null}function fi(e){let t=_d(e);if(!t)return null;let n=t.querySelector("[data-v3-cast]");return n||(n=document.createElement("div"),n.className="v3-cast",n.dataset.v3Cast="1",n.dataset.loading="false",t.appendChild(n)),n}function Nn(e){if(!e)return null;let t=e.querySelector("[data-v3-cast-list]");return t||(t=document.createElement("div"),t.className="v3-cast__scroller",t.dataset.v3CastList="1",t.id=`v3-cast-list-${++Ad}`,e.appendChild(t)),t}function gi(e){let t=Ns.get(e);return t||(t={entries:[],expanded:!1},Ns.set(e,t)),t}function kd(e){let t=String(e||"").trim();return t?/^https?:\/\//i.test(t)?t:t.startsWith("//")?`https:${t}`:`https://image.tmdb.org/t/p/w185${t.startsWith("/")?t:`/${t}`}`:""}function Td(e){let t=String(e||"").trim();return t?/^https?:\/\//i.test(t)||t.startsWith("data:")?t:t.startsWith("//")?`https:${t}`:t:""}function Cd(e,t){var i,o,s;if(!e)return"";let n=e.raw||{};if(t){let a=[e.tmdbProfile,(i=n==null?void 0:n.tmdb)==null?void 0:i.profile,(o=n==null?void 0:n.tmdb)==null?void 0:o.profile_path,(s=n==null?void 0:n.tmdb)==null?void 0:s.profilePath,n==null?void 0:n.tmdbProfile,n==null?void 0:n.profile,n==null?void 0:n.profile_path,n==null?void 0:n.profilePath];for(let c of a){let l=kd(c);if(l)return l}}let r=[e.thumb,n==null?void 0:n.thumb,n==null?void 0:n.photo,n==null?void 0:n.image];for(let a of r){let c=Td(a);if(c)return c}return""}function Id(e){let t=String(e||"").trim();if(!t)return"?";let r=t.split(/\s+/).slice(0,2).map(i=>i.charAt(0)).filter(Boolean);return r.length?r.join("").toUpperCase():t.charAt(0).toUpperCase()}function xd(e,t){let n=String((e==null?void 0:e.name)||"").trim();if(!n)return null;let r=String((e==null?void 0:e.role)||"").trim(),i=document.createElement("article");i.className="v3-cast-card",i.setAttribute("role","listitem"),i.tabIndex=0,r?i.setAttribute("aria-label",`${n} \u2013 ${r}`):(i.setAttribute("aria-label",n),i.classList.add("v3-cast-card--no-role"));let o=document.createElement("div");o.className="v3-cast-card__avatar";let s=Cd(e,t);if(s){o.classList.add("has-image");let l=document.createElement("img");l.src=s,l.alt=n,l.loading="lazy",l.decoding="async",o.appendChild(l)}else{let l=document.createElement("span");l.className="v3-cast-card__initials",l.textContent=Id(n),l.setAttribute("aria-hidden","true"),o.appendChild(l)}let a=document.createElement("div");a.className="v3-cast-card__meta";let c=document.createElement("p");if(c.className="v3-cast-card__name",c.textContent=n,a.appendChild(c),r){let l=document.createElement("p");l.className="v3-cast-card__role",l.textContent=r,a.appendChild(l)}return i.append(o,a),i}function Ds(e,t,n){let r=Nn(e);if(!r)return;let i=Kt(),o=n?t:t.slice(0,$s);r.replaceChildren(...o.map(s=>xd(s,i)).filter(Boolean)),o.length?r.setAttribute("role","list"):r.removeAttribute("role"),r.dataset.count=String(o.length),e.dataset.expanded=n?"true":"false"}function Ld(e){let t=e.querySelector("[data-v3-cast-more]");if(t)return t;t=document.createElement("button"),t.type="button",t.className="v3-cast__more",t.dataset.v3CastMore="1",t.textContent="Mehr Cast anzeigen";let n=Nn(e);return n!=null&&n.id&&t.setAttribute("aria-controls",n.id),t.addEventListener("click",()=>{let r=gi(e);r.expanded=!0,Ds(e,r.entries,!0),zs(e),t.setAttribute("aria-expanded","true")}),e.appendChild(t),t}function Os(e){let t=e.querySelector("[data-v3-cast-more]");t&&t.remove()}function zs(e){let t=gi(e);if(t.entries.length>$s&&!t.expanded){let r=Ld(e);r.hidden=!1,r.disabled=!1,r.setAttribute("aria-expanded","false")}else Os(e);js(e)}function js(e){let t=e.querySelector(".v3-cast-status");if(!t)return;let n=Nn(e);if(!n)return;let r=e.querySelector("[data-v3-cast-more]"),i=r||n;t.previousElementSibling!==i&&(r?e.insertBefore(t,r.nextSibling):e.insertBefore(t,n.nextSibling))}function Fd(e,t){let n=fi(e);if(!n)return;let r=!!t;n.dataset.loading=r?"true":"false",r?n.setAttribute("aria-busy","true"):n.removeAttribute("aria-busy")}function Hs(e,t){let n=fi(e);if(!n)return;let r=n.querySelector(".v3-cast-status");if(!t||!t.message){r&&r.remove(),n.dataset.status="";return}r||(r=document.createElement("p"),r.className="v3-cast-status",r.setAttribute("aria-live","polite"),r.setAttribute("aria-atomic","true"),n.appendChild(r)),r.dataset.state=t.state||"",r.textContent=t.message,n.dataset.status=t.state||"",js(n)}function Ks(e,t){let n=fi(e);if(!n)return;let r=(t==null?void 0:t.item)||t,i=ws(r)||[],o=gi(n);if(o.entries=i,o.expanded=!1,Fd(n,!1),!i.length){Nn(n).replaceChildren(),Hs(n,{state:"empty",message:"Keine Besetzungsdaten verf\xFCgbar."}),Os(n),n.dataset.count="0";return}Hs(n,null),Ds(n,i,!1),zs(n),n.dataset.count=String(i.length)}var $s,Ns,Ad,Ms=I(()=>{Bs();Ee();$s=12,Ns=new WeakMap,Ad=0});function Hn(){return Date.now()}function Rd(e){let t=Number(e);return!Number.isFinite(t)||t<=0?24*60*60*1e3:t<.01?Math.max(1,t*60*60*1e3*.01):t*60*60*1e3}function wd(e){try{return JSON.parse(e)}catch{return[]}}function Bd(e){try{return JSON.stringify(e)}catch{return"[]"}}function Us({storageKey:e=Pd}={}){let t=new Map,n=!1,r=null;function i(f){let g=wd(f),m=new Map,p=Hn();if(Array.isArray(g))for(let b of g){if(!Array.isArray(b)||b.length<2)continue;let[S,E]=b;if(!S||!E)continue;let k=Number(E.expiresAt);Number.isFinite(k)&&k>p&&m.set(String(S),{value:E.value,expiresAt:k})}t=m}function o(f=!1){if(typeof localStorage=="undefined")return;let g=null;try{g=localStorage.getItem(e)}catch{t=new Map,r=null;return}if(!g){t.size&&(t=new Map),r=null;return}!f&&g===r||(i(g),r=g)}function s(){n?o(!1):(o(!0),n=!0)}function a(){if(typeof localStorage=="undefined")return;let f=Array.from(t.entries()).map(([g,m])=>[g,{value:m.value,expiresAt:m.expiresAt}]);try{let g=Bd(f);localStorage.setItem(e,g),r=g}catch{}}function c(f){if(!f)return null;s();let g=t.get(String(f));return g?Number.isFinite(g.expiresAt)&&g.expiresAt<=Hn()?(t.delete(String(f)),a(),null):g.value:null}function l(f,g,m=24){if(!f)return g;s();let p=Hn()+Rd(m);return t.set(String(f),{value:g,expiresAt:p}),a(),g}function u(f){if(s(),!f){t.clear(),a();return}let g=String(f),m=!1;for(let p of t.keys())p.startsWith(g)&&(t.delete(p),m=!0);m&&a()}function d(){s();let f=Hn(),g=!1;for(let[m,p]of t.entries())Number.isFinite(p.expiresAt)&&p.expiresAt<=f&&(t.delete(m),g=!0);return g&&a(),g}function h(){return s(),t.size}return{get:c,set:l,clear:u,clearExpired:d,size:h}}function Nd(e){return qt.get(e)}function Hd(e,t,n){return qt.set(e,t,n)}function hi(e){return qt.clear(e)}function $d(){return qt.clearExpired()}function Dd(){return qt.size()}function dt(e){return Us(e)}var Pd,qt,Gs,$n=I(()=>{Pd="tmdb.metadata.cache.v1";qt=Us();Gs={get:Nd,set:Hd,clear:hi,clearExpired:$d,size:Dd,createCacheStore:dt}});function Xs(e){return new Promise(t=>setTimeout(t,Math.max(0,e||0)))}function zd(e){if(!e)return null;let t=Number(e);if(Number.isFinite(t))return t*1e3;let n=Date.parse(e);return Number.isFinite(n)?Math.max(0,n-Date.now()):null}function Vs(e,t){if(Number.isFinite(t)&&t>0)return Math.min(t,qs);let n=Math.pow(2,Math.max(0,e));return Math.min(qs,Od*n)}function mi(e){return e?Array.isArray(e)?e.filter(Boolean).join(","):typeof e=="string"?e.split(",").map(t=>t.trim()).filter(Boolean).join(","):"":""}function jd(e={}){var r,i,o,s;let t=[e.token,e.tmdbToken,(r=e==null?void 0:e.credentials)==null?void 0:r.token,(i=e==null?void 0:e.settings)==null?void 0:i.tmdbToken].find(a=>typeof a=="string"&&a.trim());if(t)return{kind:"bearer",value:t.trim()};let n=[e.apiKey,e.tmdbApiKey,(o=e==null?void 0:e.credentials)==null?void 0:o.apiKey,(s=e==null?void 0:e.settings)==null?void 0:s.tmdbApiKey].find(a=>typeof a=="string"&&a.trim());if(n)return{kind:"apikey",value:n.trim()};if(typeof localStorage!="undefined")try{let a=localStorage.getItem("tmdbToken");if(a&&a.trim())return{kind:"bearer",value:a.trim()}}catch{}return{kind:"none",value:""}}function Kd(e){let t={Accept:"application/json;charset=utf-8"};return(e==null?void 0:e.kind)==="bearer"&&e.value&&(t.Authorization=`Bearer ${e.value}`),{headers:t}}function Md(e,t){if((t==null?void 0:t.kind)!=="apikey"||!t.value)return e;let n=new URL(e);return n.searchParams.set("api_key",t.value),n.toString()}function Ud(e,t,n){let r=String(n.apiBase||Ws).replace(/\/$/,""),i=e.startsWith("/")?e:`/${e}`,o=new URL(`${r}${i}`),s=o.searchParams,a=mi(t.append_to_response);a&&s.set("append_to_response",a);let c=t.language||n.language||Ys;c&&s.set("language",c);let l=t.region||n.region||Js;l&&s.set("region",l);for(let[d,h]of Object.entries(t))if(h!=null&&!(d==="append_to_response"||d==="language"||d==="region")){if(Array.isArray(h)){h.length&&s.set(d,h.join(","));continue}s.set(d,String(h))}let u=o.toString();return a?u.replace(/append_to_response=([^&]+)/,(d,h)=>`append_to_response=${decodeURIComponent(h)}`):u}async function Gd(e,t,{retries:n=Qs}={}){let r=0,i=null;for(;r<=n;)try{let o=await fetch(e,t);if(o.status===204)return null;if(o.status===429&&r<n){let a=zd(o.headers.get("Retry-After"));await Xs(Vs(r,a)),r+=1;continue}if(!o.ok){let a=new Error(`TMDB request failed with status ${o.status}`);a.status=o.status,a.url=e;try{a.body=await o.text()}catch{a.body=null}throw a}return await o.json()}catch(o){i=o;let s=typeof(o==null?void 0:o.status)=="number"?o.status:null,a=s==null||s>=500||s===429;if(r>=n||!a)break;await Xs(Vs(r,null)),r+=1}throw i||new Error("TMDB request failed")}function pi(e={}){let t=e.cache instanceof Map?e.cache:null,n={apiBase:e.apiBase||Ws,language:e.language||Ys,region:e.region||Js,ttlHours:e.ttlHours||e.ttl||0},r=jd(e),i=e.cacheStore||(e.useCache?dt():null);function o(a,c){if(!t&&!i)return"";let l=Object.keys(c).sort().map(u=>`${u}=${JSON.stringify(c[u])}`).join("&");return`${a}?${l}`}async function s(a,c={},l={}){var p;let u={...c};if(l.append){let b=mi(u.append_to_response),S=mi(l.append),E=[b,S].filter(Boolean).join(",");E&&(u.append_to_response=E)}l.language&&(u.language=l.language),l.region&&(u.region=l.region);let d=Ud(a,u,n),h=Md(d,r),f=Kd(r),g=o(a,u);if(g){if(t&&t.has(g))return t.get(g);if(i){let b=i.get(g);if(b)return b}}let m=await Gd(h,f,{retries:(p=l.retries)!=null?p:Qs});if(g&&(t&&t.set(g,m),i))try{i.set(g,m,e.ttlHours||0)}catch{}return m}return{get:s,get credential(){return r},get config(){return{...n}}}}var Ws,Ys,Js,Qs,Od,qs,lb,Zs=I(()=>{$n();Ws="https://api.themoviedb.org/3",Ys="de-DE",Js="DE",Qs=4,Od=500,qs=1e4;lb=pi()});function qd(e){let t=String(e||bi).trim();return t?t.replace(/\/$/,""):bi}function Xd(e){if(!e)return"";let t=String(e);return t?t.startsWith("/")?t:`/${t}`:""}function Vt(e,t,n){let r=Xd(e);return r?`${qd(n)}/${t}${r}`:""}function Vd(e){return`data:image/svg+xml,${encodeURIComponent(e)}`}function Wd(e){switch(e){case"poster":return"#1f2933";case"profile":return"#111827";case"logo":return"#0f172a";case"episode":return"#0b1120";default:return"#101827"}}function Yd(e){return e==="logo"?"#e5e7eb":"#f9fafb"}function se(e,t=2){let n=String(e||"").trim();if(!n)return"";let r=n.split(/\s+/u).filter(Boolean);return r.length?r.slice(0,t).map(o=>o.charAt(0)).join("").toUpperCase():n.slice(0,t).toUpperCase()}function Wt({type:e,text:t="",width:n,height:r,fontSize:i,fontWeight:o="600",radius:s=0}){let a=Wd(e),c=Yd(e),l=se(t,2)||"\u2205",u=`<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" width="${n}" height="${r}" viewBox="0 0 ${n} ${r}">
  <rect x="0" y="0" width="${n}" height="${r}" rx="${s}" ry="${s}" fill="${a}"/>
  <text x="50%" y="50%" dominant-baseline="central" text-anchor="middle" fill="${c}" font-family="'Inter', 'Segoe UI', sans-serif" font-size="${i}" font-weight="${o}" letter-spacing="0.08em">${l}</text>
</svg>`;return Vd(u)}function ea(e){return Wt({type:"poster",text:e,width:500,height:750,fontSize:140,radius:24})}function ta(e){return Wt({type:"backdrop",text:e,width:780,height:439,fontSize:120,radius:16})}function na(e){return Wt({type:"profile",text:e,width:400,height:600,fontSize:140,radius:32})}function Jd(e){return Wt({type:"logo",text:e,width:500,height:281,fontSize:96,radius:24})}function Qd(e){return Wt({type:"episode",text:e,width:780,height:439,fontSize:110,radius:24})}function Yt(e){var t,n,r,i;return{imageBase:(n=(t=e==null?void 0:e.imageBase)!=null?t:e==null?void 0:e.base)!=null?n:bi,title:(i=(r=e==null?void 0:e.title)!=null?r:e==null?void 0:e.fallbackTitle)!=null?i:"",size:e==null?void 0:e.size}}function Re(e,t={}){let{imageBase:n,title:r,size:i}=Yt(t);return Vt(e,i||Xt.poster,n)||ea(r)}function ft(e,t={}){let{imageBase:n,title:r,size:i}=Yt(t);return Vt(e,i||Xt.backdrop,n)||ta(r)}function Dn(e,t={}){let{imageBase:n,title:r,size:i}=Yt(t);return Vt(e,i||Xt.profile,n)||na(r)}function Jt(e,t={}){let{imageBase:n,title:r,size:i}=Yt(t);return Vt(e,i||Xt.logo,n)||Jd(r)}function Qt(e,t={}){let{imageBase:n,title:r,size:i}=Yt(t);return Vt(e,i||Xt.episode,n)||Qd(r)}function On(e){return ea(e)}function ra(e){return ta(e)}function yi(e){return na(e)}var bi,Xt,zn=I(()=>{bi="https://image.tmdb.org/t/p",Xt={poster:"w500",backdrop:"w780",profile:"h632",logo:"w500",episode:"w780"}});function Xe(e={}){return{...Zd,...e}}function ee(e){if(e==null)return"";let t=Number(e);if(Number.isFinite(t)&&t>0)return String(Math.floor(t));let n=String(e).trim();if(/^\d+$/.test(n)){let r=parseInt(n,10);if(r>0)return String(r)}return""}function ef(e){let t=Number(e.vote_count||e.voteCount||0);return Number(e.vote_average||e.voteAverage||0)*10+t}function ia(e){if(!e)return"any";let t=String(e).toLowerCase();return t==="xx"||t==="null"?"any":t}function gt(e=[],{preferredLanguages:t=["de","en","any"],fallbackPath:n=""}={}){if(!Array.isArray(e)||e.length===0)return n||"";let r=e.filter(i=>i&&i.file_path).map(i=>({...i,language:ia(i.iso_639_1||i.language||""),score:ef(i)})).sort((i,o)=>o.score-i.score);for(let i of t){let o=r.find(s=>s.language===ia(i));if(o)return o.file_path||n||""}return r.length?r[0].file_path||n||"":n||""}function tf(e,t){if(!(e!=null&&e.belongs_to_collection))return null;let n=e.belongs_to_collection;return{id:ee(n.id),name:n.name||"",poster:Re(n.poster_path,{imageBase:t.imageBase,size:t.posterSize,title:n.name}),backdrop:ft(n.backdrop_path,{imageBase:t.imageBase,size:t.backdropSize,title:n.name})}}function oa(e){return Array.isArray(e)?e.map(t=>t&&(t.name||t.title||t.tag)).filter(Boolean).map(String):[]}function sa(e,t){return Array.isArray(e)?e.map(n=>({id:ee(n==null?void 0:n.id),name:(n==null?void 0:n.name)||"",originCountry:(n==null?void 0:n.origin_country)||"",logo:Jt(n==null?void 0:n.logo_path,{imageBase:t.imageBase,size:t.logoSize,title:n==null?void 0:n.name})})):[]}function nf(e,t){var o,s,a;if(!e)return null;let n=Xe(t),r=ee((o=e.provider_id)!=null?o:e.id),i=e.provider_name||e.name||"";return i?{id:r,providerId:r,name:i,logoPath:e.logo_path||"",logo:Jt(e.logo_path,{imageBase:n.imageBase,size:n.logoSize,title:i}),displayPriority:(a=(s=e.display_priority)!=null?s:e.displayPriority)!=null?a:null}:null}function rf(e,t){if(!e)return null;let n=Xe(t),r=["flatrate","rent","buy","free","ads"],i={link:e.link||""};for(let o of r){let s=Array.isArray(e[o])?e[o]:[];i[o]=s.map(a=>nf(a,n)).filter(Boolean)}return i}function aa(e,t={}){let n=Xe(t),r=e==null?void 0:e.results;if(!r||typeof r!="object")return{};let i={};for(let[s,a]of Object.entries(r)){let c=String(s||"").toUpperCase();if(!c)continue;let l=rf(a,n);l&&(i[c]=l)}let o=String(t.region||n.region||"").toUpperCase();return o&&i[o]&&(i.default=i[o]),i}function of(e,t){return Array.isArray(e)?e.map(n=>({id:ee(n==null?void 0:n.id),name:(n==null?void 0:n.name)||"",logo:Jt(n==null?void 0:n.logo_path,{imageBase:t.imageBase,size:t.logoSize,title:n==null?void 0:n.name}),originCountry:(n==null?void 0:n.origin_country)||""})):[]}function sf(e,t){return Array.isArray(e)?e.map(n=>{var r,i;return{id:ee(n==null?void 0:n.id),name:(n==null?void 0:n.name)||"",seasonNumber:(r=n==null?void 0:n.season_number)!=null?r:null,episodeCount:(i=n==null?void 0:n.episode_count)!=null?i:null,airDate:(n==null?void 0:n.air_date)||"",poster:Re(n==null?void 0:n.poster_path,{imageBase:t.imageBase,size:t.posterSize,title:n==null?void 0:n.name})}}):[]}function af(e){return Array.isArray(e)?e.map(t=>({code:(t==null?void 0:t.iso_639_1)||"",name:(t==null?void 0:t.english_name)||(t==null?void 0:t.name)||""})):[]}function cf(e){if(e!=null&&e.character)return e.character;if(Array.isArray(e==null?void 0:e.roles)&&e.roles.length){let t=e.roles.find(n=>n==null?void 0:n.character)||e.roles[0];return(t==null?void 0:t.character)||""}return""}function lf(e){if(e!=null&&e.job)return e.job;if(Array.isArray(e==null?void 0:e.jobs)&&e.jobs.length){let t=e.jobs.find(n=>n==null?void 0:n.job)||e.jobs[0];return(t==null?void 0:t.job)||""}return""}function Zt(e,t={}){var a,c;let n=Xe(t);if(!e)return{cast:[],crew:[]};let r=Array.isArray(e.cast)&&e.cast.length?e.cast:Array.isArray((a=e==null?void 0:e.aggregate)==null?void 0:a.cast)?e.aggregate.cast:[],i=Array.isArray(e.crew)&&e.crew.length?e.crew:Array.isArray((c=e==null?void 0:e.aggregate)==null?void 0:c.crew)?e.aggregate.crew:[],o=r.slice(0,n.castLimit).map(l=>{var u;return{id:ee(l==null?void 0:l.id),name:(l==null?void 0:l.name)||(l==null?void 0:l.original_name)||"",character:cf(l),order:(u=l==null?void 0:l.order)!=null?u:0,profile:Dn(l==null?void 0:l.profile_path,{imageBase:n.imageBase,size:n.profileSize,title:l==null?void 0:l.name}),initials:se((l==null?void 0:l.name)||(l==null?void 0:l.original_name)||""),knownForDepartment:(l==null?void 0:l.known_for_department)||""}}),s=i.slice(0,n.crewLimit).map(l=>({id:ee(l==null?void 0:l.id),name:(l==null?void 0:l.name)||(l==null?void 0:l.original_name)||"",job:lf(l),department:(l==null?void 0:l.department)||"",profile:Dn(l==null?void 0:l.profile_path,{imageBase:n.imageBase,size:n.profileSize,title:l==null?void 0:l.name}),initials:se((l==null?void 0:l.name)||(l==null?void 0:l.original_name)||"")}));return{cast:o,crew:s}}function uf(e=[]){let t=["DE","AT","CH","US"];for(let n of t){let r=e.find(s=>(s==null?void 0:s.iso_3166_1)===n);if(!r)continue;let o=(Array.isArray(r.release_dates)?r.release_dates:[]).filter(s=>s&&typeof s.certification=="string"&&s.certification.trim()).sort((s,a)=>{var h,f;let c=(h=s.type)!=null?h:0,l=(f=a.type)!=null?f:0;if(c!==l)return c-l;let u=Date.parse(s.release_date||"")||0,d=Date.parse(a.release_date||"")||0;return u-d});if(o.length)return o[0].certification.trim()}return""}function ca(e={}){var t,n;if((t=e.release_dates)!=null&&t.results){let r=uf(e.release_dates.results);if(r)return r}if((n=e.content_ratings)!=null&&n.results){let r=Array.isArray(e.content_ratings.results)?e.content_ratings.results:[],i=r.find(s=>(s==null?void 0:s.iso_3166_1)==="DE"&&(s==null?void 0:s.rating));if(i)return String(i.rating).trim();let o=r.find(s=>(s==null?void 0:s.iso_3166_1)==="US"&&(s==null?void 0:s.rating));if(o)return String(o.rating).trim()}return""}function en(e=[],t){return Array.isArray(e)?e.filter(n=>n&&n.file_path).map(t):[]}function la(e,t={}){var o,s,a,c;if(!e)return null;let n=Xe(t),r=gt((o=e.images)==null?void 0:o.posters,{fallbackPath:e.poster_path}),i=gt((s=e.images)==null?void 0:s.backdrops,{fallbackPath:e.backdrop_path,preferredLanguages:["de","en","any"]});return{type:"movie",id:ee(e.id),title:e.title||e.original_title||"",originalTitle:e.original_title||"",overview:e.overview||"",tagline:e.tagline||"",releaseDate:e.release_date||"",runtime:Number(e.runtime)||null,status:e.status||"",homepage:e.homepage||"",imdbId:e.imdb_id||"",collection:tf(e,n),poster:Re(r,{imageBase:n.imageBase,size:n.posterSize,title:e.title}),posterPath:r,backdrop:ft(i,{imageBase:n.imageBase,size:n.backdropSize,title:e.title}),backdropPath:i,genres:oa(e.genres),voteAverage:Number(e.vote_average)||0,voteCount:Number(e.vote_count)||0,popularity:Number(e.popularity)||0,productionCountries:Array.isArray(e.production_countries)?e.production_countries.map(l=>(l==null?void 0:l.iso_3166_1)||(l==null?void 0:l.name)||"").filter(Boolean):[],productionCompanies:sa(e.production_companies,n),spokenLanguages:af(e.spoken_languages),contentRating:ca(e),credits:Zt(e.credits,n),images:{posters:en((a=e.images)==null?void 0:a.posters,l=>({path:l.file_path,url:Re(l.file_path,{imageBase:n.imageBase,size:n.posterSize,title:e.title}),width:l.width,height:l.height,voteAverage:l.vote_average,voteCount:l.vote_count,language:l.iso_639_1||""})),backdrops:en((c=e.images)==null?void 0:c.backdrops,l=>({path:l.file_path,url:ft(l.file_path,{imageBase:n.imageBase,size:n.backdropSize,title:e.title}),width:l.width,height:l.height,voteAverage:l.vote_average,voteCount:l.vote_count,language:l.iso_639_1||""}))},watchProviders:aa(e["watch/providers"],n),url:e.id?`https://www.themoviedb.org/movie/${e.id}`:"",raw:e}}function ua(e,t={}){var o,s,a,c,l;if(!e)return null;let n=Xe(t),r=gt((o=e.images)==null?void 0:o.posters,{fallbackPath:e.poster_path}),i=gt((s=e.images)==null?void 0:s.backdrops,{fallbackPath:e.backdrop_path,preferredLanguages:["de","en","any"]});return{type:"tv",id:ee(e.id),name:e.name||e.original_name||"",originalName:e.original_name||"",overview:e.overview||"",tagline:e.tagline||"",firstAirDate:e.first_air_date||"",lastAirDate:e.last_air_date||"",numberOfEpisodes:Number(e.number_of_episodes)||0,numberOfSeasons:Number(e.number_of_seasons)||0,status:e.status||"",homepage:e.homepage||"",inProduction:!!e.in_production,poster:Re(r,{imageBase:n.imageBase,size:n.posterSize,title:e.name}),posterPath:r,backdrop:ft(i,{imageBase:n.imageBase,size:n.backdropSize,title:e.name}),backdropPath:i,genres:oa(e.genres),voteAverage:Number(e.vote_average)||0,voteCount:Number(e.vote_count)||0,popularity:Number(e.popularity)||0,createdBy:Array.isArray(e.created_by)?e.created_by.map(u=>({id:ee(u==null?void 0:u.id),name:(u==null?void 0:u.name)||"",profile:Dn(u==null?void 0:u.profile_path,{imageBase:n.imageBase,size:n.profileSize,title:u==null?void 0:u.name}),initials:se((u==null?void 0:u.name)||"")})):[],networks:of(e.networks,n),productionCompanies:sa(e.production_companies,n),seasons:sf(e.seasons,n),contentRating:ca(e),credits:(()=>{let u=e.credits||null,h=u&&(Array.isArray(u.cast)&&u.cast.length>0||Array.isArray(u.crew)&&u.crew.length>0)?u:e.aggregate_credits||null;return Zt(h,n)})(),images:{posters:en((a=e.images)==null?void 0:a.posters,u=>({path:u.file_path,url:Re(u.file_path,{imageBase:n.imageBase,size:n.posterSize,title:e.name}),width:u.width,height:u.height,voteAverage:u.vote_average,voteCount:u.vote_count,language:u.iso_639_1||""})),backdrops:en((c=e.images)==null?void 0:c.backdrops,u=>({path:u.file_path,url:ft(u.file_path,{imageBase:n.imageBase,size:n.backdropSize,title:e.name}),width:u.width,height:u.height,voteAverage:u.vote_average,voteCount:u.vote_count,language:u.iso_639_1||""})),logos:en((l=e.images)==null?void 0:l.logos,u=>({path:u.file_path,url:Jt(u.file_path,{imageBase:n.imageBase,size:n.logoSize,title:e.name}),width:u.width,height:u.height,language:u.iso_639_1||""}))},watchProviders:aa(e["watch/providers"],n),url:e.id?`https://www.themoviedb.org/tv/${e.id}`:"",raw:e}}function da(e,t={}){var s,a,c;if(!e)return null;let n=Xe(t),r=t.show||{},i=gt((s=e.images)==null?void 0:s.posters,{fallbackPath:e.poster_path}),o=Array.isArray(e.episodes)?e.episodes.map(l=>{var d,h,f,g;let u=gt((d=l==null?void 0:l.images)==null?void 0:d.stills,{fallbackPath:l==null?void 0:l.still_path});return{id:ee(l==null?void 0:l.id),episodeNumber:(h=l==null?void 0:l.episode_number)!=null?h:null,seasonNumber:(g=(f=l==null?void 0:l.season_number)!=null?f:e.season_number)!=null?g:null,name:(l==null?void 0:l.name)||"",overview:(l==null?void 0:l.overview)||"",airDate:(l==null?void 0:l.air_date)||"",runtime:Number(l==null?void 0:l.runtime)||null,voteAverage:Number(l==null?void 0:l.vote_average)||0,voteCount:Number(l==null?void 0:l.vote_count)||0,still:Qt(u,{imageBase:n.imageBase,size:n.stillSize,title:(l==null?void 0:l.name)||e.name}),stillPath:u,crew:Zt({crew:(l==null?void 0:l.crew)||[]},n).crew,guestStars:Zt({cast:(l==null?void 0:l.guest_stars)||[]},{...n,castLimit:10}).cast}}):[];return{type:"season",id:ee(e.id),showId:ee(r.id||e.show_id||""),name:e.name||"",overview:e.overview||"",airDate:e.air_date||"",seasonNumber:(a=e.season_number)!=null?a:null,episodeCount:e.episodes?e.episodes.length:e.episode_count||0,poster:Re(i,{imageBase:n.imageBase,size:n.posterSize,title:e.name||r.name}),posterPath:i,episodes:o,credits:Zt(e.credits,n),url:r.id?`https://www.themoviedb.org/tv/${r.id}/season/${(c=e.season_number)!=null?c:""}`:"",raw:e}}var Zd,fa=I(()=>{zn();Zd={imageBase:"https://image.tmdb.org/t/p",posterSize:"w500",backdropSize:"w780",profileSize:"h632",logoSize:"w500",stillSize:"w780",castLimit:20,crewLimit:40,region:"DE"}});function ff(e={}){return{apiKey:e.apiKey||e.tmdbApiKey||"",token:e.token||e.tmdbToken||"",language:e.language||e.lang||"de-DE",region:e.region||e.iso||"DE",imageBase:e.imageBase||df,ttlHours:Number(e.ttlHours||e.ttl||ga)||ga}}function gf(){return{warn(...e){try{}catch{}}}}function ha(e){return e?Array.isArray(e)?e:String(e).split(",").map(t=>t.trim()).filter(Boolean):[]}function Si(e,t){let n=new Set([...ha(e),...ha(t)]);return n.size?Array.from(n).join(","):""}function hf(e,t,n,r){let i={movie:"images,credits,release_dates,watch/providers",tv:"images,content_ratings,aggregate_credits,credits,watch/providers",season:"images,credits"};async function o(l,u,d){try{let f=t.get(l);if(f)return f}catch(f){r.warn("Cache read failed for",l,(f==null?void 0:f.message)||f)}let h=null;try{h=await d()}catch(f){throw r.warn("Request failed for",l,(f==null?void 0:f.message)||f),f}try{h!=null&&t.set(l,h,u)}catch(f){r.warn("Cache write failed for",l,(f==null?void 0:f.message)||f)}return h}async function s(l,u={}){var g;let d=l!=null?l:u.id;if(d==null)return null;let h=`tmdb:movie:${d}:v1`,f=(g=u.ttlHours)!=null?g:n.ttlHours;return o(h,f,async()=>{var b,S,E;let m=Si(i.movie,u.append),p=await e.get(`/movie/${d}`,{append_to_response:m},{language:(b=u.language)!=null?b:n.language,region:(S=u.region)!=null?S:n.region});return la(p,{imageBase:n.imageBase,posterSize:u.posterSize,backdropSize:u.backdropSize,profileSize:u.profileSize,logoSize:u.logoSize,region:(E=u.region)!=null?E:n.region})})}async function a(l,u={}){var g;let d=l!=null?l:u.id;if(d==null)return null;let h=`tmdb:tv:${d}:v1`,f=(g=u.ttlHours)!=null?g:n.ttlHours;return o(h,f,async()=>{var b,S,E;let m=Si(i.tv,u.append),p=await e.get(`/tv/${d}`,{append_to_response:m},{language:(b=u.language)!=null?b:n.language,region:(S=u.region)!=null?S:n.region});return ua(p,{imageBase:n.imageBase,posterSize:u.posterSize,backdropSize:u.backdropSize,profileSize:u.profileSize,logoSize:u.logoSize,region:(E=u.region)!=null?E:n.region})})}async function c(l,u,d={}){var g;if(l==null||u==null)return null;let h=`tmdb:tv:${l}:season:${u}:v1`,f=(g=d.ttlHours)!=null?g:n.ttlHours;return o(h,f,async()=>{var S,E;let m=Si(i.season,d.append),p=await e.get(`/tv/${l}/season/${u}`,{append_to_response:m},{language:(S=d.language)!=null?S:n.language,region:(E=d.region)!=null?E:n.region}),b=d.show||null;if(!b&&!d.skipShowLookup)try{b=await a(l,{ttlHours:f})}catch(k){r.warn("Failed to load parent show for season",l,u,(k==null?void 0:k.message)||k),b={id:l,name:"",type:"tv"}}return b||(b={id:l,name:"",type:"tv"}),da(p,{imageBase:n.imageBase,posterSize:d.posterSize,backdropSize:d.backdropSize,profileSize:d.profileSize,logoSize:d.logoSize,show:b})})}return{getMovieEnriched:s,getTvEnriched:a,getSeasonEnriched:c}}function jn(e={}){let t=ff(e),n=e.cacheStore||dt({storageKey:e.storageKey}),r=pi({apiBase:e.apiBase||t.apiBase,apiKey:t.apiKey,token:t.token,language:t.language,region:t.region,ttlHours:t.ttlHours}),i=gf(),o=hf(r,n,t,i);return{getMovieEnriched:o.getMovieEnriched,getTvEnriched:o.getTvEnriched,getSeasonEnriched:o.getSeasonEnriched,get client(){return r},get cache(){return n},get config(){return{...t}},clear(s){n.clear(s)}}}function ma(){return Ei||(Ei=dt()),Ei}function Ve(){return tn||(tn=jn({cacheStore:ma()})),tn}function pa(e={}){let t={...e};return t.cacheStore||(t.cacheStore=ma()),tn=jn(t),tn}function mf(){try{let e=localStorage.getItem("tmdbToken");if(e&&e.trim())return e.trim()}catch{}return""}function ht(e={},t={}){try{let{preferStoredToken:n=!0,token:r,apiKey:i,language:o,region:s,ttlHours:a,imageBase:c}=t||{},l={},u=o||e.lang||e.language;u&&(l.language=u);let d=s||e.region||e.iso;d&&(l.region=d);let h=[a,e.ttlHours,e.tmdbTtlHours];for(let p of h){if(p==null||typeof p=="string"&&p.trim()==="")continue;let b=Number(p);if(Number.isFinite(b)){l.ttlHours=b;break}}let f=c||e.imageBase||e.tmdbImageBase;f&&(l.imageBase=f);let g=typeof r=="string"?r.trim():r!=null?r:"";typeof g!="string"&&(g=""),!g&&n&&(g=mf()),!g&&typeof e.tmdbToken=="string"&&(g=e.tmdbToken.trim());let m=typeof i=="string"?i.trim():i!=null?i:"";typeof m!="string"&&(m=""),!m&&typeof e.tmdbApiKey=="string"&&(m=e.tmdbApiKey.trim()),g?l.token=g:m&&(l.apiKey=m),pa(l)}catch{}}var ga,df,Ei,tn,ba,le,mt=I(()=>{$n();Zs();fa();ga=24,df="https://image.tmdb.org/t/p";Ei=null,tn=null;ba={getMovieEnriched:(...e)=>Ve().getMovieEnriched(...e),getTvEnriched:(...e)=>Ve().getTvEnriched(...e),getSeasonEnriched:(...e)=>Ve().getSeasonEnriched(...e),clear(e){return Ve().clear(e)},configure:pa,sync:ht};Object.defineProperties(ba,{client:{get(){return Ve().client}},cache:{get(){return Ve().cache}},config:{get(){return Ve().config}}});le=ba});function pf(e){if(!e)return null;let t=typeof HTMLElement!="undefined"?HTMLElement:null;return t&&e instanceof t?e:t&&e.root instanceof t?e.root:t&&e.content instanceof t?e.content:null}function Kn(e){return Array.isArray(e)?e:[]}function X(e){return e==null?"":String(e).trim()}function Mn(e,t){let n=[e==null?void 0:e.seasonNumber,e==null?void 0:e.number,e==null?void 0:e.index,e==null?void 0:e.season,e==null?void 0:e.season_index,e==null?void 0:e.season_number];for(let r of n){let i=Number(r);if(Number.isFinite(i))return i}return t}function bf(e){var s,a,c,l,u,d,h,f,g;let t=(e==null?void 0:e.item)||{},n=(e==null?void 0:e.tmdb)||(t==null?void 0:t.tmdbDetail)||(t==null?void 0:t.tmdb)||{},r=(t==null?void 0:t.ids)||{},i=(f=(h=(l=(c=(a=n==null?void 0:n.id)!=null?a:(s=n==null?void 0:n.ids)==null?void 0:s.tmdb)!=null?c:t==null?void 0:t.tmdbId)!=null?l:r==null?void 0:r.tmdb)!=null?h:(d=(u=t==null?void 0:t.parent)==null?void 0:u.ids)==null?void 0:d.tmdb)!=null?f:null,o=X(e==null?void 0:e.title)||X(n==null?void 0:n.name)||X(t==null?void 0:t.title)||"";return{tmdbId:i!=null&&String(i).trim()||null,show:n!=null&&n.id?n:{id:(g=i!=null?i:t==null?void 0:t.tmdbId)!=null?g:"",name:o}}}function yf(e){let t=[],n=X(e==null?void 0:e.year)||X(e==null?void 0:e.airDate);n&&t.push(n);let r=Number(e==null?void 0:e.episodeCount);if(Number.isFinite(r)&&r>=0){let i=r===1?"Episode":"Episoden";t.push(`${r} ${i}`)}return t.join(" \u2022 ")}function Sf(e){var i;let t=document.createElement("div");t.className="v3-season-card__thumb";let n=X(((i=e==null?void 0:e.poster)==null?void 0:i.url)||(e==null?void 0:e.poster)),r=X(e==null?void 0:e.title)||"Staffelposter";if(n){let o=new Image;o.decoding="async",o.loading="lazy",o.src=n,o.alt=r,t.append(o)}else{t.dataset.state="empty";let o=document.createElement("span");o.textContent=se(r,2)||"\u2205",t.append(o)}return t}function Ef(e){let t=X(e==null?void 0:e.overview);if(!t)return null;let n=document.createElement("p");return n.className="v3-season-card__summary",n.textContent=t,n}function vf(e,t,n,r){let i=!!r;e.classList.toggle("is-open",i),t.setAttribute("aria-expanded",i?"true":"false"),n.hidden=!i,n.setAttribute("aria-hidden",i?"false":"true")}function Af(e){let t=(e==null?void 0:e.tmdb)||{},n=Mn(e,Mn(t,null)),r=(()=>{let f=[e==null?void 0:e.episodeNumber,e==null?void 0:e.number,e==null?void 0:e.index,e==null?void 0:e.episode,t==null?void 0:t.episodeNumber];for(let g of f){let m=Number(g);if(Number.isFinite(m))return m}return null})(),i=(e==null?void 0:e.seasonEpisode)&&String(e.seasonEpisode)||(Number.isFinite(n)&&Number.isFinite(r)?`S${String(n).padStart(2,"0")}E${String(r).padStart(2,"0")}`:""),o=(()=>{let f=[e==null?void 0:e.durationMin,e==null?void 0:e.duration,t==null?void 0:t.runtime];for(let g of f){let m=Number(g);if(Number.isFinite(m)&&m>0)return m>500?Math.round(m/6e4):Math.round(m)}return null})(),s=Number.isFinite(o)&&o>0?ve({runtimeMin:o}):"",a=(()=>{let f=[t==null?void 0:t.voteAverage,e==null?void 0:e.rating,e==null?void 0:e.audienceRating,e==null?void 0:e.score];for(let g of f){let m=Number(g);if(Number.isFinite(m)&&m>0)return m}return null})(),c=X((t==null?void 0:t.airDate)||(e==null?void 0:e.airDate)||(e==null?void 0:e.originallyAvailableAt)||(e==null?void 0:e.date)),l=X((t==null?void 0:t.overview)||(e==null?void 0:e.overview)||(e==null?void 0:e.summary)||(e==null?void 0:e.description)||(e==null?void 0:e.plot)),u=(t==null?void 0:t.stillPath)||(e==null?void 0:e.tmdbStillPath)||(e==null?void 0:e.stillPath),d=(t==null?void 0:t.still)||(e==null?void 0:e.tmdbStill)||(e==null?void 0:e.still)||(e==null?void 0:e.thumbFile)||(e==null?void 0:e.thumb);return{title:X((t==null?void 0:t.name)||(e==null?void 0:e.title)||(e==null?void 0:e.name)),code:i,runtimeText:s,rating:a,overview:l,airDate:c,stillPath:u,stillUrl:d}}function _f(e,t={}){let n=document.createElement("div");n.className="v3-episode__still";let r=e.title||t.showTitle||"Episode";if(e.stillPath){let o=Qt(e.stillPath,{size:"w300",title:r}),s=Qt(e.stillPath,{size:"w780",title:r}),a=new Image;return a.decoding="async",a.loading="lazy",a.src=o,a.srcset=`${o} 300w, ${s} 780w`,a.alt=r,n.append(a),n}if(e.stillUrl){let o=new Image;return o.decoding="async",o.loading="lazy",o.src=e.stillUrl,o.alt=r,n.append(o),n}n.dataset.state="empty";let i=document.createElement("span");return i.className="v3-episode__initials",i.textContent=se(r,2)||"\u2205",n.append(i),n}function kf(e){let t=[];return e.code&&t.push(e.code),e.title&&t.push(e.title),t.join(" \u2022 ")}function Tf(e){return Number.isFinite(e)?e>=10?e.toFixed(0):e.toFixed(1):""}function ya(e,t){if(!e)return null;let n=document.createElement("span");return n.className="v3-episode__badge",t&&(n.dataset.variant=t),n.textContent=e,n}function Cf(e,t){let n=Af(e),r=document.createElement("article");r.className="v3-episode";let i=_f(n,t);r.append(i);let o=document.createElement("div");o.className="v3-episode__body";let s=document.createElement("div");s.className="v3-episode__header";let a=document.createElement("h4");a.className="v3-episode__title",a.textContent=kf(n)||"Episode",s.append(a);let c=document.createElement("div");c.className="v3-episode__badges";let l=ya(n.runtimeText,"runtime"),u=ya(Tf(n.rating),"rating");l&&c.append(l),u&&c.append(u),c.childElementCount&&s.append(c);let d=document.createElement("p");d.className="v3-episode__meta",d.textContent=[n.airDate,n.runtimeText].filter(Boolean).join(" \u2022 ");let h=document.createElement("p");return h.className="v3-episode__overview",h.textContent=n.overview||"Keine Beschreibung verf\xFCgbar.",o.append(s,d,h),r.append(o),r}function pt(e,t,n){e.replaceChildren();let r=Kn(t);if(!r.length){let i=document.createElement("p");i.className="v3-episode__empty",i.textContent="Keine Episoden verf\xFCgbar.",e.append(i);return}r.forEach(i=>e.append(Cf(i,n)))}function If(e){var n;if(!e||((n=e.dataset)==null?void 0:n.accordionReady)==="1")return;e.dataset.accordionReady="1";let t=typeof HTMLElement!="undefined"?HTMLElement:null;e.addEventListener("keydown",r=>{var a,c;if(!t)return;let i=r.target instanceof t?r.target:null;if(!i||typeof i.matches!="function"||!i.matches("[data-season-toggle]"))return;let o=Array.from(e.querySelectorAll("[data-season-toggle]"));if(!o.length)return;let s=o.indexOf(i);if(s!==-1)if(r.key==="ArrowDown"||r.key==="ArrowRight"){r.preventDefault();let l=o[(s+1)%o.length];l==null||l.focus()}else if(r.key==="ArrowUp"||r.key==="ArrowLeft"){r.preventDefault();let l=o[(s-1+o.length)%o.length];l==null||l.focus()}else r.key==="Home"?(r.preventDefault(),(a=o[0])==null||a.focus()):r.key==="End"&&(r.preventDefault(),(c=o[o.length-1])==null||c.focus())})}function xf(e,t,n){let r=document.createElement("article");r.className="v3-season-card";let i=`v3-season-${vi+=1}-header`,o=`v3-season-${vi}-panel`,s=document.createElement("h3");s.className="v3-season-card__heading";let a=document.createElement("button");a.type="button",a.className="v3-season-card__button",a.dataset.seasonToggle="1",a.id=i,a.setAttribute("aria-expanded","false"),a.setAttribute("aria-controls",o);let c=Sf(e),l=document.createElement("div");l.className="v3-season-card__label";let u=document.createElement("span");u.className="v3-season-card__title",u.textContent=X(e==null?void 0:e.title)||`Staffel ${Mn(e,t+1)}`;let d=document.createElement("span");d.className="v3-season-card__meta",d.textContent=yf(e),l.append(u,d);let h=document.createElement("span");h.className="v3-season-card__chevron",h.setAttribute("aria-hidden","true"),h.textContent="\u203A",a.append(c,l,h),s.append(a);let f=document.createElement("div");f.id=o,f.className="v3-season-card__panel",f.setAttribute("role","region"),f.setAttribute("aria-labelledby",i),f.hidden=!0,f.setAttribute("aria-hidden","true");let g=Ef(e);g&&f.append(g);let m=document.createElement("div");m.className="v3-episode-list",f.append(m);let p=Kn(e==null?void 0:e.episodes);p.length&&pt(m,p,{showTitle:n.showTitle});let b=!!p.length,S=!1,E=null;function k(z){if(r.classList.toggle("is-loading",z),z){f.dataset.loading="true",m.replaceChildren();let B=document.createElement("p");B.className="v3-episode__loading",B.textContent="Episoden werden geladen \u2026",m.append(B)}else delete f.dataset.loading}function L(){E&&!E.signal.aborted&&E.abort(),E=null}function T(){if(b||S)return;let z=Mn(e,t+1);if(!n.tmdbId||z==null){b=!0,pt(m,p,{showTitle:n.showTitle});return}if(!le||typeof le.getSeasonEnriched!="function"){b=!0,pt(m,p,{showTitle:n.showTitle});return}S=!0,k(!0),E=typeof AbortController=="function"?new AbortController:null,le.getSeasonEnriched(n.tmdbId,z,{stillSize:"w300",show:n.show}).then(B=>{if(E!=null&&E.signal.aborted)return;let j=Kn(B==null?void 0:B.episodes);j.length?(e.episodes=j,pt(m,j,{showTitle:n.showTitle})):pt(m,[],{showTitle:n.showTitle}),b=!0}).catch(B=>{E!=null&&E.signal.aborted||(pt(m,p,{showTitle:n.showTitle}),b=!0)}).finally(()=>{S=!1,k(!1),E=null})}function W(){let B=!(a.getAttribute("aria-expanded")==="true");vf(r,a,f,B),B&&T()}return a.addEventListener("click",()=>{W()}),a.addEventListener("keydown",z=>{(z.key===" "||z.key==="Spacebar"||z.key==="Enter")&&(z.preventDefault(),W())}),r._cleanup=()=>{L()},r.append(s,f),r}function Sa(e,t){if(typeof document=="undefined")return;let n=pf(e);if(!n)return;vi=0;let r=Kn(t==null?void 0:t.seasons);if(n.classList.add("v3-seasons"),n.replaceChildren(),!r.length){let c=document.createElement("p");c.className="v3-seasons__empty",c.textContent="Keine Staffelinformationen verf\xFCgbar.",n.append(c);return}let{tmdbId:i,show:o}=bf(t||{}),s={tmdbId:i,show:o,showTitle:X(t==null?void 0:t.title)||X(o==null?void 0:o.name)};r.map((c,l)=>xf(c,l,s)).forEach(c=>n.append(c)),If(n)}var vi,Ea=I(()=>{mt();zn();Mt();vi=0});function Lf(e){let t=typeof HTMLElement!="undefined"?HTMLElement:null;return!e||t&&!(e instanceof t)?[]:Array.from(e.querySelectorAll(Ai)).filter(n=>n instanceof t)}function Ff(e,t){if(!e||!t)return null;let n=typeof HTMLElement!="undefined"?HTMLElement:null,r=e.ownerDocument||(n&&e instanceof n?e.ownerDocument:null)||(typeof document!="undefined"?document:null),i=t.getAttribute("aria-controls");if(i&&r){let s=r.getElementById(i);if(s&&(!e.contains||e.contains(s)))return s}let o=t.dataset?t.dataset.tab||t.dataset.pane:"";if(o){let s=`[data-pane="${o}"]`,a=e.querySelector(s);if(a)return a}if(i&&r)try{let s=r.querySelector(`[data-pane="${i}"]`);if(s)return s}catch{}return null}function nn(e,t,n){if(!t.length)return;let r=typeof HTMLElement!="undefined"?HTMLElement:null,i=typeof n=="string"?t.find(o=>{var s;return((s=o.dataset)==null?void 0:s.tab)===n||o.getAttribute("aria-controls")===n}):n;!i||r&&!(i instanceof r)||t.forEach(o=>{let s=o===i;o.classList.toggle("active",s),o.setAttribute("aria-selected",s?"true":"false"),o.tabIndex=s?0:-1;let a=Ff(e,o);a&&(a.classList.toggle("is-hidden",!s),s?(a.hidden=!1,a.setAttribute("aria-hidden","false")):(a.hidden=!0,a.setAttribute("aria-hidden","true")))})}function va(e,t,n,r){if(!t.length||!n)return;let i=t.indexOf(n),o=r>0?0:t.length-1,s=i===-1?o:(i+r+t.length)%t.length,a=t[s];a&&(_i(a),nn(e,t,a))}function _i(e){if(!e)return;let t=e.ownerDocument||(typeof document!="undefined"?document:null);if(typeof e.focus=="function"&&e.focus(),t&&t.activeElement!==e)try{t.activeElement=e}catch{}}function ki(e){if(!e)return;let t=typeof HTMLElement!="undefined"?HTMLElement:null,n=t&&e instanceof t?e:e.root||e;if(!n||t&&!(n instanceof t))return;Array.from(n.querySelectorAll(".v3-tabs")).forEach(i=>{var a;if(!i||((a=i.dataset)==null?void 0:a.tabsReady)==="1")return;let o=Lf(i);if(!o.length)return;i.dataset.tabsReady="1",i.hasAttribute("role")||i.setAttribute("role","tablist"),o.forEach(c=>{c.hasAttribute("role")||c.setAttribute("role","tab"),c.hasAttribute("type")||c.setAttribute("type","button")}),i.addEventListener("click",c=>{let l=c.target&&typeof c.target.closest=="function"?c.target.closest(Ai):null;!l||!o.includes(l)||(c.preventDefault(),nn(n,o,l))}),i.addEventListener("keydown",c=>{let l=c.target&&typeof c.target.closest=="function"?c.target.closest(Ai):null;if(!(!l||!o.includes(l)))switch(c.key){case"ArrowLeft":case"ArrowUp":c.preventDefault(),va(n,o,l,-1);break;case"ArrowRight":case"ArrowDown":c.preventDefault(),va(n,o,l,1);break;case"Home":c.preventDefault(),o[0]&&(_i(o[0]),nn(n,o,o[0]));break;case"End":if(c.preventDefault(),o.length){let u=o[o.length-1];_i(u),nn(n,o,u)}break;default:break}});let s=o.find(c=>c.getAttribute("aria-selected")==="true")||o[0];nn(n,o,s)})}var Ai,Aa=I(()=>{Ai="[data-tab]"});function Rf(e){return e!==null&&typeof e=="object"}function wf(e){var o,s;let t=Rf(e)?(s=(o=e.id)!=null?o:e.guid)!=null?s:"":e,n=typeof t=="string"?t.trim():"";if(!n)return{};let r=n.toLowerCase(),i={};for(let[a,c]of Object.entries(Pf))if(!i[a])for(let l of c){let u=l.toLowerCase(),d=r.indexOf(u);if(d===-1)continue;let h=d+u.length,f=n.slice(h);if(f=f.replace(/^\/+/,""),f=f.split(/[?#]/)[0],!!f&&(f.includes("/")&&(f=f.split("/").find(Boolean)||""),f=f.trim(),f)){i[a]=f;break}}return i}function Un(e){var i,o,s;if(!e||typeof e!="object")return e;let t={...e.ids||{}},n=(a,c)=>{if(t[a])return;let l=c==null?"":String(c).trim();l&&(t[a]=l)};n("tmdb",e.tmdbId),n("tmdb",(i=e==null?void 0:e.tmdb)==null?void 0:i.id),n("imdb",e.imdbId),n("imdb",(o=e==null?void 0:e.tmdb)==null?void 0:o.imdbId),n("tvdb",e.tvdbId),n("tvdb",(s=e==null?void 0:e.tmdb)==null?void 0:s.tvdbId);let r=[];return Array.isArray(e==null?void 0:e.guids)&&r.push(...e.guids),e!=null&&e.guid&&r.push(e.guid),r.forEach(a=>{let c=wf(a);Object.entries(c).forEach(([l,u])=>n(l,u))}),Object.keys(t).length&&(e.ids=t,t.tmdb&&!e.tmdbId&&(e.tmdbId=t.tmdb)),e}function rn(e){if(e==null||typeof e!="object")return e;if(typeof structuredClone=="function")try{return structuredClone(e)}catch{}try{return JSON.parse(JSON.stringify(e))}catch{}if(Array.isArray(e))return e.map(n=>rn(n));let t={};for(let n of Object.keys(e))t[n]=rn(e[n]);return t}function _a(e){if(!e||typeof e!="object")return null;let t=rn(e);return t.type==="show"&&(t.type="tv"),t.type||(t.type="movie"),Un(t),t}function ka(e){if(!e||typeof e!="object")return null;let t=rn(e);return t.type!=="tv"&&(t.type="tv"),Un(t),Ci(t),t}function Bf(e){if(!e||typeof e!="object")return null;let t=rn(e);return Un(t),Ci(t),t}function Ti(e,t){if(!e)return e;if(t&&typeof t=="object"){let n=Bf(t);Object.assign(e,n),Un(e)}return Ci(e),e}function Ci(e){if(!e||typeof e!="object")return;Ii(e),e.genres=bt(e.genres);let t=$f(e.cast||e.roles||[]);e.cast=t,e.roles=t,e.seasons=Array.isArray(e.seasons)?e.seasons.map(Nf).filter(Boolean):[];let n=Number(e.seasonCount);e.seasonCount=Number.isFinite(n)&&n>0?n:e.seasons.length}function Nf(e){if(!e||typeof e!="object")return null;let t={...e};return Ii(t),t.genres=bt(t.genres),t.episodes=Array.isArray(t.episodes)?t.episodes.map(Hf).filter(Boolean):[],t}function Hf(e){if(!e||typeof e!="object")return null;let t={...e};return Ii(t),t.genres=bt(t.genres),t}function Ii(e){he(e)}function $f(e){return Array.isArray(e)?e.map(t=>{if(typeof t=="string"){let o=t.trim();if(!o)return null;let s={tag:o,name:o};return he(s),s}if(!t||typeof t!="object")return null;let n=(t==null?void 0:t.tag)||(t==null?void 0:t.name)||(t==null?void 0:t.title)||"",r=String(n).trim();if(!r)return null;let i={...t,tag:r,name:r};return he(i),i}).filter(Boolean):[]}function bt(e){if(!Array.isArray(e))return[];let t=new Set,n=[];return e.forEach(r=>{let i=null;if(typeof r=="string"){let o=r.trim();o&&(i={tag:o})}else if(r&&typeof r=="object"){let o=String(r.tag||r.title||r.name||r.label||"").trim();o&&(i={...r,tag:o})}i&&!t.has(i.tag)&&(t.add(i.tag),n.push(i))}),n}var Pf,Ta=I(()=>{Ot();Pf={tmdb:["tmdb://","themoviedb://","com.plexapp.agents.themoviedb://"],imdb:["imdb://","com.plexapp.agents.imdb://"],tvdb:["tvdb://","thetvdb://","com.plexapp.agents.thetvdb://"]}});function Ia(e){return e!=null&&typeof e=="object"&&!Array.isArray(e)}function ue(e){return Array.isArray(e)?e:[]}function U(e){return typeof e!="string"?"":e.trim()}function xa(e){if(!e)return"";if(typeof e=="string")return e;if(Array.isArray(e)){for(let t of e){let n=xa(t);if(n)return n}return""}return Ia(e)&&(e.url||e.path||e.file_path||e.filePath||e.location||e.poster||e.backdrop||e.profile||e.thumbFile||e.thumb||e.image)||""}function Df(e,t){let n=U(xa(e));if(!n)return"";if(/^https?:\/\//i.test(n)||n.startsWith("data:"))return n;if(n.startsWith("//"))return`https:${n}`;if(n.startsWith("data/")||n.startsWith("./")||n.startsWith("../")||n.startsWith("assets/")||n.includes("://"))return n;if(n.startsWith("/"))return`${Gn}/${t}${n}`;if(n.startsWith("t/p/"))return`${Gn}/${t}/${n.slice(4)}`;if(/^w\d+\//.test(n)){let i=n.split("/").slice(1).join("/");return i?`${Gn}/${t}/${i}`:`${Gn}/${t}`}return n}function qn(e,t,n,r){for(let i of e){if(i==null)continue;let o=i.value!==void 0?i.value:i,s=Df(o,n);if(s){let a=i.source||"local";return{url:s,source:a}}}return{url:t(r),source:"fallback"}}function D(...e){for(let t of e)if(t){if(typeof t=="string"){let n=t.trim();if(n)return n}if(Ia(t)){let n=U(t.tag||t.name||t.title||t.label||t.value);if(n)return n}}return""}function xi(e){let t=U(e);if(!t)return"";let n=t.match(/(\d{4})/);if(n)return n[1];let i=new Date(t).getFullYear();return Number.isFinite(i)?String(i):""}function Li(e,t){return D(e==null?void 0:e.title,e==null?void 0:e.name,e==null?void 0:e.grandparentTitle,t==null?void 0:t.title,t==null?void 0:t.name,t==null?void 0:t.originalTitle,t==null?void 0:t.originalName,e==null?void 0:e.tag,"Unbekannter Titel")}function Of(e,t){return D(e==null?void 0:e.originalTitle,e==null?void 0:e.originalName,t==null?void 0:t.originalTitle,t==null?void 0:t.originalName,"")}function zf(e,t){return D(t==null?void 0:t.tagline,e==null?void 0:e.tagline,"")}function jf(e,t){return D(t==null?void 0:t.overview,e==null?void 0:e.summary,e==null?void 0:e.overview,e==null?void 0:e.plot,"")}function Kf(e,t){return D(e==null?void 0:e.summary,e==null?void 0:e.shortSummary,e==null?void 0:e.plot,t==null?void 0:t.overview,"")}function La(e,t,n){return n==="show"?D(e==null?void 0:e.originallyAvailableAt,e==null?void 0:e.firstAired,e==null?void 0:e.premiereDate,t==null?void 0:t.firstAirDate,t==null?void 0:t.lastAirDate,""):D(e==null?void 0:e.originallyAvailableAt,e==null?void 0:e.releaseDate,e==null?void 0:e.availableSince,t==null?void 0:t.releaseDate,"")}function Mf(e,t,n){let r=[e==null?void 0:e.year,e==null?void 0:e.releaseYear,t==null?void 0:t.year,n==="show"?t==null?void 0:t.firstAirDate:t==null?void 0:t.releaseDate,La(e,t,n)];for(let i of r){let o=xi(i);if(o)return o}return""}function Uf(e,t){var o;let n=Li(e,t),r=[{value:t==null?void 0:t.poster,source:"tmdb"},{value:t==null?void 0:t.posterPath,source:"tmdb"},{value:t==null?void 0:t.poster_path,source:"tmdb"},{value:(o=t==null?void 0:t.collection)==null?void 0:o.poster,source:"tmdb"},{value:e==null?void 0:e.tmdbPoster,source:"tmdb"},{value:e==null?void 0:e.poster,source:"local"},{value:e==null?void 0:e.thumbFile,source:"local"},{value:e==null?void 0:e.thumb,source:"local"},{value:e==null?void 0:e.art,source:"local"}];return{...qn(r,On,pe.poster,n),alt:n}}function Gf(e,t){var s;let n=Li(e,t),r=[{value:t==null?void 0:t.backdrop,source:"tmdb"},{value:t==null?void 0:t.backdropPath,source:"tmdb"},{value:t==null?void 0:t.backdrop_path,source:"tmdb"},{value:(s=t==null?void 0:t.collection)==null?void 0:s.backdrop,source:"tmdb"},{value:e==null?void 0:e.art,source:"local"},{value:e==null?void 0:e.background,source:"local"},{value:e==null?void 0:e.thumb,source:"local"}];return{...qn(r,ra,pe.backdrop,n),alt:n}}function Ca(e,t){let n=qn(t,yi,pe.profile,e||"");return{url:n.url,source:n.source}}function yt(e,t,n,r="derived"){let i=U(n);return i?{id:e,label:t,text:i,source:r}:null}function Fa(e,t){var n;return D(t==null?void 0:t.contentRating,e==null?void 0:e.contentRating,(n=e==null?void 0:e.contentRating)==null?void 0:n.tag,e==null?void 0:e.ratingTag,e==null?void 0:e.ratingName,e==null?void 0:e.ratingLabel,e==null?void 0:e.parentRating,"")}function Pa(e,t){let n=[e==null?void 0:e.seasonCount,e==null?void 0:e.childCount,ue(e==null?void 0:e.seasons).length,t==null?void 0:t.numberOfSeasons,ue(t==null?void 0:t.seasons).length];for(let r of n){let i=Number(r);if(Number.isFinite(i)&&i>0)return Math.round(i)}return null}function qf(e,t,n){let r=ve({...e,tmdbDetail:t||(e==null?void 0:e.tmdbDetail)||null,type:n==="show"?"tv":"movie"});return yt("runtime","Laufzeit",r,"derived")}function Xf(e,t){let n=Pa(e,t);return n?yt("seasonCount","Staffeln",`${n} ${n===1?"Staffel":"Staffeln"}`,t!=null&&t.numberOfSeasons?"tmdb":"derived"):null}function Vf(e,t){let n=Ue({...e,tmdbDetail:t||(e==null?void 0:e.tmdbDetail)||null}),r=e!=null&&e.rating||e!=null&&e.audienceRating?"local":"derived";return yt("rating","Bewertung",n,r)}function Ra(e){let t=Number(e==null?void 0:e.voteAverage);return!Number.isFinite(t)||t<=0?"":`${t.toFixed(1)} / 10`}function Wf(e,t){let n=Fa(e,t),r=t!=null&&t.contentRating?"tmdb":e!=null&&e.contentRating?"local":"derived";return yt("contentRating","FSK",n,r)}function Yf(e,t,n){let r=Ge({...e,tmdbDetail:t||(e==null?void 0:e.tmdbDetail)||null,type:n==="show"?"tv":"movie"});if(!U(r))return null;let i=e!=null&&e.studio||e!=null&&e.network?"local":t!=null&&t.productionCompanies||t!=null&&t.networks?"tmdb":"derived";return yt("studio",n==="show"?"Netzwerk":"Studio",r,i)}function Jf(e,t,n){let r=[],i=qf(t,n,e);if(i&&r.push(i),e==="show"){let u=Xf(t,n);u&&r.push(u)}let o=Vf(t,n);o&&r.push(o);let s=Wf(t,n);s&&r.push(s);let a=Yf(t,n,e);a&&r.push(a);let c=Ra(n),l=yt("tmdbRating","TMDB",c,"tmdb");return l&&r.push(l),r}function Qf(e,{hasCast:t,seasons:n}){var i;let r=[];if(r.push({id:"overview",label:on.overview}),r.push({id:"details",label:on.details}),e==="show"){let o=n.length,s=o?`${on.seasons} (${o})`:on.seasons;r.push({id:"seasons",label:s,count:o})}return t&&r.push({id:"cast",label:on.cast,count:t}),{tabs:r,defaultTab:((i=r[0])==null?void 0:i.id)||"overview"}}function Zf(e){return D(e==null?void 0:e.name,e==null?void 0:e.tag,e==null?void 0:e.title,e==null?void 0:e.role)}function eg(e){return D(e==null?void 0:e.role,e==null?void 0:e.character,e==null?void 0:e.job,e==null?void 0:e.subtitle)}function tg(e,t){var a,c,l;let n=[],r=new Set,i=ue(e==null?void 0:e.cast).length?ue(e==null?void 0:e.cast):ue(e==null?void 0:e.roles),o=ue(((a=t==null?void 0:t.credits)==null?void 0:a.cast)||((l=(c=e==null?void 0:e.tmdbDetail)==null?void 0:c.credits)==null?void 0:l.cast)),s=f=>{if(!f||!f.name)return;let g=`${f.name.toLowerCase()}::${f.character||f.role||""}`;r.has(g)||(r.add(g),n.push(f))};return i.forEach((f,g)=>{if(!f)return;let m=Zf(f),p=eg(f);if(!m)return;let b=Ca(m,[{value:f==null?void 0:f.tmdbProfile,source:"tmdb"},{value:f==null?void 0:f.profile,source:"tmdb"},{value:f==null?void 0:f.profile_path,source:"tmdb"},{value:f==null?void 0:f.profilePath,source:"tmdb"},{value:f==null?void 0:f.thumb,source:"local"},{value:f==null?void 0:f.photo,source:"local"},{value:f==null?void 0:f.image,source:"local"}]),S=U(D(f==null?void 0:f.id,f==null?void 0:f.guid,f==null?void 0:f.personId,m));s({id:S||m,name:m,subtitle:p||"",role:p||"",character:p||"",image:b,initials:se(m||p||""),source:"local",order:Number.isFinite(Number(f==null?void 0:f.order))?Number(f.order):g})}),o.forEach((f,g)=>{if(!f)return;let m=D(f==null?void 0:f.name,f==null?void 0:f.original_name);if(!m)return;let p=D(f==null?void 0:f.character,f==null?void 0:f.role),b=Ca(m,[{value:f==null?void 0:f.profile,source:"tmdb"},{value:f==null?void 0:f.profile_path,source:"tmdb"},{value:f==null?void 0:f.profilePath,source:"tmdb"}]),S=U((f==null?void 0:f.id)!=null?String(f.id):m);s({id:S||m,name:m,subtitle:p||U(f==null?void 0:f.known_for_department),role:p||"",character:p||"",image:b,initials:se(m||p||""),source:"tmdb",order:Number.isFinite(Number(f==null?void 0:f.order))?Number(f.order):1e3+g})}),n.sort((f,g)=>f.order-g.order).slice(0,20).map(f=>{var g;return{...f,image:(g=f.image)!=null&&g.url?f.image:{url:yi(f.name),source:"fallback"},initials:f.initials||se(f.name)}})}function ng(e,t){return D(e==null?void 0:e.title,e==null?void 0:e.name,e==null?void 0:e.label,typeof t=="number"?`Staffel ${t}`:"")}function rg(e){var i,o,s,a;let t=Number((a=(s=(o=(i=e==null?void 0:e.seasonNumber)!=null?i:e==null?void 0:e.index)!=null?o:e==null?void 0:e.season)!=null?s:e==null?void 0:e.season_index)!=null?a:e==null?void 0:e.season_number);if(Number.isFinite(t))return`season-${t}`;let n=U(D(e==null?void 0:e.id,e==null?void 0:e.guid));if(n)return`id-${n}`;let r=U(D(e==null?void 0:e.title,e==null?void 0:e.name));return r?`title-${r.toLowerCase()}`:`season-${Math.random().toString(36).slice(2)}`}function ig(e){var r,i;let t=Number((i=(r=e==null?void 0:e.episodeCount)!=null?r:e==null?void 0:e.childCount)!=null?i:e==null?void 0:e.episode_count);if(Number.isFinite(t)&&t>=0)return t;let n=ue(e==null?void 0:e.episodes);return n.length?n.length:null}function og(e,t,n){let r=[{value:t==null?void 0:t.poster,source:n},{value:t==null?void 0:t.posterPath,source:n},{value:t==null?void 0:t.poster_path,source:n},{value:t==null?void 0:t.thumbFile,source:"local"},{value:t==null?void 0:t.thumb,source:"local"},{value:t==null?void 0:t.art,source:"local"}];return qn(r,On,pe.poster,e)}function sg(e,t){var r,i;if(!t)return e;let n={...e};return U(n.title)||(n.title=t.title),U(n.overview)||(n.overview=t.overview),U(n.airDate)||(n.airDate=t.airDate),U(n.year)||(n.year=t.year),n.episodeCount==null&&t.episodeCount!=null&&(n.episodeCount=t.episodeCount),((r=n.poster)==null?void 0:r.source)==="fallback"&&((i=t.poster)!=null&&i.url)&&(n.poster=t.poster),n}function ag(e,t){let n=[],r=new Map,i=(o,s)=>{var p,b,S,E;if(!o)return;let a=rg(o),c=(E=(S=(b=(p=o==null?void 0:o.seasonNumber)!=null?p:o==null?void 0:o.index)!=null?b:o==null?void 0:o.season)!=null?S:o==null?void 0:o.season_index)!=null?E:o==null?void 0:o.season_number,l=Number.isFinite(Number(c))?Number(c):null,u=ng(o,l!=null?l:n.length+1)||(l!=null?`Staffel ${l}`:"Staffel"),d=D(o==null?void 0:o.airDate,o==null?void 0:o.premiereDate,o==null?void 0:o.originallyAvailableAt,o==null?void 0:o.air_date),h=xi(o==null?void 0:o.year)||xi(d),f=D(o==null?void 0:o.overview,o==null?void 0:o.summary,o==null?void 0:o.description),g=og(u,o,s),m={id:U(D(o==null?void 0:o.id,o==null?void 0:o.guid,`${a}`))||a,seasonNumber:l,title:u,overview:f,airDate:d||"",year:h||"",episodeCount:ig(o),poster:g,source:s};if(r.has(a)){let k=r.get(a),L=n[k];n[k]=sg(L,m)}else r.set(a,n.length),n.push(m)};return ue(e==null?void 0:e.seasons).forEach(o=>i(o,"local")),ue(t==null?void 0:t.seasons).forEach(o=>i(o,"tmdb")),n.map(o=>{var s;return{...o,poster:(s=o.poster)!=null&&s.url?o.poster:{url:On(o.title),source:"fallback"}}}).sort((o,s)=>o.seasonNumber!=null&&s.seasonNumber!=null?o.seasonNumber-s.seasonNumber:o.seasonNumber!=null?-1:s.seasonNumber!=null?1:o.title.localeCompare(s.title))}function cg(e,t){let n=[],r=new Set,i=o=>{let s=U(o);if(!s)return;let a=s.toLowerCase();r.has(a)||(r.add(a),n.push(s))};return bt(e==null?void 0:e.genres).forEach(o=>i((o==null?void 0:o.tag)||(o==null?void 0:o.name)||(o==null?void 0:o.title))),ue(e==null?void 0:e.genre).forEach(i),ue(t==null?void 0:t.genres).forEach(o=>i(typeof o=="string"?o:(o==null?void 0:o.name)||(o==null?void 0:o.title))),n}function lg(e,t,n){let r=ve({...t,tmdbDetail:n||(t==null?void 0:t.tmdbDetail)||null,type:e==="show"?"tv":"movie"})||"",i=Ue({...t,tmdbDetail:n||(t==null?void 0:t.tmdbDetail)||null})||"",o=Ra(n)||"",s=Ge({...t,tmdbDetail:n||(t==null?void 0:t.tmdbDetail)||null,type:e==="show"?"tv":"movie"})||"",a=Fa(t,n)||"",c=e==="show"?Pa(t,n):null;return{runtime:r,rating:i,tmdbRating:o,studio:s,contentRating:a,seasonCount:c}}function ug(e){return!e||typeof e!="object"?e:e.item||e.movie||e.media||e}function dg(e){return!e||typeof e!="object"?e:e.item||e.show||e.media||e}async function fg(e,t={}){var i,o;let n=t.tmdb||t.tmdbDetail;if(n)return n;if(e!=null&&e.tmdbDetail)return e.tmdbDetail;let r=D(t.tmdbId,(i=e==null?void 0:e.ids)==null?void 0:i.tmdb,e==null?void 0:e.tmdbId,(o=e==null?void 0:e.tmdb)==null?void 0:o.id);if(!r||!le||typeof le.getMovieEnriched!="function")return null;try{return await le.getMovieEnriched(r,{posterSize:pe.poster,backdropSize:pe.backdrop,profileSize:pe.profile})||null}catch{return null}}async function gg(e,t={}){var i,o;let n=t.tmdb||t.tmdbDetail;if(n)return n;if(e!=null&&e.tmdbDetail)return e.tmdbDetail;let r=D(t.tmdbId,(i=e==null?void 0:e.ids)==null?void 0:i.tmdb,e==null?void 0:e.tmdbId,(o=e==null?void 0:e.tmdb)==null?void 0:o.id);if(!r||!le||typeof le.getTvEnriched!="function")return null;try{return await le.getTvEnriched(r,{posterSize:pe.poster,backdropSize:pe.backdrop,profileSize:pe.profile})||null}catch{return null}}function hg(e){if(!e)return null;let t=_a(e);return t?(t.genres=bt(t.genres),t):null}function mg(e,t){if(!e)return null;let n=ka(e);return t&&Ti(n,t),n}function wa(e,t){!e||!t||(e.tmdbDetail=t)}function Ba(e,t,n){var E;let r=Uf(t,n),i=Gf(t,n),o=tg(t,n),s=e==="show"?ag(t,n):[],{tabs:a,defaultTab:c}=Qf(e,{hasCast:o.length,seasons:s}),l=Jf(e,t,n),u=lg(e,t,n),d=La(t,n,e)||"",h=Mf(t,n,e)||"",f=Li(t,n),g=Of(t,n),m=zf(t,n),p=jf(t,n),b=Kf(t,n),S=cg(t,n);return{kind:e,item:t,tmdb:n,title:f,originalTitle:g,overview:p,summary:b,tagline:m,releaseDate:d,year:h,genres:S,badges:l,tabs:a,defaultTab:c,poster:r,backdrop:i,cast:o,seasons:s,meta:u,watchProviders:((E=n==null?void 0:n.watchProviders)==null?void 0:E.default)||(n==null?void 0:n.watchProviders)||null,tmdbUrl:(n==null?void 0:n.url)||""}}async function Na(e,t={}){let n=ug(e),r=hg(n);if(!r)return null;let i=await fg(r,{...t,tmdb:t.tmdb||(e==null?void 0:e.tmdb)||(e==null?void 0:e.tmdbDetail)});return i&&wa(r,i),Ba("movie",r,i)}async function Ha(e,t={}){let n=dg(e),r=t.detail||(e==null?void 0:e.detail)||(e==null?void 0:e.showDetail)||null,i=mg(n,r);if(!i)return null;let o=await gg(i,{...t,tmdb:t.tmdb||(e==null?void 0:e.tmdb)||(e==null?void 0:e.tmdbDetail)});return o&&wa(i,o),r&&Ti(i,r),Ba("show",i,o)}var Gn,pe,on,$a=I(()=>{mt();Mt();Ta();zn();Gn="https://image.tmdb.org/t/p",pe={poster:"w500",backdrop:"w780",profile:"w185"},on={overview:"\xDCberblick",details:"Details",cast:"Besetzung",seasons:"Staffeln"}});var Da={};rt(Da,{DEMO_MOVIE:()=>pg,DEMO_SERIES:()=>bg});var pg,bg,Oa=I(()=>{pg={type:"movie",title:"Lumen: Der Aufbruch",tagline:"Eine cineastische Demo f\xFCr das neue Modal",overview:"Die Crew der Lumen wagt den Sprung in unerforschte Welten und enth\xFCllt dabei eine Energiequelle, die alles ver\xE4ndern k\xF6nnte. Zwischen Loyalit\xE4t, Intrigen und berauschenden Bildern entfaltet sich ein Abenteuer, das f\xFCr das Cinematic-Layout entworfen wurde.",summary:"Die Crew der Lumen entdeckt eine Energiequelle, die das Schicksal der Menschheit ver\xE4ndern k\xF6nnte.",runtimeMin:142,contentRating:"FSK 12",studio:"Aurora Pictures",rating:8.4,audienceRating:8,userRating:8.7,originallyAvailableAt:"2024-05-17",countries:[{tag:"Deutschland"},{tag:"Kanada"}],genres:[{tag:"Science-Fiction"},{tag:"Drama"},{tag:"Abenteuer"}],cast:[{name:"Mara Lenz",role:"Captain Alys Vega",tmdbProfile:"/3rxeQHiuCYaXJqfyUG8yt0YdHtH.jpg"},{name:"Tariq Benassi",role:"Navigator Elian Soh",tmdbProfile:"/wGl8DCycJ2U0FvJbLABd8R4FS3X.jpg"},{name:"Hannah Ko",role:"Wissenschaftlerin Dr. Mira Han",tmdbProfile:"/hJuDvwzS0SPlsE6MN4pF2UYDGtt.jpg"}],directors:[{tag:"Jonas Falk"}],writers:[{tag:"Lea Winter"}],producers:[{tag:"Studio Atlas"}],labels:[{tag:"Dolby Atmos"},{tag:"4K"}],collections:[{tag:"Aurora-Saga"}],trailer:"https://www.youtube.com/watch?v=dQw4w9WgXcQ",tmdbPoster:"https://image.tmdb.org/t/p/w500/2lUYbD2C3XSuwqMUbDVDQuz9mqz.jpg",ids:{tmdb:"demo-lumen",imdb:"tt0000001"},addedAt:"2024-06-01T12:00:00Z"},bg={type:"tv",title:"Aurora Station",tagline:"Neue Horizonte in Serie",overview:"Die Besatzung der Aurora Station sch\xFCtzt eine Au\xDFenposten an der Grenze des bekannten Raums. Jede Episode verbindet kosmische R\xE4tsel mit pers\xF6nlichen Geschichten \u2013 perfekt geeignet, um das Cinematic-Modal auszuprobieren.",summary:"Ein orbitaler Au\xDFenposten ringt um Hoffnung und Zusammenhalt, w\xE4hrend eine fremde Macht erwacht.",contentRating:"TV-14",studio:"Nebula Network",originallyAvailableAt:"2023-09-14",seasonCount:2,genres:[{tag:"Science-Fiction"},{tag:"Drama"}],countries:[{tag:"USA"},{tag:"Island"}],creators:[{tag:"Elina S\xF8rensen"}],cast:[{name:"Noah Adler",role:"Commander Ivar Hale",tmdbProfile:"/4MqUjb1SYrzHmFSVoKHSKP5MGGm.jpg"},{name:"Sofia Idris",role:"Ingenieurin Kaia Rhee",tmdbProfile:"/tHMgWz6EpRdbgoMJ2JfzFzjg3QB.jpg"},{name:"Helena Ruiz",role:"Strategin Tala Voss",tmdbProfile:"/ziEuG1ESSofxDCspotYlrwz3Tq.png"}],seasons:[{title:"Staffel 1",seasonNumber:1,year:2023,thumbFile:"https://image.tmdb.org/t/p/w300/4dO2YpC8S9nLmQAXoJLRV8LZRxn.jpg",episodes:[{title:"Kapitel Eins: Erwachen",seasonNumber:1,episodeNumber:1,durationMin:54,originallyAvailableAt:"2023-09-14",audienceRating:8.6},{title:"Kapitel Zwei: Grenzwelten",seasonNumber:1,episodeNumber:2,durationMin:52,originallyAvailableAt:"2023-09-21",audienceRating:8.2}]},{title:"Staffel 2",seasonNumber:2,year:2024,thumbFile:"https://image.tmdb.org/t/p/w300/bSL4hY8SgdKzac8AUbWQm74y87C.jpg",episodes:[{title:"Kapitel Dreizehn: Resonanz",seasonNumber:2,episodeNumber:1,durationMin:56,originallyAvailableAt:"2024-02-08",audienceRating:8.9},{title:"Kapitel Vierzehn: Echo",seasonNumber:2,episodeNumber:2,durationMin:55,originallyAvailableAt:"2024-02-15",audienceRating:8.7}]}],tmdbPoster:"https://image.tmdb.org/t/p/w500/a4I481szRmycyreQTLrRe4f4YJe.jpg",ids:{tmdb:"demo-aurora-station",imdb:"tt0000002"}}});function yg(e,t){let n=`tab-${t+1}`;if(e==null)return n;let r=String(e).trim();return r||n}function Sg(e,t){return e==null?t:String(e).trim()||t}function za(e){return!e||typeof e!="object"||Array.isArray(e)||!Array.isArray(e.tabs)?!1:typeof e.kind=="string"||typeof e.title=="string"}function Eg(e,t){var r,i;if(!e)return!1;let n=t==null?"":String(t).trim();return n?!!((r=e==null?void 0:e.ids)!=null&&r.imdb&&String(e.ids.imdb)===n||(i=e==null?void 0:e.ids)!=null&&i.tmdb&&String(e.ids.tmdb)===n||(e==null?void 0:e.ratingKey)!=null&&String(e.ratingKey)===n||(e==null?void 0:e.rating_key)!=null&&String(e.rating_key)===n||(e==null?void 0:e.id)!=null&&String(e.id)===n):!1}async function ja(){return Fi.promise||(Fi.promise=Promise.resolve().then(()=>(Oa(),Da)).catch(e=>({DEMO_MOVIE:null,DEMO_SERIES:null}))),Fi.promise}async function vg(){if(Array.isArray(sn))return sn;try{sn=await In()}catch{sn=[]}return sn}async function Ag(){if(Array.isArray(an))return an;try{an=await xn()}catch{an=[]}return an}function Xn(e,t){return!Array.isArray(e)||!e.length?null:e.find(n=>Eg(n,t))||null}async function _g(e){if(e==="demo"){let{DEMO_MOVIE:i}=await ja();return i?{item:i}:null}if(e&&typeof e=="object")return e.item||e.movie?{item:e.item||e.movie}:{item:e};let t=e==null?"":String(e).trim();if(!t)return null;let n=x(),r=Xn(n==null?void 0:n.movies,t);if(!r){let i=await vg();r=Xn(i,t)}return r?{item:r}:null}async function kg(e){if(e==="demo"){let{DEMO_SERIES:o}=await ja();return o?{item:o}:null}if(e&&typeof e=="object"){let o=e.item||e.show||e.media||e,s=e.detail||e.showDetail||e.tmdbDetail||null;return{item:o,detail:s||null}}let t=e==null?"":String(e).trim();if(!t)return null;let n=x(),r=Xn(n==null?void 0:n.shows,t);if(!r){let o=await Ag();r=Xn(o,t)}if(!r)return null;let i=null;try{i=await Uo(r)}catch{}return{item:r,detail:i||null}}async function Tg(e,t={}){let n=await _g(e);if(!n||!n.item)return null;try{return await Na(n,t)}catch{return null}}async function Cg(e,t={}){let n=await kg(e);if(!n||!n.item)return null;try{return await Ha({...n,detail:n.detail},t)}catch{return null}}function Ig(e){var p,b;if(typeof document=="undefined")return null;let t=document.createElement("article");t.className="v3-shell",t.dataset.modalv3Shell="1";let n=_s(e),r=(n==null?void 0:n.root)||null,i=((p=n==null?void 0:n.elements)==null?void 0:p.close)||(r==null?void 0:r.querySelector("#action-close"));i&&(i.hidden=!1,i.removeAttribute("hidden"),i.addEventListener("click",Wn)),r&&t.appendChild(r);let o=document.createElement("div");o.className="v3-shell__body";let s=document.createElement("div");s.className="v3-shell-columns";let a=document.createElement("aside");a.className="v3-shell-aside";let c=ks(e),l=(c==null?void 0:c.root)||null;l&&a.appendChild(l);let u=document.createElement("div");u.className="v3-shell-main";let d=document.createElement("div");d.className="v3-tabs",d.dataset.v3Tabs="1",d.setAttribute("role","tablist"),d.setAttribute("aria-label","Detailbereiche");let h=document.createElement("div");h.className="v3-pane-stack",u.append(d,h),s.append(a,u),o.append(s),t.appendChild(o);let f=Array.isArray(e==null?void 0:e.tabs)&&e.tabs.length?e.tabs:[{id:"overview",label:"\xDCberblick"}],g=(e==null?void 0:e.defaultTab)||((b=f[0])==null?void 0:b.id)||"overview",m=new Map;return f.forEach((S,E)=>{let k=yg(S==null?void 0:S.id,E),L=Sg(S==null?void 0:S.label,k),T=document.createElement("button");T.className="v3-tab",T.dataset.tab=k;let W=`v3-tab-${k}`,z=`v3-pane-${k}`;T.id=W,T.type="button",T.setAttribute("role","tab"),T.setAttribute("aria-controls",z);let B=k===g||!g&&E===0;T.setAttribute("aria-selected",B?"true":"false"),T.classList.toggle("active",B),T.tabIndex=B?0:-1,T.textContent=L,d.appendChild(T);let j=document.createElement("section");j.className="v3-pane",j.dataset.pane=k,j.id=z,j.setAttribute("role","tabpanel"),j.setAttribute("aria-labelledby",W),j.hidden=!B,j.setAttribute("aria-hidden",B?"false":"true");let P=document.createElement("h2");P.className="v3-pane__title",P.textContent=L;let N=document.createElement("div");N.className="v3-pane__content",j.append(P,N),h.appendChild(j),m.set(k,{tab:T,panel:j,content:N})}),m.has("overview")&&xs(m.get("overview").content,e),m.has("details")&&Ps(m.get("details").content,e),m.has("cast")&&Ks(m.get("cast").content,e),m.has("seasons")&&Sa(m.get("seasons").content,e),m.forEach((S,E)=>{if(E==="overview"||E==="details"||S.content.childElementCount>0)return;let k=document.createElement("p");k.textContent="Inhalt folgt \u2026",S.panel.classList.add("v3-pane--muted"),S.content.appendChild(k)}),{root:t,tabs:d,paneMap:m}}function Ka(){let e=ti();if(!e)return;let{overlay:t}=e;t&&!t.dataset.modalv3Click&&(t.addEventListener("click",xg),t.dataset.modalv3Click="1")}function xg(e){let t=ti();if(!t)return;let{overlay:n}=t,r=e.target;(r===n||r&&r.classList&&r.classList.contains("modalv3-backdrop"))&&Wn()}function Ma(e="Details werden geladen \u2026"){Ka();let t=ei({onRequestClose:Wn});if(!t)return null;let{root:n}=t;if(!n)return null;n.hidden=!1,n.removeAttribute("hidden");let r=document.createElement("div");return r.className="modalv3-loading",r.textContent=String(e||"Details werden geladen \u2026"),n.replaceChildren(r),ni(),n}function Lg(e){if(e==null)return[];let t=typeof Node!="undefined"?Node:null;if(t&&e instanceof t)return[e];if(Array.isArray(e)){let n=[];for(let r of e)t&&r instanceof t&&n.push(r);return n}return null}function Fg(e){let t=typeof HTMLElement!="undefined"?HTMLElement:null;if(!e)return null;if(t&&e instanceof t)return e;if(typeof e=="string"&&typeof document!="undefined")try{return document.querySelector(e)}catch{}return t&&e.root instanceof t?e.root:t&&e.content instanceof t?e.content:null}function Pg(e,t,n={}){if(!za(t))return null;let r=Fg(e);if(!r)return null;let{layout:i="modal",replace:o=!0,className:s,onRendered:a}=n||{},c=Ig(t);if(!(c!=null&&c.root))return null;if(c.root.hidden=!1,c.root.removeAttribute("hidden"),i==="standalone"&&c.root.classList.add("v3-shell--standalone"),s&&(Array.isArray(s)?s:String(s).split(/\s+/)).filter(Boolean).forEach(u=>c.root.classList.add(u)),o?r.replaceChildren(c.root):r.appendChild(c.root),ki(c.root),typeof a=="function")try{a(c)}catch{}return c}function Pi(e,t={}){let{token:n,media:r,kind:i}=t||{};if(n&&!lt(n))return null;if(i!=null||r!=null){let c=hs(),l=i!=null?i:c.kind,u=r!=null?r:c.item;gs(l,u)}Ka();let o=ei({onRequestClose:Wn});if(!o)return null;let{root:s}=o;if(!s)return null;s.hidden=!1,s.removeAttribute("hidden");let a=!1;if(za(e)&&(a=!!Pg(s,e,{replace:!0,layout:"modal"})),!a){let c=Lg(e);c?s.replaceChildren(...c):typeof e=="string"?s.innerHTML=e:e!=null?s.textContent=String(e):s.innerHTML="",s.querySelector(".v3-tabs")&&ki(s)}return ni(),s}function Vn(e,t={}){let n=Pi(String(e||"Details konnten nicht geladen werden."),t);return ii(),n}async function St(e=null,t={}){oi();let n=ri("movie",e);Ma();try{let i=await Tg(e,t);if(!lt(n))return n;if(!i)return Vn("Film konnte nicht geladen werden.",{token:n}),n;Pi(i,{token:n,kind:"movie",media:i.item})}catch{lt(n)&&Vn("Film konnte nicht geladen werden.",{token:n})}return n}async function Et(e=null,t={}){oi();let n=ri("show",e);Ma();try{let i=await Cg(e,t);if(!lt(n))return n;if(!i)return Vn("Seriendetails konnten nicht geladen werden.",{token:n}),n;Pi(i,{token:n,kind:"show",media:i.item})}catch{lt(n)&&Vn("Seriendetails konnten nicht geladen werden.",{token:n})}return n}function Wn(){fs(),us(),ms(),ii()}var sn,an,Fi,Yn=I(()=>{ds();ps();Ts();Ls();Rs();Ms();Ea();Aa();ie();Ot();$a();sn=null,an=null,Fi={promise:null}});function wg(){}function Jn(e){let t=parseFloat(e);return Number.isFinite(t)?t:0}var Ua,Rg,Qn,Ga=I(()=>{Ua=typeof requestAnimationFrame=="function"?requestAnimationFrame:e=>setTimeout(e,16),Rg=typeof cancelAnimationFrame=="function"?cancelAnimationFrame:e=>clearTimeout(e);Qn=class{constructor({container:t,renderItem:n,getKey:r=wg,updateItem:i=null,getSignature:o=null,overscan:s=2,estimatedItemHeight:a=420,minItemWidth:c=190}){if(!t)throw new Error("VirtualList requires a container element");if(typeof n!="function")throw new Error("VirtualList requires a renderItem function");this.container=t,this.renderItem=n,this.getKey=r,this.updateItem=typeof i=="function"?i:null,this.getSignature=typeof o=="function"?o:null,this.overscan=Math.max(0,s|0),this.estimatedItemHeight=a,this.minItemWidth=c,this.items=[],this.range={start:0,end:0},this.columns=1,this.rowCount=0,this.rowHeight=this.estimatedItemHeight,this.totalHeight=0,this.itemHeight=this.estimatedItemHeight,this.containerTop=0,this.paddingTop=0,this.paddingBottom=0,this.gapY=0,this.gapX=0,this.metricsDirty=!0,this.pendingFrame=0,this.lastWidth=0,this.nodeCache=new Map,this.renderedKeys=new Set,this.itemSignatures=new Map,this.scrollTicking=!1,this.spacer=document.createElement("div"),this.spacer.className="grid-virtual__spacer",this.windowEl=document.createElement("div"),this.windowEl.className="grid-virtual__window",this.itemsHost=document.createElement("div"),this.itemsHost.className="grid-virtual__items",this.container.textContent="",this.windowEl.append(this.itemsHost),this.container.append(this.spacer,this.windowEl),this.measureRoot=document.createElement("div"),this.measureRoot.className="grid-virtual__measure",this.measureRoot.setAttribute("aria-hidden","true"),Object.assign(this.measureRoot.style,{position:"absolute",visibility:"hidden",pointerEvents:"none",inset:"0 auto auto 0",zIndex:"-1"}),this.container.append(this.measureRoot),this.handleScroll=this.handleScroll.bind(this),this.handleResize=this.handleResize.bind(this),this.update=this.update.bind(this),window.addEventListener("scroll",this.handleScroll,{passive:!0}),window.addEventListener("resize",this.handleResize),typeof ResizeObserver=="function"?(this.resizeObserver=new ResizeObserver(this.handleResize),this.resizeObserver.observe(this.container)):this.resizeObserver=null}destroy(){window.removeEventListener("scroll",this.handleScroll),window.removeEventListener("resize",this.handleResize),this.resizeObserver&&this.resizeObserver.disconnect(),this.pendingFrame&&(Rg(this.pendingFrame),this.pendingFrame=0),this.nodeCache.clear(),this.renderedKeys.clear(),this.itemSignatures.clear(),this.items=[],this.spacer.remove(),this.windowEl.remove(),this.measureRoot.remove()}schedule(t=!1){t&&(this.metricsDirty=!0),!this.pendingFrame&&(this.pendingFrame=Ua(()=>{this.pendingFrame=0,this.update()}))}handleScroll(){this.scrollTicking||(this.scrollTicking=!0,this.schedule(!1),Ua(()=>{this.scrollTicking=!1}))}handleResize(){let t=this.container.clientWidth;t!==this.lastWidth&&(this.metricsDirty=!0,this.lastWidth=t),this.schedule(!0)}setItems(t){this.items=Array.isArray(t)?t.slice():[],this.metricsDirty=!0,this.pruneCache(),this.measureItems(),this.update()}measureItems(){if(!this.items.length){this.itemHeight=this.estimatedItemHeight;return}let t=this.items[0];this.measureRoot.textContent="";let n=this.renderItem(t,0);if(n instanceof HTMLElement)if(this.measureRoot.append(n),typeof n.getBoundingClientRect=="function"){let r=n.getBoundingClientRect();r&&r.height>0&&(this.itemHeight=r.height)}else n.offsetHeight&&(this.itemHeight=n.offsetHeight);this.measureRoot.textContent=""}pruneCache(){if(!this.items.length){this.nodeCache.forEach(r=>r.remove()),this.nodeCache.clear(),this.itemSignatures.clear(),this.renderedKeys.clear();return}let t=new Set,n=this.getSignature?new Map:null;this.items.forEach((r,i)=>{let o=this.keyFor(r,i);if(t.add(o),n){let s=this.signatureFor(r,i);n.set(o,s);let a=this.itemSignatures.get(o);if(a!==void 0&&a!==s){let c=this.nodeCache.get(o);c&&(c.parentNode&&c.parentNode.removeChild(c),this.nodeCache.delete(o),this.renderedKeys.delete(o))}}}),this.nodeCache.forEach((r,i)=>{t.has(i)||(r.parentNode&&r.parentNode.removeChild(r),this.nodeCache.delete(i),this.renderedKeys.delete(i))}),n?this.itemSignatures=n:this.itemSignatures.clear()}keyFor(t,n){let r=this.getKey?this.getKey(t,n):null;return r==null||r===""?`index-${n}`:String(r)}signatureFor(t,n){if(this.getSignature)try{return this.getSignature(t,n)}catch{return}}refreshMetrics(){let t=getComputedStyle(this.container);this.paddingTop=Jn(t.paddingTop),this.paddingBottom=Jn(t.paddingBottom);let n=getComputedStyle(this.itemsHost),r=n.getPropertyValue?n.getPropertyValue("row-gap"):n.rowGap,i=n.getPropertyValue?n.getPropertyValue("column-gap"):n.columnGap,o=n.getPropertyValue?n.getPropertyValue("gap"):n.gap;this.gapY=Jn(r||o),this.gapX=Jn(i||o);let s=Math.floor((this.container.clientWidth+this.gapX)/(this.minItemWidth+this.gapX));this.columns=Math.max(1,s||1),this.rowHeight=this.itemHeight+this.gapY,this.rowHeight<=0&&(this.rowHeight=this.itemHeight||this.estimatedItemHeight),this.rowCount=this.columns>0?Math.ceil(this.items.length/this.columns):this.items.length,this.totalHeight=Math.max(0,this.rowCount*this.rowHeight),this.updateContainerPosition(),this.spacer.style.height=`${this.totalHeight}px`,this.windowEl.style.top=`${this.paddingTop}px`,this.windowEl.style.paddingBottom=`${this.paddingBottom}px`,this.metricsDirty=!1}updateContainerPosition(){let t=this.container,n=0;for(;t&&t!==document.body;)n+=t.offsetTop,t=t.offsetParent;this.containerTop=n}update(){this.metricsDirty&&this.refreshMetrics(),this.syncVisibleRange()}syncVisibleRange(){if(!this.items.length){this.windowEl.style.transform="translate3d(0, 0, 0)",this.itemsHost.replaceChildren(),this.range={start:0,end:0};return}let t=window.scrollY,n=t+window.innerHeight,r=this.containerTop+this.paddingTop,i=r+this.totalHeight;window.__VLIST_DEBUG;let o;t<=r?o=0:t>=i?o=Math.max(0,this.rowCount-1):o=Math.floor((t-r)/this.rowHeight);let s;n>=i?s=Math.max(0,this.rowCount-1):n<=r?s=0:s=Math.ceil((n-r)/this.rowHeight),o=Math.max(0,Math.min(o,Math.max(0,this.rowCount-1))-this.overscan),s=Math.min(Math.max(0,this.rowCount-1),s+this.overscan);let a=Math.max(0,Math.min(this.items.length,o*this.columns)),c=Math.max(a,Math.min(this.items.length,(s+1)*this.columns));if(a===this.range.start&&c===this.range.end){let m=!1;for(let p=a;p<c;p++){let b=this.keyFor(this.items[p],p);if(!this.renderedKeys.has(b)){m=!0;break}}if(!m)return}this.range={start:a,end:c};let u=Math.floor(a/this.columns)*this.rowHeight;this.windowEl.style.transform=`translate3d(0, ${u}px, 0)`;let d=new Set,h=[];for(let m=a;m<c;m++){let p=this.items[m],b=this.keyFor(p,m),S=this.nodeCache.get(b);if(S){if(this.updateItem){let E=this.updateItem(S,p,m);if(E instanceof HTMLElement&&E!==S)S=E,this.nodeCache.set(b,S);else if(!(E instanceof HTMLElement))continue}}else{if(S=this.renderItem(p,m),!(S instanceof HTMLElement))continue;this.nodeCache.set(b,S)}d.add(b),h.push(S)}let f=this.itemsHost.children;if(f.length===h.length){let m=!0;for(let p=0;p<h.length;p++)if(f[p]!==h[p]){m=!1;break}if(m){this.renderedKeys=d;return}}let g=new Map;for(let m=0;m<f.length;m++)g.set(f[m],m);for(let m=0;m<h.length;m++){let p=h[m],b=f[m];b!==p&&(g.has(p)?this.itemsHost.insertBefore(p,b||null):this.itemsHost.insertBefore(p,b||null))}for(;this.itemsHost.children.length>h.length;)this.itemsHost.lastChild.remove();this.renderedKeys=d}}});var nc={};rt(nc,{renderGrid:()=>te});function Bg(e){let t=w("article","card");t.dataset.kind=(e==null?void 0:e.type)==="tv"?"show":"movie",t.tabIndex=0,t.setAttribute("role","button"),e!=null&&e.title&&t.setAttribute("aria-label",e.title);let n=w("div","card__media"),r=new Image;r.loading="lazy",r.decoding="async",r.className="card__img",r.alt=(e==null?void 0:e.title)||"",r.style.aspectRatio="2 / 3";let i=er(e);i&&(r.src=i);let o=w("div","card__media-gradient");o.setAttribute("aria-hidden","true");let s=Mg(e),a=w("div","card__badges");s.forEach(b=>{b instanceof HTMLElement&&a.append(b)}),n.append(r,o),a.childElementCount&&n.append(a);let c=tc(e);if(c>0){let b=w("div","card__progress"),S=document.createElement("span");S.style.width=`${Math.max(0,Math.min(100,c))}%`,b.append(S),n.append(b)}let l=w("div","card__body"),u=document.createElement("h3");u.className="card__title",u.textContent=(e==null?void 0:e.title)||"",e!=null&&e.title&&u.setAttribute("title",e.title);let d=w("div","card__meta"),h=Za(e);d.textContent=h.join(" \u2022 "),l.append(u,d);let f=w("div","card__actions"),g=w("div","card__chips"),m=Se(e==null?void 0:e.genres);Fn(g,m,3);let p=document.createElement("button");return p.type="button",p.className="card__primary",Xa(p,e),p.addEventListener("click",b=>{b.stopPropagation(),Yr(e),Xa(p,e)}),f.append(g,p),t.append(n,l,f),t.addEventListener("click",()=>Va(e)),t.addEventListener("keydown",b=>{b.target===t&&(b.key==="Enter"||b.key===" ")&&(b.preventDefault(),Va(e))}),t}function Ng(e,t){let n=(t||[]).slice().sort((d,h)=>{let f=Number(q(d))||0,g=Number(q(h))||0;return f!==g?f-g:(d.title||"").localeCompare(h.title||"","de")}),r=n.map(d=>Number(q(d))||0).filter(Boolean),i=r.length?Math.min(...r):"",o=n.map(d=>new Date(d.addedAt||0).getTime()).filter(Number.isFinite),s=o.length?new Date(Math.max(...o)).toISOString():null,a=n.map(d=>{var h;return Number((h=d.rating)!=null?h:d.audienceRating)}).filter(Number.isFinite),c=a.length?a.reduce((d,h)=>d+h,0)/a.length:null,l=n.find(d=>d.thumbFile)||n[0]||null,u=Array.from(new Set(n.flatMap(d=>Se(d.genres)))).slice(0,4);return{isCollectionGroup:!0,type:"collection",title:e,collectionName:e,items:n,itemCount:n.length,year:i||"",addedAt:s,rating:c,posterItem:l,genres:u}}function Hg(e){let t=document.getElementById("groupCollections"),n=document.getElementById("collectionFilter"),r=n&&n.value;if(!t||!t.checked||r)return e;let i=new Map;e.forEach(s=>{je(s).forEach(a=>{i.has(a)||i.set(a,[]),i.get(a).push(s)})});let o=[];return i.forEach((s,a)=>{o.push(Ng(a,s))}),o.sort((s,a)=>s.title.localeCompare(a.title,"de")),o}function $g(e){let t=w("article","card card--collection");t.dataset.kind="collection",t.tabIndex=0,t.setAttribute("role","button"),e!=null&&e.title&&t.setAttribute("aria-label",e.title);let n=w("div","card__media"),r=e.posterItem||{},i=new Image;i.loading="lazy",i.decoding="async",i.className="card__img",i.alt=(e==null?void 0:e.title)||"",i.style.aspectRatio="2 / 3";let o=er(r);o&&(i.src=o);let s=w("div","card__media-gradient");s.setAttribute("aria-hidden","true");let a=Ug(e),c=w("div","card__badges");a.forEach(m=>{m instanceof HTMLElement&&c.append(m)}),n.append(i,s),c.childElementCount&&n.append(c);let l=w("div","card__body"),u=document.createElement("h3");u.className="card__title",u.textContent=e.title||"",e!=null&&e.title&&u.setAttribute("title",e.title);let d=w("div","card__meta"),h=ec(e);d.textContent=h.filter(Boolean).join(" \u2022 "),l.append(u,d);let f=w("div","card__actions"),g=w("div","card__chips");return Fn(g,e.genres||[],3),f.append(g),t.append(n,l,f),t.addEventListener("click",()=>{let m=document.getElementById("collectionFilter");m&&(m.value=e.collectionName||e.title||"",m.dispatchEvent(new Event("change",{bubbles:!0})))}),t.addEventListener("keydown",m=>{if(m.target===t&&(m.key==="Enter"||m.key===" ")){m.preventDefault();let p=document.getElementById("collectionFilter");p&&(p.value=e.collectionName||e.title||"",p.dispatchEvent(new Event("change",{bubbles:!0})))}}),t}function Dg(e){return Zn||(Zn=new Qn({container:e,overscan:1,estimatedItemHeight:460,minItemWidth:190,getKey:Og,getSignature:Bi,renderItem(t){return Wa(t)},updateItem(t,n){return zg(t,n)}}),Zn)}function Og(e,t){if(e!=null&&e.isCollectionGroup){let r=e.collectionName||e.title||"";return r?`collection:${r}`:`collection-index-${t}`}let n=wi(e);return n?`item:${n}`:`item-index-${t}`}function Wa(e){let t=e!=null&&e.isCollectionGroup?$g(e):Bg(e);return t instanceof HTMLElement&&(t[Ri]=Bi(e)),t}function zg(e,t){if(e instanceof HTMLElement){let r=Bi(t);if(e[Ri]===r)return e[Ri]=r,e}let n=Wa(t);return n instanceof HTMLElement?Vg(e,n):e}function te(e){let{movies:t,shows:n,filtered:r}=x(),i=(e==="shows"?n:t)||[],o=Array.isArray(r)?r:i,s=Hg(o),a=document.getElementById("grid");if(!a)return;let c=qa!==e;qa=e,c&&jg(a),Dg(a).setItems(s),c&&Kg(a);let u=document.getElementById("empty");u&&(u.hidden=s.length>0),a.setAttribute("aria-busy","false")}function jg(e){e&&(e.classList.remove("is-entering","is-ready"),e.classList.add("is-leaving"))}function Kg(e){e&&(e.classList.remove("is-leaving"),e.classList.add("is-entering"),requestAnimationFrame(()=>{e.classList.add("is-ready"),setTimeout(()=>e.classList.remove("is-entering","is-ready"),240)}))}function er(e){var r;if(!e)return"";let t=Pn()&&(((r=e==null?void 0:e.tmdb)==null?void 0:r.poster)||(e==null?void 0:e.tmdbPoster)),n=(e==null?void 0:e.thumbFile)||(e==null?void 0:e.poster)||(e==null?void 0:e.art)||(e==null?void 0:e.thumb)||"";return t||n||""}function Ya(e){var i;let t=[];zt(e)&&t.push("Neu");let n=String((e==null?void 0:e.contentRating)||"").trim();n&&t.push(n);let r=Number((i=e==null?void 0:e.rating)!=null?i:e==null?void 0:e.audienceRating);return Number.isFinite(r)&&t.push(`\u2605 ${Z(r)}`),t.slice(0,3)}function Mg(e){return Ya(e).map(Qa)}function Ja(e){let t=[];return Number.isFinite(e==null?void 0:e.itemCount)&&e.itemCount>0&&t.push(`${e.itemCount} Titel`),e!=null&&e.year&&t.push(String(e.year)),t}function Ug(e){return Ja(e).map(Qa)}function Qa(e){let t=document.createElement("span");return t.className="badge",t.textContent=String(e||""),t}function Xa(e,t){if(!e)return;let n=Wr(t);e.textContent=n?"Gemerkt":"Merken",e.classList.toggle("active",n),e.setAttribute("aria-pressed",n?"true":"false")}function Za(e){var s;let t=[],n=q(e);n&&t.push(String(n));let r=Gg(e);r&&t.push(r);let i=Number((s=e==null?void 0:e.rating)!=null?s:e==null?void 0:e.audienceRating);Number.isFinite(i)&&t.push(`\u2605 ${Z(i)}`);let o=(e==null?void 0:e.studio)||(e==null?void 0:e.network)||"";return o&&t.push(o),t}function ec(e){let t=[];e!=null&&e.year&&t.push(String(e.year));let n=Number(e==null?void 0:e.itemCount);Number.isFinite(n)&&t.push(`${n} Titel`);let r=Number(e==null?void 0:e.rating);return Number.isFinite(r)&&t.push(`\u2605 ${Z(r)}`),t}function Gg(e){var r,i;let t=(i=(r=e==null?void 0:e.runtimeMin)!=null?r:e==null?void 0:e.durationMin)!=null?i:e!=null&&e.duration?Math.round(Number(e.duration)/6e4):null,n=Number(t);return!Number.isFinite(n)||n<=0?"":(e==null?void 0:e.type)==="tv"?`~${n} min/Ep`:`${n} min`}function tc(e){var r;let t=Number((r=e==null?void 0:e.viewOffset)!=null?r:e==null?void 0:e.viewoffset),n=Number(e==null?void 0:e.duration);return!Number.isFinite(t)||!Number.isFinite(n)||n<=0?0:Math.max(1,Math.min(100,Math.round(t/n*100)))}function wi(e){var n,r;if(!e)return"";let t=((n=e==null?void 0:e.ids)==null?void 0:n.imdb)||((r=e==null?void 0:e.ids)==null?void 0:r.tmdb);return t?String(t):e!=null&&e.ratingKey?String(e.ratingKey):""}function Bi(e){return e!=null&&e.isCollectionGroup?Xg(e):qg(e)}function qg(e){let t=Se(e==null?void 0:e.genres).slice(0,3),n=Ya(e),r=Za(e);return JSON.stringify({id:wi(e),title:(e==null?void 0:e.title)||"",poster:er(e),badges:n,meta:r,progress:tc(e),watch:Wr(e),genres:t})}function Xg(e){let t=(e==null?void 0:e.posterItem)||null,n=Array.isArray(e==null?void 0:e.genres)?e.genres.slice(0,3).map(String):[],r=Ja(e),i=ec(e),o=Number(e==null?void 0:e.itemCount),s=Number(e==null?void 0:e.rating);return JSON.stringify({name:(e==null?void 0:e.collectionName)||(e==null?void 0:e.title)||"",title:(e==null?void 0:e.title)||"",itemCount:Number.isFinite(o)?o:null,year:(e==null?void 0:e.year)||"",rating:Number.isFinite(s)?s:null,poster:er(t),badges:r,meta:i,genres:n})}function Vg(e,t){if(!(t instanceof HTMLElement))return e;if(!(e instanceof HTMLElement))return t;let n=e.parentNode,r=document.activeElement===e;return n&&n.replaceChild(t,e),r&&typeof t.focus=="function"&&requestAnimationFrame(()=>{try{t.focus({preventScroll:!0})}catch{t.focus()}}),t}function Wg(e,t){if(!e||!t)return;let n=`#/${e}/${t}`,r=(window.location.hash||"")===n;nr(n,{silent:!0,replace:r})}function Va(e){if(!e)return;let t=(e==null?void 0:e.type)==="tv"?"show":"movie",n=wi(e);n&&Wg(t,n),t==="show"?Et(e):St(e)}var Ri,Zn,qa,tr=I(()=>{ie();Sn();Ee();Qr();Yn();rc();Ga();Ri="__gridVirtualSignature";Zn=null;qa=null});var Ki={};rt(Ki,{applyFilters:()=>vt,computeFacets:()=>Di,initFilters:()=>ji,renderFacets:()=>Oi,setFiltersUpdatedHandler:()=>zi,updateFiltersAndGrid:()=>cn});function ic(e){return String(e||"").toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")}function Yg(e,t){let n=ic(t.query||""),r=!!t.onlyNew,i=Number(t.yearFrom)||null,o=Number(t.yearTo)||null,s=t.genres||new Set,a=t.collection||"";if(n&&!ic([e.title,e.originalTitle,e.summary,e.studio,Se(e.genres).join(" "),(e.roles||[]).map(u=>u&&(u.tag||u.role||u.name)).join(" "),je(e).join(" ")].filter(Boolean).join(" ")).includes(n)||r&&!zt(e))return!1;let c=Number(q(e))||null;if(i&&(!c||c<i)||o&&(!c||c>o))return!1;if(s.size){let l=new Set(Se(e.genres));for(let u of s)if(!l.has(u))return!1}return!(a&&!new Set(je(e)).has(a))}function Jg(e,t){let n=e.slice();switch(t){case"year-desc":n.sort((r,i)=>(Number(q(i))||0)-(Number(q(r))||0)||String(r.title||"").localeCompare(String(i.title||""),"de"));break;case"year-asc":n.sort((r,i)=>(Number(q(r))||0)-(Number(q(i))||0)||String(r.title||"").localeCompare(String(i.title||""),"de"));break;case"title-desc":n.sort((r,i)=>String(i.title||"").localeCompare(String(r.title||""),"de"));break;case"added-desc":n.sort((r,i)=>new Date(i.addedAt||0)-new Date(r.addedAt||0));break;case"title-asc":default:n.sort((r,i)=>String(r.title||"").localeCompare(String(i.title||""),"de"))}return n}function Di(e,t){let n=new Set,r=new Set,i=new Set,o=a=>(a||[]).forEach(c=>{Se(c.genres).forEach(u=>n.add(u));let l=c.year||(c.originallyAvailableAt?String(c.originallyAvailableAt).slice(0,4):"");l&&r.add(Number(l)),je(c).forEach(u=>i.add(u))});o(e),o(t);let s=[...r].sort((a,c)=>a-c);return{genres:[...n].sort(),years:s,collections:[...i].sort((a,c)=>a.localeCompare(c,"de"))}}function Oi(e){let t=K("#yearFrom"),n=K("#yearTo");t&&t.replaceChildren(new Option("Ab Jahr",""),...e.years.map(o=>new Option(String(o),String(o)))),n&&n.replaceChildren(new Option("Bis Jahr",""),...e.years.map(o=>new Option(String(o),String(o))));let r=K("#collectionFilter");r&&r.replaceChildren(new Option("Alle Collections",""),...e.collections.map(o=>new Option(o,o)));let i=K("#genreFilters");if(i){let o=e.genres.map(s=>{let a=document.createElement("button");return a.type="button",a.className="chip",a.textContent=s,a.dataset.name=s,a});i.replaceChildren(...o),$i()}}function Qg(){var c,l,u,d,h;let e=document.getElementById("search")||document.getElementById("q"),t=((e==null?void 0:e.value)||"").trim(),n=((c=K("#onlyNew"))==null?void 0:c.checked)||!1,r=((l=K("#yearFrom"))==null?void 0:l.value)||"",i=((u=K("#yearTo"))==null?void 0:u.value)||"",o=((d=K("#collectionFilter"))==null?void 0:d.value)||"",s=((h=K("#sort"))==null?void 0:h.value)||"title-asc",a=new Set;return document.querySelectorAll("#genreFilters .chip.active").forEach(f=>a.add(f.dataset.name)),{query:t,onlyNew:n,yearFrom:r,yearTo:i,collection:o,genres:a,sort:s}}function vt(){let e=x(),n=e.view==="shows"?e.shows:e.movies,r=Qg(),i=(n||[]).filter(s=>Yg(s,r)),o=Jg(i,r.sort);return $e({filtered:o}),o}function Zg(){Ni||(Ni=Promise.resolve().then(()=>(tr(),nc))),Ni.then(e=>{let t=e&&e.renderGrid;typeof t=="function"&&t(x().view)}).catch(console.error)}function zi(e){Hi=typeof e=="function"?e:null}function cn(){let e=vt();if(Zg(),Hi)try{let t=Array.isArray(e)?e.slice():[];Hi(t,x().view)}catch{}return e}function $i(){let e=document.getElementById("genreFilters");if(!e)return;let t=e.querySelectorAll(".chip.active").length;e.dataset.state=t>0?"active":"empty",e.dataset.count=String(t)}function ji(){let e=K("#sort");e&&e.options.length===0&&[["title-asc","Titel A\u2013Z"],["title-desc","Titel Z\u2013A"],["year-desc","Jahr \u2193"],["year-asc","Jahr \u2191"],["added-desc","Zuletzt hinzugef\xFCgt"]].forEach(([i,o])=>e.add(new Option(o,i)));let t=(i,o="input")=>{let s=K(i);s&&(s.addEventListener(o,()=>{cn()}),o==="input"&&s instanceof HTMLInputElement&&s.type==="search"&&s.addEventListener("search",()=>{cn()}))};t("#search"),t("#q"),t("#onlyNew","change"),t("#yearFrom","change"),t("#yearTo","change"),t("#collectionFilter","change"),t("#sort","change"),t("#groupCollections","change");let n=K("#yearReset");n&&n.addEventListener("click",()=>{let i=K("#yearFrom"),o=K("#yearTo");i&&(i.value=""),o&&(o.value=""),cn()});let r=K("#genreFilters");r&&(r.addEventListener("click",i=>{let o=i.target;o instanceof HTMLElement&&o.classList.contains("chip")&&(o.classList.toggle("active"),$i(),cn())}),$i())}var Ni,Hi,Mi=I(()=>{ie();Sn();Ee();Ni=null;Hi=null});var At={};rt(At,{clearCache:()=>nh,hydrateOptional:()=>ir,validateToken:()=>ah});function ae(...e){try{}catch{}}function cc(e={}){let t=e.lang||e.language||"de-DE",n=e.region||e.iso||"DE",r=Number(e.ttlHours||e.tmdbTtlHours||24)||24,i=e.imageBase||e.tmdbImageBase;return{language:t,region:n,ttlHours:r,imageBase:i}}function eh(e,t){let{language:n,region:r,ttlHours:i,imageBase:o}=cc(e),s=t!=null&&t.kind?`${t.kind}:${t.value||""}`:"none";return JSON.stringify({language:n,region:r,ttlHours:i,imageBase:o,auth:s})}function rr(e={},t){let n=eh(e,t);if(we&&sc===n)return we;let{language:r,region:i,ttlHours:o,imageBase:s}=cc(e),a={cacheStore:Gs,language:r,region:i,ttlHours:o};return s&&(a.imageBase=s),(t==null?void 0:t.kind)==="bearer"&&t.value?a.token=t.value:(t==null?void 0:t.kind)==="apikey"&&t.value&&(a.apiKey=t.value),we=jn(a),sc=n,we}function th(e){var s,a;let t=(e==null?void 0:e.type)==="tv"?"tv":"movie",n=((s=e==null?void 0:e.ids)==null?void 0:s.imdb)||"",r=((a=e==null?void 0:e.ids)==null?void 0:a.tmdb)||"",i=((e==null?void 0:e.title)||(e==null?void 0:e.name)||"").toLowerCase(),o=String((e==null?void 0:e.year)||"").slice(0,4);return[t,n,r,i,o].filter(Boolean).join("|")}function nh(){var e;try{localStorage.removeItem("tmdbCache")}catch(t){ae("Failed to clear legacy TMDB cache from storage:",t)}We.clear();try{hi("tmdb:")}catch(t){ae("Failed to clear metadata cache store:",t)}if(we)try{(e=we.clear)==null||e.call(we,"tmdb:")}catch(t){ae("Failed to clear metadata service cache:",t)}}function rh(e){try{let t=localStorage.getItem("tmdbToken");if(t&&t.trim())return{kind:"bearer",value:t.trim()}}catch(t){ae("Failed to read TMDB token from storage:",t)}if(e!=null&&e.tmdbToken){let t=String(e.tmdbToken).trim();if(t)return{kind:"bearer",value:t}}if(e!=null&&e.tmdbApiKey){let t=String(e.tmdbApiKey).trim();if(t)return{kind:"apikey",value:t}}return{kind:"none",value:""}}async function ih(e,t,n,r){var i,o,s,a,c,l;if(!t)return null;try{let h=await rr(n,r).client.get(`/find/${encodeURIComponent(t)}`,{external_source:"imdb_id"});return e==="movie"?(s=(o=(i=h==null?void 0:h.movie_results)==null?void 0:i[0])==null?void 0:o.id)!=null?s:null:(l=(c=(a=h==null?void 0:h.tv_results)==null?void 0:a[0])==null?void 0:c.id)!=null?l:null}catch(u){return ae(`Failed to resolve external id ${t}:`,u),null}}async function oh(e,t,n,r,i){var s;let o=String(t||"").trim();if(!o)return null;try{let c=rr(r,i).client,l={query:o,include_adult:!1};n&&(e==="movie"?l.year=n:l.first_air_date_year=n);let u=await c.get(`/search/${e}`,l),d=Array.isArray(u==null?void 0:u.results)?u.results[0]:null;return(s=d==null?void 0:d.id)!=null?s:null}catch(a){return ae(`Search failed for ${e} ${t}:`,a),null}}async function sh(e,t,n){var a,c;let r=(e==null?void 0:e.type)==="tv"?"tv":"movie",i=th(e);if(We.has(i))return We.get(i);let o=rr(t,n),s=(a=e==null?void 0:e.ids)==null?void 0:a.tmdb;if(!s&&((c=e==null?void 0:e.ids)!=null&&c.imdb)&&(s=await ih(r,e.ids.imdb,t,n)),!s){let l=e!=null&&e.year?Number(String(e.year).slice(0,4)):void 0;s=await oh(r,(e==null?void 0:e.title)||(e==null?void 0:e.name),l,t,n)}if(!s)return We.set(i,null),null;try{let l=r==="tv"?await o.getTvEnriched(s):await o.getMovieEnriched(s);if(!l)return We.set(i,null),null;let u={id:l.id||String(s),poster:l.poster||"",backdrop:l.backdrop||"",url:l.url||`https://www.themoviedb.org/${r}/${s}`};return We.set(i,u),u}catch(l){return ae(`Hydration failed for ${r} ${s}:`,l),We.set(i,null),null}}async function ir(e,t,n={}){try{let r=rh(n);if(!r.value)return;rr(n,r);let i=[...e||[],...t||[]],o=40,s=0,a=async()=>{let c=i.slice(s,s+4);s+=4,await Promise.all(c.map(async u=>{let d=await sh(u,n,r);d&&(u.tmdb={id:d.id,poster:d.poster,backdrop:d.backdrop,url:d.url},u.ids=u.ids||{},!u.ids.tmdb&&d.id&&(u.ids.tmdb=String(d.id)))}));try{window.dispatchEvent(new CustomEvent("tmdb:chunk",{detail:{updated:c.length,index:s}}))}catch(u){ae("Failed to dispatch tmdb:chunk event:",u)}if(s<Math.min(i.length,o))window.requestIdleCallback?window.requestIdleCallback(a,{timeout:500}):setTimeout(a,250);else try{window.dispatchEvent(new CustomEvent("tmdb:done",{detail:{total:Math.min(i.length,o)}}))}catch(u){ae("Failed to dispatch tmdb:done event:",u)}};a()}catch(r){ae("hydrateOptional failed to start:",r)}}function ac(e,t){if(!t||t.kind==="none")return{url:e,init:{}};if(t.kind==="bearer")return{url:e,init:{headers:{Authorization:`Bearer ${t.value}`,Accept:"application/json"}}};let n=e.includes("?")?"&":"?";return{url:`${e}${n}api_key=${encodeURIComponent(t.value)}`,init:{headers:{Accept:"application/json"}}}}async function ah(e){let t=String(e||"").trim();if(!t)throw new Error("empty");let n=/^[a-f0-9]{32}$/i.test(t),r=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+$/.test(t),i=o=>{try{let s=o.split(".")[1],c=atob((l=>l+"=".repeat((4-l.length%4)%4))(s.replace(/-/g,"+").replace(/_/g,"/")));return JSON.parse(c)}catch(s){return ae("Failed to decode TMDB JWT payload:",s),null}};if(n){let{url:o,init:s}=ac(`${oc}/configuration`,{kind:"apikey",value:t});return(await fetch(o,s)).ok?{ok:!0,as:"apikey",hint:"v3Key"}:{ok:!1,as:"apikey",hint:"looksV3"}}if(r){let o=i(t);if(o&&typeof o=="object"){let c=String(o.iss||"");if(c&&!/themoviedb\.org/i.test(c))return{ok:!1,as:"bearer",hint:"issMismatch"}}let{url:s,init:a}=ac(`${oc}/trending/movie/day`,{kind:"bearer",value:t});try{if((await fetch(s,a)).ok)return{ok:!0,as:"bearer",hint:null}}catch(c){ae("Bearer token validation request failed:",c)}return{ok:!0,as:"bearer",hint:"structOnly"}}return{ok:!1,as:"bearer",hint:null}}var oc,We,we,sc,Ye=I(()=>{$n();mt();oc="https://api.themoviedb.org/3",We=new Map,we=null,sc=""});async function fc(){_t=[];let e=null,t=null;try{let n=await fetch(ch,{cache:"no-cache"});if(!n.ok)throw new Error(`HTTP ${n.status}`);e=await dh(n)}catch(n){t=n,Je(`Failed to load policy (${(n==null?void 0:n.message)||"unknown error"})`),Q("Hero-Policy konnte nicht geladen werden",(n==null?void 0:n.message)||"Unbekannter Fehler")}return ne=lh(e),dc=Date.now(),fh(t),ne}function kt(){return Ui(ne)}function gc(){return{movies:ne.poolSizeMovies,series:ne.poolSizeSeries}}function hc(){let e={};return uc.forEach(t=>{e[t]={quota:ne.slots[t].quota}}),e}function mc(){return{...ne.diversity}}function pc(){return{...ne.rotation}}function bc(){return{...ne.textClamp}}function yc(){return{...ne.fallback}}function Sc(){return ne.language}function ln(){let e=Number(ne.cache.ttlHours),t=Number(ne.cache.graceMinutes);return{ttlHours:e,ttlMs:e*60*60*1e3,graceMinutes:t,graceMs:t*60*1e3}}function sr(){return _t.slice()}function Ec(){return dc}function lh(e){let t=Ui(lc);if(!e||typeof e!="object")return Je("Policy payload missing or invalid, using defaults."),t;t.poolSizeMovies=Ae(e.poolSizeMovies,t.poolSizeMovies,"poolSizeMovies"),t.poolSizeSeries=Ae(e.poolSizeSeries,t.poolSizeSeries,"poolSizeSeries");let n=e.slots&&typeof e.slots=="object"?e.slots:{};uc.forEach(u=>{let d=n[u],h=or(d==null?void 0:d.quota,0,1,t.slots[u].quota,`slots.${u}.quota`);t.slots[u]={quota:h}});let r=e.diversity&&typeof e.diversity=="object"?e.diversity:{};t.diversity={genre:or(r.genre,0,1,t.diversity.genre,"diversity.genre"),year:or(r.year,0,1,t.diversity.year,"diversity.year"),antiRepeat:or(r.antiRepeat,0,1,t.diversity.antiRepeat,"diversity.antiRepeat")};let i=e.rotation&&typeof e.rotation=="object"?e.rotation:{};t.rotation={intervalMinutes:Ae(i.intervalMinutes,t.rotation.intervalMinutes,"rotation.intervalMinutes"),minPoolSize:Ae(i.minPoolSize,t.rotation.minPoolSize,"rotation.minPoolSize")};let o=e.textClamp&&typeof e.textClamp=="object"?e.textClamp:{};t.textClamp={title:Ae(o.title,t.textClamp.title,"textClamp.title"),subtitle:Ae(o.subtitle,t.textClamp.subtitle,"textClamp.subtitle"),summary:Ae(o.summary,t.textClamp.summary,"textClamp.summary")};let s=e.fallback&&typeof e.fallback=="object"?e.fallback:{};t.fallback={prefer:uh(s.prefer,t.fallback.prefer),allowDuplicates:typeof s.allowDuplicates=="boolean"?s.allowDuplicates:t.fallback.allowDuplicates},t.language=typeof e.language=="string"&&e.language.trim()?e.language.trim():t.language,t.language!==(e.language||"").trim()&&Je("language missing or invalid, defaulted to en-US.");let a=e.cache&&typeof e.cache=="object"?e.cache:{},c=Ae(a.ttlHours,t.cache.ttlHours,"cache.ttlHours"),l=Ae(a.graceMinutes,t.cache.graceMinutes,"cache.graceMinutes",!0);return t.cache={ttlHours:c,graceMinutes:l},t}function Ae(e,t,n,r){let i=Number(e);return Number.isFinite(i)&&(r?i>=0:i>0)?Math.floor(i):(e!=null&&Je(`${n} invalid (${e}), using default (${t}).`),t)}function or(e,t,n,r,i){let o=Number(e);return Number.isFinite(o)&&o>=t&&o<=n?o:(e!=null&&Je(`${i} invalid (${e}), using default (${r}).`),r)}function uh(e,t){return e==="movies"||e==="series"||e==="shows"?e==="shows"?"series":e:(e!=null&&Je(`fallback.prefer invalid (${e}), using default (${t}).`),t)}function Ui(e){return JSON.parse(JSON.stringify(e))}async function dh(e){try{return await e.json()}catch(t){return Je(`Failed to parse hero policy JSON (${(t==null?void 0:t.message)||t}).`),null}}function Je(e){e&&_t.push(e)}function fh(e){if(_t.length){if(e){let t=_t.slice(1);t.length&&Q("Hero-Policy Hinweise",t.join(" \u2022 "));return}Q("Hero-Policy Hinweise",_t.join(" \u2022 "))}}var ch,lc,uc,ne,dc,_t,ar=I(()=>{kn();ch="hero.policy.json",lc=Object.freeze({poolSizeMovies:10,poolSizeSeries:10,slots:{new:{quota:.3},topRated:{quota:.3},oldButGold:{quota:.2},random:{quota:.2}},diversity:{genre:.4,year:.35,antiRepeat:.25},rotation:{intervalMinutes:360,minPoolSize:6},textClamp:{title:96,subtitle:240,summary:220},fallback:{prefer:"movies",allowDuplicates:!1},language:"en-US",cache:{ttlHours:24,graceMinutes:15}}),uc=["new","topRated","oldButGold","random"],ne=Ui(lc),dc=0,_t=[]});function re(...e){try{}catch{}}function ce(){return Date.now()}function lr(e){return new Promise(t=>setTimeout(t,Math.max(0,e||0)))}function mh(e,t){if(e===t)return!0;if(!e||!t)return!1;let n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(let i of n)if(e[i]!==t[i])return!1;return!0}function dr(){var e;return{active:!!O.active,until:Number(O.until)||0,retryAfterMs:Number(O.retryAfterMs)||0,lastStatus:(e=O.lastStatus)!=null?e:null,lastHitAt:Number(O.lastHitAt)||0,strikes:Number(O.strikes)||0}}function ph(){let e=dr();for(let t of Xi)try{t(e)}catch(n){re("Rate limit listener failed:",(n==null?void 0:n.message)||n)}}function ur(e){let t={...dr(),...e};return mh(O,t)||(O=t,ph()),O}function kc(e){return Math.min(8e3,400*Math.pow(2,Math.max(0,e)))}function bh(e,t){let n=1200*Math.pow(2,Math.max(0,e-1)),r=Math.max(t||0,n);return Math.min(6e4,r)}function yh(e,t=429){let n=ce(),r=Math.min(5,(O.strikes||0)+1),i=bh(r,e);return Tt=Math.max(Tt,n+i),ur({active:!0,strikes:r,retryAfterMs:i,until:n+i,lastStatus:t,lastHitAt:n}),i}function Sh(){if(!O.strikes)return;let e=Math.max(0,O.strikes-1);ur({strikes:e,active:O.active&&O.until>ce()})}function Fc(){let e=ce();O.active&&e>=O.until?ur({active:!1,retryAfterMs:0,until:0}):!O.active&&O.strikes>0&&e-O.lastHitAt>9e4&&ur({strikes:Math.max(0,O.strikes-1)}),Tt&&e>=Tt&&(Tt=0)}function Eh(e,t,n){let r=e==="tv"?"tv":"movie",i=String(n||"en-US").trim()||"en-US";return`${r}:${String(t||"").trim()}:${i}`}function Pc(){if(Ac||(Ac=!0,typeof localStorage=="undefined"))return;let e;try{if(e=localStorage.getItem(Lc),!e)return}catch(r){re("Failed to read TMDB cache from storage:",(r==null?void 0:r.message)||r);return}let t;try{t=JSON.parse(e)}catch(r){re("Stored TMDB cache invalid JSON:",(r==null?void 0:r.message)||r);return}if(!Array.isArray(t))return;let n=ce();t.forEach(([r,i])=>{var s,a,c,l;if(!r||!i)return;let o=Number((a=(s=i.ts)!=null?s:i.timestamp)!=null?a:i.fetchedAt);Number.isFinite(o)&&(n-o>864e5||de.set(String(r),{ts:o,data:(l=(c=i.data)!=null?c:i.payload)!=null?l:null}))})}function vh(){let e=ce(),t=!1;for(let[n,r]of de.entries()){if(!r||typeof r!="object"){de.delete(n),t=!0;continue}let i=Number(r.ts);(!Number.isFinite(i)||e-i>864e5)&&(de.delete(n),t=!0)}t&&Wi()}function Tc(e){Pc();let t=de.get(e);if(!t)return null;let n=Number(t.ts);return!Number.isFinite(n)||ce()-n>864e5?(de.delete(e),Wi(),null):t}function Ah(e,t){Pc(),de.set(e,{ts:ce(),data:t}),_h(),Wi()}function _h(){if(de.size<=60)return;let e=Array.from(de.entries());e.sort((n,r)=>{var s,a;let i=Number(((s=n[1])==null?void 0:s.ts)||0);return Number(((a=r[1])==null?void 0:a.ts)||0)-i});let t=e.slice(0,60);de=new Map(t)}function Wi(){typeof localStorage!="undefined"&&(Gi||(Gi=setTimeout(()=>{Gi=null,kh()},120)))}function kh(){if(typeof localStorage=="undefined")return;let e=Array.from(de.entries()).map(([t,n])=>{var r,i;return[t,{ts:(r=n==null?void 0:n.ts)!=null?r:ce(),data:(i=n==null?void 0:n.data)!=null?i:null}]});try{localStorage.setItem(Lc,JSON.stringify(e))}catch(t){re("Failed to persist TMDB cache:",(t==null?void 0:t.message)||t)}}function Th(e){if(!e)return 0;let t=Number(e);if(Number.isFinite(t))return Math.max(0,t*1e3);let n=Date.parse(e);return Number.isFinite(n)?Math.max(0,n-ce()):0}function Ch(e){return e===429||e>=500&&e<600}function Ih(e){return e&&(e.name==="AbortError"||e.code==="ABORT_ERR")}function xh(e){return Ih(e)?!1:!!(e&&typeof e=="object"&&(e.name==="TypeError"&&/network/i.test(e.message||"")||/network/i.test((e==null?void 0:e.message)||"")))}function Lh(e,t){if(!t||!t.value)return{url:e,init:{headers:{Accept:"application/json"}}};if(t.kind==="apikey"){let n=e.includes("?")?"&":"?";return{url:`${e}${n}api_key=${encodeURIComponent(t.value)}`,init:{headers:{Accept:"application/json"}}}}return{url:e,init:{headers:{Accept:"application/json",Authorization:`Bearer ${t.value}`}}}}async function Fh(){Fc();let e=ce(),t=Math.max(0,_c+400-e),n=Math.max(0,Tt-e),r=Math.max(t,n);r>0&&await lr(r),_c=ce()}async function Ct(e,t,{signal:n}={},r=0){let{url:i,init:o}=Lh(e,t),s={...o,signal:n};await Fh();let a;try{a=await fetch(i,s)}catch(c){if(r<4&&xh(c)){let l=kc(r);return await lr(l),Ct(e,t,{signal:n},r+1)}throw c}if(!a.ok){let c=a.status,l=Ch(c)&&r<4;if(c===429){let h=Th(a.headers.get("retry-after")),f=yh(h,c);if(l)return await lr(f),Ct(e,t,{signal:n},r+1)}else if(l){let h=kc(r);return await lr(h),Ct(e,t,{signal:n},r+1)}let u=await a.text().catch(()=>""),d=new Error(`HTTP ${c}${u?`: ${u}`:""}`);throw d.status=c,c===429&&(d.code="RATE_LIMIT"),d}return Sh(),Fc(),a.json()}function _e(e,t){if(!e&&e!==0)return null;let n=String(e||"").trim();return n?{kind:t||(/^[a-f0-9]{32}$/i.test(n)?"apikey":"bearer"),value:n}:null}function Ph(){if(typeof localStorage=="undefined")return"";try{return localStorage.getItem("tmdbToken")||""}catch(e){return re("Failed to read tmdbToken from storage:",(e==null?void 0:e.message)||e),""}}function Rh(e){if(!e)return{};let t=e.trim();if(!t)return{};if(t.startsWith("{")||t.startsWith("["))try{let r=JSON.parse(t);if(r&&typeof r=="object")return r}catch(r){re("Failed to parse config.cfg JSON:",(r==null?void 0:r.message)||r)}let n={};return t.split(/\r?\n/).forEach(r=>{let i=r.trim();if(!i||i.startsWith("#")||i.startsWith(";"))return;let o=i.indexOf("=");if(o===-1)return;let s=i.slice(0,o).trim(),a=i.slice(o+1).trim();s&&(n[s]=a)}),n}async function wh(){return cr||(cr=(async()=>{if(typeof fetch!="function")return{};try{let e=await fetch("config.cfg",{cache:"no-cache"});if(!e.ok)return e.status!==404&&re(`Failed to load config.cfg (HTTP ${e.status})`),{};let t=await e.text();return qi=Rh(t),qi}catch(e){return re("Error loading config.cfg:",(e==null?void 0:e.message)||e),{}}})(),cr)}function Bh(e){if(!e||typeof e!="object")return null;if(e.tmdbToken){let t=_e(e.tmdbToken,"bearer");if(t)return{...t,source:"settings.tmdbToken"}}if(e.tmdbApiKey){let t=_e(e.tmdbApiKey,"apikey");if(t)return{...t,source:"settings.tmdbApiKey"}}return null}function Nh(){let e=_e(Ph(),"bearer");return e?{...e,source:"localStorage.tmdbToken"}:null}function Hh(e){if(!e||typeof e!="object")return null;if(e.tmdbToken){let t=_e(e.tmdbToken,"bearer");if(t)return{...t,source:"config.cfg.tmdbToken"}}if(e.tmdbApiKey){let t=_e(e.tmdbApiKey,"apikey");if(t)return{...t,source:"config.cfg.tmdbApiKey"}}return null}async function Rc(e={},t={}){if(t.credentials){if(typeof t.credentials=="string"||typeof t.credentials=="number"){let s=_e(t.credentials);if(s)return{...s,source:"explicit"}}else if(t.credentials&&typeof t.credentials=="object"&&t.credentials.value){let s=_e(t.credentials.value,t.credentials.kind);if(s)return{...s,source:t.credentials.source||"explicit"}}}let n=Bh(e);if(n)return n;let r=Nh();if(r)return r;if(e&&e.tmdbApiKey){let s=_e(e.tmdbApiKey,"apikey");if(s)return{...s,source:"settings.tmdbApiKey"}}let i=await wh().catch(()=>qi||{}),o=Hh(i);if(o)return o;if(t.fallbackCredential){let s=_e(t.fallbackCredential);if(s)return{...s,source:"fallback"}}return null}function wc(){return dr()}function Bc(e){if(typeof e!="function")return()=>{};Xi.add(e);try{e(dr())}catch(t){re("Rate limit listener threw during init:",(t==null?void 0:t.message)||t)}return()=>Xi.delete(e)}function Nc(e,t="original"){let r=(typeof e=="string"?e:"").trim();if(!r)return"";let i=r.startsWith("/")?r:`/${r}`,o=String(t||"original").trim()||"original";return`${gh}${o}${i}`}function It(e){return e==null?"":String(e).trim()}async function Yi(e,t,n={}){let r=e==="tv"?"tv":"movie",i=It(t);if(!i)return null;let o=It(n.language)||"en-US",s=Eh(r,i,o);if(!n.forceRefresh){let d=Tc(s);if(d)return{id:i,type:r,language:o,data:d.data,fetchedAt:d.ts,source:"cache"}}let a=n.auth||await Rc(n.settings,n.authOptions||{});if(!a)return re("TMDB credentials missing; cannot fetch details."),null;let c=`${Vi}/${r}/${encodeURIComponent(i)}?language=${encodeURIComponent(o)}&append_to_response=${hh}`,l;try{l=await Ct(c,a,{signal:n.signal})}catch(d){throw re(`Failed to fetch TMDB ${r}#${i}:`,(d==null?void 0:d.message)||d),d}Ah(s,l);let u=Tc(s);return{id:i,type:r,language:o,data:l,fetchedAt:(u==null?void 0:u.ts)||ce(),source:"network"}}function $h(e){if(!e||typeof e!="object")return"";let t=[e.title,e.name,e.originalTitle,e.original_name,e.original_title];for(let n of t){let r=typeof n=="string"?n.trim():"";if(r)return r}return""}function Cc(e){if(e==null)return null;let t=Number(e);if(Number.isFinite(t)&&t>1800)return Math.trunc(t);if(typeof e=="string"){let n=e.match(/(19|20|21)\d{2}/);if(n)return Number(n[0])}return null}function Dh(e){var i;if(!e||typeof e!="object")return null;let t=Cc((i=e.year)!=null?i:e.startYear);if(t)return t;let n=e.originallyAvailableAt||e.premieredAt||e.releaseDate||e.firstAirDate,r=Cc(n);return r||null}async function Oh(e,t,n){let r=n.language||"en-US",i=`${Vi}/find/${encodeURIComponent(t)}?external_source=imdb_id&language=${encodeURIComponent(r)}`,o=await Ct(i,n.auth,{signal:n.signal}),s=e==="tv"?"tv_results":"movie_results",c=(Array.isArray(o==null?void 0:o[s])?o[s]:[]).find(d=>d&&d.id!=null);if(!c||c.id==null)return null;let l=String(c.id),u=await Yi(e,l,n);return u&&(u.id=l,u.resolvedId=l),u}function zh(e,t,n,r){let i=encodeURIComponent(t),o=encodeURIComponent(n||"en-US"),s=`${Vi}/search/${e}?query=${i}&language=${o}`;return r?`${s}&${e==="tv"?"first_air_date_year":"year"}=${encodeURIComponent(String(r))}`:s}async function jh(e,t,n,r){if(!t)return null;let i=r.language||"en-US",o=zh(e,t,i,n),s=await Ct(o,r.auth,{signal:r.signal}),a=Array.isArray(s==null?void 0:s.results)?s.results:[];if(!a.length)return null;let c=a.find(d=>d&&d.id!=null)||a[0];if(!c||c.id==null)return null;let l=String(c.id),u=await Yi(e,l,r);return u&&(u.id=l,u.resolvedId=l),u}function Kh(e){let t={tmdb:"",imdb:""};if(!e||typeof e!="object")return t;let n=r=>{let i=typeof r=="string"?r:r==null?void 0:r.id;if(!i)return;let o=String(i).trim();if(!o)return;let[s,a]=o.split("://");if(!a){o.startsWith("tt")&&(t.imdb=o);return}let c=s.toLowerCase(),u=a.split("?")[0].replace(/^\//,"").split("/").pop();if(c==="imdb"||c.includes("imdb")){t.imdb=u||t.imdb;return}if(c==="tmdb"||c.includes("themoviedb")){t.tmdb=u||t.tmdb;return}};return e.ids&&typeof e.ids=="object"&&(e.ids.tmdb&&(t.tmdb=It(e.ids.tmdb)),e.ids.imdb&&(t.imdb=It(e.ids.imdb))),n(e.guid),Array.isArray(e.guids)&&e.guids.forEach(n),t}function Mh(e,t){let n=It(t==null?void 0:t.searchTitle);return n||$h(e)}async function Hc(e,t={}){var l;if(!e||typeof e!="object")return null;let n=e.type==="tv"?"tv":"movie",r=It(t.language)||"en-US",i=t.auth||await Rc(t.settings,t.authOptions||{});if(!i)return re("Skipping TMDB lookup (missing credentials)."),null;let o={...t,auth:i,language:r},s=Kh(e),a=[];s.tmdb&&a.push({label:"direct id",fn:()=>Yi(n,s.tmdb,o)}),s.imdb&&a.push({label:"imdb find",fn:()=>Oh(n,s.imdb,o)});let c=Mh(e,t);if(c){let u=(l=t.searchYear)!=null?l:Dh(e);a.push({label:"search",fn:()=>jh(n,c,u,o)})}for(let u of a)try{let d=await u.fn();if(d)return!d.resolvedId&&d.id&&(d.resolvedId=d.id),d}catch(d){re(`TMDB ${u.label} lookup failed:`,(d==null?void 0:d.message)||d)}return null}var Vi,gh,hh,Lc,de,Ac,Gi,_c,cr,qi,Tt,O,Xi,Ic,xc,Ji=I(()=>{Vi="https://api.themoviedb.org/3",gh="https://image.tmdb.org/t/p/",hh="images,release_dates,content_ratings,credits",Lc="hero.tmdbCache.v1",de=new Map,Ac=!1,Gi=null,_c=0,cr=null,qi={},Tt=0,O={active:!1,until:0,retryAfterMs:0,lastStatus:null,lastHitAt:0,strikes:0},Xi=new Set;(xc=(Ic=setInterval(()=>{try{vh()}catch{}},864e5/6)).unref)==null||xc.call(Ic)});function $c(...e){try{}catch{}}function fr(e){return typeof e!="string"?"":e.trim()}function G(e){let t=fr(e);return t||""}function Qi(e){if(e==null)return null;if(typeof e=="number"&&Number.isFinite(e)&&e>1800&&e<9999)return Math.trunc(e);if(typeof e=="string"){let t=e.match(/(19|20|21)\d{2}/);if(t)return Number(t[0])}return null}function Zi(e){if(!e)return null;try{let t=new Date(e);if(Number.isNaN(t.getTime()))return null;let n=t.getUTCFullYear();return n>1800&&n<9999?n:null}catch{return null}}function Dc(e){let t=Number(e);return!Number.isFinite(t)||t<=0?null:Math.round(t*10)/10}function xt(e){if(e==null)return null;let t=Number(e);return Number.isFinite(t)&&t>0?t>1e3?Math.max(1,Math.round(t/6e4)):Math.round(t):null}function qh(e,t){let n=[];if(t&&Array.isArray(t.genres)){for(let s of t.genres)if(s&&typeof s=="object"&&s.name){let a=fr(s.name);a&&n.push(a)}}let r=e==null?void 0:e.genres;Array.isArray(r)&&r.forEach(s=>{if(!s)return;if(typeof s=="string"){let c=fr(s);c&&n.push(c);return}let a=fr(s.tag||s.title||s.label||s.name);a&&n.push(a)});let i=new Set,o=[];for(let s of n){let a=s.toLowerCase();i.has(a)||(i.add(a),o.push(s))}return o.slice(0,2)}function Xh(e){let t={},n=(r,i)=>{if(i==null)return;let o=typeof i=="string"?i:String(i),s=G(o);s&&(t[r]=s)};if(e&&typeof e=="object"){e.ratingKey!=null&&n("ratingKey",e.ratingKey),e.ids&&typeof e.ids=="object"&&(n("tmdb",e.ids.tmdb),n("imdb",e.ids.imdb));let r=i=>{let o=typeof i=="string"?i:i==null?void 0:i.id,s=G(o);if(!s)return;let[a,c]=s.split("://");if(c){let l=a.toLowerCase(),d=c.split("?")[0].replace(/^\//,"").split("/").pop();if(l==="imdb"||l.includes("imdb")){n("imdb",d);return}if(l==="tmdb"||l.includes("themoviedb")){n("tmdb",d);return}if(l==="tvdb"||l.includes("thetvdb")){n("tvdb",d);return}}else s.startsWith("tt")&&n("imdb",s)};r(e.guid),Array.isArray(e.guids)&&e.guids.forEach(r)}return t}function Vh(e,t,n){if(t)if(n==="tv"){let r=[t.name,t.original_name];for(let i of r){let o=G(i);if(o)return o}}else{let r=[t.title,t.original_title];for(let i of r){let o=G(i);if(o)return o}}if(e){let r=[e.title,e.name,e.originalTitle];for(let i of r){let o=G(i);if(o)return o}}return""}function Wh(e,t){let n=[t==null?void 0:t.tagline,e==null?void 0:e.tagline];for(let r of n){let i=G(r);if(i)return i}return""}function Yh(e,t){let n=[t==null?void 0:t.overview,e==null?void 0:e.summary,e==null?void 0:e.plot,e==null?void 0:e.description];for(let r of n){let i=G(r);if(i)return i}return""}function Jh(e,t,n){var i,o,s;if(t){let a=n==="tv"?t.first_air_date:t.release_date,c=(i=Qi(a))!=null?i:Zi(a);if(c)return c;let l=n==="tv"?t.last_air_date:t.release_date,u=(o=Qi(l))!=null?o:Zi(l);if(u)return u}let r=(s=Qi(e==null?void 0:e.year))!=null?s:Zi(e==null?void 0:e.originallyAvailableAt);return r||null}function Qh(e,t,n){var r,i,o;if(t){if(n==="tv"&&Array.isArray(t.episode_run_time)&&t.episode_run_time.length){let s=xt(t.episode_run_time.find(a=>xt(a)));if(s)return s}if(n==="movie"){let s=xt(t.runtime);if(s)return s}}if(n==="movie"){let s=xt((r=e==null?void 0:e.durationMin)!=null?r:e==null?void 0:e.duration);if(s)return s}else if(n==="tv"){if(Array.isArray(e==null?void 0:e.seasons)){for(let a of e.seasons)if(Array.isArray(a==null?void 0:a.episodes))for(let c of a.episodes){let l=xt((i=c==null?void 0:c.durationMin)!=null?i:c==null?void 0:c.duration);if(l)return l}}let s=xt((o=e==null?void 0:e.durationMin)!=null?o:e==null?void 0:e.duration);if(s)return s}return null}function Zh(e,t){var i;let n=Dc(t==null?void 0:t.vote_average);if(n)return n;let r=Dc((i=e==null?void 0:e.rating)!=null?i:e==null?void 0:e.audienceRating);return r||null}function em(e){let t=Number(e==null?void 0:e.vote_count);return Number.isFinite(t)&&t>0?Math.round(t):null}function tm(e,t,n){var i,o,s;if(n==="movie"&&((i=t==null?void 0:t.release_dates)!=null&&i.results)){let c=(Array.isArray(t.release_dates.results)?t.release_dates.results:[]).find(d=>d&&d.iso_3166_1==="US"),u=(Array.isArray(c==null?void 0:c.release_dates)?c.release_dates:[]).filter(d=>G(d==null?void 0:d.certification)).sort((d,h)=>{var m,p;let f=Number((m=d==null?void 0:d.type)!=null?m:0),g=Number((p=h==null?void 0:h.type)!=null?p:0);return f-g});if(u.length){let d=G(((o=u.find(h=>h.type===3))==null?void 0:o.certification)||u[0].certification);if(d)return d}}if(n==="tv"&&Array.isArray((s=t==null?void 0:t.content_ratings)==null?void 0:s.results)){let a=t.content_ratings.results.find(l=>l&&l.iso_3166_1==="US"),c=G(a==null?void 0:a.rating);if(c)return c}let r=G(e==null?void 0:e.contentRating);if(r){let a=r.split("/").pop(),c=G(a);if(c)return c}return""}function nm(e,t){var i;let n=[],r=Array.isArray((i=e==null?void 0:e.images)==null?void 0:i.backdrops)?e.images.backdrops:[];for(let o of r){if(!o||!o.file_path||o.width&&o.width<Uh)continue;let s=Nc(o.file_path,Gh);s&&(n.includes(s)||n.push(s))}if(n.length===0&&t){let o=t.art||t.thumb||t.thumbFile||t.backdrop;if(o&&typeof o=="string"){let s=o.trim();s&&!n.includes(s)&&n.push(s)}}return n}function rm(e,t){let n={seasons:null,episodes:null};if(Number.isFinite(t==null?void 0:t.number_of_seasons)&&(n.seasons=Math.max(0,Math.round(t.number_of_seasons))),Number.isFinite(t==null?void 0:t.number_of_episodes)&&(n.episodes=Math.max(0,Math.round(t.number_of_episodes))),n.seasons==null&&Array.isArray(e==null?void 0:e.seasons)&&(n.seasons=e.seasons.length),n.episodes==null&&Array.isArray(e==null?void 0:e.seasons)){let r=0;e.seasons.forEach(i=>{Array.isArray(i==null?void 0:i.episodes)&&(r+=i.episodes.length)}),r>0&&(n.episodes=r)}return n}function im(e,t){if(!t||typeof t!="object")return null;let n=t.tmdb||t.imdb||t.ratingKey,r=G(n);if(!r)return null;let i=e==="tv"?"show":"movie";return{id:r,kind:i,label:i==="show"?"Show details":"Movie details",target:`#/${i}/${r}`}}function om(e){let t={};return Object.entries(e||{}).forEach(([n,r])=>{let i=G(r);i&&(t[n]=i)}),t}function sm(e,t){return e.ratingKey?e.ratingKey:e.tmdb?`${t}-${e.tmdb}`:e.imdb?`${t}-${e.imdb}`:""}async function Oc(e,t={}){var E,k;if(!e||typeof e!="object")return null;let n=e.type==="tv"?"tv":"movie",r=G(t.language)||"en-US",i=Xh(e),o=null;if(t.disableTmdb!==!0)try{o=await Hc(e,{language:r,settings:t.settings,auth:t.auth,authOptions:t.authOptions,signal:t.signal,searchTitle:t.searchTitle,searchYear:t.searchYear})}catch(L){$c("TMDB lookup failed:",(L==null?void 0:L.message)||L)}let s=o==null?void 0:o.data;o!=null&&o.resolvedId&&(i.tmdb||(i.tmdb=String(o.resolvedId))),s!=null&&s.id&&!i.tmdb&&(i.tmdb=String(s.id)),s!=null&&s.imdb_id&&!i.imdb&&(i.imdb=String(s.imdb_id).trim()),i=om(i);let a=Vh(e,s,n);if(!a)return $c("Skipping item without title",(e==null?void 0:e.ratingKey)||(e==null?void 0:e.title)||(e==null?void 0:e.guid)||"unknown"),null;let c={id:sm(i,n)||String((k=(E=e.ratingKey)!=null?E:e.guid)!=null?k:a),type:n,title:a},l=Wh(e,s);l&&(c.tagline=l);let u=Yh(e,s);u&&(c.overview=u);let d=Jh(e,s,n);d&&(c.year=d);let h=Qh(e,s,n);h&&(c.runtime=h);let f=Zh(e,s);f!=null&&(c.rating=f);let g=em(s);g!=null&&(c.voteCount=g);let m=qh(e,s);m.length&&(c.genres=m);let p=tm(e,s,n);p&&(c.certification=p);let b=nm(s,e);if(b.length&&(c.backdrops=b),n==="tv"){let L=rm(e,s);L.seasons!=null&&(c.seasons=L.seasons),L.episodes!=null&&(c.episodes=L.episodes)}let S=im(n,i);if(S&&(c.cta=S),Object.keys(i).length&&(c.ids=i),c.language=r,o){let L={id:i.tmdb||(o.id?String(o.id):""),fetchedAt:o.fetchedAt||Date.now(),source:o.source};L.id||delete L.id,L.source||delete L.source,t.includeTmdbRaw&&s&&(L.raw=s),Object.keys(L).length&&(c.tmdb=L)}return t.includeSource&&(c.source=e),c}var Uh,Gh,zc=I(()=>{Ji();Uh=1920,Gh="original"});function Be(){return Date.now()}function jc(e){try{if(typeof globalThis!="undefined"&&globalThis[e])return globalThis[e]}catch{}return null}function dm(e,t){if(!e)return null;try{return e.getItem(t)}catch{return null}}function V(e,t,n){if(e)try{n==null?e.removeItem(t):e.setItem(t,n)}catch{}}function fm(e){if(!e)return null;try{return JSON.parse(e)}catch{return null}}function gr(e){try{return JSON.stringify(e)}catch{return null}}function dn(e){return e==="shows"||e==="show"||e==="series"?"series":"movies"}function hr(e){return`${am}${dn(e)}`}function eo(e){return`${hr(e)}${Lt}`}function Kc(e){return`${cm}${dn(e)}`}function to(e){return`${lm}${dn(e)}`}function no(e){return`${um}${dn(e)}`}function un(e,t){let n=dm(e,t);if(!n)return null;let r=fm(n);return!r||typeof r!="object"?null:r}function Mc(e){let{local:t}=fe(),n=to(e),r=un(t,n);return Array.isArray(r)?r.map(i=>{var o,s,a;return{id:typeof(i==null?void 0:i.id)=="string"?i.id:String((i==null?void 0:i.id)||""),ts:Number((a=(s=(o=i==null?void 0:i.ts)!=null?o:i==null?void 0:i.timestamp)!=null?s:i==null?void 0:i.time)!=null?a:0),slot:typeof(i==null?void 0:i.slot)=="string"?i.slot:(i==null?void 0:i.slot)!=null?String(i.slot):void 0}}).filter(i=>i.id&&Number.isFinite(i.ts)):[]}function gm(e,t){let n=Array.isArray(t)?t.map(a=>({id:a.id,ts:a.ts,slot:a.slot})):[],r=gr(n);if(r==null)return;let{local:i,session:o}=fe(),s=to(e);V(i,s,r),V(o,`${s}${Lt}`,r)}function ro(e){let{local:t}=fe(),n=no(e),r=un(t,n);return Array.isArray(r)?r.map(i=>{var o,s,a;return{id:typeof(i==null?void 0:i.id)=="string"?i.id:String((i==null?void 0:i.id)||""),ts:Number((a=(s=(o=i==null?void 0:i.ts)!=null?o:i==null?void 0:i.timestamp)!=null?s:i==null?void 0:i.time)!=null?a:0),reason:typeof(i==null?void 0:i.reason)=="string"?i.reason:"",hits:Number(i==null?void 0:i.hits)||0}}).filter(i=>i.id&&Number.isFinite(i.ts)):[]}function Uc(e,t){let n=Array.isArray(t)?t.map(a=>({id:a.id,ts:a.ts,reason:a.reason||"",hits:Number(a.hits)||0})):[],r=gr(n);if(r==null)return;let{local:i,session:o}=fe(),s=no(e);V(i,s,r),V(o,`${s}${Lt}`,r)}function fe(){return{local:jc("localStorage"),session:jc("sessionStorage")}}function Gc(e){if(!e||typeof e!="object")return null;let t={kind:dn(e.kind||e.library||e.type),items:Array.isArray(e.items)?e.items.slice():[],updatedAt:Number(e.updatedAt)||Be(),expiresAt:Number(e.expiresAt)||0,policyHash:typeof e.policyHash=="string"?e.policyHash:"",slotSummary:e.slotSummary&&typeof e.slotSummary=="object"?{...e.slotSummary}:{},meta:e.meta&&typeof e.meta=="object"?{...e.meta}:void 0};return e.generatedAt&&!t.updatedAt&&(t.updatedAt=Number(e.generatedAt)||t.updatedAt),t}function Ft(e,{now:t=Be(),policyHash:n=null,allowExpired:r=!1}={}){let{local:i,session:o}=fe(),s=hr(e),a=eo(e),c=un(o,a),l=un(i,s),u=c||l||null;if(!u)return null;let d=Gc(u);if(!d)return null;let f=(Number(d.expiresAt)||0)>t,g=n?d.policyHash===n:!0;return!r&&!f||n&&!g?null:(d.isExpired=!f,d.matchesPolicy=g,d.source=c?"session":"local",d)}function qc(e,t){let{local:n,session:r}=fe();if(!t||typeof t!="object"){Xc(e);return}let i=Gc({...t,kind:e});if(!i)return;let o=hr(e),s=eo(e),a=gr(i);a!=null&&(V(n,o,a),V(r,s,a))}function Xc(e){let{local:t,session:n}=fe(),r=hr(e),i=eo(e);V(t,r,null),V(n,i,null)}function Vc(e){let{local:t}=fe(),n=Kc(e),r=un(t,n);return Array.isArray(r)?r.map(i=>{var o,s,a;return{id:typeof(i==null?void 0:i.id)=="string"?i.id:String((i==null?void 0:i.id)||""),ts:Number((a=(s=(o=i==null?void 0:i.ts)!=null?o:i==null?void 0:i.timestamp)!=null?s:i==null?void 0:i.time)!=null?a:i==null?void 0:i.at)}}).filter(i=>i.id&&Number.isFinite(i.ts)):[]}function hm(e,t){let{local:n,session:r}=fe(),i=Kc(e),o=Array.isArray(t)?t.map(a=>({id:a.id,ts:a.ts})):[],s=gr(o);s!=null&&(V(n,i,s),V(r,`${i}${Lt}`,s))}function mr(e){if(!e)return null;if(typeof e=="string")return e.trim()||null;if(typeof e=="number")return`#${e}`;if(e&&typeof e=="object"){if(e.poolId!=null)return String(e.poolId);if(e.poolEntryId!=null)return String(e.poolEntryId);if(e.heroId!=null)return String(e.heroId);if(e.cta&&e.cta.id!=null)return String(e.cta.id);if(e.ids&&typeof e.ids=="object"){if(e.ids.imdb)return`imdb:${e.ids.imdb}`;if(e.ids.tmdb)return`tmdb:${e.ids.tmdb}`;if(e.ids.tvdb)return`tvdb:${e.ids.tvdb}`}if(e.guid)return String(e.guid);if(e.ratingKey!=null)return`rk:${e.ratingKey}`;if(e.id!=null)return String(e.id);if(e.slug)return String(e.slug);if(e.key)return String(e.key);if(e.title){let t=e.year?`:${e.year}`:"";return`title:${e.title}${t}`}}return null}function mm(e){return mr(e)}function Wc(e,t,{timestamp:n=Be(),limit:r=80}={}){let i=mm(t);if(!i)return null;let s=Vc(e).filter(c=>c.id!==i);s.unshift({id:i,ts:n});let a=s.filter(c=>n-c.ts<=12096e5).slice(0,Math.max(1,r));return hm(e,a),a}function io(e,{now:t=Be(),windowMs:n=12096e5,limit:r=80}={}){let i=Vc(e);if(!i.length)return{entries:[],set:new Set};let o=t-Math.max(0,n),s=new Set,a=[];for(let c of i)if(!(!c||!c.id)&&!(c.ts<o)&&!s.has(c.id)&&(s.add(c.id),a.push({id:c.id,ts:c.ts}),a.length>=r))break;return{entries:a,set:s}}function Yc(e,t,{timestamp:n=Be(),ttlMs:r=0,limit:i=120}={}){if(!Array.isArray(t)||!t.length)return[];let o=r>0?Math.max(0,n-r):0,s=Mc(e),a=new Set,c=[];for(let p of s)!p||!p.id||o&&p.ts<o||a.has(p.id)||(a.add(p.id),c.push(p));let l=[],u=new Set;for(let p of t){let b=mr(p);if(!b)continue;let S=typeof(p==null?void 0:p.slot)=="string"?p.slot:p!=null&&p.poolSlot?String(p.poolSlot):void 0;l.push({id:b,ts:n,slot:S}),u.add(b)}let d=c.filter(p=>!u.has(p.id)),f=[...l,...d].filter(p=>p&&p.id).slice(0,Math.max(1,i)),g=[],m=new Set;for(let p of f)m.has(p.id)||(m.add(p.id),g.push(p));return gm(e,g),g}function Jc(e,{now:t=Be(),windowMs:n=0,limit:r=120}={}){let i=Mc(e);if(!i.length)return{entries:[],set:new Set};let o=n>0?Math.max(0,t-n):0,s=new Set,a=[];for(let c of i)if(!(!c||!c.id)&&!(o&&c.ts<o)&&!s.has(c.id)&&(s.add(c.id),a.push({id:c.id,ts:c.ts,slot:c.slot}),a.length>=r))break;return{entries:a,set:s}}function Qc(e){let{local:t,session:n}=fe(),r=to(e);V(t,r,null),V(n,`${r}${Lt}`,null)}function Zc(e,t,{timestamp:n=Be(),ttlMs:r=0,limit:i=80,reason:o=""}={}){let s=mr(t);if(!s)return null;let a=r>0?Math.max(0,n-r):0,c=ro(e),l=[],u=0;for(let f of c)if(!(!f||!f.id)){if(f.id===s){u=(f.hits||0)+1;continue}a&&f.ts<a||l.push(f)}let d={id:s,ts:n,reason:o||"",hits:u};l.unshift(d);let h=l.slice(0,Math.max(1,i));return Uc(e,h),d}function el(e,t){let n=mr(t);if(!n)return;let r=ro(e),i=r.filter(o=>o&&o.id!==n);i.length!==r.length&&Uc(e,i)}function tl(e,{now:t=Be(),windowMs:n=0,limit:r=80}={}){let i=ro(e);if(!i.length)return{entries:[],set:new Set};let o=n>0?Math.max(0,t-n):0,s=new Set,a=[];for(let c of i)if(!(!c||!c.id)&&!(o&&c.ts<o)&&!s.has(c.id)&&(s.add(c.id),a.push({id:c.id,ts:c.ts,reason:c.reason||"",hits:c.hits||0}),a.length>=r))break;return{entries:a,set:s}}function nl(e){let{local:t,session:n}=fe(),r=no(e);V(t,r,null),V(n,`${r}${Lt}`,null)}var am,cm,lm,um,Lt,pr=I(()=>{am="heroPool:",cm="heroHistory:",lm="heroMemory:",um="heroFailures:",Lt=":session"});function Qe(){return Date.now()}function Sr(...e){try{}catch{}}function sl(e){return e==="series"||e==="show"||e==="shows"?"series":"movies"}function vm(e,t){if(!e||typeof e!="object")return"";try{let r={poolSize:sl(t)==="series"?e.poolSizeSeries:e.poolSizeMovies,slots:e.slots,diversity:e.diversity,language:e.language||"en-US"};return JSON.stringify(r)}catch(n){return Sr("Failed to compute policy signature:",(n==null?void 0:n.message)||n),""}}function Pt(e,t,n){return Math.min(n,Math.max(t,e))}function Am(e){if(!e)return 0;if(typeof e=="number"&&Number.isFinite(e))return e>1e12?Math.trunc(e):Math.trunc(e*1e3);if(typeof e=="string"){let t=Date.parse(e);if(Number.isFinite(t))return t}return 0}function _m(e){if(!e)return null;let t=Number(e);if(Number.isFinite(t)&&t>1800&&t<2100)return Math.trunc(t);if(typeof e=="string"){let n=e.match(/(19|20|21)\d{2}/);if(n)return Number(n[0])}return null}function km(e){let t=[],n=r=>{if(!r||typeof r!="string")return;let i=r.trim();if(!i)return;let o=i.replace(/\s+/g," ");t.includes(o)||t.push(o)};if(Array.isArray(e==null?void 0:e.genres)){for(let r of e.genres)if(r){if(typeof r=="string"){n(r);continue}typeof r=="object"&&n(r.tag||r.title||r.label||r.name||"")}}if(Array.isArray(e==null?void 0:e.Genre))for(let r of e.Genre)n(typeof r=="string"?r:r==null?void 0:r.tag);return t.slice(0,3)}function Tm(e){let t=[e==null?void 0:e.rating,e==null?void 0:e.audienceRating,e==null?void 0:e.userRating];for(let n of t){let r=Number(n);if(Number.isFinite(r)&&r>0)return Pt(Math.round(r*10)/10,0,10)}return null}function Cm(e){let t=[e==null?void 0:e.ratingCount,e==null?void 0:e.audienceRatingCount,e==null?void 0:e.userRatingCount,e==null?void 0:e.viewCount];for(let n of t){let r=Number(n);if(Number.isFinite(r)&&r>=0)return Math.trunc(r)}return 0}function Im(e){if(!e||typeof e!="object")return null;if(e.heroId!=null)return String(e.heroId);if(e.ids&&typeof e.ids=="object"){if(e.ids.imdb)return`imdb:${e.ids.imdb}`;if(e.ids.tmdb)return`tmdb:${e.ids.tmdb}`;if(e.ids.tvdb)return`tvdb:${e.ids.tvdb}`}if(e.guid)return String(e.guid);if(e.ratingKey!=null)return`rk:${e.ratingKey}`;if(e.id!=null)return String(e.id);if(e.slug)return String(e.slug);if(e.key!=null){let t=typeof e.key=="string"?e.key.trim():String(e.key);if(t)return t}if(e.title){let t=e.year?`:${e.year}`:"";return`title:${e.title}${t}`}return null}function xm(e,t){let n={new:0,topRated:0,oldButGold:0,random:0},r=e,i=t&&typeof t=="object"?t:{};yr.forEach((s,a)=>{var u;if(a===yr.length-1){n[s]=Math.max(0,r),r=0;return}let c=Number((u=i[s])==null?void 0:u.quota);if(!Number.isFinite(c)||c<=0){n[s]=0;return}let l=Math.max(0,Math.round(e*Pt(c,0,1)));n[s]=Math.min(r,l),r-=n[s]});let o=0;for(;r>0;){let s=yr[o%yr.length];n[s]+=1,r-=1,o+=1}return n}function Lm(e,t){let n=Pt(Number(t==null?void 0:t.genre)||.4,.1,.9),r=Pt(Number(t==null?void 0:t.year)||.35,.1,.9),i=Math.max(1,Math.round(e*Pt(n*.5,.1,.35))),o=Math.max(1,Math.round(e*Pt(r*.5,.1,.35)));return{perGenre:i,perYear:o}}function Fm(e){if(!Array.isArray(e)||!e.length)return[];let t=Qe(),n=new Set,r=[];for(let i of e){if(!i||typeof i!="object")continue;let o=Im(i);if(!o||n.has(o))continue;n.add(o);let s=Am(i.addedAt||i.createdAt||i.added),a=_m(i.year||i.originallyAvailableAt),c=Tm(i),l=Cm(i),u=km(i),d={id:o,raw:i,addedAt:s,year:a,rating:c!=null?c:0,voteCount:l,genres:u,isNew:s&&t-s<=bm,isOld:a?new Date().getUTCFullYear()-a>=ym:!1};r.push(d)}return r}function Pm(e){return e.slice().sort((t,n)=>(n.addedAt||0)-(t.addedAt||0))}function Rm(e){return e.slice().sort((t,n)=>{let r=Number.isFinite(t.rating)?t.rating:0,i=Number.isFinite(n.rating)?n.rating:0;if(i!==r)return i-r;let o=(n.voteCount||0)-(t.voteCount||0);return o!==0?o:(n.addedAt||0)-(t.addedAt||0)})}function wm(e){return e.slice().sort((t,n)=>{let r=t.year||0,i=n.year||0;if(r&&i&&r!==i)return r-i;let o=(n.rating||0)-(t.rating||0);return o!==0?o:(n.addedAt||0)-(t.addedAt||0)})}function Bm(e){let t=e.slice();for(let n=t.length-1;n>0;n--){let r=Math.floor(Math.random()*(n+1));[t[n],t[r]]=[t[r],t[n]]}return t}function il(e,t){let{caps:n,genreCounts:r,yearCounts:i}=e;if(n.perGenre>0&&t.genres&&t.genres.length){for(let o of t.genres)if((r.get(o)||0)>=n.perGenre)return!1}return!(n.perYear>0&&t.year&&(i.get(t.year)||0)>=n.perYear)}function oo(e,t,n){if(e.selected.push({...t,slot:n}),e.selectedIds.add(t.id),e.summary[n]=(e.summary[n]||0)+1,t.genres)for(let r of t.genres)e.genreCounts.set(r,(e.genreCounts.get(r)||0)+1);t.year&&e.yearCounts.set(t.year,(e.yearCounts.get(t.year)||0)+1)}function ke(e,t,n,r,{allowHistory:i=!1,filter:o}={}){if(t<=0)return 0;let s=[],a=[],c=[];for(let u of e){if(r.selected.length>=r.poolSize||r.summary[n]>=t)break;if(!r.selectedIds.has(u.id)&&!(o&&!o(u))&&il(r,u)){if(r.failureSet&&r.failureSet.has(u.id)){c.push(u);continue}if(r.memorySet&&r.memorySet.has(u.id)){a.push(u);continue}if(!i&&r.historySet&&r.historySet.has(u.id)){s.push(u);continue}oo(r,u,n)}}if(r.summary[n]>=t||r.selected.length>=r.poolSize)return r.summary[n];let l=u=>{for(let d of u){if(r.selected.length>=r.poolSize||r.summary[n]>=t)break;r.selectedIds.has(d.id)||il(r,d)&&oo(r,d,n)}};return a.length&&l(a),r.summary[n]<t&&s.length&&l(s),r.summary[n]<t&&c.length&&l(c),r.summary[n]}function Nm(e,t){for(let n of t){if(e.selected.length>=e.poolSize)break;e.selectedIds.has(n.id)||oo(e,n,"random")}}function fn(e){let t={...e,timestamp:Qe()};for(let n of Em)try{n(t)}catch(r){Sr("Progress listener failed:",(r==null?void 0:r.message)||r)}try{typeof window!="undefined"&&typeof window.dispatchEvent=="function"&&typeof CustomEvent=="function"&&window.dispatchEvent(new CustomEvent(pm,{detail:t}))}catch(n){Sr("Failed to dispatch progress event:",(n==null?void 0:n.message)||n)}}async function Hm(e,t,n={}){let r=[],i=e.length,{settings:o,auth:s,authOptions:a,signal:c,disableTmdb:l,kind:u,failureTtlMs:d}=n;for(let h=0;h<e.length;h++){let f=e[h];fn({stage:"normalizing",index:h+1,total:i,slot:f.slot,id:f.id});let g=null,m="",p=!1;try{g=await Oc(f.raw,{language:t,settings:o,auth:s,authOptions:a,signal:c,disableTmdb:l})}catch(b){Sr("Failed to normalize hero candidate:",(b==null?void 0:b.message)||b),m=(b==null?void 0:b.message)||"",(b==null?void 0:b.code)==="RATE_LIMIT"&&(p=!0)}if(!g){if(u&&!p)try{Zc(u,f.raw||f,{timestamp:Qe(),ttlMs:d,reason:m||"normalize"})}catch{}continue}if(u)try{el(u,f.raw||g)}catch{}g.slot=f.slot,g.poolSlot=f.slot,g.poolId=f.id,r.push(g)}return r}function ol(e,t,n,r,i,o){let s=Object.values(t).reduce((g,m)=>g+m,0),a={poolSize:s,caps:Lm(s,n),selected:[],summary:{new:0,topRated:0,oldButGold:0,random:0},genreCounts:new Map,yearCounts:new Map,selectedIds:new Set,historySet:(r==null?void 0:r.set)||new Set,memorySet:(i==null?void 0:i.set)||new Set,failureSet:(o==null?void 0:o.set)||new Set},c=Fm(e),l=Pm(c),u=Rm(c),d=wm(c.filter(g=>g.isOld)),h=Bm(c);ke(l,t.new,"new",a,{allowHistory:!1,filter:g=>g.isNew}),ke(l,t.new,"new",a,{allowHistory:!1}),ke(l,t.new,"new",a,{allowHistory:!0}),ke(u,t.topRated,"topRated",a,{allowHistory:!1}),ke(u,t.topRated,"topRated",a,{allowHistory:!0}),ke(d,t.oldButGold,"oldButGold",a,{allowHistory:!1}),ke(d,t.oldButGold,"oldButGold",a,{allowHistory:!0});let f=h.filter(g=>!a.selectedIds.has(g.id));if(ke(f,t.random,"random",a,{allowHistory:!1}),ke(f,t.random,"random",a,{allowHistory:!0}),a.selected.length<s){let g=c.filter(m=>!a.selectedIds.has(m.id));Nm(a,g)}return a}function $m(e,t,n={}){let r=Qe(),i=Ft(e,{now:r,policyHash:t});if(!i||!Array.isArray(i.items)||!i.items.length)return null;if(i.isExpired){if(n.allowGrace){let{graceMs:o}=ln();if(o&&o>0&&i.expiresAt+o>r)return fn({stage:"cache",status:"grace",kind:e,size:i.items.length}),{...i,fromCache:!0}}return null}return fn({stage:"cache",status:"hit",kind:e,size:i.items.length}),{...i,fromCache:!0}}async function al(e,t,n={}){let r=n.policy||kt(),i=sl(e),o=vm(r,i),s=!n.force&&$m(i,o,{allowGrace:!0});if(s)return s;if(n.force){try{Qc(i)}catch{}try{nl(i)}catch{}}let a=i==="series"?r.poolSizeSeries:r.poolSizeMovies;if(!a||a<=0)return{items:[],summary:{},fromCache:!1,updatedAt:Qe(),expiresAt:0};fn({stage:"start",kind:i,total:a});let c=xm(a,r.slots),l=ln(),u=Qe(),d=(()=>{let T=Math.max(0,l.ttlMs||0)+Math.max(0,l.graceMs||0);return T>0?T:rl})(),h=io(i,{windowMs:rl,limit:br}),f=Jc(i,{now:u,windowMs:d,limit:Math.max(br*2,a*2)}),g=tl(i,{now:u,windowMs:d}),m=ol(t,c,{...r.diversity,kind:i},h,f,g);if(m.selected.length<a&&h.entries.length){let T=io(i,{windowMs:Sm,limit:br});m=ol(t,c,{...r.diversity,kind:i},T,f,g)}let p=m.selected.slice(0,a),S=(await Hm(p,r.language||"en-US",{...n.tmdb,kind:i,failureTtlMs:d})).slice(0,a),E=Qe(),k=E+(l.ttlMs||0),L={kind:i,items:S,updatedAt:E,expiresAt:k,policyHash:o,slotSummary:m.summary,meta:{plan:c,totalCandidates:(t==null?void 0:t.length)||0,selectionCount:S.length}};try{Yc(i,S,{timestamp:E,ttlMs:d,limit:Math.max(br*2,a*2)})}catch{}return qc(i,L),fn({stage:"done",kind:i,size:S.length,updatedAt:E}),{...L,fromCache:!1}}async function cl(e,t,n={}){return al(e,t,n)}function ll(e,t,n={}){return al(e,t,{...n,force:!0})}var pm,rl,br,bm,ym,Sm,yr,Em,ul=I(()=>{zc();ar();pr();pm="hero:pool-progress",rl=1e3*60*60*24*7,br=60,bm=1e3*60*60*24*90,ym=12,Sm=1e3*60*60*24*30,yr=["new","topRated","oldButGold","random"],Em=new Set});function hn(...e){try{}catch{}}function fl(){return Date.now()}function vr(e){return e==="show"||e==="shows"||e==="series"?"series":"movies"}function zm(e,t){return e===t?!0:!e||!t?!1:e.active===t.active&&e.until===t.until&&e.retryAfterMs===t.retryAfterMs&&e.lastStatus===t.lastStatus&&e.strikes===t.strikes}function jm(){if(dl)return;try{_.tmdb.rateLimit={...wc()}}catch{_.tmdb.rateLimit={active:!1,until:0,retryAfterMs:0,lastStatus:null,strikes:0}}dl=Bc(t=>{let n=t?{...t}:{active:!1,until:0,retryAfterMs:0,lastStatus:null,strikes:0};zm(_.tmdb.rateLimit,n)||(_.tmdb.rateLimit=n,Ne())})}function gl(e){return{kind:e,state:"idle",regenerating:!1,size:0,updatedAt:0,expiresAt:0,fromCache:!1,source:"",policyHash:"",slotSummary:{},matchesPolicy:!0,isExpired:!1,lastError:null,lastRefresh:0}}function hl(e){if(!e)return null;let t={...e};return t.slotSummary=e.slotSummary?{...e.slotSummary}:{},t}function Km(){if(typeof localStorage=="undefined")return null;try{let e=localStorage.getItem(Dm);if(e==="1"||e==="0")return e}catch(e){hn("Failed to read feature flag:",(e==null?void 0:e.message)||e)}return null}function Mm(e){let t=Km();return t!=null?{enabled:t==="1",source:"localStorage"}:e&&typeof e.heroPipelineEnabled=="boolean"?{enabled:!!e.heroPipelineEnabled,source:"config.heroPipelineEnabled"}:e&&e.features&&typeof e.features.heroPipeline=="boolean"?{enabled:!!e.features.heroPipeline,source:"config.features.heroPipeline"}:{enabled:!0,source:"default"}}function mn(){return{enabled:_.enabled,featureSource:_.featureSource,ready:_.ready,activeKind:_.activeKind,tmdb:{allowed:_.tmdb.allowed,active:_.tmdb.active,rateLimit:_.tmdb.rateLimit?{..._.tmdb.rateLimit}:{active:!1,until:0,retryAfterMs:0,lastStatus:null,strikes:0}},status:{movies:hl(_.status.movies),series:hl(_.status.series)},pools:{movies:_.pools.movies.slice(),series:_.pools.series.slice()}}}function Ne(){let e=mn();for(let t of so)try{t(e)}catch(n){hn("Listener failed:",(n==null?void 0:n.message)||n)}try{typeof window!="undefined"&&typeof window.dispatchEvent=="function"&&typeof CustomEvent=="function"&&window.dispatchEvent(new CustomEvent(Om,{detail:e}))}catch(t){hn("Failed to dispatch pipeline event:",(t==null?void 0:t.message)||t)}return e}function gn(e,t){let n=vr(e),r=_.status[n];if(!r)return;let i={...t};i.slotSummary&&(i.slotSummary={...i.slotSummary}),_.status[n]={...r,...i}}function Rt(){if(!_.enabled){_.ready=!0;return}let t=["movies","series"].every(n=>{let r=_.status[n];return r?r.state==="ready"||r.state==="error"||r.state==="stale":!1});_.ready=t}function ml(e){let t=vr(e),n=Ft(t,{allowExpired:!0});n&&(_.pools[t]=Array.isArray(n.items)?n.items.slice():[],gn(t,{state:n.isExpired?"stale":"ready",regenerating:!1,size:_.pools[t].length,updatedAt:Number(n.updatedAt)||0,expiresAt:Number(n.expiresAt)||0,fromCache:!0,source:n.source||"cache",policyHash:n.policyHash||"",slotSummary:n.slotSummary||{},matchesPolicy:n.matchesPolicy!==!1,isExpired:!!n.isExpired}))}function Um(){_.sources.movies||(_.sources.movies=[]),_.sources.series||(_.sources.series=[])}function Gm(){let e=jt(),n=!(_.tmdb.allowed&&e),r={};if(_.cfg&&typeof _.cfg=="object"){let i=_.cfg.tmdbToken||_.cfg.tmdbApiKey;i&&(r.fallbackCredential=i)}return{disableTmdb:n,settings:_.cfg,authOptions:Object.keys(r).length?r:void 0}}async function ao(e,{force:t=!1}={}){let n=vr(e);if(!_.enabled)return gn(n,{state:"disabled",regenerating:!1}),Rt(),null;if(Um(),_.inFlight.has(n))return _.inFlight.get(n);let r=n==="series"?_.sources.series:_.sources.movies;gn(n,{state:"loading",regenerating:!0,lastError:null}),Ne();let i=t?ll:cl,o={policy:_.policy||void 0,tmdb:Gm()},s=i(n,r,o).then(a=>{let c=a||{},l=Array.isArray(c.items)?c.items.slice():[];return _.pools[n]=l,gn(n,{state:(c.items,"ready"),regenerating:!1,size:l.length,updatedAt:Number(c.updatedAt)||fl(),expiresAt:Number(c.expiresAt)||0,fromCache:!!c.fromCache,source:c.source||(c.fromCache?"cache":"fresh"),policyHash:c.policyHash||"",slotSummary:c.slotSummary||{},matchesPolicy:c.matchesPolicy!==!1,isExpired:!1,lastError:null,lastRefresh:fl()}),Rt(),Ne(),c}).catch(a=>{throw hn("Failed to build hero pool for",n,(a==null?void 0:a.message)||a),gn(n,{state:"error",regenerating:!1,lastError:(a==null?void 0:a.message)||String(a)}),Rt(),Ne(),a}).finally(()=>{_.inFlight.delete(n)});return _.inFlight.set(n,s),s}function qm(){let e=new Date,t=e.getUTCFullYear(),n=Date.UTC(t,0,1),r=Date.UTC(t,e.getUTCMonth(),e.getUTCDate()),i=Math.max(0,r-n);return Math.floor(i/(24*60*60*1e3))}function Xm(e,t){let n=String((e==null?void 0:e.poolId)||(e==null?void 0:e.id)||"").toLowerCase(),r=String((t==null?void 0:t.poolId)||(t==null?void 0:t.id)||"").toLowerCase();return n<r?-1:n>r?1:0}function Vm(e,t){var u,d;let n=vr(e),r=((u=t==null?void 0:t.pools)==null?void 0:u[n])||[];if(!Array.isArray(r)||!r.length)return{items:[],startIndex:0};let i=r.slice().sort(Xm),o=((d=t.status)==null?void 0:d[n])||{},s=o.updatedAt?Math.floor(Number(o.updatedAt)/(24*60*60*1e3)):0,a=n==="series"?7:0,c=qm()+s+a,l=i.length?c%i.length:0;return{items:i,startIndex:l}}function pl({cfg:e,policy:t}={}){_.cfg=e||{},_.policy=t||null;let n=Mm(e);return _.enabled=!!n.enabled,_.featureSource=n.source,_.tmdb.allowed=!!(e!=null&&e.tmdbEnabled),_.tmdb.active=_.tmdb.allowed&&jt(),jm(),ml("movies"),ml("series"),Rt(),Ne(),{enabled:_.enabled,source:_.featureSource}}function bl({movies:e=[],shows:t=[]}={}){_.sources={movies:Array.isArray(e)?e:[],series:Array.isArray(t)?t:[]}}function Ar(e){let t=e==="shows"||e==="series"?"series":"movies";_.activeKind!==t&&(_.activeKind=t,Ne())}async function yl(e={}){if(!_.enabled)return Rt(),{skipped:!0};let n=(e.kinds||["movies","series"]).map(i=>ao(i)),r=await Promise.allSettled(n);return Rt(),Ne(),r}function co(e,t={}){return ao(e,t)}function Er(e,t={}){return ao(e,{...t,force:!0})}function Sl(){return _.enabled?Promise.all([Er("movies"),Er("series")]):Promise.resolve({skipped:!0})}function _r(e){let t=!!(_.tmdb.allowed&&jt());_.tmdb.active!==t&&(_.tmdb.active=t,Ne())}function be(){return!!_.enabled}function kr(){return!!_.ready}function El(){return mn()}function wt(e){let t=mn();return{...Vm(e,t),snapshot:t}}function Tr(e){if(typeof e!="function")return()=>{};so.add(e);try{e(mn())}catch(t){hn("Initial listener invocation failed:",(t==null?void 0:t.message)||t)}return()=>so.delete(e)}function vl(){let e=mn();return{enabled:e.enabled,featureSource:e.featureSource,ready:e.ready,tmdb:e.tmdb,status:e.status,poolSizes:{movies:e.pools.movies.length,series:e.pools.series.length}}}var Dm,Om,so,dl,_,pn=I(()=>{ul();pr();Ee();Ji();Dm="feature.heroPipeline",Om="hero:pipeline-update",so=new Set,dl=null,_={cfg:{},policy:null,enabled:!0,featureSource:"default",ready:!1,sources:{movies:[],series:[]},pools:{movies:[],series:[]},status:{movies:gl("movies"),series:gl("series")},tmdb:{allowed:!1,active:!1,rateLimit:{active:!1,until:0,retryAfterMs:0,lastStatus:null,strikes:0}},activeKind:"movies",inFlight:new Map}});function _l(){let e=document.getElementById("openDebug");e&&e.addEventListener("click",()=>{Wm()})}function Wm(){var t,n,r,i;let e=document.getElementById("debugOverlay");e||(e=document.createElement("div"),e.id="debugOverlay",e.className="debug-overlay",e.innerHTML=`
      <div class="debug-dialog">
        <div class="debug-header"><h2>Debug</h2></div>
        <div class="debug-body">
          <pre id="debugPre" class="debug-pre"></pre>
          <div class="debug-cache-controls">
            <h3>Cache-Verwaltung</h3>
            <div id="cacheStats" class="cache-stats"></div>
            <div class="cache-buttons">
              <button id="debugClearExpired" class="btn">Abgelaufene l\xF6schen</button>
              <button id="debugClearAll" class="btn">Alles l\xF6schen</button>
            </div>
          </div>
        </div>
        <div class="debug-actions">
          <button id="debugCopy" class="btn">Copy report</button>
          <button id="debugClose" class="btn">Schlie\xDFen</button>
        </div>
      </div>`,document.body.append(e)),e.hidden=!1,lo(),e.addEventListener("click",o=>{o.target===e&&Al()}),(t=document.getElementById("debugClose"))==null||t.addEventListener("click",Al,{once:!0}),(n=document.getElementById("debugCopy"))==null||n.addEventListener("click",Ym,{once:!0}),(r=document.getElementById("debugClearExpired"))==null||r.addEventListener("click",()=>{_n(),lo()},{once:!0}),(i=document.getElementById("debugClearAll"))==null||i.addEventListener("click",()=>{confirm("Wirklich den gesamten Cache l\xF6schen?")&&(Po(),lo())},{once:!0})}function Al(){let e=document.getElementById("debugOverlay");e&&(e.hidden=!0)}function lo(){var u,d,h,f,g,m,p,b;let e=document.getElementById("debugPre");if(!e)return;let t=x(),n=Go(),r=t.cfg||{},i=Dr(),o=kt(),s=sr(),a=vl(),c={view:t.view,counts:{movies:(t.movies||[]).length,shows:(t.shows||[]).length,filtered:(t.filtered||[]).length},dataSources:n,cache:i,heroPolicy:{policy:o,language:Sc(),pools:gc(),slots:hc(),diversity:mc(),rotation:pc(),textClamp:bc(),fallback:yc(),cache:ln(),loadedAt:Ec(),issues:s},heroCache:a,tmdb:{enabled:!!r.tmdbEnabled,lang:r.lang,tokenPresent:!!(localStorage.getItem("tmdbToken")||r.tmdbApiKey)},useTmdbImages:localStorage.getItem("useTmdb")==="1",reduceMotion:localStorage.getItem("prefReduceMotion")==="1",locationHash:location.hash,userAgent:navigator.userAgent};e.textContent=JSON.stringify(c,null,2);let l=document.getElementById("cacheStats");if(l&&i){let S=((u=a==null?void 0:a.status)==null?void 0:u.movies)||{},E=((d=a==null?void 0:a.status)==null?void 0:d.series)||{},k=T=>{if(!Number.isFinite(T)||T<=0)return"n/a";try{return new Date(T).toLocaleString()}catch{return"n/a"}},L=a!=null&&a.enabled?`aktiv (Quelle: ${a.featureSource||"default"})`:`deaktiviert (Quelle: ${(a==null?void 0:a.featureSource)||"default"})`;l.innerHTML=`
      <p>Eintr\xE4ge gesamt: <strong>${i.totalEntries}</strong></p>
      <p>G\xFCltig: <strong>${i.validEntries}</strong> | Abgelaufen: <strong>${i.expiredEntries}</strong></p>
      <p>Gr\xF6\xDFe: <strong>${i.totalSizeMB} MB</strong></p>
      <p>Hero-Pipeline: <strong>${L}</strong></p>
      <p>Filme: <strong>${(g=(f=S.size)!=null?f:(h=a==null?void 0:a.poolSizes)==null?void 0:h.movies)!=null?g:0}</strong> Eintr\xE4ge \xB7 Update: <strong>${k(S.updatedAt)}</strong> \xB7 Ablauf: <strong>${k(S.expiresAt)}</strong></p>
      <p>Serien: <strong>${(b=(p=E.size)!=null?p:(m=a==null?void 0:a.poolSizes)==null?void 0:m.series)!=null?b:0}</strong> Eintr\xE4ge \xB7 Update: <strong>${k(E.updatedAt)}</strong> \xB7 Ablauf: <strong>${k(E.expiresAt)}</strong></p>
    `}}function Ym(){var n;let e=document.getElementById("debugPre");if(!e)return;let t=e.textContent||"";(n=navigator.clipboard)==null||n.writeText(t).catch(r=>{try{let i=document.createElement("textarea");i.value=t,document.body.append(i),i.select(),document.execCommand("copy"),i.remove()}catch{}})}var kl=I(()=>{ie();Ot();Or();ar();pn()});function Cl(e){uo=typeof e=="function"?e:null}function Il(e){fo=typeof e=="function"?e:null}function Ir(e){if(uo)try{uo(e)}catch{}}function Qm(e){if(fo)try{fo(e)}catch{}}function xl(e){let t=document.getElementById("settingsOverlay"),n=t==null?void 0:t.querySelector(".settings-dialog"),r=document.getElementById("settingsBtn"),i=document.getElementById("openSettings"),o=document.getElementById("headerSettingsBtn"),s=document.getElementById("settingsClose2"),a=document.getElementById("tmdbTokenInput"),c=document.getElementById("tmdbSave"),l=document.getElementById("tmdbTest"),u=document.getElementById("tmdbStatus"),d=document.getElementById("tmdbClearCache"),h=document.getElementById("tmdbStatusBadge"),f=document.getElementById("prefReduceMotion"),g=document.getElementById("useTmdbSetting"),m=document.getElementById("resetFilters"),p=t==null?void 0:t.querySelector(".settings-body"),b=document.getElementById("heroCacheStatus"),S=document.getElementById("heroRefreshMovies"),E=document.getElementById("heroRefreshShows"),k=document.getElementById("heroRefreshAll");if(!b&&p){let y=document.createElement("div");y.className="settings-row",y.innerHTML=`
      <div class="settings-inline" id="heroRefreshControls">
        <button type="button" id="heroRefreshMovies" class="secondary">Highlights Filme aktualisieren</button>
        <button type="button" id="heroRefreshShows" class="secondary">Highlights Serien aktualisieren</button>
        <button type="button" id="heroRefreshAll" class="secondary">Alle Highlights aktualisieren</button>
      </div>
      <p class="settings-help" id="heroCacheStatus" aria-live="polite"></p>
    `,p.append(y),b=y.querySelector("#heroCacheStatus"),S=y.querySelector("#heroRefreshMovies"),E=y.querySelector("#heroRefreshShows"),k=y.querySelector("#heroRefreshAll")}let L=[S,E,k].filter(Boolean),T=null;function W(y,A){L.forEach(v=>{v&&(v.disabled=y||!be(),v.disabled&&A?v.dataset.heroBusy=A:v.removeAttribute("data-hero-busy"))})}function z(y){if(!Number.isFinite(y)||y<=0)return"unbekannt";try{return new Date(y).toLocaleString(void 0,{hour:"2-digit",minute:"2-digit"})}catch{return"unbekannt"}}function B(y){if(!Number.isFinite(y)||y<=0)return"kein Ablauf";let A=y-Date.now();if(A<=0)return"abgelaufen";let v=A/6e4;if(v<1)return"l\xE4uft in <1 Min ab";if(v<60)return`l\xE4uft in ${Math.round(v)} Min ab`;let C=v/60;if(C<24)return`l\xE4uft in ${Math.round(C)} Std ab`;let H=C/24;return`l\xE4uft in ${Math.round(H)} Tg ab`}function j(y,A){if(!A)return`${y}: keine Daten`;if(A.state==="disabled")return`${y}: deaktiviert`;if(A.state==="loading"||A.regenerating)return`${y}: wird aktualisiert \u2026`;if(A.state==="error")return`${y}: Fehler (${A.lastError||"unbekannt"})`;if(A.state==="stale")return`${y}: ${A.size} Eintr\xE4ge (Cache abgelaufen)`;let v=z(A.updatedAt),C=B(A.expiresAt);return`${y}: ${A.size} Eintr\xE4ge (Update ${v}, ${C})`}function P(y){var C,H,et,tt,nt,yn;if(!b)return;if(!y||!be()||y.enabled===!1){b.textContent="Hero-Pipeline deaktiviert \u2013 Legacy-Hero aktiv.",W(!0,"disabled");return}let A=!!((H=(C=y.status)==null?void 0:C.movies)!=null&&H.regenerating||(tt=(et=y.status)==null?void 0:et.series)!=null&&tt.regenerating);W(A,A?"busy":"");let v=[];v.push(j("Filme",(nt=y.status)==null?void 0:nt.movies)),v.push(j("Serien",(yn=y.status)==null?void 0:yn.series)),y.tmdb&&(y.tmdb.allowed?v.push(`TMDb ${y.tmdb.active?"aktiv":"aus (Toggle)"}`):v.push("TMDb deaktiviert")),y.featureSource&&v.push(`Feature-Flag: ${y.featureSource}`),b.textContent=v.join(" \u2022 ")}async function N(y="all",A="Highlights aktualisieren \u2026"){if(!be())return;if(T)try{await T}catch{}return b&&A&&(b.textContent=A),W(!0,"busy"),T=(y==="movies"||y==="series"?Er(y):Sl()).then(()=>{Ir()}).catch(C=>{}).finally(()=>{T=null,W(!1)}),T}Tr(P),t&&t.hidden&&t.setAttribute("aria-hidden","true");let ye=null,Y="",He=!1,Ce=new Map,Lr='a[href], button:not([disabled]), input:not([disabled]), select:not([disabled]), textarea:not([disabled]), [tabindex]:not([tabindex="-1"])';function Fr(){return t?Array.from(t.querySelectorAll(Lr)).filter(y=>!y.hasAttribute("disabled")&&y.getAttribute("aria-hidden")!=="true"):[]}function $t(){n&&typeof n.focus=="function"?n.focus({preventScroll:!0}):t&&typeof t.focus=="function"&&t.focus({preventScroll:!0})}function Pr(y){if(!t)return;let A=Array.from(document.body.children).filter(v=>v!==t);y?A.forEach(v=>{Ce.has(v)||Ce.set(v,{ariaHidden:v.hasAttribute("aria-hidden")?v.getAttribute("aria-hidden"):null,inert:v.hasAttribute("inert")}),v.setAttribute("aria-hidden","true"),v.setAttribute("inert","")}):(A.forEach(v=>{let C=Ce.get(v);C?(C.ariaHidden===null||C.ariaHidden===void 0?v.removeAttribute("aria-hidden"):v.setAttribute("aria-hidden",C.ariaHidden),C.inert?v.setAttribute("inert",""):v.removeAttribute("inert"),Ce.delete(v)):(v.removeAttribute("aria-hidden"),v.removeAttribute("inert"))}),Ce.clear())}function Rr(){!t||He||(He=!0,t.hidden=!1,t.setAttribute("aria-hidden","false"),ye=document.activeElement instanceof HTMLElement?document.activeElement:null,Y=document.body.style.overflow,document.body.style.overflow="hidden",Pr(!0),Ul(),requestAnimationFrame($t))}function wr(){!t||!He||(He=!1,t.hidden=!0,t.setAttribute("aria-hidden","true"),Pr(!1),document.body.style.overflow=Y,ye&&typeof ye.focus=="function"&&ye.focus(),ye=null)}function Ml(y){if(!He)return;if(y.key==="Escape"){y.preventDefault(),wr();return}if(y.key!=="Tab")return;let A=Fr();if(!A.length){y.preventDefault(),$t();return}let v=A[0],C=A[A.length-1],H=document.activeElement;y.shiftKey?(H===v||!t.contains(H))&&(y.preventDefault(),C.focus()):H===C&&(y.preventDefault(),v.focus())}r&&r.addEventListener("click",Rr),i&&i.addEventListener("click",()=>{Rr()}),o&&o.addEventListener("click",Rr),s&&s.addEventListener("click",wr),t&&t.addEventListener("click",y=>{y.target===t&&wr()}),t&&t.addEventListener("keydown",Ml);function R(y="",A=""){if(u){u.textContent=y,u.dataset.kind=A,h&&(h.dataset.kind=A||"",h.title=y||"");try{if(A==="error"&&e&&e.tmdbApiKey){let v=String(localStorage.getItem("tmdbToken")||"").trim(),C=String((a==null?void 0:a.value)||"").trim();if(v&&C){try{localStorage.removeItem("tmdbToken")}catch{}a&&(a.value=""),Ie(!0);let H="Ung\xFCltiger Token entfernt. Verwende API Key aus config.json.";u.textContent=H,u.dataset.kind="info",h&&(h.dataset.kind="info",h.title=H)}}}catch{}}}function Ie(y){if(g&&(g.disabled=!y,g.title=g.disabled?"Nur verf\xFCgbar mit g\xFCltigem Token oder API Key.":"",!y&&g.checked)){try{localStorage.setItem("useTmdb","0")}catch{}g.checked=!1,te(x().view),Ir()}}function Ul(){let y="";try{a&&(a.value=y=localStorage.getItem("tmdbToken")||"")}catch{}try{f&&(f.checked=localStorage.getItem("prefReduceMotion")==="1")}catch{}try{g&&(g.checked=localStorage.getItem("useTmdb")==="1",g.disabled=!y,g.title=g.disabled?"Nur verf\xFCgbar mit g\xFCltigem Token.":"")}catch{}try{Ie(!!y||!!(e&&e.tmdbApiKey))}catch{}R("",""),e&&e.tmdbEnabled===!1?R("\u26A0\uFE0F TMDB ist in config.json deaktiviert (tmdbEnabled: false). Hero-Banner ben\xF6tigt TMDB!","error"):y||R("Kein Token hinterlegt. TMDB ist deaktiviert.","info"),y?(async()=>{var A;R("Pr\xFCfe Token...","pending");try{let v=await Promise.resolve().then(()=>(Ye(),At)),C=await((A=v.validateToken)==null?void 0:A.call(v,y));C&&C.ok?(Ie(!0),C.as==="bearer"?R("Token g\xFCltig (v4 Bearer).","success"):C.as==="apikey"&&R('API Key g\xFCltig (v3). Tipp: dauerhaft in site/config.json unter "tmdbApiKey" eintragen.',"success")):(Ie(!1),(C==null?void 0:C.hint)==="looksV3"?R('Eingegebener Wert sieht wie ein v3 API Key aus. Bitte in config.json als "tmdbApiKey" eintragen oder v4 Bearer Token verwenden.',"error"):R("Token ung\xFCltig oder keine Berechtigung (401).","error"))}catch{R("Pr\xFCfung fehlgeschlagen. Netzwerk/Browser-Konsole pr\xFCfen.","error")}})():Ie(!!(e&&e.tmdbApiKey))}S&&S.addEventListener("click",()=>{N("movies","Aktualisiere Film-Highlights \u2026")}),E&&E.addEventListener("click",()=>{N("series","Aktualisiere Serien-Highlights \u2026")}),k&&k.addEventListener("click",()=>{N("all","Aktualisiere alle Highlights \u2026")}),c&&c.addEventListener("click",async()=>{var A,v;let y=String((a==null?void 0:a.value)||"").trim();try{localStorage.setItem("tmdbToken",y)}catch{}if(!y){ht(e,{preferStoredToken:!1,token:""}),R("Kein Token hinterlegt. TMDB ist deaktiviert.","info"),Ie(!!(e&&e.tmdbApiKey)),_r((A=g==null?void 0:g.checked)!=null?A:!1),N("all","Highlights aktualisieren (Token entfernt)\u2026");return}ht(e,{preferStoredToken:!1,token:y}),R("Pr\xFCfe Token...","pending");try{let C=await Promise.resolve().then(()=>(Ye(),At)),H=await((v=C.validateToken)==null?void 0:v.call(C,y));H&&H.ok?(Ie(!0),H.as==="bearer"?R("Token g\xFCltig (v4 Bearer).","success"):H.as==="apikey"&&R('API Key g\xFCltig (v3). Tipp: dauerhaft in site/config.json unter "tmdbApiKey" eintragen.',"success")):(Ie(!1),(H==null?void 0:H.hint)==="looksV3"?R('Eingegebener Wert sieht wie ein v3 API Key aus. Bitte in config.json als "tmdbApiKey" eintragen oder v4 Bearer Token verwenden.',"error"):R("Token ung\xFCltig oder keine Berechtigung (401).","error"))}catch{R("Pr\xFCfung fehlgeschlagen. Netzwerk/Browser-Konsole pr\xFCfen.","error")}e&&e.tmdbEnabled===!1&&y&&R('\u26A0\uFE0F Token gespeichert, aber TMDB in config.json deaktiviert. Bitte "tmdbEnabled": true setzen!',"error"),_r(!0),N("all","Highlights aktualisieren (Token ge\xE4ndert)\u2026")}),l&&l.addEventListener("click",async()=>{var A;let y=String((a==null?void 0:a.value)||"").trim();if(!y){R("Bitte Token eingeben.","error");return}R("Pr\xFCfe Token...","pending");try{let v=await Promise.resolve().then(()=>(Ye(),At)),C=await((A=v.validateToken)==null?void 0:A.call(v,y));C&&C.ok?C.as==="bearer"?R("Token g\xFCltig (v4 Bearer).","success"):C.as==="apikey"&&R('API Key g\xFCltig (v3). Tipp: dauerhaft in site/config.json unter "tmdbApiKey" eintragen.',"success"):(C==null?void 0:C.hint)==="looksV3"?R('Eingegebener Wert sieht wie ein v3 API Key aus. Dieser funktioniert hier nicht als Bearer. Bitte in config.json als "tmdbApiKey" eintragen oder v4 Bearer Token verwenden.',"error"):R("Token ung\xFCltig oder keine Berechtigung (401).","error")}catch{R("Pr\xFCfung fehlgeschlagen. Netzwerk/Browser-Konsole pr\xFCfen.","error")}}),d&&d.addEventListener("click",()=>{Promise.resolve().then(()=>(Ee(),Vo)).then(y=>{var v;let A=(v=y.clearHeroCache)==null?void 0:v.call(y);A&&!A.error&&R(`Cache geleert: ${A.heroEntries} Hero-Eintr\xE4ge, ${A.tmdbCacheEntries} TMDB-Eintr\xE4ge. Token erhalten.`,"success")}),Promise.resolve().then(()=>(Ye(),At)).then(y=>{var A;return(A=y.clearCache)==null?void 0:A.call(y)}),N("all","Highlights aktualisieren (TMDB-Cache geleert)\u2026")}),f&&f.addEventListener("change",()=>{try{localStorage.setItem("prefReduceMotion",f.checked?"1":"0")}catch{}Qm(f.checked)}),g&&g.addEventListener("change",()=>{try{localStorage.setItem("useTmdb",g.checked?"1":"0")}catch{}g.checked&&!Tl&&(Tl=!0,Promise.resolve().then(()=>(Ye(),At)).then(y=>{var v;let A=x();(v=y.hydrateOptional)==null||v.call(y,A.movies,A.shows,A.cfg)}).catch(y=>{}),setTimeout(()=>{g.checked&&te(x().view)},1200),setTimeout(()=>{g.checked&&te(x().view)},3e3)),_r(!0),te(x().view),Ir()}),m&&m.addEventListener("click",()=>{let y=document.getElementById("search");y&&(y.value="");let A=document.getElementById("q");A&&(A.value="");let v=document.getElementById("onlyNew");v&&(v.checked=!1);let C=document.getElementById("yearFrom"),H=document.getElementById("yearTo");C&&(C.value=""),H&&(H.value="");let et=document.getElementById("collectionFilter");et&&(et.value=""),document.querySelectorAll("#genreFilters .chip.active").forEach(nt=>nt.classList.remove("active"));let tt=document.getElementById("genreFilters");tt&&(tt.dataset.state="empty",tt.dataset.count="0"),Promise.resolve().then(()=>(Mi(),Ki)).then(nt=>{let yn=nt.applyFilters();te(x().view),Ir(yn)})})}var uo,fo,Tl,Ll=I(()=>{ie();tr();pn();mt();uo=null,fo=null,Tl=!1});function bo(e){return Bt=e||null,Bt}function Bl(){var t,n,r,i,o,s,a,c;if(go)return go;let e={title:((n=(t=document.getElementById("heroTitle"))==null?void 0:t.textContent)==null?void 0:n.trim())||"",tagline:((i=(r=document.getElementById("heroTagline"))==null?void 0:r.textContent)==null?void 0:i.trim())||"",overview:((s=(o=document.getElementById("heroOverview"))==null?void 0:o.textContent)==null?void 0:s.trim())||"",cta:((c=(a=document.getElementById("heroCta"))==null?void 0:a.textContent)==null?void 0:c.trim())||""};return go=e,e}function Nl(e){mo=typeof e=="function"?e:null}function Hl(e="default",t={}){let n=document.getElementById("hero"),r=document.getElementById("heroTitle"),i=document.getElementById("heroTagline"),o=document.getElementById("heroOverview"),s=document.getElementById("heroCta"),a=document.getElementById("heroMeta"),c=document.getElementById("heroMetaPrimary"),l=document.getElementById("heroMetaSecondary"),u=document.getElementById("heroMetaTertiary"),d=document.getElementById("heroPicture"),h=document.getElementById("heroBackdropImage"),f=document.getElementById("heroBackdropLarge"),g=document.getElementById("heroBackdropMedium");if(!n||!r||!i||!o||!s||!a)return!1;let m=Bl(),p={...Fl.default,...Fl[e]||{},...t||{}};bo(null),po=e,n.dataset.heroKind="fallback",n.dataset.heroId="",n.dataset.state="fallback",n.classList.remove("hero--has-media"),So(d,h,f,g),r.textContent=p.title||m.title;let b=p.tagline||"";i.textContent=b||m.tagline,i.hidden=!b,i.dataset.taglinePaused="0",delete i.dataset.heroBound,i.classList.remove("is-fading");let S=p.overview||"";o.textContent=S,o.hidden=!S;let E=p.cta||m.cta||s.textContent||"Browse featured titles";s.textContent=E;let k=typeof p.ctaAction=="function"&&p.ctaEnabled===!0;return s.disabled=!k,s.setAttribute("aria-disabled",k?"false":"true"),k?(s.onclick=()=>{try{p.ctaAction()}catch{}},s.setAttribute("aria-label",p.ctaLabel||E)):(s.onclick=null,s.removeAttribute("aria-label")),a.hidden=!0,c&&(c.innerHTML=""),l&&(l.innerHTML=""),u&&(u.innerHTML=""),!0}function Ze(e){var k,L;let t=document.getElementById("hero"),n=document.getElementById("heroTitle"),r=document.getElementById("heroTagline"),i=document.getElementById("heroOverview"),o=document.getElementById("heroCta"),s=document.getElementById("heroMeta"),a=document.getElementById("heroMetaPrimary"),c=document.getElementById("heroMetaSecondary"),l=document.getElementById("heroMetaTertiary"),u=document.getElementById("heroPicture"),d=document.getElementById("heroBackdropImage"),h=document.getElementById("heroBackdropLarge"),f=document.getElementById("heroBackdropMedium");if(!t||!n||!r||!i||!o||!s)return;let g=Bl(),m=ep(e);if(!m){bo(null),po=null,t.dataset.heroKind="",t.dataset.heroId="",t.dataset.state="empty",t.classList.remove("hero--has-media"),So(u,d,h,f),n.textContent=g.title,r.textContent=g.tagline,r.hidden=!g.tagline,r.dataset.taglinePaused="0",delete r.dataset.heroBound,r.classList.remove("is-fading"),i.textContent=g.overview,i.hidden=!g.overview,o.textContent=g.cta||"View details",o.disabled=!0,o.setAttribute("aria-disabled","true"),o.removeAttribute("aria-label"),o.onclick=null,s.hidden=!0,a&&(a.innerHTML=""),c&&(c.innerHTML=""),l&&(l.innerHTML="");return}let p=$l(m);if(!p)return Ze([]);bo(p),po=null;let b=p.type==="tv"?"show":"movie",S=((k=p.cta)==null?void 0:k.id)||p.id||"";try{Wc(b==="show"?"series":"movies",p)}catch{}if(t.dataset.heroKind=b,t.dataset.heroId=S,t.dataset.state="ready",n.textContent=p.title||g.title,r){let T=p.tagline||"";r.textContent=T,r.hidden=!T,r.dataset.taglinePaused=T?"1":"0",T?r.dataset.heroBound="1":delete r.dataset.heroBound,r.classList.remove("is-fading")}if(i){let T=p.overview||"";i.textContent=T,i.hidden=!T}let E=((L=p.cta)==null?void 0:L.label)||(b==="show"?"View show details":"View movie details");o.textContent=E,o.disabled=!1,o.setAttribute("aria-disabled","false"),o.setAttribute("aria-label",p.title?`${E}: ${p.title}`:E),o.onclick=()=>yp(p),hp(a,c,l,s,p),pp(t,u,d,h,f,p)}function ep(e){if(Array.isArray(e)&&e.length){let n=yo(e);if(n.length)return Pl(n)}let t=np();return t.length?Pl(t):null}function yo(e){if(!Array.isArray(e))return[];let t=[];return e.forEach(n=>{if(!tp(n))return;let r=$l(n);r&&t.push(r)}),t}function tp(e){return!(!e||typeof e!="object"||e.isCollectionGroup||(typeof e.type=="string"?e.type.toLowerCase():"")==="collection")}function Pl(e){if(e.length===1)return e[0];let t=Math.floor(Math.random()*e.length),n=e[t];return Bt&&e.length>1&&n&&Bt&&n.id===Bt.id&&e.find(i=>i&&i.id!==Bt.id)||n}function np(){let e=x(),t=e.view==="shows"?"series":"movies",n=Ft(t,{allowExpired:!0})||null,r=Array.isArray(n==null?void 0:n.items)?yo(n.items):[];if(r.length)return r;let o=(Array.isArray(e.filtered)&&e.filtered.length?e.filtered:null)||(t==="series"?e.shows:e.movies)||[];return yo(o)}function $l(e){return!e||typeof e!="object"?null:rp(e)?{...e,cta:e.cta?{...e.cta}:null}:ip(e)}function rp(e){var n;if(!e||typeof e!="object")return!1;let t=((n=e==null?void 0:e.cta)==null?void 0:n.id)||(e==null?void 0:e.heroId);return!!(e.title&&t)}function ip(e){if(!e||typeof e!="object")return null;let t=e.type==="tv"?"tv":"movie",n=String(e.title||e.name||"").trim();if(!n)return null;let r=op(e),i=r.tmdb||r.imdb||r.ratingKey||"";if(!i)return null;let o=sp(e),s=ap(e,t),a=cp(e),c=lp(e),l=up(e),u=dp(e),d=fp(e),h=gp(e),f={id:i,kind:t==="tv"?"show":"movie",label:t==="tv"?"View show details":"View movie details",target:`#/${t==="tv"?"show":"movie"}/${i}`};return{id:r.ratingKey||`${t}-${i}`,type:t,title:n,tagline:d,overview:u,year:o,runtime:s,rating:a,genres:c,certification:l,cta:f,ids:r,backdrops:h}}function op(e){let t={};return e!=null&&e.ids&&typeof e.ids=="object"&&(e.ids.tmdb&&(t.tmdb=String(e.ids.tmdb)),e.ids.imdb&&(t.imdb=String(e.ids.imdb)),e.ids.tvdb&&(t.tvdb=String(e.ids.tvdb))),(e==null?void 0:e.ratingKey)!=null&&(t.ratingKey=String(e.ratingKey)),e!=null&&e.guid&&(t.guid=String(e.guid)),t}function sp(e){let t=q(e);return t?Number(t):null}function ap(e,t){var r,i;let n=(i=(r=e==null?void 0:e.runtimeMin)!=null?r:e==null?void 0:e.durationMin)!=null?i:e!=null&&e.duration?Math.round(Number(e.duration)/6e4):null;return!Number.isFinite(n)||n<=0?null:Math.max(1,Math.round(n))}function cp(e){var n;let t=Number((n=e==null?void 0:e.rating)!=null?n:e==null?void 0:e.audienceRating);return Number.isFinite(t)?t:null}function lp(e){let t=Array.isArray(e==null?void 0:e.genres)?e.genres:[],n=[];return t.forEach(r=>{if(!r)return;if(typeof r=="string"){let o=r.trim();o&&n.push(o);return}let i=r.tag||r.title||r.name||r.label||"";i&&n.push(i)}),Array.from(new Set(n))}function up(e){let t=typeof(e==null?void 0:e.contentRating)=="string"?e.contentRating.trim():"";if(!t)return"";let n=t.split("/"),r=n[n.length-1];return r?r.trim():t}function dp(e){let t=[e==null?void 0:e.summary,e==null?void 0:e.plot,e==null?void 0:e.description,e==null?void 0:e.tagline];for(let n of t){if(typeof n!="string")continue;let r=n.trim();if(r)return r}return""}function fp(e){let t=[e==null?void 0:e.tagline];for(let n of t){if(typeof n!="string")continue;let r=n.trim();if(r)return r}return""}function gp(e){var o,s,a,c,l;let t=Kt(),n=[(o=e==null?void 0:e.tmdb)==null?void 0:o.backdrop,(s=e==null?void 0:e.tmdb)==null?void 0:s.backdrop_path,(a=e==null?void 0:e.tmdb)==null?void 0:a.backdropPath,(c=e==null?void 0:e.tmdb)==null?void 0:c.background,(l=e==null?void 0:e.tmdb)==null?void 0:l.art],r=[e==null?void 0:e.art,e==null?void 0:e.background,e==null?void 0:e.thumbBackground,e==null?void 0:e.coverArt,e==null?void 0:e.thumb,e==null?void 0:e.thumbFile],i=[];return t&&n.forEach(u=>{let d=Rl(u,!0);d&&!i.includes(d)&&i.push(d)}),r.forEach(u=>{let d=Rl(u,!1);d&&!i.includes(d)&&i.push(d)}),i}function Rl(e,t){if(typeof e!="string")return"";let n=e.trim();return n?n.startsWith("http")?n:n.startsWith("/")&&t&&!n.startsWith("/library/")?`https://image.tmdb.org/t/p/original${n}`:n:""}function hp(e,t,n,r,i){let o=mp(i),[s=[],a=[],c=[]]=o;ho(e,s),ho(t,a),ho(n,c);let l=s.length||a.length||c.length;r.hidden=!l}function mp(e){let t=[],n=[];if(Number.isFinite(e.year)&&n.push({text:String(e.year),label:"Release year"}),Number.isFinite(e.runtime)){let o=e.type==="tv"?`${e.runtime} min/ep`:bp(e.runtime);n.push({text:o,label:e.type==="tv"?"Episode runtime":"Runtime"})}e.certification&&n.push({text:e.certification,label:"Certification",kind:"certification"}),n.length&&t.push(n);let r=[];if(e.rating!=null){let o=Z(e.rating);r.push({text:`\u2605 ${o}`,label:`Average rating ${o} out of 10`,kind:"rating"})}if(e.voteCount!=null){let o=Zm.format(e.voteCount);r.push({text:`${o} votes`,label:`${o} votes recorded`})}if(e.type==="tv"){let o=[];Number.isFinite(e.seasons)&&e.seasons>0&&o.push(`${e.seasons} ${e.seasons===1?"Season":"Seasons"}`),Number.isFinite(e.episodes)&&e.episodes>0&&o.push(`${e.episodes} ${e.episodes===1?"Episode":"Episodes"}`),o.length&&r.push({text:o.join(" \u2022 "),label:"Episode availability"})}r.length&&t.push(r);let i=[];return Array.isArray(e.genres)&&e.genres.slice(0,3).forEach(o=>{let s=typeof o=="string"?o:"";s&&i.push({text:s,label:`Genre: ${s}`})}),i.length&&t.push(i),t}function ho(e,t){if(!e)return;if(!t||!t.length){e.innerHTML="",e.hidden=!0;return}let n=document.createDocumentFragment();t.forEach(r=>{let i=document.createElement("span");i.className="hero__badge",r.kind==="certification"&&i.classList.add("hero__badge--certification"),r.kind==="rating"&&i.classList.add("hero__badge--rating"),i.textContent=r.text,r.label&&i.setAttribute("aria-label",r.label),n.appendChild(i)}),e.replaceChildren(n),e.hidden=!1}function pp(e,t,n,r,i,o){let a=(Array.isArray(o.backdrops)?o.backdrops.filter(Boolean):[])[0]||"";if(!t||!n){e.classList.toggle("hero--has-media",!!a);return}if(!a){So(t,n,r,i),e.classList.remove("hero--has-media");return}e.classList.add("hero--has-media"),wl(r,a),wl(i,a),n.src=a,n.alt=o.title?`${o.title} backdrop`:"",n.removeAttribute("hidden"),t.hidden=!1}function wl(e,t){e&&(t?e.srcset=t:e.removeAttribute("srcset"))}function So(e,t,n,r){n&&n.removeAttribute("srcset"),r&&r.removeAttribute("srcset"),t&&(t.removeAttribute("src"),t.setAttribute("hidden","")),e&&(e.hidden=!0)}function bp(e){if(!Number.isFinite(e)||e<=0)return"";let t=Math.floor(e/60),n=Math.round(e%60);return t&&n?`${t}h ${n}m`:t?`${t}h`:`${n}m`}function yp(e){let t=e==null?void 0:e.cta,n=(t==null?void 0:t.kind)||(e.type==="tv"?"show":"movie"),r=(t==null?void 0:t.id)||e.id;!n||!r||(Sp(n,r,t==null?void 0:t.target),n==="show"?Et(r):St(r))}function Sp(e,t,n){if(!e||!t)return;let r=n||`#/${e}/${t}`,i=(window.location.hash||"")===r;if(typeof mo=="function")try{mo(r,{silent:!0,replace:i});return}catch{}try{window.location.hash=r}catch{}}var Zm,Bt,go,mo,po,Fl,Eo=I(()=>{ie();Yn();Ee();pr();Zm=typeof Intl!="undefined"?new Intl.NumberFormat("en-US"):{format:e=>String(e)},Bt=null,go=null,mo=null,po=null,Fl={default:{title:"Highlights temporarily unavailable",tagline:"TMDb data could not be loaded just now.",overview:"The hero banner falls back to a neutral gradient until artwork and metadata are available again. Feel free to keep browsing and refresh later."},"rate-limit":{title:"Highlights are catching their breath",tagline:"TMDb is currently rate limiting our artwork requests.",overview:"We are slowing down hero generation until the limit resets. Your library stays accessible in the meantime."},error:{title:"Highlights paused",tagline:"Fresh TMDb data is temporarily unavailable.",overview:"We will automatically retry fetching artwork. You can also trigger a manual refresh from the settings when you are ready."}}});function Dl({onRefresh:e=Ze}={}){let t=document.getElementById("hero"),n=document.getElementById("heroTimer"),r=n?n.querySelector(".hero-timer__bar"):null;if(!t||!n||!r)return null;if(window.matchMedia&&window.matchMedia("(prefers-reduced-motion: reduce)").matches)return n.hidden=!0,null;n.removeAttribute("aria-hidden"),n.dataset.state="running";let o=15e3,s=new Set,a=!1,c=0,l=null,u=0,d=be(),h=E(),f=[],g=0,m=!1,p="",b=null,S=null;d&&(z(wt(h)),b=Tr(()=>{z(wt(h))})),S=To(()=>{let P=E();P!==h&&(h=P,d&&z(wt(h)))});function E(){return x().view==="shows"?"series":"movies"}function k(){return s.size>0}function L(){let P=k();n.dataset.state=P?"paused":"running",a&&!P&&(u=0),a=P}function T(P,N){N?s.add(P):s.delete(P),L()}function W(){return f.length?(g=(g+1)%f.length,f[g]):null}function z(P){var $t;if(!P)return;let N=Array.isArray(P.items)?P.items:[],Y=($t=(P.snapshot||El()).status)==null?void 0:$t[h],He=!kr()||(Y==null?void 0:Y.regenerating),Ce=`${h}:${(Y==null?void 0:Y.updatedAt)||0}:${N.length}`,Lr=f.length>0,Fr=m;if(f=N,g=N.length?P.startIndex%N.length:0,m=He||!N.length,T("pipeline",m),!m&&N.length&&(!Lr||Fr||p!==Ce)){try{e==null||e([N[g]])}catch{}c=0,r.style.setProperty("--p","0")}p=Ce}function B(P){if(k()){u=P,l=requestAnimationFrame(B);return}u||(u=P);let N=Math.max(0,P-u);u=P,c+=N;let ye=Math.max(0,Math.min(1,c/o));if(r.style.setProperty("--p",String(ye)),ye>=1){c=0,u=P,r.style.setProperty("--p","0");try{if(d){let Y=W();Y?e==null||e([Y]):e==null||e()}else e==null||e()}catch{}}l=requestAnimationFrame(B)}function j(){l||(l=requestAnimationFrame(B))}return t.addEventListener("mouseenter",()=>{T("hover",!0)}),t.addEventListener("mouseleave",()=>{T("hover",!1)}),document.addEventListener("visibilitychange",()=>{T("hidden",document.hidden)}),document.hidden?T("hidden",!0):L(),j(),{pause(){T("manual",!0)},resume(){T("manual",!1)},reset(){c=0,r.style.setProperty("--p","0")},destroy(){b&&b(),S&&S()}}}var Ol=I(()=>{Eo();ie();pn()});function vp(e){try{xr&&(xr.tmdbEnrichment=!!(e&&e.tmdbEnabled)),typeof window!="undefined"&&window.FEATURES&&window.FEATURES!==xr&&(window.FEATURES={...window.FEATURES,...xr})}catch{}}function Ap(e,t){if(bn.reason===e)return;bn.reason=e;let n=zl[e]||zl.default;try{n(t)}catch{}}function Te(e){var t,n,r,i;if(Array.isArray(e)&&e.length){bn.reason=null,Ze(e);return}if(be()){let o=x().view==="shows"?"series":"movies",s=wt(o),a=(n=(t=s==null?void 0:s.snapshot)==null?void 0:t.status)==null?void 0:n[o],c=kr(),l=a==null?void 0:a.regenerating,u=Array.isArray(s==null?void 0:s.items)?s.items:[],d=(i=(r=s==null?void 0:s.snapshot)==null?void 0:r.tmdb)==null?void 0:i.rateLimit,h=!!(d!=null&&d.active),f=(a==null?void 0:a.state)==="error";if(!u.length&&(f||h&&c&&!l)){let m=f?"error":"rate-limit";Hl(m)&&Ap(m,{status:a,rateLimit:d});return}if(c&&!l&&u.length){let m=s.startIndex%u.length,p=u[m];if(p){bn.reason=null,Ze([p]);return}}}bn.reason=null,Ze(e)}function Ht(e,t=!0){let n=document.getElementById("footerMeta");if(n){let i=n.querySelector("#footerStatus");i?i.textContent=e:n.textContent=e,n.dataset.state=t?"loading":"ready"}let r=document.getElementById("grid");r&&r.setAttribute("aria-busy",t?"true":"false")}async function _p(){let e=!!globalThis.__PLEX_TEST_MODE__;Dt(),Ip(),Co(),Ht("Initialisiere \u2026",!0),De("Initialisiere \u2026",8),Io(18);let t=fetch("config.json").then(a=>a.json()).catch(a=>(Q("Konfiguration konnte nicht geladen werden","Verwende Standardeinstellungen"),{startView:"movies",tmdbEnabled:!1})),n=fc().catch(a=>kt()),[r,i]=await Promise.all([t,n]);vp(r),ht(r);let o=pl({cfg:r,policy:i});$e({cfg:r,view:r.startView||"movies",heroPolicy:i,heroPolicyIssues:sr(),heroPipelineEnabled:o.enabled,heroPipelineSource:o.source});try{Ht("Filme laden \u2026",!0),De("Filme laden \u2026",25);let a=await In();Ht("Serien laden \u2026",!0),De("Serien laden \u2026",45);let c=await xn();Ht("Filter vorbereiten \u2026",!0),De("Filter vorbereiten \u2026",60);let l=Di(a,c);if($e({movies:a,shows:c,facets:l}),bl({movies:a,shows:c}),Ar(x().view),be()){Ht("Highlights vorbereiten \u2026",!0),De("Highlights vorbereiten \u2026",70);try{await yl()}catch{}}Ht("Ansicht aufbauen \u2026",!0),De("Ansicht aufbauen \u2026",85),$r(),_o(),Oi(l),ji();let u=vt();if(Tp(!0),te(x().view),Cp(),An(),r.tmdbEnabled&&(window.requestIdleCallback?window.requestIdleCallback(()=>{var d;return(d=ir)==null?void 0:d(a,c,r)},{timeout:600}):setTimeout(()=>{var d;return(d=ir)==null?void 0:d(a,c,r)},400)),!e)es(),xl(r),xp(),Lp(),Fp(),Pp(),Rp(),Te(u),Dl({onRefresh:Te}),_l();else try{Te(u)}catch{}Kl(!0)}catch(a){throw An(),$r(),Mr("Fehler beim Laden der Daten",()=>window.location.reload()),a}let s;window.addEventListener("tmdb:chunk",()=>{s||(s=requestAnimationFrame(()=>{s=null;try{localStorage.getItem("useTmdb")==="1"&&te(x().view),Te()}catch{}}))}),window.addEventListener("tmdb:done",()=>{try{localStorage.getItem("useTmdb")==="1"&&te(x().view),Te()}catch{}})}function kp(e){if(/^#\/(movies|shows)$/.test(e)){let s=e.includes("shows")?"shows":"movies";$e({view:s}),Ar(s),co(s==="shows"?"series":"movies").catch(c=>{});let a=vt();return _o(),te(s),Te(a),!0}let t=e.match(/^#\/(movie|show)\/(.+)/);if(!t)return!1;let[,n,r]=t,o=((n==="movie"?x().movies:x().shows)||[]).find(s=>{var a,c;return((a=s==null?void 0:s.ids)==null?void 0:a.imdb)===r||((c=s==null?void 0:s.ids)==null?void 0:c.tmdb)===r||String(s==null?void 0:s.ratingKey)===r});return o?(n==="show"?Et(o):St(o),!0):!1}function Kl(e=!1){let t=window.location.hash||"";!e&&!Ao.shouldHandle(t)||(e&&Ao.markProcessed(t),kp(t))}function _o(){let e=document.getElementById("libraryTabs");if(!e)return;let t=Array.from(e.querySelectorAll("[data-lib]")),n=x().view==="shows"?"shows":"movies";t.forEach(r=>{let i=r.dataset.lib==="series"?"shows":"movies",o=n===i;r.classList.toggle("is-active",o),r.setAttribute("aria-pressed",o?"true":"false"),r.dataset.bound!=="true"&&(r.addEventListener("click",()=>{let s=r.dataset.lib==="series"?"shows":"movies";if(x().view===s)return;if($e({view:s}),Ar(s),be()){let l=co(s==="shows"?"series":"movies");l&&typeof l.catch=="function"&&l.catch(u=>{})}nr(s==="movies"?"#/movies":"#/shows",{silent:!0}),_o();let c=vt();te(s),Te(c)}),r.dataset.bound="true")})}function Tp(e=!1){let t=document.getElementById("heroStats");if(!t)return;let n=x(),r=(n.movies||[]).length,i=(n.shows||[]).length,o=t.querySelector('[data-stat="movies"]'),s=t.querySelector('[data-stat="shows"]');!o||!s||(e?(jl(o,r),jl(s,i)):(o.textContent=String(r),s.textContent=String(i)))}function jl(e,t){if(!e)return;let n=Number(e.textContent)||0,r=Number(t)||0;if(n===r){e.textContent=String(r);return}let i=480,o=performance.now();function s(a){let c=Math.min(1,(a-o)/i),l=Math.round(n+(r-n)*(c<.5?2*c*c:-1+(4-2*c)*c));e.textContent=String(l),c<1?requestAnimationFrame(s):e.textContent=String(r)}requestAnimationFrame(s)}function Cp(){let e=document.getElementById("footerMeta");if(!e)return;let t=document.getElementById("footerStatus"),n=x(),r=n.movies||[],i=n.shows||[],o=r.concat(i).map(l=>new Date(l.addedAt||0).getTime()).filter(Number.isFinite),a=(o.length?new Date(Math.max(...o)):new Date).toISOString().slice(0,10);t&&(t.textContent=`Stand: ${a}`),e.dataset.state="ready";let c=document.getElementById("grid");c&&c.setAttribute("aria-busy","false")}function ko(e){var t,n;try{let r=document.body;r?((t=document.documentElement)==null||t.classList.remove("reduce-motion","reduced-motion"),r.classList.remove("reduced-motion"),r.classList.toggle("reduce-motion",e)):((n=document.documentElement)==null||n.classList.toggle("reduce-motion",e),window.addEventListener("DOMContentLoaded",()=>ko(e),{once:!0}))}catch{}}function Ip(){try{let e=localStorage.getItem("prefReduceMotion")==="1";ko(e)}catch{}}function xp(){let e=document.getElementById("toggleAdvanced"),t=document.getElementById("advancedFilters");if(!e||!t)return;let n=!1,r=0,i=()=>{n=!1,r&&(clearTimeout(r),r=0),t.dataset.state==="closing"?(t.dataset.state="closed",t.hidden=!0,t.style.removeProperty("--advanced-max")):t.dataset.state==="open"?t.style.removeProperty("--advanced-max"):t.dataset.state==="expanding"&&(t.dataset.state="open",t.style.removeProperty("--advanced-max"))},o=()=>{r&&clearTimeout(r),r=window.setTimeout(i,320)};t.addEventListener("transitionend",c=>{c.target!==t||c.propertyName!=="max-height"||i()});let s=()=>{n||(n=!0,t.hidden=!1,t.dataset.state="expanding",t.setAttribute("aria-hidden","false"),t.style.setProperty("--advanced-max","0px"),requestAnimationFrame(()=>{let c=t.scrollHeight;t.style.setProperty("--advanced-max",c+"px"),t.dataset.state="open",o()}))},a=()=>{if(n)return;n=!0;let c=t.scrollHeight;t.style.setProperty("--advanced-max",c+"px"),t.dataset.state="closing",t.setAttribute("aria-hidden","true"),requestAnimationFrame(()=>{t.style.setProperty("--advanced-max","0px"),o()})};e.addEventListener("click",()=>{e.getAttribute("aria-expanded")==="true"?(e.setAttribute("aria-expanded","false"),a()):(e.setAttribute("aria-expanded","true"),s())})}function Lp(){let e=document.getElementById("siteLogo");e&&e.addEventListener("error",()=>{e.classList.add("logo-missing");let o=document.querySelector(".site-header__brand-text .site-header__label");o&&o.classList.remove("sr-only")});let t=document.getElementById("heroTagline"),n=["Curated spotlights and smart filters for every mood.","Bring Plex highlights on the road with offline browsing.","Plan your next movie night with shareable watchlists."],r=0;t&&!t.textContent&&(t.textContent=n[r]);function i(){!t||t.dataset.taglinePaused==="1"||(t.classList.add("is-fading"),setTimeout(()=>{if(!t||t.dataset.taglinePaused==="1"){t&&t.classList.remove("is-fading");return}r=(r+1)%n.length,t.textContent=n[r],t.classList.remove("is-fading")},280))}t?(t.dataset.taglinePaused=t.dataset.taglinePaused==="1"?"1":"0",Nt&&clearInterval(Nt),Nt=setInterval(i,6e3),setTimeout(i,3e3)):Nt&&(clearInterval(Nt),Nt=null)}function Fp(){let e=document.getElementById("scrollProgress");if(!e)return;let t=()=>{let n=document.documentElement.scrollTop||document.body.scrollTop||0,r=document.documentElement.scrollHeight-document.documentElement.clientHeight||1,i=Math.max(0,Math.min(100,n/r*100));e.style.width=i+"%"};addEventListener("scroll",t,{passive:!0}),t()}function Pp(){let e=document.getElementById("scrollTop");if(!e)return;let t=()=>{let n=window.scrollY||0;e.style.display=n>300?"block":"none"};addEventListener("scroll",t,{passive:!0}),t(),e.addEventListener("click",()=>window.scrollTo({top:0,behavior:"smooth"}))}function Rp(){let e=document.querySelector(".filters");if(!e||typeof CSS!="undefined"&&typeof CSS.supports=="function"&&CSS.supports("animation-timeline: scroll()"))return;let n=window.scrollY||window.pageYOffset||0,r=!1,i=!1,o=120,s=8,a=d=>{r!==d&&(r=d,e.classList.toggle("is-hidden",r))},c=()=>{i=!1;let d=window.scrollY||window.pageYOffset||0;if(d<=o){a(!1),n=d;return}let h=d-n;n=d,h>s?a(!0):h<-s&&a(!1)},l=()=>{i||(i=!0,requestAnimationFrame(c))};window.addEventListener("scroll",l,{passive:!0}),window.addEventListener("resize",c);let u=()=>a(!1);e.addEventListener("focusin",u),e.addEventListener("pointerenter",u,{passive:!0}),e.addEventListener("pointerdown",u,{passive:!0}),c()}var Ep,xr,Nt,bn,zl,Ao,nr,vo,rc=I(()=>{ie();xo();Ot();Mi();tr();Yn();Ye();Qr();kl();kn();Ll();Eo();Ol();ar();pn();mt();Ep={tmdbEnrichment:!1},xr=(()=>{let e=typeof window!="undefined"&&window.FEATURES?window.FEATURES:{},t={...Ep,...e};return typeof window!="undefined"&&(window.FEATURES=t),t})();Nt=null,bn={reason:null},zl={"rate-limit":()=>Q("TMDb drosselt Anfragen","Highlights werden kurzzeitig langsamer aktualisiert."),error:e=>{var t;return Q("Highlights vor\xFCbergehend nicht verf\xFCgbar",((t=e==null?void 0:e.status)==null?void 0:t.lastError)||"TMDb-Daten konnten nicht geladen werden.")},default:()=>Q("Highlights vor\xFCbergehend nicht verf\xFCgbar","TMDb-Daten konnten nicht geladen werden.")};Ao=(()=>{let e=window.location.hash||"",t=null;function n(s){if(typeof s!="string")return"";let a=s.trim();return a?a.startsWith("#")?a:`#${a}`:""}function r(s,a={}){let{replace:c=!1,silent:l=!1}=a,u=n(s);if(!u)return;let d=window.location.hash||"";if(u===d){if(c&&history&&typeof history.replaceState=="function")try{history.replaceState(null,"",u)}catch{}l&&(t=u,e=u);return}let h=c?"replaceState":"pushState",f=!1;try{history&&typeof history[h]=="function"&&(history[h](null,"",u),f=!0)}catch{}if(!f){window.location.hash=u,l&&(t=u,e=u);return}if(l){t=u,e=u;return}try{let g=typeof HashChangeEvent=="function"?new HashChangeEvent("hashchange"):new Event("hashchange");window.dispatchEvent(g)}catch{}}function i(s){let a=typeof s=="string"?s:"";return t&&a===t?(t=null,!1):(t=null,a===e?!1:(e=a,!0))}function o(s){e=typeof s=="string"?s:"",t=null}return{navigate:r,shouldHandle:i,markProcessed:o}})(),nr=(e,t)=>Ao.navigate(e,t);Nl(nr);vo=null;window.addEventListener("hashchange",()=>{vo&&clearTimeout(vo),vo=setTimeout(()=>{Kl(!1)},50)});zi(e=>{try{Te(e)}catch{}});Cl(e=>{try{Te(e)}catch{}});Il(e=>{try{ko(!!e)}catch{}});globalThis.__PLEX_TEST_MODE__||_p();window.addEventListener("load",()=>{try{An()}catch{}})});rc();export{_p as boot,nr as navigateToHash};
//# sourceMappingURL=main.js.map
