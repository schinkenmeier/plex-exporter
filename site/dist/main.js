var qr=Object.defineProperty;var k=(e,t)=>()=>(e&&(t=e(e=0)),t);var Ce=(e,t)=>{for(var n in t)qr(e,n,{get:t[n],enumerable:!0})};function te(e){Object.assign(ot,e),Gr.forEach(t=>t(ot))}var ot,Gr,S,K=k(()=>{ot={view:"movies",movies:[],shows:[],facets:{},filtered:[],cfg:{}},Gr=new Set,S=()=>ot});function T(e,t,n){let r=document.createElement(e);return t&&(r.className=t),n!=null&&(r.textContent=n),r}var I,Ne=k(()=>{I=(e,t=document)=>t.querySelector(e)});function st(){if(!q&&(q=I("#loaderOverlay"),!q)){q=T("div","loader-overlay"),q.id="loaderOverlay",q.hidden=!0;let e=T("div","loader");Be=T("div","msg",""),_e=T("div","bar"),e.append(Be,_e),q.append(e),document.body.append(q)}}function sn(){st(),q.hidden=!1}function ce(e,t){st(),Be&&(Be.textContent=e||""),_e&&(_e.style.width=(t||0)+"%")}function $e(){st(),q.hidden=!0}function an(e=18){let t=I("#grid");if(t){W=T("div","skeleton");for(let n=0;n<e;n++)W.append(T("div","skel"));t.replaceChildren(W)}}function at(){W&&W.parentElement&&W.parentElement.removeChild(W),W=null}var q,_e,Be,W,ln=k(()=>{Ne()});function cn(e,t,n=864e5){try{let r=ne+e,o={value:t,timestamp:Date.now(),ttl:n};localStorage.setItem(r,JSON.stringify(o)),Vr()}catch(r){if(r.name==="QuotaExceededError"){fn();try{let o=ne+e,s={value:t,timestamp:Date.now(),ttl:n};localStorage.setItem(o,JSON.stringify(s))}catch{}}}}function dn(e){try{let t=ne+e,n=localStorage.getItem(t);if(!n)return null;let r=JSON.parse(n);if(typeof r.timestamp!="number"||typeof r.ttl!="number")return localStorage.removeItem(t),null;let o=Date.now();return r.timestamp+r.ttl<o?(localStorage.removeItem(t),null):r.value}catch{return null}}function un(){try{Object.keys(localStorage).forEach(t=>{t.startsWith(ne)&&localStorage.removeItem(t)})}catch{}}function Pe(){try{let e=Object.keys(localStorage),t=Date.now(),n=0;e.forEach(r=>{if(r.startsWith(ne))try{let o=JSON.parse(localStorage.getItem(r));o.timestamp+o.ttl<t&&(localStorage.removeItem(r),n++)}catch{localStorage.removeItem(r),n++}}),n>0}catch{}}function it(){try{let t=Object.keys(localStorage).filter(a=>a.startsWith(ne)),n=Date.now(),r=0,o=0,s=0;return t.forEach(a=>{let i=localStorage.getItem(a);r+=i.length*2;try{let l=JSON.parse(i);l.timestamp+l.ttl>=n?o++:s++}catch{s++}}),{totalEntries:t.length,validEntries:o,expiredEntries:s,totalSize:r,totalSizeMB:(r/1024/1024).toFixed(2)}}catch{return null}}function Vr(){try{let e=it();e&&e.totalSize>5242880&&fn(.3)}catch{}}function fn(e=.3){try{let t=Object.keys(localStorage),n=[];t.forEach(o=>{if(o.startsWith(ne))try{let s=JSON.parse(localStorage.getItem(o));n.push({key:o,timestamp:s.timestamp})}catch{n.push({key:o,timestamp:0})}}),n.sort((o,s)=>o.timestamp-s.timestamp);let r=Math.ceil(n.length*e);for(let o=0;o<r;o++)localStorage.removeItem(n[o].key)}catch{}}var ne,Ur,lt=k(()=>{ne="plex_cache_";Ur=null;typeof window!="undefined"&&typeof window.document!="undefined"&&window===globalThis&&(Pe(),Ur=setInterval(Pe,5*60*1e3))});function de(e){return e!==null&&typeof e=="object"&&!Array.isArray(e)}function to(e,t){switch(t){case"string":return typeof e=="string";case"number":return typeof e=="number"&&Number.isFinite(e);case"boolean":return typeof e=="boolean";case"array":return Array.isArray(e);case"object":return de(e);default:return!1}}function ct(e,t,n="value"){if(!t)return;if(e==null){if(t.nullable)return;throw new Error(`${n} darf nicht null oder undefined sein.`)}let r=Array.isArray(t.type)?t.type:[t.type];if(r&&r.length&&!r.some(s=>to(e,s))){let s=r.join(" oder ");throw new Error(`${n} erwartet Typ ${s}, erhielt ${typeof e}.`)}if(r.includes("array")){if(!Array.isArray(e))throw new Error(`${n} erwartet eine Liste.`);t.items&&e.forEach((o,s)=>{n.includes(".genres")||n.includes("List")&&t.items.type&&Array.isArray(t.items.type)&&t.items.type.includes("string")&&t.items.type.includes("object")||ct(o,t.items,`${n}[${s}]`)});return}if(r.includes("object")){if(!de(e))throw new Error(`${n} erwartet ein Objekt.`);let o=t.required||[];for(let a of o){let i=e[a];if(i==null||typeof i=="string"&&!i.trim())throw new Error(`${n}.${a} ist ein Pflichtfeld.`)}let s=t.properties||{};for(let[a,i]of Object.entries(s))e[a]!=null&&ct(e[a],i,`${n}.${a}`)}}function hn(e){return Array.isArray(e)?e.map(t=>typeof t=="string"?t.trim():t&&typeof t=="object"&&typeof t.tag=="string"?t.tag.trim():null).filter(t=>t&&t.length>0):[]}function gn(e,t){let n={...e};for(let[r,o]of Object.entries(t))n[r]==null?n[r]=Array.isArray(o)?[...o]:o:Array.isArray(o)&&(n[r]=Array.isArray(n[r])?[...n[r]]:[...o]);return n}function pn(e){if(!de(e)||typeof e.title!="string"||!e.title.trim())return!1;let t=e.ratingKey;return typeof t=="string"||typeof t=="number"}function no(e){return pn(e)?e.seasons==null?!0:Array.isArray(e.seasons)?e.seasons.every(t=>de(t)):!1:!1}function ro(e){let t=gn(e,Xr);t.title=t.title.trim(),t.ratingKey=String(e.ratingKey).trim();let n=typeof t.thumb=="string"?t.thumb:"",r=typeof t.thumbFile=="string"?t.thumbFile:"";return t.thumb=n,t.thumbFile=r||n,t.summary=typeof t.summary=="string"?t.summary:"",t.href=typeof t.href=="string"?t.href:"",t.tagline=typeof t.tagline=="string"?t.tagline:"",t.genres=hn(t.genres),t}function oo(e){let t=gn(e,Wr);t.title=t.title.trim(),t.ratingKey=String(e.ratingKey).trim();let n=typeof t.thumb=="string"?t.thumb:"",r=typeof t.thumbFile=="string"?t.thumbFile:"";return t.thumb=n,t.thumbFile=r||n,t.summary=typeof t.summary=="string"?t.summary:"",t.href=typeof t.href=="string"?t.href:"",t.tagline=typeof t.tagline=="string"?t.tagline:"",t.genres=hn(t.genres),Array.isArray(e.seasons)?t.seasons=e.seasons.filter(de).map(o=>{let s={...o};return s.episodes=Array.isArray(o.episodes)?o.episodes.filter(de).map(a=>({...a})):[],typeof s.thumb!="string"&&(s.thumb=""),typeof s.thumbFile!="string"&&(s.thumbFile=""),s}):t.seasons=[],t}function dt(e,t="movie"){if(ct(e,t==="show"?eo:Qr,`${t}List`),!Array.isArray(e))throw new Error("Datensatz ist keine Liste.");let r=t==="show"?no:pn,o=t==="show"?oo:ro;return e.map((s,a)=>{if(!r(s))throw new Error(`Ung\xFCltiger ${t}-Eintrag an Index ${a}.`);return o(s)})}var Xr,Wr,Jr,Yr,Zr,Qr,eo,mn=k(()=>{Xr=Object.freeze({thumb:"",thumbFile:"",summary:"",href:"",tagline:"",genres:[]}),Wr=Object.freeze({thumb:"",thumbFile:"",summary:"",href:"",tagline:"",genres:[],seasons:[]}),Jr=Object.freeze({type:"object",required:["title","ratingKey"],properties:{title:{type:"string"},ratingKey:{type:["string","number"]},thumb:{type:"string",nullable:!0},thumbFile:{type:"string",nullable:!0},summary:{type:"string",nullable:!0},href:{type:"string",nullable:!0},tagline:{type:"string",nullable:!0},genres:{type:"array",items:{type:["string","object"]},nullable:!0}}}),Yr=Object.freeze({type:"object",properties:{episodes:{type:"array",items:{type:"object"},nullable:!0},thumb:{type:"string",nullable:!0},thumbFile:{type:"string",nullable:!0}}}),Zr=Object.freeze({type:"object",required:["title","ratingKey"],properties:{title:{type:"string"},ratingKey:{type:["string","number"]},thumb:{type:"string",nullable:!0},thumbFile:{type:"string",nullable:!0},summary:{type:"string",nullable:!0},href:{type:"string",nullable:!0},tagline:{type:"string",nullable:!0},genres:{type:"array",items:{type:["string","object"]},nullable:!0},seasons:{type:"array",items:Yr,nullable:!0}}}),Qr=Object.freeze({type:"array",items:Jr}),eo=Object.freeze({type:"array",items:Zr})});var bn={};Ce(bn,{clearErrors:()=>ao,initErrorHandler:()=>Te,showError:()=>ue,showRetryableError:()=>ft,withErrorHandling:()=>so});function Te(){P||(P=document.createElement("div"),P.id="errorContainer",P.className="error-container",P.setAttribute("role","alert"),P.setAttribute("aria-live","polite"),document.body.appendChild(P)),window.addEventListener("unhandledrejection",e=>{var t;ue("Ein unerwarteter Fehler ist aufgetreten",(t=e.reason)==null?void 0:t.message),e.preventDefault()}),window.addEventListener("error",e=>{var t;ue("Ein Fehler ist aufgetreten",(t=e.error)==null?void 0:t.message)})}function ue(e,t="",n=5e3){P||Te();let r=document.createElement("div");return r.className="error-toast",r.innerHTML=`
    <div class="error-toast-content">
      <div class="error-toast-icon">\u26A0\uFE0F</div>
      <div class="error-toast-text">
        <div class="error-toast-title">${ut(e)}</div>
        ${t?`<div class="error-toast-message">${ut(t)}</div>`:""}
      </div>
      <button class="error-toast-close" aria-label="Schlie\xDFen">\xD7</button>
    </div>
  `,r.querySelector(".error-toast-close").addEventListener("click",()=>{r.classList.add("error-toast-exit"),setTimeout(()=>r.remove(),300)}),P.appendChild(r),n>0&&setTimeout(()=>{r.parentNode&&(r.classList.add("error-toast-exit"),setTimeout(()=>r.remove(),300))},n),requestAnimationFrame(()=>{r.classList.add("error-toast-show")}),r}function so(e,t="Ein Fehler ist aufgetreten"){return async(...n)=>{try{return await e(...n)}catch(r){throw ue(t,r.message),r}}}function ft(e,t){P||Te();let n=document.createElement("div");n.className="error-toast error-toast-retryable",n.innerHTML=`
    <div class="error-toast-content">
      <div class="error-toast-icon">\u26A0\uFE0F</div>
      <div class="error-toast-text">
        <div class="error-toast-title">${ut(e)}</div>
      </div>
      <button class="error-toast-retry">Erneut versuchen</button>
      <button class="error-toast-close" aria-label="Schlie\xDFen">\xD7</button>
    </div>
  `;let r=n.querySelector(".error-toast-retry"),o=n.querySelector(".error-toast-close");return r.addEventListener("click",async()=>{n.remove();try{await t()}catch{}}),o.addEventListener("click",()=>{n.classList.add("error-toast-exit"),setTimeout(()=>n.remove(),300)}),P.appendChild(n),requestAnimationFrame(()=>{n.classList.add("error-toast-show")}),n}function ao(){P&&(P.innerHTML="")}function ut(e){let t=document.createElement("div");return t.textContent=e,t.innerHTML}var P,ht=k(()=>{P=null});async function gt(e,t=2,n=!0){if(n){let a=dn(e);if(a!==null)return a}let r=null;for(let a=0;a<=t;a++){try{let i=await fetch(e,{cache:"no-store"});if(i&&i.ok){let l=await i.json();return n&&l&&cn(e,l,io),l}if(i&&i.status===404)return null;r=new Error(`HTTP ${i.status}: ${i.statusText}`)}catch(i){r=i}if(a<t){let i=Math.min(1e3*Math.pow(2,a),5e3);await new Promise(l=>setTimeout(l,i))}}let o=(r==null?void 0:r.message)||"Unbekannter Fehler",s=new Error(`Daten konnten nicht geladen werden: ${e} (${o})`);throw r&&typeof r=="object"&&(s.cause=r),s}function ho(e){try{let t=document.getElementById(e);if(t&&t.textContent)return JSON.parse(t.textContent)}catch{}return null}function go(e){try{let t=lo;return(t&&Array.isArray(t[e])?t[e]:null)||null}catch{return null}}function po(e){try{return(Array.isArray(window[e])?window[e]:null)||null}catch{return null}}async function wn(e,t){let n=null;try{n=await gt(e)}catch{n=null}if(Array.isArray(n)&&n.length)return fe(t==null?void 0:t.label,`primary:${e}`),n;if(t!=null&&t.embedId){let r=ho(t.embedId);if(Array.isArray(r)&&r.length)return fe(t==null?void 0:t.label,`embedded:${t.embedId}`),r}if(t!=null&&t.exportKey){let r=go(t.exportKey);if(Array.isArray(r)&&r.length)return fe(t==null?void 0:t.label,`globalBag:${t.exportKey}`),r}if(t!=null&&t.globalVar){let r=po(t.globalVar);if(Array.isArray(r)&&r.length)return fe(t==null?void 0:t.label,`window:${t.globalVar}`),r}for(let r of(t==null?void 0:t.altUrls)||[]){let o=null;try{o=await gt(r)}catch{o=null}if(Array.isArray(o)&&o.length)return fe(t==null?void 0:t.label,`alt:${r}`),o}return fe(t==null?void 0:t.label,"empty"),Array.isArray(n)?n:[]}function pt(e,t){typeof window=="undefined"||typeof document=="undefined"||typeof document.createElement!="function"||Promise.resolve().then(()=>(ht(),bn)).then(n=>{var r;try{(r=n.showError)==null||r.call(n,e,t,8e3)}catch{}}).catch(n=>{})}function mo(e,t){let n=e==null?"":String(e).trim();if(!n)return"";if(n.startsWith("//")||n.startsWith("/")||fo.test(n))return n;let r=n.replace(/\\/g,"/"),o=t?t.endsWith("/")?t:`${t}/`:"",s=!1,a=p=>p.split("/").map(h=>{if(!h)return"";try{return encodeURIComponent(decodeURIComponent(h))}catch{return s||(s=!0),encodeURIComponent(h)}}).join("/"),l=r.replace(/^\/+/,"").split("/"),d=[];for(let p of l)if(!(!p||p===".")){if(p===".."){d.length&&d.pop();continue}d.push(p)}let c=d.join("/");if(c.startsWith("data/"))return a(c);let u=d;if(o&&u.length){let p=o.replace(/\/+$/,"").split("/").pop();p&&u[0]===p&&(u=u.slice(1))}let m=u.join("/"),f=a(m);return`${o}${f}`}function En(e,t){var o,s;if(!e||typeof e!="object")return e;let n=(s=(o=e.thumbFile)!=null?o:e.thumb)!=null?s:"",r=mo(n,t);if(r)e.thumbFile=r,e.thumb=r;else if(n){let a=String(n);e.thumbFile=a,e.thumb==null&&(e.thumb=a)}return e}function bo(e){return En(e,co)}function D(e){return En(e,uo)}function Sn(e){return!e||typeof e!="object"||(D(e),Array.isArray(e.seasons)&&e.seasons.forEach(An)),e}function An(e){return!e||typeof e!="object"||(D(e),Array.isArray(e.episodes)&&e.episodes.forEach(t=>D(t))),e}function yo(e){return Array.isArray(e)?(e.forEach(t=>{t&&typeof t=="object"&&bo(t)}),e):[]}function vo(e){return Array.isArray(e)?(e.forEach(t=>{t&&typeof t=="object"&&Sn(t)}),e):[]}async function kn(){try{let e=await wn("data/movies/movies.json",{label:"movies",embedId:"movies-json",exportKey:"movies",globalVar:"__PLEX_MOVIES__",altUrls:["movies/movies.json","data/movies.json","Filme/movies.json","movies.json"]}),t;try{t=dt(e,"movie")}catch(n){let r=(n==null?void 0:n.message)||"Unbekannte Validierungsfehler",o=new Error(`Ung\xFCltige Filmdaten: ${r}`);throw n instanceof Error&&(o.cause=n),o}return yo(t)}catch(e){return pt("Filme konnten nicht geladen werden",(e==null?void 0:e.message)||"Unbekannter Fehler"),[]}}async function Cn(){try{let e=await wn("data/series/series_index.json",{label:"shows",embedId:"series-json",exportKey:"shows",globalVar:"__PLEX_SHOWS__",altUrls:["series/series_index.json","data/shows.json","data/series.json","Serien/series.json","series/series.json","series.json","shows.json"]}),t;try{t=dt(e,"show")}catch(n){let r=(n==null?void 0:n.message)||"Unbekannte Validierungsfehler",o=new Error(`Ung\xFCltige Seriendaten: ${r}`);throw n instanceof Error&&(o.cause=n),o}return vo(t)}catch(e){return pt("Serien konnten nicht geladen werden",(e==null?void 0:e.message)||"Unbekannter Fehler"),[]}}async function Tn(e){if(!e)return null;let t=wo(e),n=Eo(t);if(n!==void 0)return n;let r=So(e),o=null;for(let s of r)try{let a=await gt(s);if(a&&typeof a=="object"){let i=Ao(a);return yn(t,i,e),Fn(i)}}catch(a){o=a}return o&&pt("Details konnten nicht geladen werden",(o==null?void 0:o.message)||"Bitte sp\xE4ter erneut versuchen."),yn(t,null,e),null}function fe(e,t){if(e)try{vn[e]=t}catch{}}function xn(){return{...vn}}function wo(e){let t=[];(e==null?void 0:e.ratingKey)!==void 0&&(e==null?void 0:e.ratingKey)!==null&&(e==null?void 0:e.ratingKey)!==""&&t.push(`rk:${String(e.ratingKey)}`);let n=Re(e==null?void 0:e.href);return n&&t.push(`href:${n}`),t}function Re(e){return e?String(e).trim().replace(/^\.\//,"").replace(/^\/+/,""):""}function Eo(e){for(let t of e)if(re.has(t)){let n=re.get(t);return n?Fn(n):null}}function yn(e,t,n){let r=t;e.forEach(l=>{re.set(l,r)});let o=n==null?void 0:n.ratingKey;o!=null&&re.set(`rk:${String(o)}`,r);let s=t&&typeof t=="object"?t.ratingKey:void 0;s!=null&&re.set(`rk:${String(s)}`,r);let a=Re(n==null?void 0:n.href);a&&re.set(`href:${a}`,r);let i=t&&typeof t=="object"?Re(t.href):"";i&&re.set(`href:${i}`,r)}function So(e){let t=new Set,n=Re(e==null?void 0:e.href);if(n)if(/^https?:/i.test(n))t.add(n);else{n.startsWith("data/")?t.add(n):t.add(`data/${n}`);let o=n.replace(/^data\//,"");o.startsWith("series/")||t.add(`data/series/${o}`);let s=o.replace(/^series\//,"").replace(/^details\//,"").replace(/\.json$/,"");s&&t.add(`data/series/details/${s}.json`)}let r=e==null?void 0:e.ratingKey;return r!=null&&t.add(`data/series/details/${String(r)}.json`),Array.from(t)}function Ao(e){if(!e||typeof e!="object")return null;let t={...e};D(t),t.genres=mt(t.genres);let n=To(t.cast||t.roles||[]);return t.cast=n,t.roles=n,t.seasons=Array.isArray(t.seasons)?t.seasons.map(ko).filter(Boolean):[],t.seasonCount=Number.isFinite(t.seasonCount)?t.seasonCount:t.seasons.length,Sn(t),t}function ko(e){if(!e||typeof e!="object")return null;let t={...e};return D(t),t.genres=mt(t.genres),t.episodes=Array.isArray(t.episodes)?t.episodes.map(Co).filter(Boolean):[],An(t),t}function Co(e){if(!e||typeof e!="object")return null;let t={...e};return D(t),t.genres=mt(t.genres),t}function mt(e){if(!Array.isArray(e))return[];let t=new Set,n=[];return e.forEach(r=>{let o=null;if(typeof r=="string"){let s=r.trim();s&&(o={tag:s})}else if(r&&typeof r=="object"){let s=String(r.tag||r.title||r.name||r.label||"").trim();s&&(o={...r,tag:s})}o&&!t.has(o.tag)&&(t.add(o.tag),n.push(o))}),n}function To(e){return Array.isArray(e)?e.map(t=>{if(!t)return null;if(typeof t=="string"){let n=t.trim();return n?{tag:n}:null}if(typeof t=="object"){let n=String(t.tag||t.name||t.role||"").trim();return n?{...t,tag:n}:{...t}}return null}).filter(Boolean):[]}function Fn(e){if(e==null)return e;try{return structuredClone(e)}catch{}try{return JSON.parse(JSON.stringify(e))}catch{}return e}var vn,re,io,He,lo,co,uo,fo,he=k(()=>{lt();mn();vn={movies:null,shows:null},re=new Map,io=1e3*60*30,He="__PLEX_EXPORTER__",lo=(()=>{try{if(typeof globalThis!="undefined"){if(globalThis[He])return globalThis[He];if(globalThis.window&&globalThis.window[He])return globalThis.window[He]}}catch{}return null})(),co="data/movies/",uo="data/series/",fo=/^[a-z][a-z0-9+.-]*:/i});function J(e){let t=new Set,n=[];return(e||[]).forEach(r=>{let o="";typeof r=="string"?o=r:r&&typeof r=="object"&&(o=r.tag||r.title||r.name||"");let s=String(o||"").trim();s&&!t.has(s)&&(t.add(s),n.push(s))}),n}function bt(e,t,n=3){if(!e)return;let r=(t||[]).filter(Boolean);if(r.length>n){let o=r.slice(0,n),s=r.slice(n),a=o.map(l=>Oe(l)),i=Oe(`+ ${s.length}`);i.classList.add("more","card__chip--more"),i.setAttribute("data-more",s.length),i.setAttribute("title",`${s.length} weitere Genres: ${s.join(", ")}`),i._extraChips=s.map(l=>Oe(l)),a.push(i),e.replaceChildren(...a)}else{let o=r.map(s=>Oe(s));e.replaceChildren(...o)}Fo(e)}function Fo(e=document){try{e.querySelectorAll(".chip.more, .card__chip--more").forEach(t=>{t.dataset.bound||(t.dataset.bound="1",t.addEventListener("click",n=>{n.stopPropagation();let r=t.closest(".card");if(r)r.click();else{let o=t._extraChips||[];try{o.forEach(s=>t.before(s))}catch{}t.remove()}}))})}catch{}}function ge(e){return(e&&e.collections||[]).map(t=>t&&(t.tag||t.title||t.name||"")).filter(Boolean)}function _(e){if(!e)return"";let t=[e.originallyAvailableAt,e.year,e.releaseDate,e.premiereDate];for(let n of t){if(n==null)continue;let r=String(n);if(!r)continue;let o=r.match(/\d{4}/);if(o)return o[0]}return""}function R(e){if(e instanceof Number)return R(e.valueOf());if(typeof e=="number")return Number.isFinite(e)?e.toFixed(1):"0.0";if(typeof e=="string"){let t=e.trim();if(!t)return"0.0";let n=Number(t);return Number.isFinite(n)?n.toFixed(1):"0.0"}return"0.0"}function Oe(e){let t=document.createElement("span");return t.className="chip",t.textContent=String(e||""),t}function pe(e){if(!(e!=null&&e.addedAt))return!1;let t=new Date(e.addedAt).getTime();if(!Number.isFinite(t))return!1;let n=S().cfg||{},r=Number(n.newDays||30);return Date.now()-t<=r*24*60*60*1e3}function Y(){try{return localStorage.getItem("useTmdb")==="1"}catch{return!1}}var oe=k(()=>{K()});function Io(){try{G=new Set(JSON.parse(localStorage.getItem(Mn)||"[]"))}catch{G=new Set}}function Nn(){try{localStorage.setItem(Mn,JSON.stringify(Array.from(G.values())))}catch{}}function vt(e){var r,o;if(!e)return"";let t=e.type==="tv"||e.libraryType==="show"?"show":"movie",n=((r=e.ids)==null?void 0:r.imdb)||((o=e.ids)==null?void 0:o.tmdb)||String(e.ratingKey||"");return n?`${t}:${n}`:""}function wt(e){return G.has(vt(e))}function Lo(){return G.size}function Et(e){let t=vt(e);if(!t)return;G.has(t)?G.delete(t):G.add(t),Nn(),St();let n=document.getElementById("watchlistPanel");n&&!n.hidden&&De()}function St(){let e=document.getElementById("watchlistCount");e&&(e.textContent=String(Lo()))}function In(){let e=document.getElementById("watchlistPanel");e&&(e.hidden=!1,e.setAttribute("aria-hidden","false"),De())}function Ln(){let e=document.getElementById("watchlistPanel");e&&(e.hidden=!0,e.setAttribute("aria-hidden","true")),yt(!1)}function Mo(){G.clear(),Nn(),St(),De()}function No(){let e=_n(),t=JSON.stringify(e,null,2),n=new Blob([t],{type:"application/json"}),r=document.createElement("a");r.href=URL.createObjectURL(n),r.download="watchlist.json",document.body.append(r),r.click(),r.remove(),setTimeout(()=>URL.revokeObjectURL(r.href),1e3)}function _n(){let e=S(),t=(e.movies||[]).concat(e.shows||[]),n=new Map(t.map(r=>[vt(r),r]));return Array.from(G.values()).map(r=>n.get(r)).filter(Boolean)}function De(){let e=document.getElementById("watchlistItems"),t=document.getElementById("watchlistEmpty");if(!e||!t)return;let n=_n();if(n.length===0){e.replaceChildren(),t.hidden=!1;return}t.hidden=!0;let r=document.createDocumentFragment();n.forEach(o=>{let s=document.createElement("li");s.className="watchlist-item";let a=document.createElement("span");a.className="title",a.textContent=o.title||"";let i=document.createElement("button");i.textContent="Entfernen",i.addEventListener("click",()=>{Et(o),De()});let l=document.createElement("button");l.textContent="\xD6ffnen",l.addEventListener("click",()=>{var u,m;let d=o.type==="tv"?"show":"movie",c=((u=o.ids)==null?void 0:u.imdb)||((m=o.ids)==null?void 0:m.tmdb)||String(o.ratingKey||"");c&&(location.hash=`#/${d}/${c}`)}),s.append(a,l,i),r.append(s)}),e.replaceChildren(r)}function Bn(){Io(),St();let e=document.getElementById("openWatchlist"),t=document.getElementById("watchlistToggle"),n=document.getElementById("closeWatchlist"),r=document.getElementById("clearWatchlist"),o=document.getElementById("exportWatchlist");e&&e.addEventListener("click",()=>{In(),yt(!0)}),t&&t.addEventListener("click",()=>{let s=document.getElementById("watchlistPanel");s&&!s.hidden?Ln():(In(),yt(!0))}),n&&n.addEventListener("click",()=>{Ln()}),r&&r.addEventListener("click",()=>{Mo()}),o&&o.addEventListener("click",()=>{No()})}function yt(e){let t=document.getElementById("watchlistToggle");t&&t.setAttribute("aria-expanded",e?"true":"false")}var Mn,G,At=k(()=>{K();Mn="watchlist:v1",G=new Set});function Pn(e){let t=e.querySelector(".v2-tabs");if(!t)return;let n=Array.from(t.querySelectorAll("button[data-t]")),r=a=>{n.forEach(i=>{let l=i.dataset.t===a;i.classList.toggle("active",l),i.setAttribute("aria-selected",l?"true":"false"),i.tabIndex=l?0:-1;let d=e.querySelector(`.v2-pane[data-pane="${i.dataset.t}"]`);d&&(d.hidden=!l,d.setAttribute("aria-hidden",d.hidden?"true":"false"))})},o=(a,i)=>{if(!n.length)return;let l=n.indexOf(a),d=i>0?0:n.length-1,c=l===-1?d:(l+i+n.length)%n.length,u=n[c];u&&(u.focus(),r(u.dataset.t))};t.addEventListener("click",a=>{let i=a.target.closest("button[data-t]");i&&(a.preventDefault(),r(i.dataset.t))}),t.addEventListener("keydown",a=>{let i=a.target.closest("button[data-t]");if(i)switch(a.key){case"ArrowLeft":case"ArrowUp":a.preventDefault(),o(i,-1);break;case"ArrowRight":case"ArrowDown":a.preventDefault(),o(i,1);break;case"Home":a.preventDefault(),n[0]&&(n[0].focus(),r(n[0].dataset.t));break;case"End":if(a.preventDefault(),n.length){let l=n[n.length-1];l.focus(),r(l.dataset.t)}break;default:break}});let s=n.find(a=>a.classList.contains("active"))||n[0];s&&r(s.dataset.t)}var Hn=k(()=>{});function _o(e){var r;let t=((r=e==null?void 0:e.tmdb)==null?void 0:r.poster)||(e==null?void 0:e.tmdbPoster),n=(e==null?void 0:e.poster)||(e==null?void 0:e.thumbFile)||(e==null?void 0:e.art)||"";return Y()&&t?t:n}function kt(e){let t=(e==null?void 0:e.runtimeMin)||(e==null?void 0:e.durationMin)||(e!=null&&e.duration?Math.round(Number(e.duration)/6e4):null);return Number.isFinite(t)?(e==null?void 0:e.type)==="tv"?`~${t} min/Ep`:`${t} min`:""}function Bo(e){var n;let t=Number((n=e==null?void 0:e.rating)!=null?n:e==null?void 0:e.audienceRating);return Number.isFinite(t)?`\u2605 ${R(t)}`:""}function Ct(e){return(e==null?void 0:e.studio)||(e==null?void 0:e.network)||(e==null?void 0:e.studioName)||""}function $o(e){let t=[];return pe(e)&&t.push("Neu"),(e==null?void 0:e.type)==="tv"&&Number.isFinite(Number(e==null?void 0:e.seasonCount))&&t.push(`Staffeln: ${e.seasonCount}`),((e==null?void 0:e.genres)||[]).map(r=>r?typeof r=="string"?r:r.tag||r.title||r.name||"":"").filter(Boolean).forEach(r=>t.push(r)),t}function On(e,t){let n=e.querySelector(".v2-title");n&&(n.textContent=(t==null?void 0:t.title)||(t==null?void 0:t.name)||"");let r=((t==null?void 0:t.tagline)||"").trim(),o=e.querySelector(".v2-meta"),s=e.querySelector(".v2-subline"),a=_(t),i=kt(t),l=Bo(t),d=Ct(t),c=[a,i,l,d].filter(Boolean);if(s){let h=c.join(" \u2022 ");s.textContent=r||h,s.hidden=!(r||h)}o&&(o.textContent=r&&c.length?c.join(" \u2022 "):"",o.hidden=!(r&&c.length));let u=e.querySelector(".v2-chips");u&&(u.replaceChildren(),$o(t).forEach(h=>{let g=document.createElement("span");g.className="chip",g.textContent=h,u.appendChild(g)}),u.hidden=!u.childElementCount);let m=e.querySelector(".v2-facts"),f=e.querySelector(".v2-facts-list");if(m&&f){let h=[];a&&h.push(["Jahr",a]);let g=((t==null?void 0:t.contentRating)||"").trim();g&&h.push(["Freigabe",g]),i&&h.push(["Laufzeit",i]),l&&h.push(["Bewertung",l]),d&&h.push(["Studio",d]),f.replaceChildren(),h.forEach(([w,C])=>{let M=document.createElement("dt");M.textContent=w;let ee=document.createElement("dd");ee.textContent=C,f.append(M,ee)}),m.hidden=!h.length}let p=e.querySelector(".v2-poster img");if(p){let h=_o(t);p.src=h||"",p.alt=t!=null&&t.title?`Poster: ${t.title}`:"",p.loading="lazy",p.decoding="async",p.classList.remove("is-ready"),h?(p.addEventListener("load",Rn,{once:!0}),p.addEventListener("error",Rn,{once:!0})):p.classList.add("is-ready")}}function Rn(e){var t;(t=e.currentTarget)==null||t.classList.add("is-ready")}var Tt=k(()=>{oe()});function Dn(e,t){let n=e.querySelector(".v2-overview");if(!n)return;let r=typeof t=="string"?t:"";if(!r){n.textContent="";return}let o=document.createElement("p");o.className="v2-overview-text line-clamp line-clamp-5",o.textContent=r;let s=document.createElement("button");s.type="button",s.className="v2-overview-toggle";let a=d=>{o.classList.toggle("is-expanded",d),s.setAttribute("aria-expanded",String(d)),s.textContent=d?"Weniger anzeigen":"Mehr anzeigen"};s.addEventListener("click",()=>{let d=s.getAttribute("aria-expanded")==="true";a(!d)}),n.replaceChildren(o,s),a(!1),(typeof requestAnimationFrame=="function"?requestAnimationFrame:d=>setTimeout(d,0))(()=>{o.scrollHeight>o.clientHeight+1||(o.classList.add("is-expanded"),s.hidden=!0)})}var jn=k(()=>{});function Po(e){let t=[e==null?void 0:e.originallyAvailableAt,e==null?void 0:e.releaseDate,e==null?void 0:e.premiereDate,e==null?void 0:e.firstAired,e==null?void 0:e.airDate];for(let r of t){let o=r==null?"":String(r).trim();if(!o)continue;let s=new Date(o);if(Number.isFinite(s.getTime()))try{return s.toLocaleDateString("de-DE",{year:"numeric",month:"2-digit",day:"2-digit"})}catch{}let a=o.match(/^\d{4}-\d{2}-\d{2}/);if(a&&a[0])return a[0];if(o.length>=4)return o.slice(0,10)}let n=_(e);return n?String(n):""}function se(e){return Array.isArray(e)?e.map(t=>t?typeof t=="string"?t:t.tag||t.title||t.name||"":"").filter(Boolean):[]}function Ho(e){let n=(Array.isArray(e==null?void 0:e.genres)?e.genres:[]).map(r=>r?typeof r=="string"?r:r.tag||r.title||r.name||"":"").filter(Boolean);return Array.from(new Set(n))}function je(e){if(e instanceof Number)return je(e.valueOf());if(typeof e=="number")return Number.isFinite(e)?R(e):"";if(typeof e=="string"){let t=e.trim();if(!t)return"";let n=Number(t);return Number.isFinite(n)?R(n):""}return""}function zn(e,t){let n=e.querySelector(".v2-details");if(!n)return;n.replaceChildren();let r=document.createElement("div");r.className="v2-details-grid";let o=[],s=Po(t);s&&o.push(["Ver\xF6ffentlichung",s]);let a=kt(t);a&&o.push(["Laufzeit",a]);let i=Ct(t);i&&o.push(["Studio",i]);let l=((t==null?void 0:t.contentRating)||"").trim();l&&o.push(["Freigabe",l]);let d=je(t==null?void 0:t.rating),c=je(t==null?void 0:t.audienceRating),u=je(t==null?void 0:t.userRating);if(d?(o.push(["Bewertung",`\u2605 ${d}`]),c&&c!==d&&o.push(["Publikum",`\u2605 ${c}`])):c&&o.push(["Bewertung",`\u2605 ${c}`]),u&&o.push(["Eigene Wertung",`\u2605 ${u}`]),(t==null?void 0:t.type)==="tv"){let x=Number(t==null?void 0:t.seasonCount),L=Number.isFinite(x)?x:Array.isArray(t==null?void 0:t.seasons)?t.seasons.length:null;Number.isFinite(L)&&L>0&&o.push(["Staffeln",String(L)]);let F=Array.isArray(t==null?void 0:t.seasons)?t.seasons.reduce(($,N)=>{if(!N)return $;let z=Array.isArray(N.episodes)?N.episodes.length:0;return $+(Number.isFinite(z)?z:0)},0):null;Number.isFinite(F)&&F>0&&o.push(["Episoden",String(F)])}let m=se(t==null?void 0:t.countries);m.length&&o.push(["L\xE4nder",m.join(", ")]);let f=se(t==null?void 0:t.collections);f.length&&o.push(["Sammlungen",f.join(", ")]);let p=se(t==null?void 0:t.labels);if(p.length&&o.push(["Labels",p.join(", ")]),t!=null&&t.editionTitle&&o.push(["Edition",t.editionTitle]),t!=null&&t.originalTitle&&t.originalTitle!==t.title&&o.push(["Originaltitel",t.originalTitle]),o.length){let x=document.createElement("section");x.className="v2-details-section",x.dataset.section="general";let L=document.createElement("h3");L.className="v2-details-heading",L.textContent="Allgemein";let F=document.createElement("dl");F.className="v2-details-list",o.forEach(([$,N])=>{if(!$||!N)return;let z=document.createElement("dt");z.textContent=$;let A=document.createElement("dd");A.textContent=N,F.append(z,A)}),F.childElementCount&&(x.append(L,F),r.append(x))}let h=Ho(t);if(h.length){let x=document.createElement("section");x.className="v2-details-section",x.dataset.section="genres";let L=document.createElement("h3");L.className="v2-details-heading",L.textContent="Genres";let F=document.createElement("div");F.className="v2-chip-group",h.forEach($=>{let N=document.createElement("span");N.className="chip",N.textContent=$,F.appendChild(N)}),x.append(L,F),r.append(x)}let g=[],w=se(t==null?void 0:t.directors);w.length&&g.push(["Regie",w.join(", ")]);let C=se(t==null?void 0:t.writers);C.length&&g.push(["Drehbuch",C.join(", ")]);let M=se(t==null?void 0:t.producers);M.length&&g.push(["Produktion",M.join(", ")]);let ee=se((t==null?void 0:t.creators)||(t==null?void 0:t.showrunners));if((t==null?void 0:t.type)==="tv"&&ee.length&&g.push(["Creator",ee.join(", ")]),g.length){let x=document.createElement("section");x.className="v2-details-section",x.dataset.section="crew";let L=document.createElement("h3");L.className="v2-details-heading",L.textContent="Credits";let F=document.createElement("dl");F.className="v2-details-list",g.forEach(([$,N])=>{if(!$||!N)return;let z=document.createElement("dt");z.textContent=$;let A=document.createElement("dd");A.textContent=N,F.append(z,A)}),F.childElementCount&&(x.append(L,F),r.append(x))}if(r.childElementCount)n.appendChild(r);else{let x=document.createElement("p");x.className="v2-details-empty",x.textContent="Keine zus\xE4tzlichen Details verf\xFCgbar.",n.appendChild(x)}}var Kn=k(()=>{oe();Tt()});function qn(e,t){let n=Ro(e,t);if(!n)return;let r=Array.isArray(e)&&!xt(e)?e||[]:Array.isArray(t)?t:[];n.replaceChildren(),(r||[]).forEach((o,s)=>n.append(Oo(o,s)))}function xt(e){return e instanceof Element||typeof e=="string"}function Ro(e,t){if(xt(e)){if(e instanceof Element)return e;if(typeof e=="string")return document.querySelector(e)}if(xt(t)){if(t instanceof Element)return t;if(typeof t=="string")return document.querySelector(t)}return document.getElementById("seasonsAccordion")}function Oo(e,t){D(e);let n=document.createElement("article");n.className="season-card";let r=document.createElement("div");r.className="season-head";let o=document.createElement("div");o.className="season-thumb";let s=new Image;s.loading="lazy",s.decoding="async",s.src=e.thumbFile||"",s.alt=e.title||`Staffel ${e.seasonNumber||t+1}`,o.append(s);let a=document.createElement("div"),i=document.createElement("div");i.className="season-title",i.textContent=e.title||`Staffel ${e.seasonNumber||t+1}`;let l=document.createElement("div");l.className="season-sub";let d=e.year||e.releaseYear||"",c=Array.isArray(e.episodes)?e.episodes.length:e.episodeCount||0;l.textContent=[d,c?`${c} Episoden`:""].filter(Boolean).join(" \u2022 "),a.append(i,l);let u=document.createElement("div");u.className="chev",u.textContent="\u203A",r.append(o,a,u);let m=document.createElement("div");return m.className="season-body",(e.episodes||[]).forEach(f=>{D(f),m.append(Do(f))}),r.addEventListener("click",()=>n.classList.toggle("open")),n.append(r,m),n}function Do(e){var m;let t=document.createElement("div");t.className="episode";let n=document.createElement("div");n.className="ep-title";let r=e.seasonNumber!=null?Number(e.seasonNumber):null,o=e.episodeNumber!=null?Number(e.episodeNumber):null,s=e.seasonEpisode&&String(e.seasonEpisode).toUpperCase()||(Number.isFinite(r)&&Number.isFinite(o)?`S${String(r).padStart(2,"0")}E${String(o).padStart(2,"0")}`:"");n.textContent=`${s?s+" \u2022 ":""}${e.title||""}`;let a=document.createElement("div");a.className="badges";let i=Number((m=e.audienceRating)!=null?m:e.rating);if(Number.isFinite(i)){let f=document.createElement("span");f.className="badge",f.textContent=`${i.toFixed(1)}`,a.append(f)}let l=document.createElement("div");l.className="ep-meta";let d=e.durationMin||(e.duration?Math.round(Number(e.duration)/6e4):null),c=e.durationHuman||(d?`${d} min`:null),u=e.originallyAvailableAt||e.date||"";return l.textContent=[c,u].filter(Boolean).join(" \u2022 "),t.append(n,a,l),t}var Gn=k(()=>{he()});function Vn(e,t){let n=e.querySelector(".v2-seasons");if(!n)return;let r=Array.isArray(t==null?void 0:t.seasons)?t.seasons:[];if(!r.length){n.innerHTML='<p class="modalv2-loading">Keine Staffel-Informationen verf\xFCgbar.</p>';return}n.innerHTML="",qn(n,r)}var Un=k(()=>{Gn()});function Xn(e,t){var d,c;let n=e.querySelector("#v2Tmdb"),r=e.querySelector("#v2Imdb"),o=e.querySelector("#v2Trailer"),s=((d=t==null?void 0:t.ids)==null?void 0:d.tmdb)||(t==null?void 0:t.tmdbId),a=((c=t==null?void 0:t.ids)==null?void 0:c.imdb)||(t==null?void 0:t.imdbId),i=(t==null?void 0:t.trailer)||(t==null?void 0:t.trailerUrl),l=(t==null?void 0:t.type)==="tv"?"tv":"movie";n&&(s?(n.hidden=!1,n.href=`https://www.themoviedb.org/${l}/${s}`):(n.hidden=!0,n.removeAttribute("href"))),r&&(a?(r.hidden=!1,r.href=`https://www.imdb.com/title/${a}/`):(r.hidden=!0,r.removeAttribute("href"))),o&&(i?(o.hidden=!1,o.onclick=()=>window.open(i,"_blank","noopener")):(o.hidden=!0,o.onclick=null))}var Wn=k(()=>{});function Jn(e){return(Array.isArray(e==null?void 0:e.cast)?e.cast:Array.isArray(e==null?void 0:e.roles)?e.roles:[]).map(n=>{var i,l,d;if(!n)return null;if(typeof n=="string"){let c=String(n).trim();return c?{name:c,role:"",thumb:"",tmdbProfile:"",raw:null}:null}let r=String(n.tag||n.name||n.role||"").trim();if(!r)return null;let o=(()=>{let c=String(n.role||"").trim();return c?c.toLowerCase()===r.toLowerCase()?"":c:""})(),s=[(i=n==null?void 0:n.tmdb)==null?void 0:i.profile,(l=n==null?void 0:n.tmdb)==null?void 0:l.profile_path,(d=n==null?void 0:n.tmdb)==null?void 0:d.profilePath,n==null?void 0:n.tmdbProfile,n==null?void 0:n.profile,n==null?void 0:n.profile_path,n==null?void 0:n.profilePath].find(c=>typeof c=="string"&&c.trim()),a=[n==null?void 0:n.thumb,n==null?void 0:n.photo,n==null?void 0:n.image].find(c=>typeof c=="string"&&c.trim())||"";return{name:r,role:o,thumb:a,tmdbProfile:s?String(s).trim():"",raw:n}}).filter(Boolean)}function Yn(e,t){let n=e.querySelector(".v2-cast");if(!n)return;n.innerHTML='<div class="v2-cast-scroll"></div>';let r=n.querySelector(".v2-cast-scroll");if(!r)return;let o=Array.isArray(t)?t.slice(0,12):[];if(!o.length){r.innerHTML='<span class="modalv2-loading">Keine Besetzungsdaten verf\xFCgbar.</span>',r.removeAttribute("role");return}r.setAttribute("role","list");let s=Y();o.forEach(a=>{let i=a&&typeof a=="object"&&"name"in a?a:(()=>{let f=String(a||"").trim();return f?{name:f,role:"",thumb:"",tmdbProfile:"",raw:null}:null})();if(!i||!i.name)return;let l=document.createElement("article");l.className="v2-cast-card",l.tabIndex=0,l.setAttribute("role","listitem");let d=String(i.role||"").trim();l.setAttribute("aria-label",d?`${i.name} \u2013 ${d}`:i.name);let c=document.createElement("div");c.className="v2-cast-avatar";let u=Go(i,s);if(u){c.classList.add("has-image");let f=document.createElement("img");f.src=u,f.alt=i.name,f.loading="lazy",f.decoding="async",c.appendChild(f)}else{let f=document.createElement("span");f.className="v2-cast-initials",f.textContent=Vo(i.name),f.setAttribute("aria-hidden","true"),c.appendChild(f)}let m=document.createElement("p");if(m.className="v2-cast-name",m.textContent=i.name,l.append(c,m),d){let f=document.createElement("p");f.className="v2-cast-role",f.textContent=d,l.append(f)}else l.classList.add("v2-cast-card--no-role");r.appendChild(l)}),r.children.length||(r.innerHTML='<span class="modalv2-loading">Keine Besetzungsdaten verf\xFCgbar.</span>',r.removeAttribute("role"))}function Ko(e){let t=String(e||"").trim();if(!t)return"";if(/^https?:\/\//i.test(t))return t;if(t.startsWith("//"))return`https:${t}`;let n=t.startsWith("/")?t:`/${t}`;return`${jo}${zo}${n}`}function qo(e){let t=String(e||"").trim();return t?/^https?:\/\//i.test(t)||t.startsWith("data:")?t:t.startsWith("//")?`https:${t}`:t:""}function Go(e,t){var o,s,a;if(!e)return"";let n=e.raw||{};if(t){let i=[e.tmdbProfile,(o=n==null?void 0:n.tmdb)==null?void 0:o.profile,(s=n==null?void 0:n.tmdb)==null?void 0:s.profile_path,(a=n==null?void 0:n.tmdb)==null?void 0:a.profilePath,n==null?void 0:n.tmdbProfile,n==null?void 0:n.profile,n==null?void 0:n.profile_path,n==null?void 0:n.profilePath];for(let l of i){let d=Ko(l);if(d)return d}}let r=[e.thumb,n==null?void 0:n.thumb,n==null?void 0:n.photo,n==null?void 0:n.image];for(let i of r){let l=qo(i);if(l)return l}return""}function Vo(e){let t=String(e||"").trim();if(!t)return"?";let r=t.split(/\s+/).slice(0,2).map(o=>o.charAt(0)).filter(Boolean);return r.length?r.join("").toUpperCase():t.charAt(0).toUpperCase()}var jo,zo,Zn=k(()=>{oe();jo="https://image.tmdb.org/t/p/",zo="w185"});function xe(e){if(e==null||typeof e!="object")return e;if(typeof structuredClone=="function")try{return structuredClone(e)}catch{}try{return JSON.parse(JSON.stringify(e))}catch{}if(Array.isArray(e))return e.map(n=>xe(n));let t={};for(let n of Object.keys(e))t[n]=xe(e[n]);return t}function ze(e){if(!e||typeof e!="object")return null;let t=xe(e);return t.type==="show"&&(t.type="tv"),t.type||(t.type="movie"),t}function Ke(e){if(!e||typeof e!="object")return null;let t=xe(e);return t.type!=="tv"&&(t.type="tv"),Ft(t),t}function Uo(e){if(!e||typeof e!="object")return null;let t=xe(e);return Ft(t),t}function Qn(e){let t=Array.isArray(e==null?void 0:e.seasons)?e.seasons:[],n=t.some(o=>Array.isArray(o==null?void 0:o.episodes)&&o.episodes.length),r=Array.isArray(e==null?void 0:e.cast)?e.cast:Array.isArray(e==null?void 0:e.roles)?e.roles:[];return!t.length||!n||!r.length}function er(e,t){if(!e)return e;if(t&&typeof t=="object"){let n=Uo(t);Object.assign(e,n)}return Ft(e),e}function Ft(e){if(!e||typeof e!="object")return;It(e),e.genres=Lt(e.genres);let t=Jo(e.cast||e.roles||[]);e.cast=t,e.roles=t,e.seasons=Array.isArray(e.seasons)?e.seasons.map(Xo).filter(Boolean):[];let n=Number(e.seasonCount);e.seasonCount=Number.isFinite(n)&&n>0?n:e.seasons.length}function Xo(e){if(!e||typeof e!="object")return null;let t={...e};return It(t),t.genres=Lt(t.genres),t.episodes=Array.isArray(t.episodes)?t.episodes.map(Wo).filter(Boolean):[],t}function Wo(e){if(!e||typeof e!="object")return null;let t={...e};return It(t),t.genres=Lt(t.genres),t}function It(e){D(e)}function Lt(e){if(!Array.isArray(e))return[];let t=new Set,n=[];return e.forEach(r=>{let o=null;if(typeof r=="string"){let s=r.trim();s&&(o={tag:s})}else if(r&&typeof r=="object"){let s=String(r.tag||r.title||r.name||r.label||"").trim();s&&(o={...r,tag:s})}o&&!t.has(o.tag)&&(t.add(o.tag),n.push(o))}),n}function Jo(e){return Array.isArray(e)?e.map(t=>{if(!t)return null;if(typeof t=="string"){let n=t.trim();return n?{tag:n}:null}if(typeof t=="object"){let n=String(t.tag||t.name||t.role||"").trim();return n?{...t,tag:n}:{...t}}return null}).filter(Boolean):[]}var tr=k(()=>{he()});var nr={};Ce(nr,{DEMO_MOVIE:()=>Yo,DEMO_SERIES:()=>Zo});var Yo,Zo,rr=k(()=>{Yo={type:"movie",title:"Lumen: Der Aufbruch",tagline:"Eine cineastische Demo f\xFCr das neue Modal",overview:"Die Crew der Lumen wagt den Sprung in unerforschte Welten und enth\xFCllt dabei eine Energiequelle, die alles ver\xE4ndern k\xF6nnte. Zwischen Loyalit\xE4t, Intrigen und berauschenden Bildern entfaltet sich ein Abenteuer, das f\xFCr das Cinematic-Layout entworfen wurde.",summary:"Die Crew der Lumen entdeckt eine Energiequelle, die das Schicksal der Menschheit ver\xE4ndern k\xF6nnte.",runtimeMin:142,contentRating:"FSK 12",studio:"Aurora Pictures",rating:8.4,audienceRating:8,userRating:8.7,originallyAvailableAt:"2024-05-17",countries:[{tag:"Deutschland"},{tag:"Kanada"}],genres:[{tag:"Science-Fiction"},{tag:"Drama"},{tag:"Abenteuer"}],cast:[{name:"Mara Lenz",role:"Captain Alys Vega",tmdbProfile:"/3rxeQHiuCYaXJqfyUG8yt0YdHtH.jpg"},{name:"Tariq Benassi",role:"Navigator Elian Soh",tmdbProfile:"/wGl8DCycJ2U0FvJbLABd8R4FS3X.jpg"},{name:"Hannah Ko",role:"Wissenschaftlerin Dr. Mira Han",tmdbProfile:"/hJuDvwzS0SPlsE6MN4pF2UYDGtt.jpg"}],directors:[{tag:"Jonas Falk"}],writers:[{tag:"Lea Winter"}],producers:[{tag:"Studio Atlas"}],labels:[{tag:"Dolby Atmos"},{tag:"4K"}],collections:[{tag:"Aurora-Saga"}],trailer:"https://www.youtube.com/watch?v=dQw4w9WgXcQ",tmdbPoster:"https://image.tmdb.org/t/p/w500/2lUYbD2C3XSuwqMUbDVDQuz9mqz.jpg",ids:{tmdb:"demo-lumen",imdb:"tt0000001"},addedAt:"2024-06-01T12:00:00Z"},Zo={type:"tv",title:"Aurora Station",tagline:"Neue Horizonte in Serie",overview:"Die Besatzung der Aurora Station sch\xFCtzt eine Au\xDFenposten an der Grenze des bekannten Raums. Jede Episode verbindet kosmische R\xE4tsel mit pers\xF6nlichen Geschichten \u2013 perfekt geeignet, um das Cinematic-Modal auszuprobieren.",summary:"Ein orbitaler Au\xDFenposten ringt um Hoffnung und Zusammenhalt, w\xE4hrend eine fremde Macht erwacht.",contentRating:"TV-14",studio:"Nebula Network",originallyAvailableAt:"2023-09-14",seasonCount:2,genres:[{tag:"Science-Fiction"},{tag:"Drama"}],countries:[{tag:"USA"},{tag:"Island"}],creators:[{tag:"Elina S\xF8rensen"}],cast:[{name:"Noah Adler",role:"Commander Ivar Hale",tmdbProfile:"/4MqUjb1SYrzHmFSVoKHSKP5MGGm.jpg"},{name:"Sofia Idris",role:"Ingenieurin Kaia Rhee",tmdbProfile:"/tHMgWz6EpRdbgoMJ2JfzFzjg3QB.jpg"},{name:"Helena Ruiz",role:"Strategin Tala Voss",tmdbProfile:"/ziEuG1ESSofxDCspotYlrwz3Tq.png"}],seasons:[{title:"Staffel 1",seasonNumber:1,year:2023,thumbFile:"https://image.tmdb.org/t/p/w300/4dO2YpC8S9nLmQAXoJLRV8LZRxn.jpg",episodes:[{title:"Kapitel Eins: Erwachen",seasonNumber:1,episodeNumber:1,durationMin:54,originallyAvailableAt:"2023-09-14",audienceRating:8.6},{title:"Kapitel Zwei: Grenzwelten",seasonNumber:1,episodeNumber:2,durationMin:52,originallyAvailableAt:"2023-09-21",audienceRating:8.2}]},{title:"Staffel 2",seasonNumber:2,year:2024,thumbFile:"https://image.tmdb.org/t/p/w300/bSL4hY8SgdKzac8AUbWQm74y87C.jpg",episodes:[{title:"Kapitel Dreizehn: Resonanz",seasonNumber:2,episodeNumber:1,durationMin:56,originallyAvailableAt:"2024-02-08",audienceRating:8.9},{title:"Kapitel Vierzehn: Echo",seasonNumber:2,episodeNumber:2,durationMin:55,originallyAvailableAt:"2024-02-15",audienceRating:8.7}]}],tmdbPoster:"https://image.tmdb.org/t/p/w500/a4I481szRmycyreQTLrRe4f4YJe.jpg",ids:{tmdb:"demo-aurora-station",imdb:"tt0000002"}}});function or(){return Mt||(Mt=Promise.resolve().then(()=>(rr(),nr)).catch(e=>({DEMO_MOVIE:null,DEMO_SERIES:null}))),Mt}function Qo(){if(O)return O;let e=document.getElementById("modal-root-v2");if(!e)return null;if(U=e,e.classList.add("modalv2-overlay"),e.hasAttribute("hidden")||e.setAttribute("hidden",""),e.dataset.modalv2Ready||(e.innerHTML=`
      <div class="modalv2-backdrop" data-modalv2-backdrop="1"></div>
      <div class="modalv2-dialog" role="dialog" aria-modal="true">
        <div class="modalv2-scroll" data-modalv2-scroll></div>
      </div>
    `,e.dataset.modalv2Ready="1",e.addEventListener("click",es)),B=e.querySelector(".modalv2-dialog"),B&&!B.hasAttribute("tabindex")&&B.setAttribute("tabindex","-1"),Q=e.querySelector("[data-modalv2-scroll]"),Q&&!O){let t=Q.querySelector(".modalv2");t?O=t:(O=document.createElement("div"),O.className="modalv2",O.setAttribute("hidden",""),Q.appendChild(O))}return O}function es(e){if(!U)return;let t=e.target;(t===U||t&&t.dataset&&t.dataset.modalv2Backdrop)&&_t()}function sr(){return B?Array.from(B.querySelectorAll('a[href], button:not([disabled]), textarea, input, select, [tabindex]:not([tabindex="-1"])')).filter(t=>t.hasAttribute("disabled")||t.getAttribute("aria-hidden")==="true"||t.hasAttribute("hidden")?!1:t.offsetParent!==null):[]}function ts(){B&&(ae&&B.removeEventListener("keydown",ae),ae=e=>{if(e.key!=="Tab")return;let t=sr();if(!t.length)return;let n=t[0],r=t[t.length-1];e.shiftKey?document.activeElement===n&&(e.preventDefault(),r.focus()):document.activeElement===r&&(e.preventDefault(),n.focus())},B.addEventListener("keydown",ae))}function ns(){!B||!ae||(B.removeEventListener("keydown",ae),ae=null)}function rs(){be||(be=e=>{e.key==="Escape"&&(e.preventDefault(),_t())},window.addEventListener("keydown",be))}function os(){be&&(window.removeEventListener("keydown",be),be=null)}function qe(){let e=Qo();return!e||!U?null:(U.hidden=!1,U.setAttribute("aria-hidden","false"),document.body.classList.add("modalv2-open"),Q&&(Q.scrollTop=0),ts(),rs(),e)}function Nt(){if(!B)return;let e=B.querySelector("#v2Close"),t=sr(),n=e&&!e.hasAttribute("hidden")?e:t[0];if(n||(n=B),n){let r=()=>{try{n.focus()}catch{}};(window.requestAnimationFrame||setTimeout)(r,0)}}function ss(e="Details werden geladen \u2026"){let t=qe();if(!t)return;t.hidden=!1;let n=document.createElement("div");n.className="modalv2-loading",n.textContent=String(e||"Details werden geladen \u2026"),t.replaceChildren(n)}function ar(e){let t=qe();if(!t)return;t.hidden=!1;let n=(e==null?void 0:e.type)==="tv";t.innerHTML=`
    <section class="v2-layout">
      <aside class="v2-side">
        <div class="v2-poster"><img alt=""></div>
        <div class="v2-facts" aria-label="Schnellinfos" hidden>
          <h3 class="v2-facts-title">Schnellinfos</h3>
          <dl class="v2-facts-list"></dl>
        </div>
      </aside>
      <div class="v2-info">
        <header class="v2-head">
          <div class="v2-titlebar">
            <div class="v2-title-wrap">
              <h2 class="v2-title" id="modalV2Title"></h2>
              <div class="v2-subline"></div>
              <div class="v2-meta"></div>
            </div>
            <div class="v2-actions" aria-label="Externe Aktionen">
              <button class="v2-icon-btn" id="v2Close" type="button" aria-label="Schlie\xDFen">
                <svg class="v2-icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                  <path d="M6 6l12 12M6 18L18 6" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"></path>
                </svg>
              </button>
              <a class="v2-icon-btn" id="v2Tmdb" target="_blank" rel="noopener noreferrer" aria-label="Auf TMDB \xF6ffnen" hidden>
                <svg class="v2-icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                  <path d="M4 9h16v10a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V9z" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linejoin="round"></path>
                  <path d="M4 9V7a2 2 0 0 1 2-2h1l2 4 2-4 2 4 2-4h1a2 2 0 0 1 2 2v2" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"></path>
                </svg>
              </a>
              <a class="v2-icon-btn" id="v2Imdb" target="_blank" rel="noopener noreferrer" aria-label="Auf IMDb \xF6ffnen" hidden>
                <svg class="v2-icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                  <path d="M12 4l2.4 4.9 5.4.8-3.9 3.8.9 5.4-4.8-2.5-4.8 2.5.9-5.4-3.9-3.8 5.4-.8z" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linejoin="round"></path>
                </svg>
              </a>
              <button class="v2-icon-btn" id="v2Trailer" type="button" aria-label="Trailer abspielen" hidden>
                <svg class="v2-icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                  <path d="M9 6l8 6-8 6V6z" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linejoin="round" stroke-linecap="round"></path>
                </svg>
              </button>
            </div>
          </div>
          <div class="v2-chips" aria-label="Attribute"></div>
        </header>
        <nav class="v2-tabs" aria-label="Details Navigation" role="tablist">
          <button type="button" data-t="overview" class="active" id="v2TabOverview" role="tab" aria-controls="v2PaneOverview" aria-selected="true">\xDCberblick</button>
          <button type="button" data-t="details" id="v2TabDetails" role="tab" aria-controls="v2PaneDetails" aria-selected="false">Details</button>
          ${n?'<button type="button" data-t="seasons" id="v2TabSeasons" role="tab" aria-controls="v2PaneSeasons" aria-selected="false">Staffeln</button>':""}
          <button type="button" data-t="cast" id="v2TabCast" role="tab" aria-controls="v2PaneCast" aria-selected="false">Cast</button>
        </nav>
        <section class="v2-body">
          <div class="v2-pane v2-overview" data-pane="overview" id="v2PaneOverview" role="tabpanel" aria-labelledby="v2TabOverview"></div>
          <div class="v2-pane v2-details" data-pane="details" id="v2PaneDetails" role="tabpanel" aria-labelledby="v2TabDetails" hidden></div>
          ${n?'<div class="v2-pane v2-seasons" data-pane="seasons" id="v2PaneSeasons" role="tabpanel" aria-labelledby="v2TabSeasons" hidden></div>':""}
          <div class="v2-pane v2-cast" data-pane="cast" id="v2PaneCast" role="tabpanel" aria-labelledby="v2TabCast" hidden></div>
        </section>
      </div>
    </section>
  `,On(t,e),Xn(t,e),Dn(t,(e==null?void 0:e.overview)||(e==null?void 0:e.summary)||""),zn(t,e),(e==null?void 0:e.type)==="tv"&&Vn(t,e),Yn(t,Jn(e)),Pn(t);let r=t.querySelector("#v2Close");r&&r.addEventListener("click",_t),B&&B.setAttribute("aria-labelledby","modalV2Title"),Nt()}async function ve(e){let t=++Z;me=document.activeElement instanceof HTMLElement?document.activeElement:null;let n=qe();if(!n)return;let r=await as(e);if(t===Z){if(!r){n.hidden=!1;let o=document.createElement("div");o.className="modalv2-loading",o.textContent="Film konnte nicht geladen werden.",n.replaceChildren(o),ye=null,Fe=null,Nt();return}ye=r,Fe="movie",ar(r)}}async function we(e){let t=++Z;me=document.activeElement instanceof HTMLElement?document.activeElement:null;let n=await is(e),r=qe();if(!r||t!==Z)return;if(!n){r.hidden=!1;let s=document.createElement("div");s.className="modalv2-loading",s.textContent="Seriendetails konnten nicht geladen werden.",r.replaceChildren(s),ye=null,Fe=null,Nt();return}ye=n,Fe="show";let o=n;if(Qn(o)){if(ss(),t!==Z)return;let s=null;try{s=await Tn(o)}catch{s=null}if(t!==Z)return;s&&(er(o,s),ye=o)}t===Z&&ar(o)}function _t(){if(Z++,!!U){if(U.hidden=!0,U.setAttribute("aria-hidden","true"),document.body.classList.remove("modalv2-open"),ns(),os(),O&&(O.innerHTML="",O.setAttribute("hidden","")),Q&&(Q.scrollTop=0),me&&typeof me.focus=="function")try{me.focus()}catch{}me=null,ye=null,Fe=null}}async function as(e){if(e==="demo"){let{DEMO_MOVIE:s}=await or();return ze(s)}if(e&&typeof e=="object")return ze(e);let t=e==null?"":String(e).trim();if(!t)return null;let n=S(),o=(Array.isArray(n==null?void 0:n.movies)?n.movies:[]).find(s=>ir(s,t));return o?ze(o):null}async function is(e){if(e==="demo"){let{DEMO_SERIES:s}=await or();return Ke(s)}if(e&&typeof e=="object")return Ke(e);let t=e==null?"":String(e).trim();if(!t)return null;let n=S(),o=(Array.isArray(n==null?void 0:n.shows)?n.shows:[]).find(s=>ir(s,t));return o?Ke(o):null}function ir(e,t){var r,o;if(!e)return!1;let n=String(t||"").trim();return n?!!((r=e==null?void 0:e.ids)!=null&&r.imdb&&String(e.ids.imdb)===n||(o=e==null?void 0:e.ids)!=null&&o.tmdb&&String(e.ids.tmdb)===n||(e==null?void 0:e.ratingKey)!=null&&String(e.ratingKey)===n):!1}var U,B,Q,O,me,ae,be,Z,Fe,ye,Mt,Ge=k(()=>{Hn();Tt();jn();Kn();Un();Wn();Zn();K();he();tr();U=null,B=null,Q=null,O=null,me=null,ae=null,be=null,Z=0,Fe=null,ye=null,Mt=null});function cs(){}function Ve(e){let t=parseFloat(e);return Number.isFinite(t)?t:0}var lr,ls,Ue,cr=k(()=>{lr=typeof requestAnimationFrame=="function"?requestAnimationFrame:e=>setTimeout(e,16),ls=typeof cancelAnimationFrame=="function"?cancelAnimationFrame:e=>clearTimeout(e);Ue=class{constructor({container:t,renderItem:n,getKey:r=cs,updateItem:o=null,getSignature:s=null,overscan:a=2,estimatedItemHeight:i=420,minItemWidth:l=190}){if(!t)throw new Error("VirtualList requires a container element");if(typeof n!="function")throw new Error("VirtualList requires a renderItem function");this.container=t,this.renderItem=n,this.getKey=r,this.updateItem=typeof o=="function"?o:null,this.getSignature=typeof s=="function"?s:null,this.overscan=Math.max(0,a|0),this.estimatedItemHeight=i,this.minItemWidth=l,this.items=[],this.range={start:0,end:0},this.columns=1,this.rowCount=0,this.rowHeight=this.estimatedItemHeight,this.totalHeight=0,this.itemHeight=this.estimatedItemHeight,this.containerTop=0,this.paddingTop=0,this.paddingBottom=0,this.gapY=0,this.gapX=0,this.metricsDirty=!0,this.pendingFrame=0,this.lastWidth=0,this.nodeCache=new Map,this.renderedKeys=new Set,this.itemSignatures=new Map,this.scrollTicking=!1,this.spacer=document.createElement("div"),this.spacer.className="grid-virtual__spacer",this.windowEl=document.createElement("div"),this.windowEl.className="grid-virtual__window",this.itemsHost=document.createElement("div"),this.itemsHost.className="grid-virtual__items",this.container.textContent="",this.windowEl.append(this.itemsHost),this.container.append(this.spacer,this.windowEl),this.measureRoot=document.createElement("div"),this.measureRoot.className="grid-virtual__measure",this.measureRoot.setAttribute("aria-hidden","true"),Object.assign(this.measureRoot.style,{position:"absolute",visibility:"hidden",pointerEvents:"none",inset:"0 auto auto 0",zIndex:"-1"}),this.container.append(this.measureRoot),this.handleScroll=this.handleScroll.bind(this),this.handleResize=this.handleResize.bind(this),this.update=this.update.bind(this),window.addEventListener("scroll",this.handleScroll,{passive:!0}),window.addEventListener("resize",this.handleResize),typeof ResizeObserver=="function"?(this.resizeObserver=new ResizeObserver(this.handleResize),this.resizeObserver.observe(this.container)):this.resizeObserver=null}destroy(){window.removeEventListener("scroll",this.handleScroll),window.removeEventListener("resize",this.handleResize),this.resizeObserver&&this.resizeObserver.disconnect(),this.pendingFrame&&(ls(this.pendingFrame),this.pendingFrame=0),this.nodeCache.clear(),this.renderedKeys.clear(),this.itemSignatures.clear(),this.items=[],this.spacer.remove(),this.windowEl.remove(),this.measureRoot.remove()}schedule(t=!1){t&&(this.metricsDirty=!0),!this.pendingFrame&&(this.pendingFrame=lr(()=>{this.pendingFrame=0,this.update()}))}handleScroll(){this.scrollTicking||(this.scrollTicking=!0,this.schedule(!1),lr(()=>{this.scrollTicking=!1}))}handleResize(){let t=this.container.clientWidth;t!==this.lastWidth&&(this.metricsDirty=!0,this.lastWidth=t),this.schedule(!0)}setItems(t){this.items=Array.isArray(t)?t.slice():[],this.metricsDirty=!0,this.pruneCache(),this.measureItems(),this.update()}measureItems(){if(!this.items.length){this.itemHeight=this.estimatedItemHeight;return}let t=this.items[0];this.measureRoot.textContent="";let n=this.renderItem(t,0);if(n instanceof HTMLElement)if(this.measureRoot.append(n),typeof n.getBoundingClientRect=="function"){let r=n.getBoundingClientRect();r&&r.height>0&&(this.itemHeight=r.height)}else n.offsetHeight&&(this.itemHeight=n.offsetHeight);this.measureRoot.textContent=""}pruneCache(){if(!this.items.length){this.nodeCache.forEach(r=>r.remove()),this.nodeCache.clear(),this.itemSignatures.clear(),this.renderedKeys.clear();return}let t=new Set,n=this.getSignature?new Map:null;this.items.forEach((r,o)=>{let s=this.keyFor(r,o);if(t.add(s),n){let a=this.signatureFor(r,o);n.set(s,a);let i=this.itemSignatures.get(s);if(i!==void 0&&i!==a){let l=this.nodeCache.get(s);l&&(l.parentNode&&l.parentNode.removeChild(l),this.nodeCache.delete(s),this.renderedKeys.delete(s))}}}),this.nodeCache.forEach((r,o)=>{t.has(o)||(r.parentNode&&r.parentNode.removeChild(r),this.nodeCache.delete(o),this.renderedKeys.delete(o))}),n?this.itemSignatures=n:this.itemSignatures.clear()}keyFor(t,n){let r=this.getKey?this.getKey(t,n):null;return r==null||r===""?`index-${n}`:String(r)}signatureFor(t,n){if(this.getSignature)try{return this.getSignature(t,n)}catch{return}}refreshMetrics(){let t=getComputedStyle(this.container);this.paddingTop=Ve(t.paddingTop),this.paddingBottom=Ve(t.paddingBottom);let n=getComputedStyle(this.itemsHost),r=n.getPropertyValue?n.getPropertyValue("row-gap"):n.rowGap,o=n.getPropertyValue?n.getPropertyValue("column-gap"):n.columnGap,s=n.getPropertyValue?n.getPropertyValue("gap"):n.gap;this.gapY=Ve(r||s),this.gapX=Ve(o||s);let a=Math.floor((this.container.clientWidth+this.gapX)/(this.minItemWidth+this.gapX));this.columns=Math.max(1,a||1),this.rowHeight=this.itemHeight+this.gapY,this.rowHeight<=0&&(this.rowHeight=this.itemHeight||this.estimatedItemHeight),this.rowCount=this.columns>0?Math.ceil(this.items.length/this.columns):this.items.length,this.totalHeight=Math.max(0,this.rowCount*this.rowHeight),this.updateContainerPosition(),this.spacer.style.height=`${this.totalHeight}px`,this.windowEl.style.top=`${this.paddingTop}px`,this.windowEl.style.paddingBottom=`${this.paddingBottom}px`,this.metricsDirty=!1}updateContainerPosition(){let t=this.container,n=0;for(;t&&t!==document.body;)n+=t.offsetTop,t=t.offsetParent;this.containerTop=n}update(){this.metricsDirty&&this.refreshMetrics(),this.syncVisibleRange()}syncVisibleRange(){if(!this.items.length){this.windowEl.style.transform="translate3d(0, 0, 0)",this.itemsHost.replaceChildren(),this.range={start:0,end:0};return}let t=window.scrollY,n=t+window.innerHeight,r=this.containerTop+this.paddingTop,o=r+this.totalHeight;window.__VLIST_DEBUG;let s;t<=r?s=0:t>=o?s=Math.max(0,this.rowCount-1):s=Math.floor((t-r)/this.rowHeight);let a;n>=o?a=Math.max(0,this.rowCount-1):n<=r?a=0:a=Math.ceil((n-r)/this.rowHeight),s=Math.max(0,Math.min(s,Math.max(0,this.rowCount-1))-this.overscan),a=Math.min(Math.max(0,this.rowCount-1),a+this.overscan);let i=Math.max(0,Math.min(this.items.length,s*this.columns)),l=Math.max(i,Math.min(this.items.length,(a+1)*this.columns));if(i===this.range.start&&l===this.range.end){let h=!1;for(let g=i;g<l;g++){let w=this.keyFor(this.items[g],g);if(!this.renderedKeys.has(w)){h=!0;break}}if(!h)return}this.range={start:i,end:l};let c=Math.floor(i/this.columns)*this.rowHeight;this.windowEl.style.transform=`translate3d(0, ${c}px, 0)`;let u=new Set,m=[];for(let h=i;h<l;h++){let g=this.items[h],w=this.keyFor(g,h),C=this.nodeCache.get(w);if(C){if(this.updateItem){let M=this.updateItem(C,g,h);if(M instanceof HTMLElement&&M!==C)C=M,this.nodeCache.set(w,C);else if(!(M instanceof HTMLElement))continue}}else{if(C=this.renderItem(g,h),!(C instanceof HTMLElement))continue;this.nodeCache.set(w,C)}u.add(w),m.push(C)}let f=this.itemsHost.children;if(f.length===m.length){let h=!0;for(let g=0;g<m.length;g++)if(f[g]!==m[g]){h=!1;break}if(h){this.renderedKeys=u;return}}let p=new Map;for(let h=0;h<f.length;h++)p.set(f[h],h);for(let h=0;h<m.length;h++){let g=m[h],w=f[h];w!==g&&(p.has(g)?this.itemsHost.insertBefore(g,w||null):this.itemsHost.insertBefore(g,w||null))}for(;this.itemsHost.children.length>m.length;)this.itemsHost.lastChild.remove();this.renderedKeys=u}}});var wr={};Ce(wr,{renderGrid:()=>H});function ds(e){let t=T("article","card");t.dataset.kind=(e==null?void 0:e.type)==="tv"?"show":"movie",t.tabIndex=0,t.setAttribute("role","button"),e!=null&&e.title&&t.setAttribute("aria-label",e.title);let n=T("div","card__media"),r=new Image;r.loading="lazy",r.decoding="async",r.className="card__img",r.alt=(e==null?void 0:e.title)||"",r.style.aspectRatio="2 / 3";let o=We(e);o&&(r.src=o);let s=T("div","card__media-gradient");s.setAttribute("aria-hidden","true");let a=vs(e),i=T("div","card__badges");a.forEach(w=>{w instanceof HTMLElement&&i.append(w)}),n.append(r,s),i.childElementCount&&n.append(i);let l=vr(e);if(l>0){let w=T("div","card__progress"),C=document.createElement("span");C.style.width=`${Math.max(0,Math.min(100,l))}%`,w.append(C),n.append(w)}let d=T("div","card__body"),c=document.createElement("h3");c.className="card__title",c.textContent=(e==null?void 0:e.title)||"",e!=null&&e.title&&c.setAttribute("title",e.title);let u=T("div","card__meta"),m=br(e);u.textContent=m.join(" \u2022 "),d.append(c,u);let f=T("div","card__actions"),p=T("div","card__chips"),h=J(e==null?void 0:e.genres);bt(p,h,3);let g=document.createElement("button");return g.type="button",g.className="card__primary",ur(g,e),g.addEventListener("click",w=>{w.stopPropagation(),Et(e),ur(g,e)}),f.append(p,g),t.append(n,d,f),t.addEventListener("click",()=>fr(e)),t.addEventListener("keydown",w=>{w.target===t&&(w.key==="Enter"||w.key===" ")&&(w.preventDefault(),fr(e))}),t}function us(e,t){let n=(t||[]).slice().sort((u,m)=>{let f=Number(_(u))||0,p=Number(_(m))||0;return f!==p?f-p:(u.title||"").localeCompare(m.title||"","de")}),r=n.map(u=>Number(_(u))||0).filter(Boolean),o=r.length?Math.min(...r):"",s=n.map(u=>new Date(u.addedAt||0).getTime()).filter(Number.isFinite),a=s.length?new Date(Math.max(...s)).toISOString():null,i=n.map(u=>{var m;return Number((m=u.rating)!=null?m:u.audienceRating)}).filter(Number.isFinite),l=i.length?i.reduce((u,m)=>u+m,0)/i.length:null,d=n.find(u=>u.thumbFile)||n[0]||null,c=Array.from(new Set(n.flatMap(u=>J(u.genres)))).slice(0,4);return{isCollectionGroup:!0,type:"collection",title:e,collectionName:e,items:n,itemCount:n.length,year:o||"",addedAt:a,rating:l,posterItem:d,genres:c}}function fs(e){let t=document.getElementById("groupCollections"),n=document.getElementById("collectionFilter"),r=n&&n.value;if(!t||!t.checked||r)return e;let o=new Map;e.forEach(a=>{ge(a).forEach(i=>{o.has(i)||o.set(i,[]),o.get(i).push(a)})});let s=[];return o.forEach((a,i)=>{s.push(us(i,a))}),s.sort((a,i)=>a.title.localeCompare(i.title,"de")),s}function hs(e){let t=T("article","card card--collection");t.dataset.kind="collection",t.tabIndex=0,t.setAttribute("role","button"),e!=null&&e.title&&t.setAttribute("aria-label",e.title);let n=T("div","card__media"),r=e.posterItem||{},o=new Image;o.loading="lazy",o.decoding="async",o.className="card__img",o.alt=(e==null?void 0:e.title)||"",o.style.aspectRatio="2 / 3";let s=We(r);s&&(o.src=s);let a=T("div","card__media-gradient");a.setAttribute("aria-hidden","true");let i=ws(e),l=T("div","card__badges");i.forEach(h=>{h instanceof HTMLElement&&l.append(h)}),n.append(o,a),l.childElementCount&&n.append(l);let d=T("div","card__body"),c=document.createElement("h3");c.className="card__title",c.textContent=e.title||"",e!=null&&e.title&&c.setAttribute("title",e.title);let u=T("div","card__meta"),m=yr(e);u.textContent=m.filter(Boolean).join(" \u2022 "),d.append(c,u);let f=T("div","card__actions"),p=T("div","card__chips");return bt(p,e.genres||[],3),f.append(p),t.append(n,d,f),t.addEventListener("click",()=>{let h=document.getElementById("collectionFilter");h&&(h.value=e.collectionName||e.title||"",h.dispatchEvent(new Event("change",{bubbles:!0})))}),t.addEventListener("keydown",h=>{if(h.target===t&&(h.key==="Enter"||h.key===" ")){h.preventDefault();let g=document.getElementById("collectionFilter");g&&(g.value=e.collectionName||e.title||"",g.dispatchEvent(new Event("change",{bubbles:!0})))}}),t}function gs(e){return Xe||(Xe=new Ue({container:e,overscan:1,estimatedItemHeight:460,minItemWidth:190,getKey:ps,getSignature:Pt,renderItem(t){return hr(t)},updateItem(t,n){return ms(t,n)}}),Xe)}function ps(e,t){if(e!=null&&e.isCollectionGroup){let r=e.collectionName||e.title||"";return r?`collection:${r}`:`collection-index-${t}`}let n=$t(e);return n?`item:${n}`:`item-index-${t}`}function hr(e){let t=e!=null&&e.isCollectionGroup?hs(e):ds(e);return t instanceof HTMLElement&&(t[Bt]=Pt(e)),t}function ms(e,t){if(e instanceof HTMLElement){let r=Pt(t);if(e[Bt]===r)return e[Bt]=r,e}let n=hr(t);return n instanceof HTMLElement?ks(e,n):e}function H(e){let{movies:t,shows:n,filtered:r}=S(),o=(e==="shows"?n:t)||[],s=Array.isArray(r)?r:o,a=fs(s),i=document.getElementById("grid");if(!i)return;let l=dr!==e;dr=e,l&&bs(i),gs(i).setItems(a),l&&ys(i);let c=document.getElementById("empty");c&&(c.hidden=a.length>0),i.setAttribute("aria-busy","false")}function bs(e){e&&(e.classList.remove("is-entering","is-ready"),e.classList.add("is-leaving"))}function ys(e){e&&(e.classList.remove("is-leaving"),e.classList.add("is-entering"),requestAnimationFrame(()=>{e.classList.add("is-ready"),setTimeout(()=>e.classList.remove("is-entering","is-ready"),240)}))}function We(e){var r;if(!e)return"";let t=Y()&&(((r=e==null?void 0:e.tmdb)==null?void 0:r.poster)||(e==null?void 0:e.tmdbPoster)),n=(e==null?void 0:e.thumbFile)||(e==null?void 0:e.poster)||(e==null?void 0:e.art)||(e==null?void 0:e.thumb)||"";return t||n||""}function gr(e){var o;let t=[];pe(e)&&t.push("Neu");let n=String((e==null?void 0:e.contentRating)||"").trim();n&&t.push(n);let r=Number((o=e==null?void 0:e.rating)!=null?o:e==null?void 0:e.audienceRating);return Number.isFinite(r)&&t.push(`\u2605 ${R(r)}`),t.slice(0,3)}function vs(e){return gr(e).map(mr)}function pr(e){let t=[];return Number.isFinite(e==null?void 0:e.itemCount)&&e.itemCount>0&&t.push(`${e.itemCount} Titel`),e!=null&&e.year&&t.push(String(e.year)),t}function ws(e){return pr(e).map(mr)}function mr(e){let t=document.createElement("span");return t.className="badge",t.textContent=String(e||""),t}function ur(e,t){if(!e)return;let n=wt(t);e.textContent=n?"Gemerkt":"Merken",e.classList.toggle("active",n),e.setAttribute("aria-pressed",n?"true":"false")}function br(e){var a;let t=[],n=_(e);n&&t.push(String(n));let r=Es(e);r&&t.push(r);let o=Number((a=e==null?void 0:e.rating)!=null?a:e==null?void 0:e.audienceRating);Number.isFinite(o)&&t.push(`\u2605 ${R(o)}`);let s=(e==null?void 0:e.studio)||(e==null?void 0:e.network)||"";return s&&t.push(s),t}function yr(e){let t=[];e!=null&&e.year&&t.push(String(e.year));let n=Number(e==null?void 0:e.itemCount);Number.isFinite(n)&&t.push(`${n} Titel`);let r=Number(e==null?void 0:e.rating);return Number.isFinite(r)&&t.push(`\u2605 ${R(r)}`),t}function Es(e){var r,o;let t=(o=(r=e==null?void 0:e.runtimeMin)!=null?r:e==null?void 0:e.durationMin)!=null?o:e!=null&&e.duration?Math.round(Number(e.duration)/6e4):null,n=Number(t);return!Number.isFinite(n)||n<=0?"":(e==null?void 0:e.type)==="tv"?`~${n} min/Ep`:`${n} min`}function vr(e){var r;let t=Number((r=e==null?void 0:e.viewOffset)!=null?r:e==null?void 0:e.viewoffset),n=Number(e==null?void 0:e.duration);return!Number.isFinite(t)||!Number.isFinite(n)||n<=0?0:Math.max(1,Math.min(100,Math.round(t/n*100)))}function $t(e){var n,r;if(!e)return"";let t=((n=e==null?void 0:e.ids)==null?void 0:n.imdb)||((r=e==null?void 0:e.ids)==null?void 0:r.tmdb);return t?String(t):e!=null&&e.ratingKey?String(e.ratingKey):""}function Pt(e){return e!=null&&e.isCollectionGroup?As(e):Ss(e)}function Ss(e){let t=J(e==null?void 0:e.genres).slice(0,3),n=gr(e),r=br(e);return JSON.stringify({id:$t(e),title:(e==null?void 0:e.title)||"",poster:We(e),badges:n,meta:r,progress:vr(e),watch:wt(e),genres:t})}function As(e){let t=(e==null?void 0:e.posterItem)||null,n=Array.isArray(e==null?void 0:e.genres)?e.genres.slice(0,3).map(String):[],r=pr(e),o=yr(e),s=Number(e==null?void 0:e.itemCount),a=Number(e==null?void 0:e.rating);return JSON.stringify({name:(e==null?void 0:e.collectionName)||(e==null?void 0:e.title)||"",title:(e==null?void 0:e.title)||"",itemCount:Number.isFinite(s)?s:null,year:(e==null?void 0:e.year)||"",rating:Number.isFinite(a)?a:null,poster:We(t),badges:r,meta:o,genres:n})}function ks(e,t){if(!(t instanceof HTMLElement))return e;if(!(e instanceof HTMLElement))return t;let n=e.parentNode,r=document.activeElement===e;return n&&n.replaceChild(t,e),r&&typeof t.focus=="function"&&requestAnimationFrame(()=>{try{t.focus({preventScroll:!0})}catch{t.focus()}}),t}function Cs(e,t){if(!e||!t)return;let n=`#/${e}/${t}`,r=(window.location.hash||"")===n;Ye(n,{silent:!0,replace:r})}function fr(e){if(!e)return;let t=(e==null?void 0:e.type)==="tv"?"show":"movie",n=$t(e);n&&Cs(t,n),t==="show"?we(e):ve(e)}var Bt,Xe,dr,Je=k(()=>{K();Ne();oe();At();Ge();Er();cr();Bt="__gridVirtualSignature";Xe=null;dr=null});var qt={};Ce(qt,{applyFilters:()=>Ee,computeFacets:()=>Dt,initFilters:()=>Kt,renderFacets:()=>jt,setFiltersUpdatedHandler:()=>zt,updateFiltersAndGrid:()=>Ie});function Sr(e){return String(e||"").toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")}function Ts(e,t){let n=Sr(t.query||""),r=!!t.onlyNew,o=Number(t.yearFrom)||null,s=Number(t.yearTo)||null,a=t.genres||new Set,i=t.collection||"";if(n&&!Sr([e.title,e.originalTitle,e.summary,e.studio,J(e.genres).join(" "),(e.roles||[]).map(c=>c&&(c.tag||c.role||c.name)).join(" "),ge(e).join(" ")].filter(Boolean).join(" ")).includes(n)||r&&!pe(e))return!1;let l=Number(_(e))||null;if(o&&(!l||l<o)||s&&(!l||l>s))return!1;if(a.size){let d=new Set(J(e.genres));for(let c of a)if(!d.has(c))return!1}return!(i&&!new Set(ge(e)).has(i))}function xs(e,t){let n=e.slice();switch(t){case"year-desc":n.sort((r,o)=>(Number(_(o))||0)-(Number(_(r))||0)||String(r.title||"").localeCompare(String(o.title||""),"de"));break;case"year-asc":n.sort((r,o)=>(Number(_(r))||0)-(Number(_(o))||0)||String(r.title||"").localeCompare(String(o.title||""),"de"));break;case"title-desc":n.sort((r,o)=>String(o.title||"").localeCompare(String(r.title||""),"de"));break;case"added-desc":n.sort((r,o)=>new Date(o.addedAt||0)-new Date(r.addedAt||0));break;case"title-asc":default:n.sort((r,o)=>String(r.title||"").localeCompare(String(o.title||""),"de"))}return n}function Dt(e,t){let n=new Set,r=new Set,o=new Set,s=i=>(i||[]).forEach(l=>{J(l.genres).forEach(c=>n.add(c));let d=l.year||(l.originallyAvailableAt?String(l.originallyAvailableAt).slice(0,4):"");d&&r.add(Number(d)),ge(l).forEach(c=>o.add(c))});s(e),s(t);let a=[...r].sort((i,l)=>i-l);return{genres:[...n].sort(),years:a,collections:[...o].sort((i,l)=>i.localeCompare(l,"de"))}}function jt(e){let t=I("#yearFrom"),n=I("#yearTo");t&&t.replaceChildren(new Option("Ab Jahr",""),...e.years.map(s=>new Option(String(s),String(s)))),n&&n.replaceChildren(new Option("Bis Jahr",""),...e.years.map(s=>new Option(String(s),String(s))));let r=I("#collectionFilter");r&&r.replaceChildren(new Option("Alle Collections",""),...e.collections.map(s=>new Option(s,s)));let o=I("#genreFilters");if(o){let s=e.genres.map(a=>{let i=document.createElement("button");return i.type="button",i.className="chip",i.textContent=a,i.dataset.name=a,i});o.replaceChildren(...s),Ot()}}function Fs(){var l,d,c,u,m;let e=document.getElementById("search")||document.getElementById("q"),t=((e==null?void 0:e.value)||"").trim(),n=((l=I("#onlyNew"))==null?void 0:l.checked)||!1,r=((d=I("#yearFrom"))==null?void 0:d.value)||"",o=((c=I("#yearTo"))==null?void 0:c.value)||"",s=((u=I("#collectionFilter"))==null?void 0:u.value)||"",a=((m=I("#sort"))==null?void 0:m.value)||"title-asc",i=new Set;return document.querySelectorAll("#genreFilters .chip.active").forEach(f=>i.add(f.dataset.name)),{query:t,onlyNew:n,yearFrom:r,yearTo:o,collection:s,genres:i,sort:a}}function Ee(){let e=S(),n=e.view==="shows"?e.shows:e.movies,r=Fs(),o=(n||[]).filter(a=>Ts(a,r)),s=xs(o,r.sort);return te({filtered:s}),s}function Is(){Ht||(Ht=Promise.resolve().then(()=>(Je(),wr))),Ht.then(e=>{let t=e&&e.renderGrid;typeof t=="function"&&t(S().view)}).catch(console.error)}function zt(e){Rt=typeof e=="function"?e:null}function Ie(){let e=Ee();if(Is(),Rt)try{let t=Array.isArray(e)?e.slice():[];Rt(t,S().view)}catch{}return e}function Ot(){let e=document.getElementById("genreFilters");if(!e)return;let t=e.querySelectorAll(".chip.active").length;e.dataset.state=t>0?"active":"empty",e.dataset.count=String(t)}function Kt(){let e=I("#sort");e&&e.options.length===0&&[["title-asc","Titel A\u2013Z"],["title-desc","Titel Z\u2013A"],["year-desc","Jahr \u2193"],["year-asc","Jahr \u2191"],["added-desc","Zuletzt hinzugef\xFCgt"]].forEach(([o,s])=>e.add(new Option(s,o)));let t=(o,s="input")=>{let a=I(o);a&&(a.addEventListener(s,()=>{Ie()}),s==="input"&&a instanceof HTMLInputElement&&a.type==="search"&&a.addEventListener("search",()=>{Ie()}))};t("#search"),t("#q"),t("#onlyNew","change"),t("#yearFrom","change"),t("#yearTo","change"),t("#collectionFilter","change"),t("#sort","change"),t("#groupCollections","change");let n=I("#yearReset");n&&n.addEventListener("click",()=>{let o=I("#yearFrom"),s=I("#yearTo");o&&(o.value=""),s&&(s.value=""),Ie()});let r=I("#genreFilters");r&&(r.addEventListener("click",o=>{let s=o.target;s instanceof HTMLElement&&s.classList.contains("chip")&&(s.classList.toggle("active"),Ot(),Ie())}),Ot())}var Ht,Rt,Gt=k(()=>{K();Ne();oe();Ht=null;Rt=null});var Ae={};Ce(Ae,{clearCache:()=>Ns,hydrateOptional:()=>Xt,validateToken:()=>Os});function Ls(){try{return new Map(JSON.parse(localStorage.getItem("tmdbCache")||"[]"))}catch{return new Map}}function Ms(){try{localStorage.setItem("tmdbCache",JSON.stringify(Array.from(ie.entries())))}catch{}}function Ns(){try{localStorage.removeItem("tmdbCache")}catch{}ie=new Map}function _s(e){try{let t=localStorage.getItem("tmdbToken");if(t)return{kind:"bearer",value:t}}catch{}return e!=null&&e.tmdbApiKey?{kind:"apikey",value:String(e.tmdbApiKey)}:{kind:"none",value:""}}function Bs(e){var a,i;let t=e.type==="tv"?"tv":"movie",n=((a=e==null?void 0:e.ids)==null?void 0:a.imdb)||"",r=((i=e==null?void 0:e.ids)==null?void 0:i.tmdb)||"",o=(e.title||"").toLowerCase(),s=String(e.year||"").slice(0,4);return[t,n,r,o,s].filter(Boolean).join("|")}function Vt(e,t){if(!t||t.kind==="none")return{url:e,init:{}};if(t.kind==="bearer")return{url:e,init:{headers:{Authorization:`Bearer ${t.value}`,Accept:"application/json"}}};let n=e.includes("?")?"&":"?";return{url:`${e}${n}api_key=${encodeURIComponent(t.value)}`,init:{headers:{Accept:"application/json"}}}}async function Qe(e,t){let{url:n,init:r}=Vt(e,t),o=await fetch(n,r);if(!o.ok)throw new Error("HTTP "+o.status);return o.json()}function $s(e){return e!=null&&e.file_path?Ze+Ar+e.file_path:""}function Ps(e){return e!=null&&e.file_path?Ze+kr+e.file_path:""}async function Ut(e,t,n,r){let o=await Qe(`${Se}/${e}/${t}?language=${encodeURIComponent(n||"de-DE")}`,r),s=await Qe(`${Se}/${e}/${t}/images`,r).catch(l=>({posters:[],backdrops:[]})),a=$s((s.posters||[])[0])||(o.poster_path?Ze+Ar+o.poster_path:""),i=Ps((s.backdrops||[])[0])||(o.backdrop_path?Ze+kr+o.backdrop_path:"");return{id:o.id,poster:a,backdrop:i,url:`https://www.themoviedb.org/${e}/${o.id}`}}async function Hs(e,t,n,r,o){let s=encodeURIComponent(t||""),a=n?`&year=${encodeURIComponent(String(n))}`:"",l=((await Qe(`${Se}/search/${e}?query=${s}${a}&language=${encodeURIComponent(r||"de-DE")}`,o)).results||[])[0];if(!l)throw new Error("not found");return Ut(e,l.id,r,o)}async function Rs(e,t,n){var a,i;let r=e.type==="tv"?"tv":"movie",o=Bs(e);if(ie.has(o))return ie.get(o);let s;try{if((a=e==null?void 0:e.ids)!=null&&a.tmdb)s=await Ut(r,e.ids.tmdb,t.lang,n);else if((i=e==null?void 0:e.ids)!=null&&i.imdb){let d=await Qe(`${Se}/find/${e.ids.imdb}?external_source=imdb_id&language=${encodeURIComponent(t.lang||"de-DE")}`,n),c=r==="movie"?(d.movie_results||[])[0]:(d.tv_results||[])[0];if(c)s=await Ut(r,c.id,t.lang,n);else throw new Error("not found")}else s=await Hs(r,e.title,e.year,t.lang,n)}catch{s=null}return ie.set(o,s),Ms(),s}async function Xt(e,t,n={}){try{ie=ie||Ls();let r=_s(n);if(!r.value)return;let o=(e||[]).concat(t||[]),s=0,a=40,i=async()=>{let l=o.slice(s,s+4);s+=4,await Promise.all(l.map(async d=>{let c=await Rs(d,n,r);c&&(d.tmdb={id:c.id,poster:c.poster,backdrop:c.backdrop,url:c.url},d.ids=d.ids||{},!d.ids.tmdb&&c.id&&(d.ids.tmdb=String(c.id)))}));try{window.dispatchEvent(new CustomEvent("tmdb:chunk",{detail:{updated:l.length,index:s}}))}catch{}if(s<Math.min(o.length,a))(window.requestIdleCallback||setTimeout)(i,250);else try{window.dispatchEvent(new CustomEvent("tmdb:done",{detail:{total:Math.min(o.length,a)}}))}catch{}};i()}catch{}}async function Os(e){let t=String(e||"").trim();if(!t)throw new Error("empty");let n=/^[a-f0-9]{32}$/i.test(t),r=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+$/.test(t),o=s=>{try{let a=s.split(".")[1],l=atob((d=>d+"=".repeat((4-d.length%4)%4))(a.replace(/-/g,"+").replace(/_/g,"/")));return JSON.parse(l)}catch{return null}};if(n){let{url:s,init:a}=Vt(`${Se}/configuration`,{kind:"apikey",value:t});return(await fetch(s,a)).ok?{ok:!0,as:"apikey",hint:"v3Key"}:{ok:!1,as:"apikey",hint:"looksV3"}}if(r){let s=o(t);if(s&&typeof s=="object"){let l=String(s.iss||"");if(l&&!/themoviedb\.org/i.test(l))return{ok:!1,as:"bearer",hint:"issMismatch"}}let{url:a,init:i}=Vt(`${Se}/trending/movie/day`,{kind:"bearer",value:t});try{if((await fetch(a,i)).ok)return{ok:!0,as:"bearer",hint:null}}catch{}return{ok:!0,as:"bearer",hint:"structOnly"}}return{ok:!1,as:"bearer",hint:null}}var Se,Ze,Ar,kr,ie,le=k(()=>{Se="https://api.themoviedb.org/3",Ze="https://image.tmdb.org/t/p/",Ar="w342",kr="w780"});function Tr(){let e=document.getElementById("openDebug");e&&e.addEventListener("click",()=>{Ds()})}function Ds(){var t,n,r,o;let e=document.getElementById("debugOverlay");e||(e=document.createElement("div"),e.id="debugOverlay",e.className="debug-overlay",e.innerHTML=`
      <div class="debug-dialog">
        <div class="debug-header"><h2>Debug</h2></div>
        <div class="debug-body">
          <pre id="debugPre" class="debug-pre"></pre>
          <div class="debug-cache-controls">
            <h3>Cache-Verwaltung</h3>
            <div id="cacheStats" class="cache-stats"></div>
            <div class="cache-buttons">
              <button id="debugClearExpired" class="btn">Abgelaufene l\xF6schen</button>
              <button id="debugClearAll" class="btn">Alles l\xF6schen</button>
            </div>
          </div>
        </div>
        <div class="debug-actions">
          <button id="debugCopy" class="btn">Copy report</button>
          <button id="debugClose" class="btn">Schlie\xDFen</button>
        </div>
      </div>`,document.body.append(e)),e.hidden=!1,Wt(),e.addEventListener("click",s=>{s.target===e&&Cr()}),(t=document.getElementById("debugClose"))==null||t.addEventListener("click",Cr,{once:!0}),(n=document.getElementById("debugCopy"))==null||n.addEventListener("click",js,{once:!0}),(r=document.getElementById("debugClearExpired"))==null||r.addEventListener("click",()=>{Pe(),Wt()},{once:!0}),(o=document.getElementById("debugClearAll"))==null||o.addEventListener("click",()=>{confirm("Wirklich den gesamten Cache l\xF6schen?")&&(un(),Wt())},{once:!0})}function Cr(){let e=document.getElementById("debugOverlay");e&&(e.hidden=!0)}function Wt(){let e=document.getElementById("debugPre");if(!e)return;let t=S(),n=xn(),r=t.cfg||{},o=it(),s={view:t.view,counts:{movies:(t.movies||[]).length,shows:(t.shows||[]).length,filtered:(t.filtered||[]).length},dataSources:n,cache:o,tmdb:{enabled:!!r.tmdbEnabled,lang:r.lang,tokenPresent:!!(localStorage.getItem("tmdbToken")||r.tmdbApiKey)},useTmdbImages:localStorage.getItem("useTmdb")==="1",reduceMotion:localStorage.getItem("prefReduceMotion")==="1",locationHash:location.hash,userAgent:navigator.userAgent};e.textContent=JSON.stringify(s,null,2);let a=document.getElementById("cacheStats");a&&o&&(a.innerHTML=`
      <p>Eintr\xE4ge gesamt: <strong>${o.totalEntries}</strong></p>
      <p>G\xFCltig: <strong>${o.validEntries}</strong> | Abgelaufen: <strong>${o.expiredEntries}</strong></p>
      <p>Gr\xF6\xDFe: <strong>${o.totalSizeMB} MB</strong></p>
    `)}function js(){var n;let e=document.getElementById("debugPre");if(!e)return;let t=e.textContent||"";(n=navigator.clipboard)==null||n.writeText(t).catch(r=>{try{let o=document.createElement("textarea");o.value=t,document.body.append(o),o.select(),document.execCommand("copy"),o.remove()}catch{}})}var xr=k(()=>{K();he();lt()});function Ir(e){Yt=typeof e=="function"?e:null}function Lr(e){Zt=typeof e=="function"?e:null}function Jt(e){if(Yt)try{Yt(e)}catch{}}function Ks(e){if(Zt)try{Zt(e)}catch{}}function Mr(e){let t=document.getElementById("settingsOverlay"),n=t==null?void 0:t.querySelector(".settings-dialog"),r=document.getElementById("settingsBtn"),o=document.getElementById("openSettings"),s=document.getElementById("headerSettingsBtn"),a=document.getElementById("settingsClose2"),i=document.getElementById("tmdbTokenInput"),l=document.getElementById("tmdbSave"),d=document.getElementById("tmdbTest"),c=document.getElementById("tmdbStatus"),u=document.getElementById("tmdbClearCache"),m=document.getElementById("tmdbStatusBadge"),f=document.getElementById("prefReduceMotion"),p=document.getElementById("useTmdbSetting"),h=document.getElementById("resetFilters");t&&t.hidden&&t.setAttribute("aria-hidden","true");let g=null,w="",C=!1,M=new Map,ee='a[href], button:not([disabled]), input:not([disabled]), select:not([disabled]), textarea:not([disabled]), [tabindex]:not([tabindex="-1"])';function x(){return t?Array.from(t.querySelectorAll(ee)).filter(b=>!b.hasAttribute("disabled")&&b.getAttribute("aria-hidden")!=="true"):[]}function L(){n&&typeof n.focus=="function"?n.focus({preventScroll:!0}):t&&typeof t.focus=="function"&&t.focus({preventScroll:!0})}function F(b){if(!t)return;let E=Array.from(document.body.children).filter(y=>y!==t);b?E.forEach(y=>{M.has(y)||M.set(y,{ariaHidden:y.hasAttribute("aria-hidden")?y.getAttribute("aria-hidden"):null,inert:y.hasAttribute("inert")}),y.setAttribute("aria-hidden","true"),y.setAttribute("inert","")}):(E.forEach(y=>{let v=M.get(y);v?(v.ariaHidden===null||v.ariaHidden===void 0?y.removeAttribute("aria-hidden"):y.setAttribute("aria-hidden",v.ariaHidden),v.inert?y.setAttribute("inert",""):y.removeAttribute("inert"),M.delete(y)):(y.removeAttribute("aria-hidden"),y.removeAttribute("inert"))}),M.clear())}function $(){!t||C||(C=!0,t.hidden=!1,t.setAttribute("aria-hidden","false"),g=document.activeElement instanceof HTMLElement?document.activeElement:null,w=document.body.style.overflow,document.body.style.overflow="hidden",F(!0),zr(),requestAnimationFrame(L))}function N(){!t||!C||(C=!1,t.hidden=!0,t.setAttribute("aria-hidden","true"),F(!1),document.body.style.overflow=w,g&&typeof g.focus=="function"&&g.focus(),g=null)}function z(b){if(!C)return;if(b.key==="Escape"){b.preventDefault(),N();return}if(b.key!=="Tab")return;let E=x();if(!E.length){b.preventDefault(),L();return}let y=E[0],v=E[E.length-1],V=document.activeElement;b.shiftKey?(V===y||!t.contains(V))&&(b.preventDefault(),v.focus()):V===v&&(b.preventDefault(),y.focus())}r&&r.addEventListener("click",$),o&&o.addEventListener("click",()=>{$()}),s&&s.addEventListener("click",$),a&&a.addEventListener("click",N),t&&t.addEventListener("click",b=>{b.target===t&&N()}),t&&t.addEventListener("keydown",z);function A(b="",E=""){if(c){c.textContent=b,c.dataset.kind=E,m&&(m.dataset.kind=E||"",m.title=b||"");try{if(E==="error"&&e&&e.tmdbApiKey){let y=String(localStorage.getItem("tmdbToken")||"").trim(),v=String((i==null?void 0:i.value)||"").trim();if(y&&v){try{localStorage.removeItem("tmdbToken")}catch{}i&&(i.value=""),X(!0);let V="Ung\xFCltiger Token entfernt. Verwende API Key aus config.json.";c.textContent=V,c.dataset.kind="info",m&&(m.dataset.kind="info",m.title=V)}}}catch{}}}function X(b){if(p&&(p.disabled=!b,p.title=p.disabled?"Nur verf\xFCgbar mit g\xFCltigem Token oder API Key.":"",!b&&p.checked)){try{localStorage.setItem("useTmdb","0")}catch{}p.checked=!1,H(S().view),Jt()}}function zr(){let b="";try{i&&(i.value=b=localStorage.getItem("tmdbToken")||"")}catch{}try{f&&(f.checked=localStorage.getItem("prefReduceMotion")==="1")}catch{}try{p&&(p.checked=localStorage.getItem("useTmdb")==="1",p.disabled=!b,p.title=p.disabled?"Nur verf\xFCgbar mit g\xFCltigem Token.":"")}catch{}try{X(!!b||!!(e&&e.tmdbApiKey))}catch{}A("",""),b||A("Kein Token hinterlegt. TMDB ist deaktiviert.","info"),e!=null&&e.tmdbEnabled||A("Hinweis: TMDB in config.json deaktiviert (tmdbEnabled=false).","info"),b?(async()=>{var E;A("Pr\xFCfe Token...","pending");try{let y=await Promise.resolve().then(()=>(le(),Ae)),v=await((E=y.validateToken)==null?void 0:E.call(y,b));v&&v.ok?(X(!0),v.as==="bearer"?A("Token g\xFCltig (v4 Bearer).","success"):v.as==="apikey"&&A('API Key g\xFCltig (v3). Tipp: dauerhaft in site/config.json unter "tmdbApiKey" eintragen.',"success")):(X(!1),(v==null?void 0:v.hint)==="looksV3"?A('Eingegebener Wert sieht wie ein v3 API Key aus. Bitte in config.json als "tmdbApiKey" eintragen oder v4 Bearer Token verwenden.',"error"):A("Token ung\xFCltig oder keine Berechtigung (401).","error"))}catch{A("Pr\xFCfung fehlgeschlagen. Netzwerk/Browser-Konsole pr\xFCfen.","error")}})():X(!!(e&&e.tmdbApiKey))}l&&l.addEventListener("click",async()=>{var E;let b=String((i==null?void 0:i.value)||"").trim();try{localStorage.setItem("tmdbToken",b)}catch{}if(!b){A("Kein Token hinterlegt. TMDB ist deaktiviert.","info"),X(!!(e&&e.tmdbApiKey));return}A("Pr\xFCfe Token...","pending");try{let y=await Promise.resolve().then(()=>(le(),Ae)),v=await((E=y.validateToken)==null?void 0:E.call(y,b));v&&v.ok?(X(!0),v.as==="bearer"?A("Token g\xFCltig (v4 Bearer).","success"):v.as==="apikey"&&A('API Key g\xFCltig (v3). Tipp: dauerhaft in site/config.json unter "tmdbApiKey" eintragen.',"success")):(X(!1),(v==null?void 0:v.hint)==="looksV3"?A('Eingegebener Wert sieht wie ein v3 API Key aus. Bitte in config.json als "tmdbApiKey" eintragen oder v4 Bearer Token verwenden.',"error"):A("Token ung\xFCltig oder keine Berechtigung (401).","error"))}catch{A("Pr\xFCfung fehlgeschlagen. Netzwerk/Browser-Konsole pr\xFCfen.","error")}}),d&&d.addEventListener("click",async()=>{var E;let b=String((i==null?void 0:i.value)||"").trim();if(!b){A("Bitte Token eingeben.","error");return}A("Pr\xFCfe Token...","pending");try{let y=await Promise.resolve().then(()=>(le(),Ae)),v=await((E=y.validateToken)==null?void 0:E.call(y,b));v&&v.ok?v.as==="bearer"?A("Token g\xFCltig (v4 Bearer).","success"):v.as==="apikey"&&A('API Key g\xFCltig (v3). Tipp: dauerhaft in site/config.json unter "tmdbApiKey" eintragen.',"success"):(v==null?void 0:v.hint)==="looksV3"?A('Eingegebener Wert sieht wie ein v3 API Key aus. Dieser funktioniert hier nicht als Bearer. Bitte in config.json als "tmdbApiKey" eintragen oder v4 Bearer Token verwenden.',"error"):A("Token ung\xFCltig oder keine Berechtigung (401).","error")}catch{A("Pr\xFCfung fehlgeschlagen. Netzwerk/Browser-Konsole pr\xFCfen.","error")}}),u&&u.addEventListener("click",()=>{Promise.resolve().then(()=>(le(),Ae)).then(b=>{var E;return(E=b.clearCache)==null?void 0:E.call(b)})}),f&&f.addEventListener("change",()=>{try{localStorage.setItem("prefReduceMotion",f.checked?"1":"0")}catch{}Ks(f.checked)}),p&&p.addEventListener("change",()=>{try{localStorage.setItem("useTmdb",p.checked?"1":"0")}catch{}p.checked&&!Fr&&(Fr=!0,Promise.resolve().then(()=>(le(),Ae)).then(b=>{var y;let E=S();(y=b.hydrateOptional)==null||y.call(b,E.movies,E.shows,E.cfg)}).catch(b=>{}),setTimeout(()=>{p.checked&&H(S().view)},1200),setTimeout(()=>{p.checked&&H(S().view)},3e3)),H(S().view),Jt()}),h&&h.addEventListener("click",()=>{let b=document.getElementById("search");b&&(b.value="");let E=document.getElementById("q");E&&(E.value="");let y=document.getElementById("onlyNew");y&&(y.checked=!1);let v=document.getElementById("yearFrom"),V=document.getElementById("yearTo");v&&(v.value=""),V&&(V.value="");let tt=document.getElementById("collectionFilter");tt&&(tt.value=""),document.querySelectorAll("#genreFilters .chip.active").forEach(rt=>rt.classList.remove("active"));let nt=document.getElementById("genreFilters");nt&&(nt.dataset.state="empty",nt.dataset.count="0"),Promise.resolve().then(()=>(Gt(),qt)).then(rt=>{let Kr=rt.applyFilters();H(S().view),Jt(Kr)})})}var Yt,Zt,Fr,Nr=k(()=>{K();Je();Yt=null,Zt=null,Fr=!1});function _r(e){return Le=e||null,Le}function qs(){return et}function Gs(){var t,n,r;if(et)return et;let e={title:((t=document.getElementById("heroTitle"))==null?void 0:t.textContent)||"",subtitle:((n=document.getElementById("heroSubtitle"))==null?void 0:n.textContent)||"",cta:((r=document.getElementById("heroCta"))==null?void 0:r.textContent)||""};return et=e,e}function Hr(e){Qt=typeof e=="function"?e:null}function j(e){let t=document.getElementById("hero"),n=document.getElementById("heroTitle"),r=document.getElementById("heroSubtitle"),o=document.getElementById("heroCta");if(!t||!n||!r||!o)return;let s=Gs(),a=Vs(e);if(!a){_r(null),n.textContent=s.title,r.textContent=s.subtitle,r.dataset.taglinePaused="0",delete r.dataset.heroBound,r.classList.remove("is-fading"),o.textContent=s.cta,o.disabled=!0,o.setAttribute("aria-disabled","true"),o.removeAttribute("aria-label"),o.onclick=null,t.style.backgroundImage="",t.classList.remove("has-poster"),t.dataset.heroKind="",t.dataset.heroId="";return}_r(a);let i=a.type==="tv"?"show":"movie",l=Qs(a);n.textContent=a.title||s.title,r.textContent=Xs(a),r.dataset.taglinePaused="1",r.dataset.heroBound="1",r.classList.remove("is-fading");let d=i==="show"?"Serien-Details \xF6ffnen":"Film-Details \xF6ffnen";o.textContent=d,o.disabled=!1,o.setAttribute("aria-disabled","false"),o.setAttribute("aria-label",a.title?`${d}: ${a.title}`:d),o.onclick=()=>ea(a,i,l),t.dataset.heroKind=i,t.dataset.heroId=l||"";let c=na(a);c?(t.style.backgroundImage=`url(${c})`,t.classList.add("has-poster")):(t.style.backgroundImage="",t.classList.remove("has-poster"))}function Vs(e){if(Array.isArray(e)){let r=e.filter($r);return r.length?Br(r):null}let n=Us().filter($r);return n.length?Br(n):null}function Br(e){if(e.length===1)return e[0];let t=Math.floor(Math.random()*e.length),n=e[t];return Le&&e.length>1&&n===Le&&e.find(o=>o!==Le)||n}function Us(){let e=S(),t=e.view==="shows"?"shows":"movies",r=(Array.isArray(e.filtered)&&e.filtered.length?e.filtered:null)||(t==="shows"?e.shows:e.movies)||[];return Array.isArray(r)?r:[]}function $r(e){return!!e&&typeof e=="object"&&!e.isCollectionGroup&&e.type!=="collection"}function Xs(e){var l;let t=[],n=_(e);n&&t.push(String(n));let r=Ws(e);r&&t.push(r);let o=Number((l=e==null?void 0:e.rating)!=null?l:e==null?void 0:e.audienceRating);Number.isFinite(o)&&t.push(`\u2605 ${R(o)}`);let s=Js(e,2);s.length&&t.push(s.join(", "));let a=Ys(e);if(a)return t.length?`${t.join(" \u2022 ")} \u2014 ${a}`:a;let i=qs();return t.length?t.join(" \u2022 "):(i==null?void 0:i.subtitle)||""}function Ws(e){var r,o;let t=(o=(r=e==null?void 0:e.runtimeMin)!=null?r:e==null?void 0:e.durationMin)!=null?o:e!=null&&e.duration?Math.round(Number(e.duration)/6e4):null,n=Number(t);return!Number.isFinite(n)||n<=0?"":(e==null?void 0:e.type)==="tv"?`~${n} min/Ep`:`${n} min`}function Js(e,t=3){let n=Array.isArray(e==null?void 0:e.genres)?e.genres:[],r=[];return n.forEach(s=>{if(!s)return;if(typeof s=="string"){r.push(s);return}let a=s.tag||s.title||s.name||s.label||"";a&&r.push(a)}),Array.from(new Set(r)).slice(0,Math.max(0,t))}function Ys(e){let t=[e==null?void 0:e.tagline,e==null?void 0:e.summary,e==null?void 0:e.plot,e==null?void 0:e.overview];for(let n of t){if(typeof n!="string")continue;let r=n.trim();if(r)return Zs(r,220)}return""}function Zs(e,t){let n=String(e||"").trim();return n?n.length<=t?n:`${n.slice(0,Math.max(0,t-1)).trimEnd()}\u2026`:""}function Qs(e){var t,n;return e?(t=e==null?void 0:e.ids)!=null&&t.imdb?String(e.ids.imdb):(n=e==null?void 0:e.ids)!=null&&n.tmdb?String(e.ids.tmdb):(e==null?void 0:e.ratingKey)!=null?String(e.ratingKey):"":""}function ea(e,t,n){n&&ta(t,n),t==="show"?we(e):ve(e)}function ta(e,t){if(!e||!t)return;let n=`#/${e}/${t}`,r=(window.location.hash||"")===n;if(typeof Qt=="function")try{Qt(n,{silent:!0,replace:r});return}catch{}try{window.location.hash=n}catch{}}function na(e){var s,a,i,l,d;if(!e)return"";let t=Y(),n=[(s=e==null?void 0:e.tmdb)==null?void 0:s.backdrop,(a=e==null?void 0:e.tmdb)==null?void 0:a.backdrop_path,(i=e==null?void 0:e.tmdb)==null?void 0:i.backdropPath,(l=e==null?void 0:e.tmdb)==null?void 0:l.background,(d=e==null?void 0:e.tmdb)==null?void 0:d.art],r=[e==null?void 0:e.art,e==null?void 0:e.background,e==null?void 0:e.thumbBackground,e==null?void 0:e.coverArt,e==null?void 0:e.thumb,e==null?void 0:e.thumbFile];if(t){let c=n.find(Pr);if(c)return c}return r.find(Pr)||""}function Pr(e){return typeof e=="string"&&e.trim().length>0}var Le,et,Qt,en=k(()=>{K();Ge();oe();Le=null,et=null,Qt=null});function Rr({onRefresh:e=j}={}){let t=document.getElementById("hero"),n=document.getElementById("heroTimer"),r=n?n.querySelector(".hero-timer__bar"):null;if(!t||!n||!r)return null;if(window.matchMedia&&window.matchMedia("(prefers-reduced-motion: reduce)").matches)return n.hidden=!0,null;n.removeAttribute("aria-hidden"),n.dataset.state="running";let s=15e3,a=new Set,i=!1,l=0,d=null,c=0;function u(){return a.size>0}function m(){let g=u();n.dataset.state=g?"paused":"running",i&&!g&&(c=0),i=g}function f(g,w){w?a.add(g):a.delete(g),m()}function p(g){if(u()){c=g,d=requestAnimationFrame(p);return}c||(c=g);let w=Math.max(0,g-c);c=g,l+=w;let C=Math.max(0,Math.min(1,l/s));if(r.style.setProperty("--p",String(C)),C>=1){l=0,c=g,r.style.setProperty("--p","0");try{e==null||e()}catch{}}d=requestAnimationFrame(p)}function h(){d||(d=requestAnimationFrame(p))}return t.addEventListener("mouseenter",()=>{f("hover",!0)}),t.addEventListener("mouseleave",()=>{f("hover",!1)}),document.addEventListener("visibilitychange",()=>{f("hidden",document.hidden)}),document.hidden?f("hidden",!0):m(),h(),{pause(){f("manual",!0)},resume(){f("manual",!1)},reset(){l=0,r.style.setProperty("--p","0")}}}var Or=k(()=>{en()});function Me(e,t=!0){let n=document.getElementById("footerMeta");if(n){let o=n.querySelector("#footerStatus");o?o.textContent=e:n.textContent=e,n.dataset.state=t?"loading":"ready"}let r=document.getElementById("grid");r&&r.setAttribute("aria-busy",t?"true":"false")}async function ra(){let e=!!globalThis.__PLEX_TEST_MODE__;Te(),ia(),sn(),Me("Initialisiere \u2026",!0),ce("Initialisiere \u2026",8),an(18);let t=await fetch("config.json").then(r=>r.json()).catch(r=>(ue("Konfiguration konnte nicht geladen werden","Verwende Standardeinstellungen"),{startView:"movies",tmdbEnabled:!1}));te({cfg:t,view:t.startView||"movies"});try{Me("Filme laden \u2026",!0),ce("Filme laden \u2026",25);let r=await kn();Me("Serien laden \u2026",!0),ce("Serien laden \u2026",45);let o=await Cn();Me("Filter vorbereiten \u2026",!0),ce("Filter vorbereiten \u2026",60);let s=Dt(r,o);if(te({movies:r,shows:o,facets:s}),Me("Ansicht aufbauen \u2026",!0),ce("Ansicht aufbauen \u2026",85),at(),rn(),jt(s),Kt(),Ee(),sa(!0),H(S().view),aa(),$e(),t.tmdbEnabled&&(window.requestIdleCallback||setTimeout)(()=>{var a;return(a=Xt)==null?void 0:a(r,o,t)},400),!e)Bn(),Mr(t),la(),ca(),da(),ua(),fa(),j(),Rr(),Tr();else try{j()}catch{}jr(!0)}catch(r){throw $e(),at(),ft("Fehler beim Laden der Daten",()=>window.location.reload()),r}let n;window.addEventListener("tmdb:chunk",()=>{n||(n=requestAnimationFrame(()=>{n=null;try{localStorage.getItem("useTmdb")==="1"&&(H(S().view),j())}catch{}}))}),window.addEventListener("tmdb:done",()=>{try{localStorage.getItem("useTmdb")==="1"&&(H(S().view),j())}catch{}})}function oa(e){if(/^#\/(movies|shows)$/.test(e)){let a=e.includes("shows")?"shows":"movies";te({view:a});let i=Ee();return rn(),H(a),j(i),!0}let t=e.match(/^#\/(movie|show)\/(.+)/);if(!t)return!1;let[,n,r]=t,s=((n==="movie"?S().movies:S().shows)||[]).find(a=>{var i,l;return((i=a==null?void 0:a.ids)==null?void 0:i.imdb)===r||((l=a==null?void 0:a.ids)==null?void 0:l.tmdb)===r||String(a==null?void 0:a.ratingKey)===r});return s?(n==="show"?we(s):ve(s),!0):!1}function jr(e=!1){let t=window.location.hash||"";!e&&!nn.shouldHandle(t)||(e&&nn.markProcessed(t),oa(t))}function rn(){let e=document.getElementById("libraryTabs");if(!e)return;let t=Array.from(e.querySelectorAll("[data-lib]")),n=S().view==="shows"?"shows":"movies";t.forEach(r=>{let o=r.dataset.lib==="series"?"shows":"movies",s=n===o;r.classList.toggle("is-active",s),r.setAttribute("aria-pressed",s?"true":"false"),r.dataset.bound!=="true"&&(r.addEventListener("click",()=>{let a=r.dataset.lib==="series"?"shows":"movies";if(S().view===a)return;te({view:a}),Ye(a==="movies"?"#/movies":"#/shows",{silent:!0}),rn();let l=Ee();H(a),j(l)}),r.dataset.bound="true")})}function sa(e=!1){let t=document.getElementById("heroStats");if(!t)return;let n=S(),r=(n.movies||[]).length,o=(n.shows||[]).length,s=t.querySelector('[data-stat="movies"]'),a=t.querySelector('[data-stat="shows"]');!s||!a||(e?(Dr(s,r),Dr(a,o)):(s.textContent=String(r),a.textContent=String(o)))}function Dr(e,t){if(!e)return;let n=Number(e.textContent)||0,r=Number(t)||0;if(n===r){e.textContent=String(r);return}let o=480,s=performance.now();function a(i){let l=Math.min(1,(i-s)/o),d=Math.round(n+(r-n)*(l<.5?2*l*l:-1+(4-2*l)*l));e.textContent=String(d),l<1?requestAnimationFrame(a):e.textContent=String(r)}requestAnimationFrame(a)}function aa(){let e=document.getElementById("footerMeta");if(!e)return;let t=document.getElementById("footerStatus"),n=S(),r=n.movies||[],o=n.shows||[],s=r.concat(o).map(d=>new Date(d.addedAt||0).getTime()).filter(Number.isFinite),i=(s.length?new Date(Math.max(...s)):new Date).toISOString().slice(0,10);t&&(t.textContent=`Stand: ${i}`),e.dataset.state="ready";let l=document.getElementById("grid");l&&l.setAttribute("aria-busy","false")}function on(e){var t,n;try{let r=document.body;r?((t=document.documentElement)==null||t.classList.remove("reduce-motion","reduced-motion"),r.classList.remove("reduced-motion"),r.classList.toggle("reduce-motion",e)):((n=document.documentElement)==null||n.classList.toggle("reduce-motion",e),window.addEventListener("DOMContentLoaded",()=>on(e),{once:!0}))}catch{}}function ia(){try{let e=localStorage.getItem("prefReduceMotion")==="1";on(e)}catch{}}function la(){let e=document.getElementById("toggleAdvanced"),t=document.getElementById("advancedFilters");if(!e||!t)return;let n=!1,r=0,o=()=>{n=!1,r&&(clearTimeout(r),r=0),t.dataset.state==="closing"?(t.dataset.state="closed",t.hidden=!0,t.style.removeProperty("--advanced-max")):t.dataset.state==="open"?t.style.removeProperty("--advanced-max"):t.dataset.state==="expanding"&&(t.dataset.state="open",t.style.removeProperty("--advanced-max"))},s=()=>{r&&clearTimeout(r),r=window.setTimeout(o,320)};t.addEventListener("transitionend",l=>{l.target!==t||l.propertyName!=="max-height"||o()});let a=()=>{n||(n=!0,t.hidden=!1,t.dataset.state="expanding",t.setAttribute("aria-hidden","false"),t.style.setProperty("--advanced-max","0px"),requestAnimationFrame(()=>{let l=t.scrollHeight;t.style.setProperty("--advanced-max",l+"px"),t.dataset.state="open",s()}))},i=()=>{if(n)return;n=!0;let l=t.scrollHeight;t.style.setProperty("--advanced-max",l+"px"),t.dataset.state="closing",t.setAttribute("aria-hidden","true"),requestAnimationFrame(()=>{t.style.setProperty("--advanced-max","0px"),s()})};e.addEventListener("click",()=>{e.getAttribute("aria-expanded")==="true"?(e.setAttribute("aria-expanded","false"),i()):(e.setAttribute("aria-expanded","true"),a())})}function ca(){let e=document.getElementById("siteLogo");e&&e.addEventListener("error",()=>{e.classList.add("logo-missing");let s=document.querySelector(".site-header__brand-text .site-header__label");s&&s.classList.remove("sr-only")});let t=document.getElementById("heroSubtitle"),n=["Offline st\xF6bern & Wunschlisten teilen","Filter. Finden. Freuen.","Filme & Serien \u2013 stressfrei sichtbar","Schneller als jeder SMB-Share","Merkliste zuerst, Streit sp\xE4ter"],r=0;t&&(t.textContent=n[r]);function o(){!t||t.dataset.taglinePaused==="1"||(t.classList.add("is-fading"),setTimeout(()=>{if(!t||t.dataset.taglinePaused==="1"){t&&t.classList.remove("is-fading");return}r=(r+1)%n.length,t.textContent=n[r],t.classList.remove("is-fading")},280))}t?(t.dataset.taglinePaused="0",ke&&clearInterval(ke),ke=setInterval(o,6e3),setTimeout(o,3e3)):ke&&(clearInterval(ke),ke=null)}function da(){let e=document.getElementById("scrollProgress");if(!e)return;let t=()=>{let n=document.documentElement.scrollTop||document.body.scrollTop||0,r=document.documentElement.scrollHeight-document.documentElement.clientHeight||1,o=Math.max(0,Math.min(100,n/r*100));e.style.width=o+"%"};addEventListener("scroll",t,{passive:!0}),t()}function ua(){let e=document.getElementById("scrollTop");if(!e)return;let t=()=>{let n=window.scrollY||0;e.style.display=n>300?"block":"none"};addEventListener("scroll",t,{passive:!0}),t(),e.addEventListener("click",()=>window.scrollTo({top:0,behavior:"smooth"}))}function fa(){let e=document.querySelector(".filters");if(!e||typeof CSS!="undefined"&&typeof CSS.supports=="function"&&CSS.supports("animation-timeline: scroll()"))return;let n=window.scrollY||window.pageYOffset||0,r=!1,o=!1,s=120,a=8,i=u=>{r!==u&&(r=u,e.classList.toggle("is-hidden",r))},l=()=>{o=!1;let u=window.scrollY||window.pageYOffset||0;if(u<=s){i(!1),n=u;return}let m=u-n;n=u,m>a?i(!0):m<-a&&i(!1)},d=()=>{o||(o=!0,requestAnimationFrame(l))};window.addEventListener("scroll",d,{passive:!0}),window.addEventListener("resize",l);let c=()=>i(!1);e.addEventListener("focusin",c),e.addEventListener("pointerenter",c,{passive:!0}),e.addEventListener("pointerdown",c,{passive:!0}),l()}var ke,nn,Ye,tn,Er=k(()=>{K();ln();he();Gt();Je();Ge();le();At();xr();ht();Nr();en();Or();ke=null,nn=(()=>{let e=window.location.hash||"",t=null;function n(a){if(typeof a!="string")return"";let i=a.trim();return i?i.startsWith("#")?i:`#${i}`:""}function r(a,i={}){let{replace:l=!1,silent:d=!1}=i,c=n(a);if(!c)return;let u=window.location.hash||"";if(c===u){if(l&&history&&typeof history.replaceState=="function")try{history.replaceState(null,"",c)}catch{}d&&(t=c,e=c);return}let m=l?"replaceState":"pushState",f=!1;try{history&&typeof history[m]=="function"&&(history[m](null,"",c),f=!0)}catch{}if(!f){window.location.hash=c,d&&(t=c,e=c);return}if(d){t=c,e=c;return}try{let p=typeof HashChangeEvent=="function"?new HashChangeEvent("hashchange"):new Event("hashchange");window.dispatchEvent(p)}catch{}}function o(a){let i=typeof a=="string"?a:"";return t&&i===t?(t=null,!1):(t=null,i===e?!1:(e=i,!0))}function s(a){e=typeof a=="string"?a:"",t=null}return{navigate:r,shouldHandle:o,markProcessed:s}})(),Ye=(e,t)=>nn.navigate(e,t);Hr(Ye);tn=null;window.addEventListener("hashchange",()=>{tn&&clearTimeout(tn),tn=setTimeout(()=>{jr(!1)},50)});zt(e=>{try{j(e)}catch{}});Ir(e=>{try{j(e)}catch{}});Lr(e=>{try{on(!!e)}catch{}});globalThis.__PLEX_TEST_MODE__||ra();window.addEventListener("load",()=>{try{$e()}catch{}})});Er();export{ra as boot,Ye as navigateToHash};
//# sourceMappingURL=main.js.map
