var Rn=Object.defineProperty;var F=(e,t)=>()=>(e&&(t=e(e=0)),t);var Xe=(e,t)=>{for(var n in t)Rn(e,n,{get:t[n],enumerable:!0})};function te(e){Object.assign(Ze,e),Hn.forEach(t=>t(Ze))}var Ze,Hn,v,G=F(()=>{Ze={view:"movies",movies:[],shows:[],facets:{},filtered:[],cfg:{}},Hn=new Set,v=()=>Ze});function C(e,t,n){let r=document.createElement(e);return t&&(r.className=t),n!=null&&(r.textContent=n),r}var x,Be=F(()=>{x=(e,t=document)=>t.querySelector(e)});function Kt(e,t,n=864e5){try{let r=ne+e,o={value:t,timestamp:Date.now(),ttl:n};localStorage.setItem(r,JSON.stringify(o)),qn()}catch(r){if(r.name==="QuotaExceededError"){Vt();try{let o=ne+e,a={value:t,timestamp:Date.now(),ttl:n};localStorage.setItem(o,JSON.stringify(a))}catch{}}}}function zt(e){try{let t=ne+e,n=localStorage.getItem(t);if(!n)return null;let r=JSON.parse(n),o=Date.now();return r.timestamp+r.ttl<o?(localStorage.removeItem(t),null):r.value}catch{return null}}function Ot(){try{Object.keys(localStorage).forEach(t=>{t.startsWith(ne)&&localStorage.removeItem(t)})}catch{}}function $e(){try{let e=Object.keys(localStorage),t=Date.now(),n=0;e.forEach(r=>{if(r.startsWith(ne))try{let o=JSON.parse(localStorage.getItem(r));o.timestamp+o.ttl<t&&(localStorage.removeItem(r),n++)}catch{localStorage.removeItem(r),n++}}),n>0}catch{}}function tt(){try{let t=Object.keys(localStorage).filter(s=>s.startsWith(ne)),n=Date.now(),r=0,o=0,a=0;return t.forEach(s=>{let i=localStorage.getItem(s);r+=i.length*2;try{let c=JSON.parse(i);c.timestamp+c.ttl>=n?o++:a++}catch{a++}}),{totalEntries:t.length,validEntries:o,expiredEntries:a,totalSize:r,totalSizeMB:(r/1024/1024).toFixed(2)}}catch{return null}}function qn(){try{let e=tt();e&&e.totalSize>5242880&&Vt(.3)}catch{}}function Vt(e=.3){try{let t=Object.keys(localStorage),n=[];t.forEach(o=>{if(o.startsWith(ne))try{let a=JSON.parse(localStorage.getItem(o));n.push({key:o,timestamp:a.timestamp})}catch{n.push({key:o,timestamp:0})}}),n.sort((o,a)=>o.timestamp-a.timestamp);let r=Math.ceil(n.length*e);for(let o=0;o<r;o++)localStorage.removeItem(n[o].key)}catch{}}var ne,Kn,nt=F(()=>{ne="plex_cache_";Kn=null;typeof window!="undefined"&&typeof window.document!="undefined"&&window===globalThis&&($e(),Kn=setInterval($e,5*60*1e3))});async function rt(e,t=2,n=!0){if(n){let o=zt(e);if(o!==null)return o}let r=null;for(let o=0;o<=t;o++){try{let a=await fetch(e,{cache:"no-store"});if(a&&a.ok){let s=await a.json();return n&&s&&Kt(e,s,zn),s}if(a&&a.status===404)return null;r=new Error(`HTTP ${a.status}: ${a.statusText}`)}catch(a){r=a}if(o<t){let a=Math.min(1e3*Math.pow(2,o),5e3);await new Promise(s=>setTimeout(s,a))}}return null}function Un(e){try{let t=document.getElementById(e);if(t&&t.textContent)return JSON.parse(t.textContent)}catch{}return null}function Jn(e){try{let t=window.__PLEX_EXPORTER__;return(t&&Array.isArray(t[e])?t[e]:null)||null}catch{return null}}function Gn(e){try{return(Array.isArray(window[e])?window[e]:null)||null}catch{return null}}async function Gt(e,t){let n=await rt(e);if(Array.isArray(n)&&n.length)return ue(t==null?void 0:t.label,`primary:${e}`),n;if(t!=null&&t.embedId){let r=Un(t.embedId);if(Array.isArray(r)&&r.length)return ue(t==null?void 0:t.label,`embedded:${t.embedId}`),r}if(t!=null&&t.exportKey){let r=Jn(t.exportKey);if(Array.isArray(r)&&r.length)return ue(t==null?void 0:t.label,`globalBag:${t.exportKey}`),r}if(t!=null&&t.globalVar){let r=Gn(t.globalVar);if(Array.isArray(r)&&r.length)return ue(t==null?void 0:t.label,`window:${t.globalVar}`),r}for(let r of(t==null?void 0:t.altUrls)||[]){let o=await rt(r);if(Array.isArray(o)&&o.length)return ue(t==null?void 0:t.label,`alt:${r}`),o}return ue(t==null?void 0:t.label,"empty"),Array.isArray(n)?n:[]}function Yn(e,t){let n=e==null?"":String(e).trim();if(!n)return"";if(n.startsWith("//")||n.startsWith("/")||Wn.test(n))return n;let r=n.replace(/\\/g,"/"),o=t?t.endsWith("/")?t:`${t}/`:"",a=f=>f.split("/").map(b=>{if(!b)return"";try{return encodeURIComponent(decodeURIComponent(b))}catch{return encodeURIComponent(b)}}).join("/"),i=r.replace(/^\/+/,"").split("/"),c=[];for(let f of i)if(!(!f||f===".")){if(f===".."){c.length&&c.pop();continue}c.push(f)}let l=c.join("/");if(l.startsWith("data/"))return a(l);let d=c;if(o&&d.length){let f=o.replace(/\/+$/,"").split("/").pop();f&&d[0]===f&&(d=d.slice(1))}let u=d.join("/"),h=a(u);return`${o}${h}`}function Yt(e,t){var o,a;if(!e||typeof e!="object")return e;let n=(a=(o=e.thumbFile)!=null?o:e.thumb)!=null?a:"",r=Yn(n,t);if(r)e.thumbFile=r,e.thumb=r;else if(n){let s=String(n);e.thumbFile=s,e.thumb==null&&(e.thumb=s)}return e}function Xn(e){return Yt(e,On)}function D(e){return Yt(e,Vn)}function Xt(e){return!e||typeof e!="object"||(D(e),Array.isArray(e.seasons)&&e.seasons.forEach(Zt)),e}function Zt(e){return!e||typeof e!="object"||(D(e),Array.isArray(e.episodes)&&e.episodes.forEach(t=>D(t))),e}function Zn(e){return Array.isArray(e)?(e.forEach(t=>{t&&typeof t=="object"&&Xn(t)}),e):[]}function Qn(e){return Array.isArray(e)?(e.forEach(t=>{t&&typeof t=="object"&&Xt(t)}),e):[]}async function ot(){try{let e=await Gt("data/movies/movies.json",{label:"movies",embedId:"movies-json",exportKey:"movies",globalVar:"__PLEX_MOVIES__",altUrls:["movies/movies.json","data/movies.json","Filme/movies.json","movies.json"]});return X.movies=0,Zn(e)}catch(e){if(X.movies<Jt)return X.movies++,await new Promise(t=>setTimeout(t,1e3*X.movies)),ot();throw e}}async function at(){try{let e=await Gt("data/series/series_index.json",{label:"shows",embedId:"series-json",exportKey:"shows",globalVar:"__PLEX_SHOWS__",altUrls:["series/series_index.json","data/shows.json","data/series.json","Serien/series.json","series/series.json","series.json","shows.json"]});return X.shows=0,Qn(e)}catch(e){if(X.shows<Jt)return X.shows++,await new Promise(t=>setTimeout(t,1e3*X.shows)),at();throw e}}async function Qt(e){if(!e)return null;let t=er(e),n=tr(t);if(n!==void 0)return n;let r=nr(e),o=null;for(let a of r)try{let s=await rt(a);if(s&&typeof s=="object"){let i=rr(s);return Wt(t,i,e),tn(i)}}catch(s){o=s}return Wt(t,null,e),null}function ue(e,t){if(e)try{Ut[e]=t}catch{}}function en(){return{...Ut}}function er(e){let t=[];(e==null?void 0:e.ratingKey)!==void 0&&(e==null?void 0:e.ratingKey)!==null&&(e==null?void 0:e.ratingKey)!==""&&t.push(`rk:${String(e.ratingKey)}`);let n=_e(e==null?void 0:e.href);return n&&t.push(`href:${n}`),t}function _e(e){return e?String(e).trim().replace(/^\.\//,"").replace(/^\/+/,""):""}function tr(e){for(let t of e)if(re.has(t)){let n=re.get(t);return n?tn(n):null}}function Wt(e,t,n){let r=t;e.forEach(c=>{re.set(c,r)});let o=n==null?void 0:n.ratingKey;o!=null&&re.set(`rk:${String(o)}`,r);let a=t&&typeof t=="object"?t.ratingKey:void 0;a!=null&&re.set(`rk:${String(a)}`,r);let s=_e(n==null?void 0:n.href);s&&re.set(`href:${s}`,r);let i=t&&typeof t=="object"?_e(t.href):"";i&&re.set(`href:${i}`,r)}function nr(e){let t=new Set,n=_e(e==null?void 0:e.href);if(n)if(/^https?:/i.test(n))t.add(n);else{n.startsWith("data/")?t.add(n):t.add(`data/${n}`);let o=n.replace(/^data\//,"");o.startsWith("series/")||t.add(`data/series/${o}`);let a=o.replace(/^series\//,"").replace(/^details\//,"").replace(/\.json$/,"");a&&t.add(`data/series/details/${a}.json`)}let r=e==null?void 0:e.ratingKey;return r!=null&&t.add(`data/series/details/${String(r)}.json`),Array.from(t)}function rr(e){if(!e||typeof e!="object")return null;let t={...e};D(t),t.genres=st(t.genres);let n=sr(t.cast||t.roles||[]);return t.cast=n,t.roles=n,t.seasons=Array.isArray(t.seasons)?t.seasons.map(or).filter(Boolean):[],t.seasonCount=Number.isFinite(t.seasonCount)?t.seasonCount:t.seasons.length,Xt(t),t}function or(e){if(!e||typeof e!="object")return null;let t={...e};return D(t),t.genres=st(t.genres),t.episodes=Array.isArray(t.episodes)?t.episodes.map(ar).filter(Boolean):[],Zt(t),t}function ar(e){if(!e||typeof e!="object")return null;let t={...e};return D(t),t.genres=st(t.genres),t}function st(e){if(!Array.isArray(e))return[];let t=new Set,n=[];return e.forEach(r=>{let o=null;if(typeof r=="string"){let a=r.trim();a&&(o={tag:a})}else if(r&&typeof r=="object"){let a=String(r.tag||r.title||r.name||r.label||"").trim();a&&(o={...r,tag:a})}o&&!t.has(o.tag)&&(t.add(o.tag),n.push(o))}),n}function sr(e){return Array.isArray(e)?e.map(t=>{if(!t)return null;if(typeof t=="string"){let n=t.trim();return n?{tag:n}:null}if(typeof t=="object"){let n=String(t.tag||t.name||t.role||"").trim();return n?{...t,tag:n}:{...t}}return null}).filter(Boolean):[]}function tn(e){if(e==null)return e;try{return structuredClone(e)}catch{}try{return JSON.parse(JSON.stringify(e))}catch{}return e}var Ut,re,X,Jt,zn,On,Vn,Wn,fe=F(()=>{nt();Ut={movies:null,shows:null},re=new Map,X={movies:0,shows:0},Jt=3,zn=1e3*60*30,On="data/movies/",Vn="data/series/",Wn=/^[a-z][a-z0-9+.-]*:/i});function oe(e){let t=new Set,n=[];return(e||[]).forEach(r=>{let o="";typeof r=="string"?o=r:r&&typeof r=="object"&&(o=r.tag||r.title||r.name||"");let a=String(o||"").trim();a&&!t.has(a)&&(t.add(a),n.push(a))}),n}function ct(e,t,n=6){if(!e)return;let r=(t||[]).filter(Boolean),o=r.slice(0,n),a=r.slice(n),s=o.map(i=>it(i));if(a.length){let i=it(`+${a.length} mehr`);i.classList.add("more"),i._extraChips=a.map(c=>it(c)),s.push(i)}e.replaceChildren(...s),cr(e)}function cr(e=document){try{e.querySelectorAll(".chips .chip.more, .cardv2__tags .chip.more").forEach(t=>{t.dataset.bound||(t.dataset.bound="1",t.addEventListener("click",n=>{n.stopPropagation();let r=t.closest(".cardv2, .card");if(r)r.click();else{let o=t._extraChips||[];try{o.forEach(a=>t.before(a))}catch{}t.remove()}}))})}catch{}}function K(e){return e!=null&&e.year?e.year:e!=null&&e.originallyAvailableAt?String(e.originallyAvailableAt).slice(0,4):""}function j(e){if(e instanceof Number)return j(e.valueOf());if(typeof e=="number")return Number.isFinite(e)?e.toFixed(1):"0.0";if(typeof e=="string"){let t=e.trim();if(!t)return"0.0";let n=Number(t);return Number.isFinite(n)?n.toFixed(1):"0.0"}return"0.0"}function it(e){let t=document.createElement("span");return t.className="chip",t.textContent=String(e||""),t}function Pe(e){if(!(e!=null&&e.addedAt))return!1;let t=new Date(e.addedAt).getTime();if(!Number.isFinite(t))return!1;let n=v().cfg||{},r=Number(n.newDays||30);return Date.now()-t<=r*24*60*60*1e3}function ae(){try{return localStorage.getItem("useTmdb")==="1"}catch{return!1}}var ye=F(()=>{G()});function lr(){try{z=new Set(JSON.parse(localStorage.getItem(on)||"[]"))}catch{z=new Set}}function an(){try{localStorage.setItem(on,JSON.stringify(Array.from(z.values())))}catch{}}function dt(e){var r,o;if(!e)return"";let t=e.type==="tv"||e.libraryType==="show"?"show":"movie",n=((r=e.ids)==null?void 0:r.imdb)||((o=e.ids)==null?void 0:o.tmdb)||String(e.ratingKey||"");return n?`${t}:${n}`:""}function sn(e){return z.has(dt(e))}function dr(){return z.size}function ut(e){let t=dt(e);if(!t)return;z.has(t)?z.delete(t):z.add(t),an(),ft();let n=document.getElementById("watchlistPanel");n&&!n.hidden&&De()}function ft(){let e=document.getElementById("watchlistCount");e&&(e.textContent=String(dr()))}function nn(){let e=document.getElementById("watchlistPanel");e&&(e.hidden=!1,e.setAttribute("aria-hidden","false"),De(),document.dispatchEvent(new CustomEvent("watchlist:open")))}function rn(){let e=document.getElementById("watchlistPanel");e&&(e.hidden=!0,e.setAttribute("aria-hidden","true"),document.dispatchEvent(new CustomEvent("watchlist:close"))),lt(!1)}function ur(){z.clear(),an(),ft(),De()}function fr(){let e=cn(),t=JSON.stringify(e,null,2),n=new Blob([t],{type:"application/json"}),r=document.createElement("a");r.href=URL.createObjectURL(n),r.download="watchlist.json",document.body.append(r),r.click(),r.remove(),setTimeout(()=>URL.revokeObjectURL(r.href),1e3)}function cn(){let e=v(),t=(e.movies||[]).concat(e.shows||[]),n=new Map(t.map(r=>[dt(r),r]));return Array.from(z.values()).map(r=>n.get(r)).filter(Boolean)}function De(){let e=document.getElementById("watchlistItems"),t=document.getElementById("watchlistEmpty");if(!e||!t)return;let n=cn();if(n.length===0){e.replaceChildren(),t.hidden=!1;return}t.hidden=!0;let r=document.createDocumentFragment();n.forEach(o=>{let a=document.createElement("li");a.className="watchlist-item";let s=document.createElement("span");s.className="title",s.textContent=o.title||"";let i=document.createElement("button");i.textContent="Entfernen",i.addEventListener("click",()=>{ut(o),De()});let c=document.createElement("button");c.textContent="\xD6ffnen",c.addEventListener("click",()=>{var u,h;let l=o.type==="tv"?"show":"movie",d=((u=o.ids)==null?void 0:u.imdb)||((h=o.ids)==null?void 0:h.tmdb)||String(o.ratingKey||"");d&&(location.hash=`#/${l}/${d}`)}),a.append(s,c,i),r.append(a)}),e.replaceChildren(r)}function ln(){lr(),ft();let e=document.getElementById("openWatchlist"),t=document.getElementById("watchlistToggle"),n=document.getElementById("closeWatchlist"),r=document.getElementById("clearWatchlist"),o=document.getElementById("exportWatchlist");e&&e.addEventListener("click",()=>{nn(),lt(!0)}),t&&t.addEventListener("click",()=>{let a=document.getElementById("watchlistPanel");a&&!a.hidden?rn():(nn(),lt(!0))}),n&&n.addEventListener("click",()=>{rn()}),r&&r.addEventListener("click",()=>{ur()}),o&&o.addEventListener("click",()=>{fr()})}function lt(e){let t=document.getElementById("watchlistToggle");t&&t.setAttribute("aria-expanded",e?"true":"false")}var on,z,ht=F(()=>{G();on="watchlist:v1",z=new Set});function un(e,t){let n=hr(e,t);if(!n)return;let r=Array.isArray(e)&&!gt(e)?e||[]:Array.isArray(t)?t:[];n.replaceChildren(),(r||[]).forEach((o,a)=>n.append(gr(o,a)))}function gt(e){return e instanceof Element||typeof e=="string"}function hr(e,t){if(gt(e)){if(e instanceof Element)return e;if(typeof e=="string")return document.querySelector(e)}if(gt(t)){if(t instanceof Element)return t;if(typeof t=="string")return document.querySelector(t)}return document.getElementById("seasonsAccordion")}function gr(e,t){D(e);let n=document.createElement("article");n.className="season-card";let r=document.createElement("div");r.className="season-head";let o=document.createElement("div");o.className="season-thumb";let a=new Image;a.loading="lazy",a.decoding="async",a.src=e.thumbFile||"",a.alt=e.title||`Staffel ${e.seasonNumber||t+1}`,o.append(a);let s=document.createElement("div"),i=document.createElement("div");i.className="season-title",i.textContent=e.title||`Staffel ${e.seasonNumber||t+1}`;let c=document.createElement("div");c.className="season-sub";let l=e.year||e.releaseYear||"",d=Array.isArray(e.episodes)?e.episodes.length:e.episodeCount||0;c.textContent=[l,d?`${d} Episoden`:""].filter(Boolean).join(" \u2022 "),s.append(i,c);let u=document.createElement("div");u.className="chev",u.textContent="\u203A",r.append(o,s,u);let h=document.createElement("div");return h.className="season-body",(e.episodes||[]).forEach(f=>{D(f),h.append(pr(f))}),r.addEventListener("click",()=>n.classList.toggle("open")),n.append(r,h),n}function pr(e){var h;let t=document.createElement("div");t.className="episode";let n=document.createElement("div");n.className="ep-title";let r=e.seasonNumber!=null?Number(e.seasonNumber):null,o=e.episodeNumber!=null?Number(e.episodeNumber):null,a=e.seasonEpisode&&String(e.seasonEpisode).toUpperCase()||(Number.isFinite(r)&&Number.isFinite(o)?`S${String(r).padStart(2,"0")}E${String(o).padStart(2,"0")}`:"");n.textContent=`${a?a+" \u2022 ":""}${e.title||""}`;let s=document.createElement("div");s.className="badges";let i=Number((h=e.audienceRating)!=null?h:e.rating);if(Number.isFinite(i)){let f=document.createElement("span");f.className="badge",f.textContent=`${i.toFixed(1)}`,s.append(f)}let c=document.createElement("div");c.className="ep-meta";let l=e.durationMin||(e.duration?Math.round(Number(e.duration)/6e4):null),d=e.durationHuman||(l?`${l} min`:null),u=e.originallyAvailableAt||e.date||"";return c.textContent=[d,u].filter(Boolean).join(" \u2022 "),t.append(n,s,c),t}var fn=F(()=>{fe()});function we(e){if(e==null||typeof e!="object")return e;if(typeof structuredClone=="function")try{return structuredClone(e)}catch{}try{return JSON.parse(JSON.stringify(e))}catch{}if(Array.isArray(e))return e.map(n=>we(n));let t={};for(let n of Object.keys(e))t[n]=we(e[n]);return t}function je(e){if(!e||typeof e!="object")return null;let t=we(e);return t.type==="show"&&(t.type="tv"),t.type||(t.type="movie"),t}function Re(e){if(!e||typeof e!="object")return null;let t=we(e);return t.type!=="tv"&&(t.type="tv"),pt(t),t}function br(e){if(!e||typeof e!="object")return null;let t=we(e);return pt(t),t}function hn(e){let t=Array.isArray(e==null?void 0:e.seasons)?e.seasons:[],n=t.some(o=>Array.isArray(o==null?void 0:o.episodes)&&o.episodes.length),r=Array.isArray(e==null?void 0:e.cast)?e.cast:Array.isArray(e==null?void 0:e.roles)?e.roles:[];return!t.length||!n||!r.length}function gn(e,t){if(!e)return e;if(t&&typeof t=="object"){let n=br(t);Object.assign(e,n)}return pt(e),e}function pt(e){if(!e||typeof e!="object")return;bt(e),e.genres=mt(e.genres);let t=yr(e.cast||e.roles||[]);e.cast=t,e.roles=t,e.seasons=Array.isArray(e.seasons)?e.seasons.map(mr).filter(Boolean):[];let n=Number(e.seasonCount);e.seasonCount=Number.isFinite(n)&&n>0?n:e.seasons.length}function mr(e){if(!e||typeof e!="object")return null;let t={...e};return bt(t),t.genres=mt(t.genres),t.episodes=Array.isArray(t.episodes)?t.episodes.map(vr).filter(Boolean):[],t}function vr(e){if(!e||typeof e!="object")return null;let t={...e};return bt(t),t.genres=mt(t.genres),t}function bt(e){D(e)}function mt(e){if(!Array.isArray(e))return[];let t=new Set,n=[];return e.forEach(r=>{let o=null;if(typeof r=="string"){let a=r.trim();a&&(o={tag:a})}else if(r&&typeof r=="object"){let a=String(r.tag||r.title||r.name||r.label||"").trim();a&&(o={...r,tag:a})}o&&!t.has(o.tag)&&(t.add(o.tag),n.push(o))}),n}function yr(e){return Array.isArray(e)?e.map(t=>{if(!t)return null;if(typeof t=="string"){let n=t.trim();return n?{tag:n}:null}if(typeof t=="object"){let n=String(t.tag||t.name||t.role||"").trim();return n?{...t,tag:n}:{...t}}return null}).filter(Boolean):[]}var pn=F(()=>{fe()});function kr(){if(M)return M;let e=document.getElementById("modal-root-v2");if(!e)return null;if(W=e,e.classList.add("modalv2-overlay"),e.hasAttribute("hidden")||e.setAttribute("hidden",""),e.dataset.modalv2Ready||(e.innerHTML=`
      <div class="modalv2-backdrop" data-modalv2-backdrop="1"></div>
      <div class="modalv2-dialog" role="dialog" aria-modal="true">
        <div class="modalv2-scroll" data-modalv2-scroll></div>
      </div>
    `,e.dataset.modalv2Ready="1",e.addEventListener("click",Cr)),T=e.querySelector(".modalv2-dialog"),T&&!T.hasAttribute("tabindex")&&T.setAttribute("tabindex","-1"),Q=e.querySelector("[data-modalv2-scroll]"),Q&&!M){let t=Q.querySelector(".modalv2");t?M=t:(M=document.createElement("div"),M.className="modalv2",M.setAttribute("hidden",""),Q.appendChild(M))}return M}function Cr(e){if(!W)return;let t=e.target;(t===W||t&&t.dataset&&t.dataset.modalv2Backdrop)&&yt()}function mn(){return T?Array.from(T.querySelectorAll('a[href], button:not([disabled]), textarea, input, select, [tabindex]:not([tabindex="-1"])')).filter(t=>t.hasAttribute("disabled")||t.getAttribute("aria-hidden")==="true"||t.hasAttribute("hidden")?!1:t.offsetParent!==null):[]}function xr(){T&&(ie&&T.removeEventListener("keydown",ie),ie=e=>{if(e.key!=="Tab")return;let t=mn();if(!t.length)return;let n=t[0],r=t[t.length-1];e.shiftKey?document.activeElement===n&&(e.preventDefault(),r.focus()):document.activeElement===r&&(e.preventDefault(),n.focus())},T.addEventListener("keydown",ie))}function Tr(){!T||!ie||(T.removeEventListener("keydown",ie),ie=null)}function Ir(){ge||(ge=e=>{e.key==="Escape"&&(e.preventDefault(),yt())},window.addEventListener("keydown",ge))}function Nr(){ge&&(window.removeEventListener("keydown",ge),ge=null)}function He(){let e=kr();return!e||!W?null:(W.hidden=!1,W.setAttribute("aria-hidden","false"),document.body.classList.add("modalv2-open"),Q&&(Q.scrollTop=0),xr(),Ir(),document.dispatchEvent(new CustomEvent("modal:open")),e)}function vt(){if(!T)return;let e=T.querySelector("#v2Close"),t=mn(),n=e&&!e.hasAttribute("hidden")?e:t[0];if(n||(n=T),n){let r=()=>{try{n.focus()}catch{}};(window.requestAnimationFrame||setTimeout)(r,0)}}function Br(e){var r;let t=((r=e==null?void 0:e.tmdb)==null?void 0:r.poster)||(e==null?void 0:e.tmdbPoster),n=(e==null?void 0:e.poster)||(e==null?void 0:e.thumbFile)||(e==null?void 0:e.art)||"";return ae()&&t?t:n}function vn(e){let t=(e==null?void 0:e.runtimeMin)||(e==null?void 0:e.durationMin)||(e!=null&&e.duration?Math.round(Number(e.duration)/6e4):null);return Number.isFinite(t)?(e==null?void 0:e.type)==="tv"?`~${t} min/Ep`:`${t} min`:""}function Lr(e){var n;let t=Number((n=e==null?void 0:e.rating)!=null?n:e==null?void 0:e.audienceRating);return Number.isFinite(t)?`\u2605 ${j(t)}`:""}function yn(e){return(e==null?void 0:e.studio)||(e==null?void 0:e.network)||(e==null?void 0:e.studioName)||""}function Fr(e){let t=[e==null?void 0:e.originallyAvailableAt,e==null?void 0:e.releaseDate,e==null?void 0:e.premiereDate,e==null?void 0:e.firstAired,e==null?void 0:e.airDate];for(let r of t){let o=r==null?"":String(r).trim();if(!o)continue;let a=new Date(o);if(Number.isFinite(a.getTime()))try{return a.toLocaleDateString("de-DE",{year:"numeric",month:"2-digit",day:"2-digit"})}catch{}let s=o.match(/^\d{4}-\d{2}-\d{2}/);if(s&&s[0])return s[0];if(o.length>=4)return o.slice(0,10)}let n=K(e);return n?String(n):""}function se(e){return Array.isArray(e)?e.map(t=>t?typeof t=="string"?t:t.tag||t.title||t.name||"":"").filter(Boolean):[]}function Mr(e){let n=(Array.isArray(e==null?void 0:e.genres)?e.genres:[]).map(r=>r?typeof r=="string"?r:r.tag||r.title||r.name||"":"").filter(Boolean);return Array.from(new Set(n))}function $r(e){let t=[];return Pe(e)&&t.push("Neu"),(e==null?void 0:e.type)==="tv"&&Number.isFinite(Number(e==null?void 0:e.seasonCount))&&t.push(`Staffeln: ${e.seasonCount}`),((e==null?void 0:e.genres)||[]).map(r=>r?typeof r=="string"?r:r.tag||r.title||r.name||"":"").filter(Boolean).forEach(r=>t.push(r)),t}function _r(e){return(Array.isArray(e==null?void 0:e.cast)?e.cast:Array.isArray(e==null?void 0:e.roles)?e.roles:[]).map(n=>{var i,c,l;if(!n)return null;if(typeof n=="string"){let d=String(n).trim();return d?{name:d,role:"",thumb:"",tmdbProfile:"",raw:null}:null}let r=String(n.tag||n.name||n.role||"").trim();if(!r)return null;let o=(()=>{let d=String(n.role||"").trim();return d?d.toLowerCase()===r.toLowerCase()?"":d:""})(),a=[(i=n==null?void 0:n.tmdb)==null?void 0:i.profile,(c=n==null?void 0:n.tmdb)==null?void 0:c.profile_path,(l=n==null?void 0:n.tmdb)==null?void 0:l.profilePath,n==null?void 0:n.tmdbProfile,n==null?void 0:n.profile,n==null?void 0:n.profile_path,n==null?void 0:n.profilePath].find(d=>typeof d=="string"&&d.trim()),s=[n==null?void 0:n.thumb,n==null?void 0:n.photo,n==null?void 0:n.image].find(d=>typeof d=="string"&&d.trim())||"";return{name:r,role:o,thumb:s,tmdbProfile:a?String(a).trim():"",raw:n}}).filter(Boolean)}function Pr(e){let t=String(e||"").trim();if(!t)return"";if(/^https?:\/\//i.test(t))return t;if(t.startsWith("//"))return`https:${t}`;let n=t.startsWith("/")?t:`/${t}`;return`${wr}${Er}${n}`}function Dr(e){let t=String(e||"").trim();return t?/^https?:\/\//i.test(t)||t.startsWith("data:")?t:t.startsWith("//")?`https:${t}`:t:""}function jr(e,t){var o,a,s;if(!e)return"";let n=e.raw||{};if(t){let i=[e.tmdbProfile,(o=n==null?void 0:n.tmdb)==null?void 0:o.profile,(a=n==null?void 0:n.tmdb)==null?void 0:a.profile_path,(s=n==null?void 0:n.tmdb)==null?void 0:s.profilePath,n==null?void 0:n.tmdbProfile,n==null?void 0:n.profile,n==null?void 0:n.profile_path,n==null?void 0:n.profilePath];for(let c of i){let l=Pr(c);if(l)return l}}let r=[e.thumb,n==null?void 0:n.thumb,n==null?void 0:n.photo,n==null?void 0:n.image];for(let i of r){let c=Dr(i);if(c)return c}return""}function Rr(e){let t=String(e||"").trim();if(!t)return"?";let r=t.split(/\s+/).slice(0,2).map(o=>o.charAt(0)).filter(Boolean);return r.length?r.join("").toUpperCase():t.charAt(0).toUpperCase()}function Hr(e){let t=e.querySelector(".v2-tabs");if(!t)return;let n=Array.from(t.querySelectorAll("button[data-t]")),r=s=>{n.forEach(i=>{let c=i.dataset.t===s;i.classList.toggle("active",c),i.setAttribute("aria-selected",c?"true":"false"),i.tabIndex=c?0:-1;let l=e.querySelector(`.v2-pane[data-pane="${i.dataset.t}"]`);l&&(l.hidden=!c,l.setAttribute("aria-hidden",l.hidden?"true":"false"))})},o=(s,i)=>{if(!n.length)return;let c=n.indexOf(s),l=i>0?0:n.length-1,d=c===-1?l:(c+i+n.length)%n.length,u=n[d];u&&(u.focus(),r(u.dataset.t))};t.addEventListener("click",s=>{let i=s.target.closest("button[data-t]");i&&(s.preventDefault(),r(i.dataset.t))}),t.addEventListener("keydown",s=>{let i=s.target.closest("button[data-t]");if(i)switch(s.key){case"ArrowLeft":case"ArrowUp":s.preventDefault(),o(i,-1);break;case"ArrowRight":case"ArrowDown":s.preventDefault(),o(i,1);break;case"Home":s.preventDefault(),n[0]&&(n[0].focus(),r(n[0].dataset.t));break;case"End":if(s.preventDefault(),n.length){let c=n[n.length-1];c.focus(),r(c.dataset.t)}break;default:break}});let a=n.find(s=>s.classList.contains("active"))||n[0];a&&r(a.dataset.t)}function qr(e,t){let n=e.querySelector(".v2-cast");if(!n)return;n.innerHTML='<div class="v2-cast-scroll"></div>';let r=n.querySelector(".v2-cast-scroll");if(!r)return;let o=Array.isArray(t)?t.slice(0,12):[];if(!o.length){r.innerHTML='<span class="modalv2-loading">Keine Besetzungsdaten verf\xFCgbar.</span>',r.removeAttribute("role");return}r.setAttribute("role","list");let a=ae();o.forEach(s=>{let i=s&&typeof s=="object"&&"name"in s?s:(()=>{let f=String(s||"").trim();return f?{name:f,role:"",thumb:"",tmdbProfile:"",raw:null}:null})();if(!i||!i.name)return;let c=document.createElement("article");c.className="v2-cast-card",c.tabIndex=0,c.setAttribute("role","listitem");let l=String(i.role||"").trim();c.setAttribute("aria-label",l?`${i.name} \u2013 ${l}`:i.name);let d=document.createElement("div");d.className="v2-cast-avatar";let u=jr(i,a);if(u){d.classList.add("has-image");let f=document.createElement("img");f.src=u,f.alt=i.name,f.loading="lazy",f.decoding="async",d.appendChild(f)}else{let f=document.createElement("span");f.className="v2-cast-initials",f.textContent=Rr(i.name),f.setAttribute("aria-hidden","true"),d.appendChild(f)}let h=document.createElement("p");if(h.className="v2-cast-name",h.textContent=i.name,c.append(d,h),l){let f=document.createElement("p");f.className="v2-cast-role",f.textContent=l,c.append(f)}else c.classList.add("v2-cast-card--no-role");r.appendChild(c)}),r.children.length||(r.innerHTML='<span class="modalv2-loading">Keine Besetzungsdaten verf\xFCgbar.</span>',r.removeAttribute("role"))}function Kr(e,t){let n=e.querySelector(".v2-overview");if(!n)return;let r=typeof t=="string"?t:"";if(!r){n.textContent="";return}let o=document.createElement("p");o.className="v2-overview-text line-clamp line-clamp-5",o.textContent=r;let a=document.createElement("button");a.type="button",a.className="v2-overview-toggle";let s=l=>{o.classList.toggle("is-expanded",l),a.setAttribute("aria-expanded",String(l)),a.textContent=l?"Weniger anzeigen":"Mehr anzeigen"};a.addEventListener("click",()=>{let l=a.getAttribute("aria-expanded")==="true";s(!l)}),n.replaceChildren(o,a),s(!1),(typeof requestAnimationFrame=="function"?requestAnimationFrame:l=>setTimeout(l,0))(()=>{o.scrollHeight>o.clientHeight+1||(o.classList.add("is-expanded"),a.hidden=!0)})}function zr(e,t){let n=e.querySelector(".v2-details");if(!n)return;n.replaceChildren();let r=document.createElement("div");r.className="v2-details-grid";let o=[],a=Fr(t);a&&o.push(["Ver\xF6ffentlichung",a]);let s=vn(t);s&&o.push(["Laufzeit",s]);let i=yn(t);i&&o.push(["Studio",i]);let c=((t==null?void 0:t.contentRating)||"").trim();c&&o.push(["Freigabe",c]);let l=y=>{if(y instanceof Number)return l(y.valueOf());if(typeof y=="number")return Number.isFinite(y)?j(y):"";if(typeof y=="string"){let k=y.trim();if(!k)return"";let S=Number(k);return Number.isFinite(S)?j(S):""}return""},d=l(t==null?void 0:t.rating),u=l(t==null?void 0:t.audienceRating),h=l(t==null?void 0:t.userRating);if(d?(o.push(["Bewertung",`\u2605 ${d}`]),u&&u!==d&&o.push(["Publikum",`\u2605 ${u}`])):u&&o.push(["Bewertung",`\u2605 ${u}`]),h&&o.push(["Eigene Wertung",`\u2605 ${h}`]),(t==null?void 0:t.type)==="tv"){let y=Number(t==null?void 0:t.seasonCount),k=Number.isFinite(y)?y:Array.isArray(t==null?void 0:t.seasons)?t.seasons.length:null;Number.isFinite(k)&&k>0&&o.push(["Staffeln",String(k)]);let S=Array.isArray(t==null?void 0:t.seasons)?t.seasons.reduce((B,N)=>{if(!N)return B;let w=Array.isArray(N.episodes)?N.episodes.length:0;return B+(Number.isFinite(w)?w:0)},0):null;Number.isFinite(S)&&S>0&&o.push(["Episoden",String(S)])}let f=se(t==null?void 0:t.countries);f.length&&o.push(["L\xE4nder",f.join(", ")]);let b=se(t==null?void 0:t.collections);b.length&&o.push(["Sammlungen",b.join(", ")]);let A=se(t==null?void 0:t.labels);if(A.length&&o.push(["Labels",A.join(", ")]),t!=null&&t.editionTitle&&o.push(["Edition",t.editionTitle]),t!=null&&t.originalTitle&&t.originalTitle!==t.title&&o.push(["Originaltitel",t.originalTitle]),o.length){let y=document.createElement("section");y.className="v2-details-section",y.dataset.section="general";let k=document.createElement("h3");k.className="v2-details-heading",k.textContent="Allgemein";let S=document.createElement("dl");S.className="v2-details-list",o.forEach(([B,N])=>{if(!B||!N)return;let w=document.createElement("dt");w.textContent=B;let L=document.createElement("dd");L.textContent=N,S.append(w,L)}),S.childElementCount&&(y.append(k,S),r.append(y))}let I=Mr(t);if(I.length){let y=document.createElement("section");y.className="v2-details-section",y.dataset.section="genres";let k=document.createElement("h3");k.className="v2-details-heading",k.textContent="Genres";let S=document.createElement("div");S.className="v2-chip-group",I.forEach(B=>{let N=document.createElement("span");N.className="chip",N.textContent=B,S.appendChild(N)}),y.append(k,S),r.append(y)}let _=[],H=se(t==null?void 0:t.directors);H.length&&_.push(["Regie",H.join(", ")]);let P=se(t==null?void 0:t.writers);P.length&&_.push(["Drehbuch",P.join(", ")]);let ee=se(t==null?void 0:t.producers);ee.length&&_.push(["Produktion",ee.join(", ")]);let Ne=se((t==null?void 0:t.creators)||(t==null?void 0:t.showrunners));if((t==null?void 0:t.type)==="tv"&&Ne.length&&_.push(["Creator",Ne.join(", ")]),_.length){let y=document.createElement("section");y.className="v2-details-section",y.dataset.section="crew";let k=document.createElement("h3");k.className="v2-details-heading",k.textContent="Credits";let S=document.createElement("dl");S.className="v2-details-list",_.forEach(([B,N])=>{if(!B||!N)return;let w=document.createElement("dt");w.textContent=B;let L=document.createElement("dd");L.textContent=N,S.append(w,L)}),S.childElementCount&&(y.append(k,S),r.append(y))}if(r.childElementCount)n.appendChild(r);else{let y=document.createElement("p");y.className="v2-details-empty",y.textContent="Keine zus\xE4tzlichen Details verf\xFCgbar.",n.appendChild(y)}}function Or(e,t){let n=e.querySelector(".v2-seasons");if(!n)return;let r=Array.isArray(t==null?void 0:t.seasons)?t.seasons:[];if(!r.length){n.innerHTML='<p class="modalv2-loading">Keine Staffel-Informationen verf\xFCgbar.</p>';return}n.innerHTML="",un(n,r)}function Vr(e,t){var l,d;let n=e.querySelector("#v2Tmdb"),r=e.querySelector("#v2Imdb"),o=e.querySelector("#v2Trailer"),a=((l=t==null?void 0:t.ids)==null?void 0:l.tmdb)||(t==null?void 0:t.tmdbId),s=((d=t==null?void 0:t.ids)==null?void 0:d.imdb)||(t==null?void 0:t.imdbId),i=(t==null?void 0:t.trailer)||(t==null?void 0:t.trailerUrl),c=(t==null?void 0:t.type)==="tv"?"tv":"movie";n&&(a?(n.hidden=!1,n.href=`https://www.themoviedb.org/${c}/${a}`):(n.hidden=!0,n.removeAttribute("href"))),r&&(s?(r.hidden=!1,r.href=`https://www.imdb.com/title/${s}/`):(r.hidden=!0,r.removeAttribute("href"))),o&&(i?(o.hidden=!1,o.onclick=()=>window.open(i,"_blank","noopener")):(o.hidden=!0,o.onclick=null))}function Wr(e,t){let n=e.querySelector(".v2-title");n&&(n.textContent=(t==null?void 0:t.title)||(t==null?void 0:t.name)||"");let r=((t==null?void 0:t.tagline)||"").trim(),o=e.querySelector(".v2-meta"),a=e.querySelector(".v2-subline"),s=K(t),i=vn(t),c=Lr(t),l=yn(t),d=[s,i,c,l].filter(Boolean);if(a){let A=d.join(" \u2022 ");a.textContent=r||A,a.hidden=!(r||A)}o&&(o.textContent=r&&d.length?d.join(" \u2022 "):"",o.hidden=!(r&&d.length));let u=e.querySelector(".v2-chips");u&&(u.replaceChildren(),$r(t).forEach(A=>{let I=document.createElement("span");I.className="chip",I.textContent=A,u.appendChild(I)}),u.hidden=!u.childElementCount);let h=e.querySelector(".v2-facts"),f=e.querySelector(".v2-facts-list");if(h&&f){let A=[];s&&A.push(["Jahr",s]);let I=((t==null?void 0:t.contentRating)||"").trim();I&&A.push(["Freigabe",I]),i&&A.push(["Laufzeit",i]),c&&A.push(["Bewertung",c]),l&&A.push(["Studio",l]),f.replaceChildren(),A.forEach(([_,H])=>{let P=document.createElement("dt");P.textContent=_;let ee=document.createElement("dd");ee.textContent=H,f.append(P,ee)}),h.hidden=!A.length}let b=e.querySelector(".v2-poster img");if(b){let A=Br(t);b.src=A||"",b.alt=t!=null&&t.title?`Poster: ${t.title}`:"",b.loading="lazy",b.decoding="async",b.classList.remove("is-ready"),A?(b.addEventListener("load",bn,{once:!0}),b.addEventListener("error",bn,{once:!0})):b.classList.add("is-ready")}}function bn(e){var t;(t=e.currentTarget)==null||t.classList.add("is-ready")}function Ur(e="Details werden geladen \u2026"){let t=He();if(!t)return;t.hidden=!1;let n=document.createElement("div");n.className="modalv2-loading",n.textContent=String(e||"Details werden geladen \u2026"),t.replaceChildren(n)}function wn(e){let t=He();if(!t)return;t.hidden=!1;let n=(e==null?void 0:e.type)==="tv";t.innerHTML=`
    <section class="v2-layout">
      <aside class="v2-side">
        <div class="v2-poster"><img alt=""></div>
        <div class="v2-facts" aria-label="Schnellinfos" hidden>
          <h3 class="v2-facts-title">Schnellinfos</h3>
          <dl class="v2-facts-list"></dl>
        </div>
      </aside>
      <div class="v2-info">
        <header class="v2-head">
          <div class="v2-titlebar">
            <div class="v2-title-wrap">
              <h2 class="v2-title" id="modalV2Title"></h2>
              <div class="v2-subline"></div>
              <div class="v2-meta"></div>
            </div>
            <div class="v2-actions" aria-label="Externe Aktionen">
              <button class="v2-icon-btn" id="v2Close" type="button" aria-label="Schlie\xDFen">
                <svg class="v2-icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                  <path d="M6 6l12 12M6 18L18 6" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"></path>
                </svg>
              </button>
              <a class="v2-icon-btn" id="v2Tmdb" target="_blank" rel="noopener noreferrer" aria-label="Auf TMDB \xF6ffnen" hidden>
                <svg class="v2-icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                  <path d="M4 9h16v10a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V9z" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linejoin="round"></path>
                  <path d="M4 9V7a2 2 0 0 1 2-2h1l2 4 2-4 2 4 2-4h1a2 2 0 0 1 2 2v2" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"></path>
                </svg>
              </a>
              <a class="v2-icon-btn" id="v2Imdb" target="_blank" rel="noopener noreferrer" aria-label="Auf IMDb \xF6ffnen" hidden>
                <svg class="v2-icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                  <path d="M12 4l2.4 4.9 5.4.8-3.9 3.8.9 5.4-4.8-2.5-4.8 2.5.9-5.4-3.9-3.8 5.4-.8z" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linejoin="round"></path>
                </svg>
              </a>
              <button class="v2-icon-btn" id="v2Trailer" type="button" aria-label="Trailer abspielen" hidden>
                <svg class="v2-icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                  <path d="M9 6l8 6-8 6V6z" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linejoin="round" stroke-linecap="round"></path>
                </svg>
              </button>
            </div>
          </div>
          <div class="v2-chips" aria-label="Attribute"></div>
        </header>
        <nav class="v2-tabs" aria-label="Details Navigation" role="tablist">
          <button type="button" data-t="overview" class="active" id="v2TabOverview" role="tab" aria-controls="v2PaneOverview" aria-selected="true">\xDCberblick</button>
          <button type="button" data-t="details" id="v2TabDetails" role="tab" aria-controls="v2PaneDetails" aria-selected="false">Details</button>
          ${n?'<button type="button" data-t="seasons" id="v2TabSeasons" role="tab" aria-controls="v2PaneSeasons" aria-selected="false">Staffeln</button>':""}
          <button type="button" data-t="cast" id="v2TabCast" role="tab" aria-controls="v2PaneCast" aria-selected="false">Cast</button>
        </nav>
        <section class="v2-body">
          <div class="v2-pane v2-overview" data-pane="overview" id="v2PaneOverview" role="tabpanel" aria-labelledby="v2TabOverview"></div>
          <div class="v2-pane v2-details" data-pane="details" id="v2PaneDetails" role="tabpanel" aria-labelledby="v2TabDetails" hidden></div>
          ${n?'<div class="v2-pane v2-seasons" data-pane="seasons" id="v2PaneSeasons" role="tabpanel" aria-labelledby="v2TabSeasons" hidden></div>':""}
          <div class="v2-pane v2-cast" data-pane="cast" id="v2PaneCast" role="tabpanel" aria-labelledby="v2TabCast" hidden></div>
        </section>
      </div>
    </section>
  `,Wr(t,e),Vr(t,e),Kr(t,(e==null?void 0:e.overview)||(e==null?void 0:e.summary)||""),zr(t,e),(e==null?void 0:e.type)==="tv"&&Or(t,e),qr(t,_r(e)),Hr(t);let r=t.querySelector("#v2Close");r&&r.addEventListener("click",yt),T&&T.setAttribute("aria-labelledby","modalV2Title"),vt()}async function Se(e){let t=++Z;he=document.activeElement instanceof HTMLElement?document.activeElement:null;let n=He();if(!n)return;let r=Jr(e);if(t===Z){if(!r){n.hidden=!1;let o=document.createElement("div");o.className="modalv2-loading",o.textContent="Film konnte nicht geladen werden.",n.replaceChildren(o),pe=null,Ee=null,vt();return}pe=r,Ee="movie",wn(r)}}async function Ae(e){let t=++Z;he=document.activeElement instanceof HTMLElement?document.activeElement:null;let n=Gr(e),r=He();if(!r||t!==Z)return;if(!n){r.hidden=!1;let a=document.createElement("div");a.className="modalv2-loading",a.textContent="Seriendetails konnten nicht geladen werden.",r.replaceChildren(a),pe=null,Ee=null,vt();return}pe=n,Ee="show";let o=n;if(hn(o)){if(Ur(),t!==Z)return;let a=null;try{a=await Qt(o)}catch{a=null}if(t!==Z)return;a&&(gn(o,a),pe=o)}t===Z&&wn(o)}function yt(){if(Z++,!!W){if(W.hidden=!0,W.setAttribute("aria-hidden","true"),document.body.classList.remove("modalv2-open"),Tr(),Nr(),M&&(M.innerHTML="",M.setAttribute("hidden","")),Q&&(Q.scrollTop=0),he&&typeof he.focus=="function")try{he.focus()}catch{}he=null,pe=null,Ee=null,document.dispatchEvent(new CustomEvent("modal:close"))}}function Jr(e){if(e==="demo")return je(Sr);if(e&&typeof e=="object")return je(e);let t=e==null?"":String(e).trim();if(!t)return null;let n=v(),o=(Array.isArray(n==null?void 0:n.movies)?n.movies:[]).find(a=>En(a,t));return o?je(o):null}function Gr(e){if(e==="demo")return Re(Ar);if(e&&typeof e=="object")return Re(e);let t=e==null?"":String(e).trim();if(!t)return null;let n=v(),o=(Array.isArray(n==null?void 0:n.shows)?n.shows:[]).find(a=>En(a,t));return o?Re(o):null}function En(e,t){var r,o;if(!e)return!1;let n=String(t||"").trim();return n?!!((r=e==null?void 0:e.ids)!=null&&r.imdb&&String(e.ids.imdb)===n||(o=e==null?void 0:e.ids)!=null&&o.tmdb&&String(e.ids.tmdb)===n||(e==null?void 0:e.ratingKey)!=null&&String(e.ratingKey)===n):!1}var wr,Er,W,T,Q,M,he,ie,ge,Z,Ee,pe,Sr,Ar,wt=F(()=>{fn();ye();G();fe();pn();wr="https://image.tmdb.org/t/p/",Er="w185",W=null,T=null,Q=null,M=null,he=null,ie=null,ge=null,Z=0,Ee=null,pe=null,Sr={type:"movie",title:"Lumen: Der Aufbruch",tagline:"Eine cineastische Demo f\xFCr das neue Modal",overview:"Die Crew der Lumen wagt den Sprung in unerforschte Welten und enth\xFCllt dabei eine Energiequelle, die alles ver\xE4ndern k\xF6nnte. Zwischen Loyalit\xE4t, Intrigen und berauschenden Bildern entfaltet sich ein Abenteuer, das f\xFCr das Cinematic-Layout entworfen wurde.",summary:"Die Crew der Lumen entdeckt eine Energiequelle, die das Schicksal der Menschheit ver\xE4ndern k\xF6nnte.",runtimeMin:142,contentRating:"FSK 12",studio:"Aurora Pictures",rating:8.4,audienceRating:8,userRating:8.7,originallyAvailableAt:"2024-05-17",countries:[{tag:"Deutschland"},{tag:"Kanada"}],genres:[{tag:"Science-Fiction"},{tag:"Drama"},{tag:"Abenteuer"}],cast:[{name:"Mara Lenz",role:"Captain Alys Vega",tmdbProfile:"/3rxeQHiuCYaXJqfyUG8yt0YdHtH.jpg"},{name:"Tariq Benassi",role:"Navigator Elian Soh",tmdbProfile:"/wGl8DCycJ2U0FvJbLABd8R4FS3X.jpg"},{name:"Hannah Ko",role:"Wissenschaftlerin Dr. Mira Han",tmdbProfile:"/hJuDvwzS0SPlsE6MN4pF2UYDGtt.jpg"}],directors:[{tag:"Jonas Falk"}],writers:[{tag:"Lea Winter"}],producers:[{tag:"Studio Atlas"}],labels:[{tag:"Dolby Atmos"},{tag:"4K"}],collections:[{tag:"Aurora-Saga"}],trailer:"https://www.youtube.com/watch?v=dQw4w9WgXcQ",tmdbPoster:"https://image.tmdb.org/t/p/w500/2lUYbD2C3XSuwqMUbDVDQuz9mqz.jpg",ids:{tmdb:"demo-lumen",imdb:"tt0000001"},addedAt:"2024-06-01T12:00:00Z"},Ar={type:"tv",title:"Aurora Station",tagline:"Neue Horizonte in Serie",overview:"Die Besatzung der Aurora Station sch\xFCtzt eine Au\xDFenposten an der Grenze des bekannten Raums. Jede Episode verbindet kosmische R\xE4tsel mit pers\xF6nlichen Geschichten \u2013 perfekt geeignet, um das Cinematic-Modal auszuprobieren.",summary:"Ein orbitaler Au\xDFenposten ringt um Hoffnung und Zusammenhalt, w\xE4hrend eine fremde Macht erwacht.",contentRating:"TV-14",studio:"Nebula Network",originallyAvailableAt:"2023-09-14",seasonCount:2,genres:[{tag:"Science-Fiction"},{tag:"Drama"}],countries:[{tag:"USA"},{tag:"Island"}],creators:[{tag:"Elina S\xF8rensen"}],cast:[{name:"Noah Adler",role:"Commander Ivar Hale",tmdbProfile:"/4MqUjb1SYrzHmFSVoKHSKP5MGGm.jpg"},{name:"Sofia Idris",role:"Ingenieurin Kaia Rhee",tmdbProfile:"/tHMgWz6EpRdbgoMJ2JfzFzjg3QB.jpg"},{name:"Helena Ruiz",role:"Strategin Tala Voss",tmdbProfile:"/ziEuG1ESSofxDCspotYlrwz3Tq.png"}],seasons:[{title:"Staffel 1",seasonNumber:1,year:2023,thumbFile:"https://image.tmdb.org/t/p/w300/4dO2YpC8S9nLmQAXoJLRV8LZRxn.jpg",episodes:[{title:"Kapitel Eins: Erwachen",seasonNumber:1,episodeNumber:1,durationMin:54,originallyAvailableAt:"2023-09-14",audienceRating:8.6},{title:"Kapitel Zwei: Grenzwelten",seasonNumber:1,episodeNumber:2,durationMin:52,originallyAvailableAt:"2023-09-21",audienceRating:8.2}]},{title:"Staffel 2",seasonNumber:2,year:2024,thumbFile:"https://image.tmdb.org/t/p/w300/bSL4hY8SgdKzac8AUbWQm74y87C.jpg",episodes:[{title:"Kapitel Dreizehn: Resonanz",seasonNumber:2,episodeNumber:1,durationMin:56,originallyAvailableAt:"2024-02-08",audienceRating:8.9},{title:"Kapitel Vierzehn: Echo",seasonNumber:2,episodeNumber:2,durationMin:55,originallyAvailableAt:"2024-02-15",audienceRating:8.7}]}],tmdbPoster:"https://image.tmdb.org/t/p/w500/a4I481szRmycyreQTLrRe4f4YJe.jpg",ids:{tmdb:"demo-aurora-station",imdb:"tt0000002"}}});var Cn={};Xe(Cn,{renderGrid:()=>$});function Yr(e){let t=C("article","cardv2");t.style.contentVisibility="auto",t.dataset.kind=(e==null?void 0:e.type)==="tv"?"show":"movie",t.tabIndex=0,t.setAttribute("role","button"),e!=null&&e.title&&t.setAttribute("aria-label",e.title);let n=oo(e),r=kn(e,n,co(e)),o=C("div","cardv2__body"),a=document.createElement("h3");a.className="cardv2__title",a.textContent=(e==null?void 0:e.title)||"";let s=C("div","cardv2__meta"),i=so(e);s.textContent=i.join(" \u2022 ");let c=C("div","cardv2__tags"),l=oe(e==null?void 0:e.genres);ct(c,l,3);let d=C("div","cardv2__actions"),u=document.createElement("button");return u.type="button",u.className="watch-btn btn",Sn(u,e),u.addEventListener("click",h=>{h.stopPropagation(),ut(e),Sn(u,e)}),d.append(u),o.append(a,s,c,d),t.append(r,o),t.addEventListener("click",()=>An(e)),t.addEventListener("keydown",h=>{h.target===t&&(h.key==="Enter"||h.key===" ")&&(h.preventDefault(),An(e))}),t}function Xr(e){return(e&&e.collections||[]).map(t=>t&&(t.tag||t.title||t.name||"")).filter(Boolean)}function Zr(e,t){let n=(t||[]).slice().sort((u,h)=>{let f=Number(K(u))||0,b=Number(K(h))||0;return f!==b?f-b:(u.title||"").localeCompare(h.title||"","de")}),r=n.map(u=>Number(K(u))||0).filter(Boolean),o=r.length?Math.min(...r):"",a=n.map(u=>new Date(u.addedAt||0).getTime()).filter(Number.isFinite),s=a.length?new Date(Math.max(...a)).toISOString():null,i=n.map(u=>{var h;return Number((h=u.rating)!=null?h:u.audienceRating)}).filter(Number.isFinite),c=i.length?i.reduce((u,h)=>u+h,0)/i.length:null,l=n.find(u=>u.thumbFile)||n[0]||null,d=Array.from(new Set(n.flatMap(u=>oe(u.genres)))).slice(0,4);return{isCollectionGroup:!0,type:"collection",title:e,collectionName:e,items:n,itemCount:n.length,year:o||"",addedAt:s,rating:c,posterItem:l,genres:d}}function Qr(e){let t=document.getElementById("groupCollections"),n=document.getElementById("collectionFilter"),r=n&&n.value;if(!t||!t.checked||r)return e;let o=new Map;e.forEach(s=>{Xr(s).forEach(i=>{o.has(i)||o.set(i,[]),o.get(i).push(s)})});let a=[];return o.forEach((s,i)=>{a.push(Zr(i,s))}),a.sort((s,i)=>s.title.localeCompare(i.title,"de")),a}function eo(e){let t=C("article","cardv2 collection");t.style.contentVisibility="auto",t.dataset.kind="collection",t.tabIndex=0,t.setAttribute("role","button"),e!=null&&e.title&&t.setAttribute("aria-label",e.title);let n=e.posterItem||{},r=kn(n,ao(e),0,e.title||""),o=C("div","cardv2__body"),a=document.createElement("h3");a.className="cardv2__title",a.textContent=e.title||"";let s=C("div","cardv2__meta"),i=[e.year,`${e.itemCount} Titel`];Number.isFinite(e.rating)&&i.push(`\u2605 ${j(e.rating)}`),s.textContent=i.filter(Boolean).join(" \u2022 ");let c=C("div","cardv2__tags");return ct(c,e.genres||[],3),o.append(a,s,c),t.append(r,o),t.addEventListener("click",()=>{let l=document.getElementById("collectionFilter");l&&(l.value=e.collectionName||e.title||"",l.dispatchEvent(new Event("change",{bubbles:!0})))}),t.addEventListener("keydown",l=>{if(l.target===t&&(l.key==="Enter"||l.key===" ")){l.preventDefault();let d=document.getElementById("collectionFilter");d&&(d.value=e.collectionName||e.title||"",d.dispatchEvent(new Event("change",{bubbles:!0})))}}),t}function $(e){let{movies:t,shows:n,filtered:r}=v(),o=(e==="shows"?n:t)||[],a=Array.isArray(r)?r:o,s=Qr(a),i=document.getElementById("grid");if(!i)return;to(i);let c=document.createDocumentFragment();s.forEach(d=>c.append(d.isCollectionGroup?eo(d):Yr(d))),i.replaceChildren(c),no(i);let l=document.getElementById("empty");l&&(l.hidden=s.length>0)}function to(e){e&&(e.classList.remove("is-entering","is-ready"),e.classList.add("is-leaving"))}function no(e){e&&(e.classList.remove("is-leaving"),e.classList.add("is-entering"),requestAnimationFrame(()=>{e.classList.add("is-ready"),setTimeout(()=>e.classList.remove("is-entering","is-ready"),240)}))}function kn(e,t=[],n=0,r=""){let o=C("div","cardv2__thumb"),a=new Image;a.loading="lazy",a.decoding="async",a.alt=r||(e==null?void 0:e.title)||"";let s=ro(e);if(s&&(a.src=s),o.append(a),Array.isArray(t)&&t.length){let l=C("div","cardv2__badge-group");t.forEach(d=>{d instanceof HTMLElement&&l.append(d)}),l.childElementCount&&o.append(l)}let i=document.createElement("div");i.className="cardv2__thumb-overlay",i.setAttribute("aria-hidden","true"),o.append(i);let c=Number(n)||0;if(c>0){let l=C("div","cardv2__progress"),d=document.createElement("span");d.style.width=`${Math.max(0,Math.min(100,c))}%`,l.append(d),o.append(l)}return o}function ro(e){var r;if(!e)return"";let t=ae()&&(((r=e==null?void 0:e.tmdb)==null?void 0:r.poster)||(e==null?void 0:e.tmdbPoster)),n=(e==null?void 0:e.thumbFile)||(e==null?void 0:e.poster)||(e==null?void 0:e.art)||(e==null?void 0:e.thumb)||"";return t||n||""}function oo(e){var o;let t=[];Pe(e)&&t.push(ke("Neu"));let n=String((e==null?void 0:e.contentRating)||"").trim();n&&t.push(ke(n));let r=Number((o=e==null?void 0:e.rating)!=null?o:e==null?void 0:e.audienceRating);return Number.isFinite(r)&&t.push(ke(`\u2605 ${j(r)}`)),t.slice(0,3)}function ao(e){let t=[];return Number.isFinite(e==null?void 0:e.itemCount)&&e.itemCount>0&&t.push(ke(`${e.itemCount} Titel`)),e!=null&&e.year&&t.push(ke(String(e.year))),t}function ke(e){let t=document.createElement("span");return t.className="badge",t.textContent=String(e||""),t}function Sn(e,t){if(!e)return;let n=sn(t);e.textContent=n?"Gemerkt":"Merken",e.classList.toggle("active",n),e.setAttribute("aria-pressed",n?"true":"false")}function so(e){var s;let t=[],n=K(e);n&&t.push(String(n));let r=io(e);r&&t.push(r);let o=Number((s=e==null?void 0:e.rating)!=null?s:e==null?void 0:e.audienceRating);Number.isFinite(o)&&t.push(`\u2605 ${j(o)}`);let a=(e==null?void 0:e.studio)||(e==null?void 0:e.network)||"";return a&&t.push(a),t}function io(e){var r,o;let t=(o=(r=e==null?void 0:e.runtimeMin)!=null?r:e==null?void 0:e.durationMin)!=null?o:e!=null&&e.duration?Math.round(Number(e.duration)/6e4):null,n=Number(t);return!Number.isFinite(n)||n<=0?"":(e==null?void 0:e.type)==="tv"?`~${n} min/Ep`:`${n} min`}function co(e){var r;let t=Number((r=e==null?void 0:e.viewOffset)!=null?r:e==null?void 0:e.viewoffset),n=Number(e==null?void 0:e.duration);return!Number.isFinite(t)||!Number.isFinite(n)||n<=0?0:Math.max(1,Math.min(100,Math.round(t/n*100)))}function lo(e){var n,r;if(!e)return"";let t=((n=e==null?void 0:e.ids)==null?void 0:n.imdb)||((r=e==null?void 0:e.ids)==null?void 0:r.tmdb);return t?String(t):e!=null&&e.ratingKey?String(e.ratingKey):""}function uo(e,t){if(!e||!t)return;let n=`#/${e}/${t}`;try{if(history&&typeof history.pushState=="function"){location.hash===n&&typeof history.replaceState=="function"?history.replaceState(null,"",n):history.pushState(null,"",n);return}}catch{}try{window.__skipNextHashNavigation=!0}catch{}location.hash=n}function An(e){if(!e)return;let t=(e==null?void 0:e.type)==="tv"?"show":"movie",n=lo(e);n&&uo(t,n),t==="show"?Ae(e):Se(e)}var Et=F(()=>{G();qe();Be();ye();ht();wt()});var It={};Xe(It,{applyFilters:()=>be,computeFacets:()=>Ct,initFilters:()=>Tt,renderFacets:()=>xt,updateFiltersAndGrid:()=>xe});function Ce(e){return e.year?e.year:e.originallyAvailableAt?String(e.originallyAvailableAt).slice(0,4):""}function At(e){return(e&&e.collections||[]).map(t=>t&&(t.tag||t.title||t.name||"")).filter(Boolean)}function fo(e){if(!(e!=null&&e.addedAt))return!1;let t=new Date(e.addedAt).getTime();if(!Number.isFinite(t))return!1;let n=v().cfg||{},r=Number(n.newDays||30);return Date.now()-t<=r*24*60*60*1e3}function xn(e){return String(e||"").toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")}function ho(e,t){let n=xn(t.query||""),r=!!t.onlyNew,o=Number(t.yearFrom)||null,a=Number(t.yearTo)||null,s=t.genres||new Set,i=t.collection||"";if(n&&!xn([e.title,e.originalTitle,e.summary,e.studio,oe(e.genres).join(" "),(e.roles||[]).map(d=>d&&(d.tag||d.role||d.name)).join(" "),At(e).join(" ")].filter(Boolean).join(" ")).includes(n)||r&&!fo(e))return!1;let c=Number(Ce(e))||null;if(o&&(!c||c<o)||a&&(!c||c>a))return!1;if(s.size){let l=new Set(oe(e.genres));for(let d of s)if(!l.has(d))return!1}return!(i&&!new Set(At(e)).has(i))}function go(e,t){let n=e.slice();switch(t){case"year-desc":n.sort((r,o)=>(Number(Ce(o))||0)-(Number(Ce(r))||0)||String(r.title||"").localeCompare(String(o.title||""),"de"));break;case"year-asc":n.sort((r,o)=>(Number(Ce(r))||0)-(Number(Ce(o))||0)||String(r.title||"").localeCompare(String(o.title||""),"de"));break;case"title-desc":n.sort((r,o)=>String(o.title||"").localeCompare(String(r.title||""),"de"));break;case"added-desc":n.sort((r,o)=>new Date(o.addedAt||0)-new Date(r.addedAt||0));break;case"title-asc":default:n.sort((r,o)=>String(r.title||"").localeCompare(String(o.title||""),"de"))}return n}function Ct(e,t){let n=new Set,r=new Set,o=new Set,a=i=>(i||[]).forEach(c=>{oe(c.genres).forEach(d=>n.add(d));let l=c.year||(c.originallyAvailableAt?String(c.originallyAvailableAt).slice(0,4):"");l&&r.add(Number(l)),At(c).forEach(d=>o.add(d))});a(e),a(t);let s=[...r].sort((i,c)=>i-c);return{genres:[...n].sort(),years:s,collections:[...o].sort((i,c)=>i.localeCompare(c,"de"))}}function xt(e){let t=x("#yearFrom"),n=x("#yearTo");t&&t.replaceChildren(new Option("Ab Jahr",""),...e.years.map(a=>new Option(String(a),String(a)))),n&&n.replaceChildren(new Option("Bis Jahr",""),...e.years.map(a=>new Option(String(a),String(a))));let r=x("#collectionFilter");r&&r.replaceChildren(new Option("Alle Collections",""),...e.collections.map(a=>new Option(a,a)));let o=x("#genreFilters");if(o){let a=e.genres.map(s=>{let i=document.createElement("button");return i.type="button",i.className="chip",i.textContent=s,i.dataset.name=s,i});o.replaceChildren(...a),kt()}}function po(){var c,l,d,u,h;let e=document.getElementById("search")||document.getElementById("q"),t=((e==null?void 0:e.value)||"").trim(),n=((c=x("#onlyNew"))==null?void 0:c.checked)||!1,r=((l=x("#yearFrom"))==null?void 0:l.value)||"",o=((d=x("#yearTo"))==null?void 0:d.value)||"",a=((u=x("#collectionFilter"))==null?void 0:u.value)||"",s=((h=x("#sort"))==null?void 0:h.value)||"title-asc",i=new Set;return document.querySelectorAll("#genreFilters .chip.active").forEach(f=>i.add(f.dataset.name)),{query:t,onlyNew:n,yearFrom:r,yearTo:o,collection:a,genres:i,sort:s}}function be(){let e=v(),n=e.view==="shows"?e.shows:e.movies,r=po(),o=(n||[]).filter(s=>ho(s,r)),a=go(o,r.sort);return te({filtered:a}),a}function bo(){St||(St=Promise.resolve().then(()=>(Et(),Cn))),St.then(e=>{let t=e&&e.renderGrid;typeof t=="function"&&t(v().view)}).catch(console.error)}function xe(){let e=be();return bo(),mo(e),e}function mo(e){try{let n={items:Array.isArray(e)?e.slice():[],view:v().view};window.dispatchEvent(new CustomEvent("filters:updated",{detail:n}))}catch{}}function kt(){let e=document.getElementById("genreFilters");if(!e)return;let t=e.querySelectorAll(".chip.active").length;e.dataset.state=t>0?"active":"empty",e.dataset.count=String(t)}function Tt(){let e=x("#sort");e&&e.options.length===0&&[["title-asc","Titel A\u2013Z"],["title-desc","Titel Z\u2013A"],["year-desc","Jahr \u2193"],["year-asc","Jahr \u2191"],["added-desc","Zuletzt hinzugef\xFCgt"]].forEach(([o,a])=>e.add(new Option(a,o)));let t=(o,a="input")=>{let s=x(o);s&&(s.addEventListener(a,()=>{xe()}),a==="input"&&s instanceof HTMLInputElement&&s.type==="search"&&s.addEventListener("search",()=>{xe()}))};t("#search"),t("#q"),t("#onlyNew","change"),t("#yearFrom","change"),t("#yearTo","change"),t("#collectionFilter","change"),t("#sort","change"),t("#groupCollections","change");let n=x("#yearReset");n&&n.addEventListener("click",()=>{let o=x("#yearFrom"),a=x("#yearTo");o&&(o.value=""),a&&(a.value=""),xe()});let r=x("#genreFilters");r&&(r.addEventListener("click",o=>{let a=o.target;a instanceof HTMLElement&&a.classList.contains("chip")&&(a.classList.toggle("active"),kt(),xe())}),kt())}var St,qe=F(()=>{G();Be();ye();St=null});var ve={};Xe(ve,{clearCache:()=>wo,hydrateOptional:()=>Lt,validateToken:()=>To});function vo(){try{return new Map(JSON.parse(localStorage.getItem("tmdbCache")||"[]"))}catch{return new Map}}function yo(){try{localStorage.setItem("tmdbCache",JSON.stringify(Array.from(ce.entries())))}catch{}}function wo(){try{localStorage.removeItem("tmdbCache"),ce=new Map}catch{}}function Eo(e){try{let t=localStorage.getItem("tmdbToken");if(t)return{kind:"bearer",value:t}}catch{}return e!=null&&e.tmdbApiKey?{kind:"apikey",value:String(e.tmdbApiKey)}:{kind:"none",value:""}}function So(e){var s,i;let t=e.type==="tv"?"tv":"movie",n=((s=e==null?void 0:e.ids)==null?void 0:s.imdb)||"",r=((i=e==null?void 0:e.ids)==null?void 0:i.tmdb)||"",o=(e.title||"").toLowerCase(),a=String(e.year||"").slice(0,4);return[t,n,r,o,a].filter(Boolean).join("|")}function Nt(e,t){if(!t||t.kind==="none")return{url:e,init:{}};if(t.kind==="bearer")return{url:e,init:{headers:{Authorization:`Bearer ${t.value}`,Accept:"application/json"}}};let n=e.includes("?")?"&":"?";return{url:`${e}${n}api_key=${encodeURIComponent(t.value)}`,init:{headers:{Accept:"application/json"}}}}async function ze(e,t){let{url:n,init:r}=Nt(e,t),o=await fetch(n,r);if(!o.ok)throw new Error("HTTP "+o.status);return o.json()}function Ao(e){return e!=null&&e.file_path?Ke+Tn+e.file_path:""}function ko(e){return e!=null&&e.file_path?Ke+In+e.file_path:""}async function Bt(e,t,n,r){let o=await ze(`${me}/${e}/${t}?language=${encodeURIComponent(n||"de-DE")}`,r),a=await ze(`${me}/${e}/${t}/images`,r).catch(()=>({posters:[],backdrops:[]})),s=Ao((a.posters||[])[0])||(o.poster_path?Ke+Tn+o.poster_path:""),i=ko((a.backdrops||[])[0])||(o.backdrop_path?Ke+In+o.backdrop_path:"");return{id:o.id,poster:s,backdrop:i,url:`https://www.themoviedb.org/${e}/${o.id}`}}async function Co(e,t,n,r,o){let a=encodeURIComponent(t||""),s=n?`&year=${encodeURIComponent(String(n))}`:"",c=((await ze(`${me}/search/${e}?query=${a}${s}&language=${encodeURIComponent(r||"de-DE")}`,o)).results||[])[0];if(!c)throw new Error("not found");return Bt(e,c.id,r,o)}async function xo(e,t,n){var s,i;let r=e.type==="tv"?"tv":"movie",o=So(e);if(ce.has(o))return ce.get(o);let a;try{if((s=e==null?void 0:e.ids)!=null&&s.tmdb)a=await Bt(r,e.ids.tmdb,t.lang,n);else if((i=e==null?void 0:e.ids)!=null&&i.imdb){let c=await ze(`${me}/find/${e.ids.imdb}?external_source=imdb_id&language=${encodeURIComponent(t.lang||"de-DE")}`,n),l=r==="movie"?(c.movie_results||[])[0]:(c.tv_results||[])[0];if(l)a=await Bt(r,l.id,t.lang,n);else throw new Error("not found")}else a=await Co(r,e.title,e.year,t.lang,n)}catch{a=null}return ce.set(o,a),yo(),a}async function Lt(e,t,n={}){try{ce=ce||vo();let r=Eo(n);if(!r.value)return;let o=(e||[]).concat(t||[]),a=0,s=40,i=async()=>{let c=o.slice(a,a+4);a+=4,await Promise.all(c.map(async l=>{let d=await xo(l,n,r);d&&(l.tmdb={id:d.id,poster:d.poster,backdrop:d.backdrop,url:d.url},l.ids=l.ids||{},!l.ids.tmdb&&d.id&&(l.ids.tmdb=String(d.id)))}));try{window.dispatchEvent(new CustomEvent("tmdb:chunk",{detail:{updated:c.length,index:a}}))}catch{}if(a<Math.min(o.length,s))(window.requestIdleCallback||setTimeout)(i,250);else try{window.dispatchEvent(new CustomEvent("tmdb:done",{detail:{total:Math.min(o.length,s)}}))}catch{}};i()}catch{}}async function To(e){let t=String(e||"").trim();if(!t)throw new Error("empty");let n=/^[a-f0-9]{32}$/i.test(t),r=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+$/.test(t),o=a=>{try{let s=a.split(".")[1],c=atob((l=>l+"=".repeat((4-l.length%4)%4))(s.replace(/-/g,"+").replace(/_/g,"/")));return JSON.parse(c)}catch{return null}};if(n){let{url:a,init:s}=Nt(`${me}/configuration`,{kind:"apikey",value:t});return(await fetch(a,s)).ok?{ok:!0,as:"apikey",hint:"v3Key"}:{ok:!1,as:"apikey",hint:"looksV3"}}if(r){let a=o(t);if(a&&typeof a=="object"){let c=String(a.iss||"");if(c&&!/themoviedb\.org/i.test(c))return{ok:!1,as:"bearer",hint:"issMismatch"}}let{url:s,init:i}=Nt(`${me}/trending/movie/day`,{kind:"bearer",value:t});try{if((await fetch(s,i)).ok)return{ok:!0,as:"bearer",hint:null}}catch{}return{ok:!0,as:"bearer",hint:"structOnly"}}return{ok:!1,as:"bearer",hint:null}}var me,Ke,Tn,In,ce,le=F(()=>{me="https://api.themoviedb.org/3",Ke="https://image.tmdb.org/t/p/",Tn="w342",In="w780"});G();Be();var q,Le,Fe,Y;function Qe(){if(!q&&(q=x("#loaderOverlay"),!q)){q=C("div","loader-overlay"),q.id="loaderOverlay",q.hidden=!0;let e=C("div","loader");Fe=C("div","msg",""),Le=C("div","bar"),e.append(Fe,Le),q.append(e),document.body.append(q)}}function Ht(){Qe(),q.hidden=!1}function de(e,t){Qe(),Fe&&(Fe.textContent=e||""),Le&&(Le.style.width=(t||0)+"%")}function Me(){Qe(),q.hidden=!0}function qt(e=18){let t=x("#grid");if(t){Y=C("div","skeleton");for(let n=0;n<e;n++)Y.append(C("div","skel"));t.replaceChildren(Y)}}function et(){Y&&Y.parentElement&&Y.parentElement.removeChild(Y),Y=null}fe();qe();Et();wt();le();ht();G();fe();nt();function Bn(){let e=document.getElementById("openDebug");e&&e.addEventListener("click",()=>{Io()})}function Io(){var t,n,r,o;let e=document.getElementById("debugOverlay");e||(e=document.createElement("div"),e.id="debugOverlay",e.className="debug-overlay",e.innerHTML=`
      <div class="debug-dialog">
        <div class="debug-header"><h2>Debug</h2></div>
        <div class="debug-body">
          <pre id="debugPre" class="debug-pre"></pre>
          <div class="debug-cache-controls">
            <h3>Cache-Verwaltung</h3>
            <div id="cacheStats" class="cache-stats"></div>
            <div class="cache-buttons">
              <button id="debugClearExpired" class="btn">Abgelaufene l\xF6schen</button>
              <button id="debugClearAll" class="btn">Alles l\xF6schen</button>
            </div>
          </div>
        </div>
        <div class="debug-actions">
          <button id="debugCopy" class="btn">Copy report</button>
          <button id="debugClose" class="btn">Schlie\xDFen</button>
        </div>
      </div>`,document.body.append(e)),e.hidden=!1,Ft(),e.addEventListener("click",a=>{a.target===e&&Nn()}),(t=document.getElementById("debugClose"))==null||t.addEventListener("click",Nn,{once:!0}),(n=document.getElementById("debugCopy"))==null||n.addEventListener("click",No,{once:!0}),(r=document.getElementById("debugClearExpired"))==null||r.addEventListener("click",()=>{$e(),Ft()},{once:!0}),(o=document.getElementById("debugClearAll"))==null||o.addEventListener("click",()=>{confirm("Wirklich den gesamten Cache l\xF6schen?")&&(Ot(),Ft())},{once:!0})}function Nn(){let e=document.getElementById("debugOverlay");e&&(e.hidden=!0)}function Ft(){let e=document.getElementById("debugPre");if(!e)return;let t=v(),n=en(),r=t.cfg||{},o=tt(),a={view:t.view,counts:{movies:(t.movies||[]).length,shows:(t.shows||[]).length,filtered:(t.filtered||[]).length},dataSources:n,cache:o,tmdb:{enabled:!!r.tmdbEnabled,lang:r.lang,tokenPresent:!!(localStorage.getItem("tmdbToken")||r.tmdbApiKey)},useTmdbImages:localStorage.getItem("useTmdb")==="1",reduceMotion:localStorage.getItem("prefReduceMotion")==="1",locationHash:location.hash,userAgent:navigator.userAgent};e.textContent=JSON.stringify(a,null,2);let s=document.getElementById("cacheStats");s&&o&&(s.innerHTML=`
      <p>Eintr\xE4ge gesamt: <strong>${o.totalEntries}</strong></p>
      <p>G\xFCltig: <strong>${o.validEntries}</strong> | Abgelaufen: <strong>${o.expiredEntries}</strong></p>
      <p>Gr\xF6\xDFe: <strong>${o.totalSizeMB} MB</strong></p>
    `)}function No(){var n;let e=document.getElementById("debugPre");if(!e)return;let t=e.textContent||"";(n=navigator.clipboard)==null||n.writeText(t).catch(()=>{try{let r=document.createElement("textarea");r.value=t,document.body.append(r),r.select(),document.execCommand("copy"),r.remove()}catch{}})}ye();var R=null;function Ve(){R||(R=document.createElement("div"),R.id="errorContainer",R.className="error-container",R.setAttribute("role","alert"),R.setAttribute("aria-live","polite"),document.body.appendChild(R)),window.addEventListener("unhandledrejection",e=>{var t;Oe("Ein unerwarteter Fehler ist aufgetreten",(t=e.reason)==null?void 0:t.message),e.preventDefault()}),window.addEventListener("error",e=>{var t;Oe("Ein Fehler ist aufgetreten",(t=e.error)==null?void 0:t.message)})}function Oe(e,t="",n=5e3){R||Ve();let r=document.createElement("div");return r.className="error-toast",r.innerHTML=`
    <div class="error-toast-content">
      <div class="error-toast-icon">\u26A0\uFE0F</div>
      <div class="error-toast-text">
        <div class="error-toast-title">${Mt(e)}</div>
        ${t?`<div class="error-toast-message">${Mt(t)}</div>`:""}
      </div>
      <button class="error-toast-close" aria-label="Schlie\xDFen">\xD7</button>
    </div>
  `,r.querySelector(".error-toast-close").addEventListener("click",()=>{r.classList.add("error-toast-exit"),setTimeout(()=>r.remove(),300)}),R.appendChild(r),n>0&&setTimeout(()=>{r.parentNode&&(r.classList.add("error-toast-exit"),setTimeout(()=>r.remove(),300))},n),requestAnimationFrame(()=>{r.classList.add("error-toast-show")}),r}function Ln(e,t){R||Ve();let n=document.createElement("div");n.className="error-toast error-toast-retryable",n.innerHTML=`
    <div class="error-toast-content">
      <div class="error-toast-icon">\u26A0\uFE0F</div>
      <div class="error-toast-text">
        <div class="error-toast-title">${Mt(e)}</div>
      </div>
      <button class="error-toast-retry">Erneut versuchen</button>
      <button class="error-toast-close" aria-label="Schlie\xDFen">\xD7</button>
    </div>
  `;let r=n.querySelector(".error-toast-retry"),o=n.querySelector(".error-toast-close");return r.addEventListener("click",async()=>{n.remove();try{await t()}catch{}}),o.addEventListener("click",()=>{n.classList.add("error-toast-exit"),setTimeout(()=>n.remove(),300)}),R.appendChild(n),requestAnimationFrame(()=>{n.classList.add("error-toast-show")}),n}function Mt(e){let t=document.createElement("div");return t.textContent=e,t.innerHTML}var $t=0,We=!1,_t=!1,O=null;function Fn(){O=document.getElementById("filterBar"),O&&(window.addEventListener("scroll",Lo,{passive:!0}),document.addEventListener("modal:open",Ue),document.addEventListener("modal:close",Je),document.addEventListener("settings:open",Ue),document.addEventListener("settings:close",Je),document.addEventListener("watchlist:open",Ue),document.addEventListener("watchlist:close",Je))}function Lo(){_t||(window.requestAnimationFrame(()=>{Fo(),_t=!1}),_t=!0)}function Fo(){let e=window.scrollY;e>$t&&e>100?We||(We=!0,Ue()):e<$t&&We&&(We=!1,Je()),$t=e}function Ue(){O&&(O.classList.add("filters--hidden"),O.setAttribute("aria-hidden","true"),O.setAttribute("inert",""))}function Je(){if(!O)return;let e=document.querySelector('.modalv2-overlay[aria-hidden="false"]'),t=document.querySelector('.settings-overlay[aria-hidden="false"]'),n=document.querySelector('.watchlist-panel[aria-hidden="false"]');e||t||n||(O.classList.remove("filters--hidden"),O.setAttribute("aria-hidden","false"),O.removeAttribute("inert"))}var Ie=null,U=null;function Te(e,t=!0){let n=document.getElementById("footerMeta");if(n){let o=n.querySelector("#footerStatus");o?o.textContent=e:n.textContent=e,n.dataset.state=t?"loading":"ready"}let r=document.getElementById("grid");r&&r.setAttribute("aria-busy",t?"true":"false")}async function Mo(){Ve(),Go(),Ht(),Te("Initialisiere \u2026",!0),de("Initialisiere \u2026",8),qt(18);let e=await fetch("config.json").then(n=>n.json()).catch(n=>(Oe("Konfiguration konnte nicht geladen werden","Verwende Standardeinstellungen"),{startView:"movies",tmdbEnabled:!1}));te({cfg:e,view:e.startView||"movies"});try{Te("Filme laden \u2026",!0),de("Filme laden \u2026",25);let n=await ot();Te("Serien laden \u2026",!0),de("Serien laden \u2026",45);let r=await at();Te("Filter vorbereiten \u2026",!0),de("Filter vorbereiten \u2026",60);let o=Ct(n,r);te({movies:n,shows:r,facets:o}),Te("Ansicht aufbauen \u2026",!0),de("Ansicht aufbauen \u2026",85),et(),jt(),xt(o),Tt(),be(),$o(!0),$(v().view),_o(),Me(),e.tmdbEnabled&&(window.requestIdleCallback||setTimeout)(()=>{var a;return(a=Lt)==null?void 0:a(n,r,e)},400),ln(),Jo(e),Yo(),Xo(),Zo(),Qo(),Fn(),J(),Bn()}catch(n){throw Me(),et(),Ln("Fehler beim Laden der Daten",()=>window.location.reload()),n}let t;window.addEventListener("tmdb:chunk",()=>{t||(t=requestAnimationFrame(()=>{t=null;try{localStorage.getItem("useTmdb")==="1"&&($(v().view),J())}catch{}}))}),window.addEventListener("tmdb:done",()=>{try{localStorage.getItem("useTmdb")==="1"&&($(v().view),J())}catch{}})}var Pt=null,Dt="";window.addEventListener("hashchange",()=>{if(window.__skipNextHashNavigation){try{window.__skipNextHashNavigation=!1,Dt=location.hash||""}catch{}return}let e=location.hash||"";Pt&&clearTimeout(Pt),Pt=setTimeout(()=>{if(e===Dt)return;Dt=e;let t=e;if(/^#\/(movies|shows)$/.test(t)){let i=t.includes("shows")?"shows":"movies";te({view:i});let c=be();jt(),$(i),J(c);return}let n=t.match(/^#\/(movie|show)\/(.+)/);if(!n)return;let[,r,o]=n,s=((r==="movie"?v().movies:v().shows)||[]).find(i=>{var c,l;return((c=i==null?void 0:i.ids)==null?void 0:c.imdb)===o||((l=i==null?void 0:i.ids)==null?void 0:l.tmdb)===o||String(i==null?void 0:i.ratingKey)===o});s&&(r==="show"?Ae(s):Se(s))},50)});function jt(){let e=document.getElementById("libraryTabs");if(!e)return;let t=Array.from(e.querySelectorAll("[data-lib]")),n=v().view==="shows"?"shows":"movies";t.forEach(r=>{let o=r.dataset.lib==="series"?"shows":"movies",a=n===o;r.classList.toggle("is-active",a),r.setAttribute("aria-pressed",a?"true":"false"),r.dataset.bound!=="true"&&(r.addEventListener("click",()=>{let s=r.dataset.lib==="series"?"shows":"movies";if(v().view===s)return;te({view:s});try{window.__skipNextHashNavigation=!0}catch{}location.hash=s==="movies"?"#/movies":"#/shows",jt();let i=be();$(s),J(i)}),r.dataset.bound="true")})}function $o(e=!1){let t=document.getElementById("heroStats");if(!t)return;let n=v(),r=(n.movies||[]).length,o=(n.shows||[]).length,a=t.querySelector('[data-stat="movies"]'),s=t.querySelector('[data-stat="shows"]');!a||!s||(e?(Mn(a,r),Mn(s,o)):(a.textContent=String(r),s.textContent=String(o)))}function Mn(e,t){if(!e)return;let n=Number(e.textContent)||0,r=Number(t)||0;if(n===r){e.textContent=String(r);return}let o=480,a=performance.now();function s(i){let c=Math.min(1,(i-a)/o),l=Math.round(n+(r-n)*(c<.5?2*c*c:-1+(4-2*c)*c));e.textContent=String(l),c<1?requestAnimationFrame(s):e.textContent=String(r)}requestAnimationFrame(s)}function _o(){let e=document.getElementById("footerMeta");if(!e)return;let t=document.getElementById("footerStatus"),n=v(),r=n.movies||[],o=n.shows||[],a=r.concat(o).map(l=>new Date(l.addedAt||0).getTime()).filter(Number.isFinite),i=(a.length?new Date(Math.max(...a)):new Date).toISOString().slice(0,10);t&&(t.textContent=`Stand: ${i}`),e.dataset.state="ready";let c=document.getElementById("grid");c&&c.setAttribute("aria-busy","false")}function J(e){let t=document.getElementById("hero"),n=document.getElementById("heroTitle"),r=document.getElementById("heroSubtitle"),o=document.getElementById("heroCta");if(!t||!n||!r||!o)return;Po();let a=Do(e);if(!a){Ie=null,n.textContent=U.title,r.textContent=U.subtitle,r.dataset.taglinePaused="0",delete r.dataset.heroBound,r.classList.remove("is-fading"),o.textContent=U.cta,o.disabled=!0,o.setAttribute("aria-disabled","true"),o.removeAttribute("aria-label"),o.onclick=null,t.style.backgroundImage="",t.classList.remove("has-poster"),t.dataset.heroKind="",t.dataset.heroId="";return}Ie=a;let s=a.type==="tv"?"show":"movie",i=Oo(a);n.textContent=a.title||U.title,r.textContent=Ro(a),r.dataset.taglinePaused="1",r.dataset.heroBound="1",r.classList.remove("is-fading");let c=s==="show"?"Serien-Details \xF6ffnen":"Film-Details \xF6ffnen";o.textContent=c,o.disabled=!1,o.setAttribute("aria-disabled","false"),o.setAttribute("aria-label",a.title?`${c}: ${a.title}`:c),o.onclick=()=>Vo(a,s,i),t.dataset.heroKind=s,t.dataset.heroId=i||"";let l=Uo(a);l?(t.style.backgroundImage=`url(${l})`,t.classList.add("has-poster")):(t.style.backgroundImage="",t.classList.remove("has-poster"))}window.__heroRefresh=J;function Po(){var e,t,n;U||(U={title:((e=document.getElementById("heroTitle"))==null?void 0:e.textContent)||"",subtitle:((t=document.getElementById("heroSubtitle"))==null?void 0:t.textContent)||"",cta:((n=document.getElementById("heroCta"))==null?void 0:n.textContent)||""})}function Do(e){if(Array.isArray(e)){let r=e.filter(_n);return r.length?$n(r):null}let n=jo().filter(_n);return n.length?$n(n):null}function $n(e){if(e.length===1)return e[0];let t=Math.floor(Math.random()*e.length),n=e[t];return Ie&&e.length>1&&n===Ie&&e.find(o=>o!==Ie)||n}function jo(){let e=v(),t=e.view==="shows"?"shows":"movies",r=(Array.isArray(e.filtered)&&e.filtered.length?e.filtered:null)||(t==="shows"?e.shows:e.movies)||[];return Array.isArray(r)?r:[]}function _n(e){return!!e&&typeof e=="object"&&!e.isCollectionGroup&&e.type!=="collection"}function Ro(e){var i;let t=[],n=K(e);n&&t.push(String(n));let r=Ho(e);r&&t.push(r);let o=Number((i=e==null?void 0:e.rating)!=null?i:e==null?void 0:e.audienceRating);Number.isFinite(o)&&t.push(`\u2605 ${j(o)}`);let a=qo(e,2);a.length&&t.push(a.join(", "));let s=Ko(e);return s?t.length?`${t.join(" \u2022 ")} \u2014 ${s}`:s:t.length?t.join(" \u2022 "):(U==null?void 0:U.subtitle)||""}function Ho(e){var r,o;let t=(o=(r=e==null?void 0:e.runtimeMin)!=null?r:e==null?void 0:e.durationMin)!=null?o:e!=null&&e.duration?Math.round(Number(e.duration)/6e4):null,n=Number(t);return!Number.isFinite(n)||n<=0?"":(e==null?void 0:e.type)==="tv"?`~${n} min/Ep`:`${n} min`}function qo(e,t=3){let n=Array.isArray(e==null?void 0:e.genres)?e.genres:[],r=[];return n.forEach(a=>{if(!a)return;if(typeof a=="string"){r.push(a);return}let s=a.tag||a.title||a.name||a.label||"";s&&r.push(s)}),Array.from(new Set(r)).slice(0,Math.max(0,t))}function Ko(e){let t=[e==null?void 0:e.tagline,e==null?void 0:e.summary,e==null?void 0:e.plot,e==null?void 0:e.overview];for(let n of t){if(typeof n!="string")continue;let r=n.trim();if(r)return zo(r,220)}return""}function zo(e,t){let n=String(e||"").trim();return n?n.length<=t?n:`${n.slice(0,Math.max(0,t-1)).trimEnd()}\u2026`:""}function Oo(e){var t,n;return e?(t=e==null?void 0:e.ids)!=null&&t.imdb?String(e.ids.imdb):(n=e==null?void 0:e.ids)!=null&&n.tmdb?String(e.ids.tmdb):(e==null?void 0:e.ratingKey)!=null?String(e.ratingKey):"":""}function Vo(e,t,n){n&&Wo(t,n),t==="show"?Ae(e):Se(e)}function Wo(e,t){if(!e||!t)return;let n=`#/${e}/${t}`;try{if(history&&typeof history.pushState=="function"){location.hash===n&&typeof history.replaceState=="function"?history.replaceState(null,"",n):history.pushState(null,"",n);return}}catch{}try{window.__skipNextHashNavigation=!0}catch{}location.hash=n}function Uo(e){var a,s,i,c,l;if(!e)return"";let t=ae(),n=[(a=e==null?void 0:e.tmdb)==null?void 0:a.backdrop,(s=e==null?void 0:e.tmdb)==null?void 0:s.backdrop_path,(i=e==null?void 0:e.tmdb)==null?void 0:i.backdropPath,(c=e==null?void 0:e.tmdb)==null?void 0:c.background,(l=e==null?void 0:e.tmdb)==null?void 0:l.art],r=[e==null?void 0:e.art,e==null?void 0:e.background,e==null?void 0:e.thumbBackground,e==null?void 0:e.coverArt,e==null?void 0:e.thumb,e==null?void 0:e.thumbFile];if(t){let d=n.find(Pn);if(d)return d}return r.find(Pn)||""}function Pn(e){return typeof e=="string"&&e.trim().length>0}window.addEventListener("filters:updated",e=>{let t=e==null?void 0:e.detail,n=Array.isArray(t==null?void 0:t.items)?t.items:null;J(n)});Mo();window.addEventListener("load",()=>{try{Me()}catch{}});function Jo(e){let t=document.getElementById("settingsOverlay"),n=t==null?void 0:t.querySelector(".settings-dialog"),r=document.getElementById("settingsBtn"),o=document.getElementById("openSettings"),a=document.getElementById("headerSettingsBtn"),s=document.getElementById("settingsClose2"),i=document.getElementById("tmdbTokenInput"),c=document.getElementById("tmdbSave"),l=document.getElementById("tmdbTest"),d=document.getElementById("tmdbStatus"),u=document.getElementById("tmdbClearCache"),h=document.getElementById("tmdbStatusBadge"),f=document.getElementById("prefReduceMotion"),b=document.getElementById("useTmdbSetting"),A=document.getElementById("resetFilters");t&&t.hidden&&t.setAttribute("aria-hidden","true");let I=null,_="",H=!1,P=new Map,ee='a[href], button:not([disabled]), input:not([disabled]), select:not([disabled]), textarea:not([disabled]), [tabindex]:not([tabindex="-1"])';function Ne(){return t?Array.from(t.querySelectorAll(ee)).filter(g=>!g.hasAttribute("disabled")&&g.getAttribute("aria-hidden")!=="true"):[]}function y(){n&&typeof n.focus=="function"?n.focus({preventScroll:!0}):t&&typeof t.focus=="function"&&t.focus({preventScroll:!0})}function k(g){if(!t)return;let E=Array.from(document.body.children).filter(p=>p!==t);g?E.forEach(p=>{P.has(p)||P.set(p,{ariaHidden:p.hasAttribute("aria-hidden")?p.getAttribute("aria-hidden"):null,inert:p.hasAttribute("inert")}),p.setAttribute("aria-hidden","true"),p.setAttribute("inert","")}):(E.forEach(p=>{let m=P.get(p);m?(m.ariaHidden===null||m.ariaHidden===void 0?p.removeAttribute("aria-hidden"):p.setAttribute("aria-hidden",m.ariaHidden),m.inert?p.setAttribute("inert",""):p.removeAttribute("inert"),P.delete(p)):(p.removeAttribute("aria-hidden"),p.removeAttribute("inert"))}),P.clear())}function S(){!t||H||(H=!0,t.hidden=!1,t.setAttribute("aria-hidden","false"),I=document.activeElement instanceof HTMLElement?document.activeElement:null,_=document.body.style.overflow,document.body.style.overflow="hidden",k(!0),Dn(),requestAnimationFrame(y),document.dispatchEvent(new CustomEvent("settings:open")))}function B(){!t||!H||(H=!1,t.hidden=!0,t.setAttribute("aria-hidden","true"),k(!1),document.body.style.overflow=_,I&&typeof I.focus=="function"&&I.focus(),I=null,document.dispatchEvent(new CustomEvent("settings:close")))}function N(g){if(!H)return;if(g.key==="Escape"){g.preventDefault(),B();return}if(g.key!=="Tab")return;let E=Ne();if(!E.length){g.preventDefault(),y();return}let p=E[0],m=E[E.length-1],V=document.activeElement;g.shiftKey?(V===p||!t.contains(V))&&(g.preventDefault(),m.focus()):V===m&&(g.preventDefault(),p.focus())}r&&r.addEventListener("click",S),o&&o.addEventListener("click",()=>{S()}),a&&a.addEventListener("click",S),s&&s.addEventListener("click",B),t&&t.addEventListener("click",g=>{g.target===t&&B()}),t&&t.addEventListener("keydown",N);function w(g="",E=""){if(d){d.textContent=g,d.dataset.kind=E,h&&(h.dataset.kind=E||"",h.title=g||"");try{if(E==="error"&&e&&e.tmdbApiKey){let p=String(localStorage.getItem("tmdbToken")||"").trim(),m=String((i==null?void 0:i.value)||"").trim();if(p&&m){try{localStorage.removeItem("tmdbToken")}catch{}i&&(i.value=""),L(!0);let V="Ung\xFCltiger Token entfernt. Verwende API Key aus config.json.";d.textContent=V,d.dataset.kind="info",h&&(h.dataset.kind="info",h.title=V)}}}catch{}}}function L(g){if(b&&(b.disabled=!g,b.title=b.disabled?"Nur verf\xFCgbar mit g\xFCltigem Token oder API Key.":"",!g&&b.checked)){try{localStorage.setItem("useTmdb","0")}catch{}b.checked=!1,$(v().view)}}function Dn(){let g="";try{i&&(i.value=g=localStorage.getItem("tmdbToken")||"")}catch{}try{f&&(f.checked=localStorage.getItem("prefReduceMotion")==="1")}catch{}try{b&&(b.checked=localStorage.getItem("useTmdb")==="1",b.disabled=!g,b.title=b.disabled?"Nur verf\xFCgbar mit g\xFCltigem Token.":"")}catch{}try{L(!!g||!!(e&&e.tmdbApiKey))}catch{}w("",""),g||w("Kein Token hinterlegt. TMDB ist deaktiviert.","info"),e!=null&&e.tmdbEnabled||w("Hinweis: TMDB in config.json deaktiviert (tmdbEnabled=false).","info"),g?(async()=>{var E;w("Pr\xFCfe Token...","pending");try{let p=await Promise.resolve().then(()=>(le(),ve)),m=await((E=p.validateToken)==null?void 0:E.call(p,g));m&&m.ok?(L(!0),m.as==="bearer"?w("Token g\xFCltig (v4 Bearer).","success"):m.as==="apikey"&&w('API Key g\xFCltig (v3). Tipp: dauerhaft in site/config.json unter "tmdbApiKey" eintragen.',"success")):(L(!1),(m==null?void 0:m.hint)==="looksV3"?w('Eingegebener Wert sieht wie ein v3 API Key aus. Bitte in config.json als "tmdbApiKey" eintragen oder v4 Bearer Token verwenden.',"error"):w("Token ung\xFCltig oder keine Berechtigung (401).","error"))}catch{w("Pr\xFCfung fehlgeschlagen. Netzwerk/Browser-Konsole pr\xFCfen.","error")}})():L(!!(e&&e.tmdbApiKey))}c&&c.addEventListener("click",async()=>{var E;let g=String((i==null?void 0:i.value)||"").trim();try{localStorage.setItem("tmdbToken",g)}catch{}if(!g){w("Kein Token hinterlegt. TMDB ist deaktiviert.","info"),L(!!(e&&e.tmdbApiKey));return}w("Pr\xFCfe Token...","pending");try{let p=await Promise.resolve().then(()=>(le(),ve)),m=await((E=p.validateToken)==null?void 0:E.call(p,g));m&&m.ok?(L(!0),m.as==="bearer"?w("Token g\xFCltig (v4 Bearer).","success"):m.as==="apikey"&&w('API Key g\xFCltig (v3). Tipp: dauerhaft in site/config.json unter "tmdbApiKey" eintragen.',"success")):(L(!1),(m==null?void 0:m.hint)==="looksV3"?w('Eingegebener Wert sieht wie ein v3 API Key aus. Bitte in config.json als "tmdbApiKey" eintragen oder v4 Bearer Token verwenden.',"error"):w("Token ung\xFCltig oder keine Berechtigung (401).","error"))}catch{w("Pr\xFCfung fehlgeschlagen. Netzwerk/Browser-Konsole pr\xFCfen.","error")}}),l&&l.addEventListener("click",async()=>{var E;let g=String((i==null?void 0:i.value)||"").trim();if(!g){w("Bitte Token eingeben.","error");return}w("Pr\xFCfe Token...","pending");try{let p=await Promise.resolve().then(()=>(le(),ve)),m=await((E=p.validateToken)==null?void 0:E.call(p,g));m&&m.ok?m.as==="bearer"?w("Token g\xFCltig (v4 Bearer).","success"):m.as==="apikey"&&w('API Key g\xFCltig (v3). Tipp: dauerhaft in site/config.json unter "tmdbApiKey" eintragen.',"success"):(m==null?void 0:m.hint)==="looksV3"?w('Eingegebener Wert sieht wie ein v3 API Key aus. Dieser funktioniert hier nicht als Bearer. Bitte in config.json als "tmdbApiKey" eintragen oder v4 Bearer Token verwenden.',"error"):w("Token ung\xFCltig oder keine Berechtigung (401).","error")}catch{w("Pr\xFCfung fehlgeschlagen. Netzwerk/Browser-Konsole pr\xFCfen.","error")}}),u&&u.addEventListener("click",()=>{Promise.resolve().then(()=>(le(),ve)).then(g=>{var E;return(E=g.clearCache)==null?void 0:E.call(g)})}),f&&f.addEventListener("change",()=>{try{localStorage.setItem("prefReduceMotion",f.checked?"1":"0")}catch{}document.documentElement.classList.toggle("reduce-motion",f.checked)}),b&&b.addEventListener("change",()=>{try{localStorage.setItem("useTmdb",b.checked?"1":"0")}catch{}b.checked&&!window.__tmdbHydrationStarted&&(window.__tmdbHydrationStarted=1,Promise.resolve().then(()=>(le(),ve)).then(g=>{var p;let E=v();(p=g.hydrateOptional)==null||p.call(g,E.movies,E.shows,E.cfg)}).catch(()=>{}),setTimeout(()=>{b.checked&&$(v().view)},1200),setTimeout(()=>{b.checked&&$(v().view)},3e3)),$(v().view),J()}),A&&A.addEventListener("click",()=>{let g=document.getElementById("search");g&&(g.value="");let E=document.getElementById("q");E&&(E.value="");let p=document.getElementById("onlyNew");p&&(p.checked=!1);let m=document.getElementById("yearFrom"),V=document.getElementById("yearTo");m&&(m.value=""),V&&(V.value="");let Rt=document.getElementById("collectionFilter");Rt&&(Rt.value=""),document.querySelectorAll("#genreFilters .chip.active").forEach(Ye=>Ye.classList.remove("active"));let Ge=document.getElementById("genreFilters");Ge&&(Ge.dataset.state="empty",Ge.dataset.count="0"),Promise.resolve().then(()=>(qe(),It)).then(Ye=>{let jn=Ye.applyFilters();$(v().view),J(jn)})})}function Go(){try{let e=localStorage.getItem("prefReduceMotion")==="1";document.documentElement.classList.toggle("reduce-motion",e)}catch{}}function Yo(){let e=document.getElementById("toggleAdvanced"),t=document.getElementById("advancedFilters");if(!e||!t)return;let n=!1,r=0,o=()=>{n=!1,r&&(clearTimeout(r),r=0),t.dataset.state==="closing"?(t.dataset.state="closed",t.hidden=!0,t.style.removeProperty("--advanced-max")):t.dataset.state==="open"?t.style.removeProperty("--advanced-max"):t.dataset.state==="expanding"&&(t.dataset.state="open",t.style.removeProperty("--advanced-max"))},a=()=>{r&&clearTimeout(r),r=window.setTimeout(o,320)};t.addEventListener("transitionend",c=>{c.target!==t||c.propertyName!=="max-height"||o()});let s=()=>{n||(n=!0,t.hidden=!1,t.dataset.state="expanding",t.setAttribute("aria-hidden","false"),t.style.setProperty("--advanced-max","0px"),requestAnimationFrame(()=>{let c=t.scrollHeight;t.style.setProperty("--advanced-max",c+"px"),t.dataset.state="open",a()}))},i=()=>{if(n)return;n=!0;let c=t.scrollHeight;t.style.setProperty("--advanced-max",c+"px"),t.dataset.state="closing",t.setAttribute("aria-hidden","true"),requestAnimationFrame(()=>{t.style.setProperty("--advanced-max","0px"),a()})};e.addEventListener("click",()=>{e.getAttribute("aria-expanded")==="true"?(e.setAttribute("aria-expanded","false"),i()):(e.setAttribute("aria-expanded","true"),s())})}function Xo(){let e=document.getElementById("siteLogo");e&&e.addEventListener("error",()=>{e.classList.add("logo-missing");let a=document.querySelector(".site-header__brand-text .site-header__label");a&&a.classList.remove("sr-only")});let t=document.getElementById("heroSubtitle"),n=["Offline st\xF6bern & Wunschlisten teilen","Filter. Finden. Freuen.","Filme & Serien \u2013 stressfrei sichtbar","Schneller als jeder SMB-Share","Merkliste zuerst, Streit sp\xE4ter"],r=0;t&&(t.textContent=n[r]);function o(){!t||t.dataset.taglinePaused==="1"||(t.classList.add("is-fading"),setTimeout(()=>{if(!t||t.dataset.taglinePaused==="1"){t&&t.classList.remove("is-fading");return}r=(r+1)%n.length,t.textContent=n[r],t.classList.remove("is-fading")},280))}t&&(t.dataset.taglinePaused="0",window.__taglineTicker||(window.__taglineTicker=setInterval(o,6e3),setTimeout(o,3e3)))}function Zo(){let e=document.getElementById("scrollProgress");if(!e)return;let t=()=>{let n=document.documentElement.scrollTop||document.body.scrollTop||0,r=document.documentElement.scrollHeight-document.documentElement.clientHeight||1,o=Math.max(0,Math.min(100,n/r*100));e.style.width=o+"%"};addEventListener("scroll",t,{passive:!0}),t()}function Qo(){let e=document.getElementById("scrollTop");if(!e)return;let t=()=>{let n=window.scrollY||0;e.style.display=n>300?"block":"none"};addEventListener("scroll",t,{passive:!0}),t(),e.addEventListener("click",()=>window.scrollTo({top:0,behavior:"smooth"}))}
//# sourceMappingURL=main.js.map
