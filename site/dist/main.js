var Mn=Object.defineProperty;var _=(e,t)=>()=>(e&&(t=e(e=0)),t);var Je=(e,t)=>{for(var n in t)Mn(e,n,{get:t[n],enumerable:!0})};function ee(e){Object.assign(Ge,e),_n.forEach(t=>t(Ge))}var Ge,_n,y,J=_(()=>{Ge={view:"movies",movies:[],shows:[],facets:{},filtered:[],cfg:{}},_n=new Set,y=()=>Ge});function k(e,t,n){let r=document.createElement(e);return t&&(r.className=t),n!=null&&(r.textContent=n),r}var I,Ne=_(()=>{I=(e,t=document)=>t.querySelector(e)});function Dt(e,t,n=864e5){try{let r=te+e,o={value:t,timestamp:Date.now(),ttl:n};localStorage.setItem(r,JSON.stringify(o)),$n()}catch(r){if(r.name==="QuotaExceededError"){Ht();try{let o=te+e,a={value:t,timestamp:Date.now(),ttl:n};localStorage.setItem(o,JSON.stringify(a))}catch{}}}}function jt(e){try{let t=te+e,n=localStorage.getItem(t);if(!n)return null;let r=JSON.parse(n),o=Date.now();return r.timestamp+r.ttl<o?(localStorage.removeItem(t),null):r.value}catch{return null}}function Rt(){try{Object.keys(localStorage).forEach(t=>{t.startsWith(te)&&localStorage.removeItem(t)})}catch{}}function Me(){try{let e=Object.keys(localStorage),t=Date.now(),n=0;e.forEach(r=>{if(r.startsWith(te))try{let o=JSON.parse(localStorage.getItem(r));o.timestamp+o.ttl<t&&(localStorage.removeItem(r),n++)}catch{localStorage.removeItem(r),n++}}),n>0}catch{}}function Ze(){try{let t=Object.keys(localStorage).filter(s=>s.startsWith(te)),n=Date.now(),r=0,o=0,a=0;return t.forEach(s=>{let i=localStorage.getItem(s);r+=i.length*2;try{let c=JSON.parse(i);c.timestamp+c.ttl>=n?o++:a++}catch{a++}}),{totalEntries:t.length,validEntries:o,expiredEntries:a,totalSize:r,totalSizeMB:(r/1024/1024).toFixed(2)}}catch{return null}}function $n(){try{let e=Ze();e&&e.totalSize>5242880&&Ht(.3)}catch{}}function Ht(e=.3){try{let t=Object.keys(localStorage),n=[];t.forEach(o=>{if(o.startsWith(te))try{let a=JSON.parse(localStorage.getItem(o));n.push({key:o,timestamp:a.timestamp})}catch{n.push({key:o,timestamp:0})}}),n.sort((o,a)=>o.timestamp-a.timestamp);let r=Math.ceil(n.length*e);for(let o=0;o<r;o++)localStorage.removeItem(n[o].key)}catch{}}var te,Pn,Qe=_(()=>{te="plex_cache_";Pn=null;typeof window!="undefined"&&typeof window.document!="undefined"&&window===globalThis&&(Me(),Pn=setInterval(Me,5*60*1e3))});async function et(e,t=2,n=!0){if(n){let o=jt(e);if(o!==null)return o}let r=null;for(let o=0;o<=t;o++){try{let a=await fetch(e,{cache:"no-store"});if(a&&a.ok){let s=await a.json();return n&&s&&Dt(e,s,Dn),s}if(a&&a.status===404)return null;r=new Error(`HTTP ${a.status}: ${a.statusText}`)}catch(a){r=a}if(o<t){let a=Math.min(1e3*Math.pow(2,o),5e3);await new Promise(s=>setTimeout(s,a))}}return null}function qn(e){try{let t=document.getElementById(e);if(t&&t.textContent)return JSON.parse(t.textContent)}catch{}return null}function Kn(e){try{let t=window.__PLEX_EXPORTER__;return(t&&Array.isArray(t[e])?t[e]:null)||null}catch{return null}}function zn(e){try{return(Array.isArray(window[e])?window[e]:null)||null}catch{return null}}async function Ot(e,t){let n=await et(e);if(Array.isArray(n)&&n.length)return de(t==null?void 0:t.label,`primary:${e}`),n;if(t!=null&&t.embedId){let r=qn(t.embedId);if(Array.isArray(r)&&r.length)return de(t==null?void 0:t.label,`embedded:${t.embedId}`),r}if(t!=null&&t.exportKey){let r=Kn(t.exportKey);if(Array.isArray(r)&&r.length)return de(t==null?void 0:t.label,`globalBag:${t.exportKey}`),r}if(t!=null&&t.globalVar){let r=zn(t.globalVar);if(Array.isArray(r)&&r.length)return de(t==null?void 0:t.label,`window:${t.globalVar}`),r}for(let r of(t==null?void 0:t.altUrls)||[]){let o=await et(r);if(Array.isArray(o)&&o.length)return de(t==null?void 0:t.label,`alt:${r}`),o}return de(t==null?void 0:t.label,"empty"),Array.isArray(n)?n:[]}function On(e,t){let n=e==null?"":String(e).trim();if(!n)return"";if(n.startsWith("//")||n.startsWith("/")||Hn.test(n))return n;let r=n.replace(/\\/g,"/"),o=t?t.endsWith("/")?t:`${t}/`:"",a=u=>u.split("/").map(b=>{if(!b)return"";try{return encodeURIComponent(decodeURIComponent(b))}catch{return encodeURIComponent(b)}}).join("/"),i=r.replace(/^\/+/,"").split("/"),c=[];for(let u of i)if(!(!u||u===".")){if(u===".."){c.length&&c.pop();continue}c.push(u)}let l=c.join("/");if(l.startsWith("data/"))return a(l);let d=c;if(o&&d.length){let u=o.replace(/\/+$/,"").split("/").pop();u&&d[0]===u&&(d=d.slice(1))}let f=d.join("/"),g=a(f);return`${o}${g}`}function Vt(e,t){var o,a;if(!e||typeof e!="object")return e;let n=(a=(o=e.thumbFile)!=null?o:e.thumb)!=null?a:"",r=On(n,t);if(r)e.thumbFile=r,e.thumb=r;else if(n){let s=String(n);e.thumbFile=s,e.thumb==null&&(e.thumb=s)}return e}function Vn(e){return Vt(e,jn)}function j(e){return Vt(e,Rn)}function Ut(e){return!e||typeof e!="object"||(j(e),Array.isArray(e.seasons)&&e.seasons.forEach(Wt)),e}function Wt(e){return!e||typeof e!="object"||(j(e),Array.isArray(e.episodes)&&e.episodes.forEach(t=>j(t))),e}function Un(e){return Array.isArray(e)?(e.forEach(t=>{t&&typeof t=="object"&&Vn(t)}),e):[]}function Wn(e){return Array.isArray(e)?(e.forEach(t=>{t&&typeof t=="object"&&Ut(t)}),e):[]}async function tt(){try{let e=await Ot("data/movies/movies.json",{label:"movies",embedId:"movies-json",exportKey:"movies",globalVar:"__PLEX_MOVIES__",altUrls:["movies/movies.json","data/movies.json","Filme/movies.json","movies.json"]});return Y.movies=0,Un(e)}catch(e){if(Y.movies<zt)return Y.movies++,await new Promise(t=>setTimeout(t,1e3*Y.movies)),tt();throw e}}async function nt(){try{let e=await Ot("data/series/series_index.json",{label:"shows",embedId:"series-json",exportKey:"shows",globalVar:"__PLEX_SHOWS__",altUrls:["series/series_index.json","data/shows.json","data/series.json","Serien/series.json","series/series.json","series.json","shows.json"]});return Y.shows=0,Wn(e)}catch(e){if(Y.shows<zt)return Y.shows++,await new Promise(t=>setTimeout(t,1e3*Y.shows)),nt();throw e}}async function Jt(e){if(!e)return null;let t=Jn(e),n=Gn(t);if(n!==void 0)return n;let r=Yn(e),o=null;for(let a of r)try{let s=await et(a);if(s&&typeof s=="object"){let i=Xn(s);return qt(t,i,e),Yt(i)}}catch(s){o=s}return qt(t,null,e),null}function de(e,t){if(e)try{Kt[e]=t}catch{}}function Gt(){return{...Kt}}function Jn(e){let t=[];(e==null?void 0:e.ratingKey)!==void 0&&(e==null?void 0:e.ratingKey)!==null&&(e==null?void 0:e.ratingKey)!==""&&t.push(`rk:${String(e.ratingKey)}`);let n=_e(e==null?void 0:e.href);return n&&t.push(`href:${n}`),t}function _e(e){return e?String(e).trim().replace(/^\.\//,"").replace(/^\/+/,""):""}function Gn(e){for(let t of e)if(ne.has(t)){let n=ne.get(t);return n?Yt(n):null}}function qt(e,t,n){let r=t;e.forEach(c=>{ne.set(c,r)});let o=n==null?void 0:n.ratingKey;o!=null&&ne.set(`rk:${String(o)}`,r);let a=t&&typeof t=="object"?t.ratingKey:void 0;a!=null&&ne.set(`rk:${String(a)}`,r);let s=_e(n==null?void 0:n.href);s&&ne.set(`href:${s}`,r);let i=t&&typeof t=="object"?_e(t.href):"";i&&ne.set(`href:${i}`,r)}function Yn(e){let t=new Set,n=_e(e==null?void 0:e.href);if(n)if(/^https?:/i.test(n))t.add(n);else{n.startsWith("data/")?t.add(n):t.add(`data/${n}`);let o=n.replace(/^data\//,"");o.startsWith("series/")||t.add(`data/series/${o}`);let a=o.replace(/^series\//,"").replace(/^details\//,"").replace(/\.json$/,"");a&&t.add(`data/series/details/${a}.json`)}let r=e==null?void 0:e.ratingKey;return r!=null&&t.add(`data/series/details/${String(r)}.json`),Array.from(t)}function Xn(e){if(!e||typeof e!="object")return null;let t={...e};j(t),t.genres=rt(t.genres);let n=er(t.cast||t.roles||[]);return t.cast=n,t.roles=n,t.seasons=Array.isArray(t.seasons)?t.seasons.map(Zn).filter(Boolean):[],t.seasonCount=Number.isFinite(t.seasonCount)?t.seasonCount:t.seasons.length,Ut(t),t}function Zn(e){if(!e||typeof e!="object")return null;let t={...e};return j(t),t.genres=rt(t.genres),t.episodes=Array.isArray(t.episodes)?t.episodes.map(Qn).filter(Boolean):[],Wt(t),t}function Qn(e){if(!e||typeof e!="object")return null;let t={...e};return j(t),t.genres=rt(t.genres),t}function rt(e){if(!Array.isArray(e))return[];let t=new Set,n=[];return e.forEach(r=>{let o=null;if(typeof r=="string"){let a=r.trim();a&&(o={tag:a})}else if(r&&typeof r=="object"){let a=String(r.tag||r.title||r.name||r.label||"").trim();a&&(o={...r,tag:a})}o&&!t.has(o.tag)&&(t.add(o.tag),n.push(o))}),n}function er(e){return Array.isArray(e)?e.map(t=>{if(!t)return null;if(typeof t=="string"){let n=t.trim();return n?{tag:n}:null}if(typeof t=="object"){let n=String(t.tag||t.name||t.role||"").trim();return n?{...t,tag:n}:{...t}}return null}).filter(Boolean):[]}function Yt(e){if(e==null)return e;try{return structuredClone(e)}catch{}try{return JSON.parse(JSON.stringify(e))}catch{}return e}var Kt,ne,Y,zt,Dn,jn,Rn,Hn,ue=_(()=>{Qe();Kt={movies:null,shows:null},ne=new Map,Y={movies:0,shows:0},zt=3,Dn=1e3*60*30,jn="data/movies/",Rn="data/series/",Hn=/^[a-z][a-z0-9+.-]*:/i});function re(e){let t=new Set,n=[];return(e||[]).forEach(r=>{let o="";typeof r=="string"?o=r:r&&typeof r=="object"&&(o=r.tag||r.title||r.name||"");let a=String(o||"").trim();a&&!t.has(a)&&(t.add(a),n.push(a))}),n}function ot(e,t,n=3){if(!e)return;let r=(t||[]).filter(Boolean);if(r.length>n){let o=r.slice(0,n),a=r.slice(n),s=o.map(c=>$e(c)),i=$e(`+ ${a.length}`);i.classList.add("more","card__chip--more"),i.setAttribute("data-more",a.length),i.setAttribute("title",`${a.length} weitere Genres: ${a.join(", ")}`),i._extraChips=a.map(c=>$e(c)),s.push(i),e.replaceChildren(...s)}else{let o=r.map(a=>$e(a));e.replaceChildren(...o)}nr(e)}function nr(e=document){try{e.querySelectorAll(".chip.more, .card__chip--more").forEach(t=>{t.dataset.bound||(t.dataset.bound="1",t.addEventListener("click",n=>{n.stopPropagation();let r=t.closest(".card");if(r)r.click();else{let o=t._extraChips||[];try{o.forEach(a=>t.before(a))}catch{}t.remove()}}))})}catch{}}function K(e){return e!=null&&e.year?e.year:e!=null&&e.originallyAvailableAt?String(e.originallyAvailableAt).slice(0,4):""}function R(e){if(e instanceof Number)return R(e.valueOf());if(typeof e=="number")return Number.isFinite(e)?e.toFixed(1):"0.0";if(typeof e=="string"){let t=e.trim();if(!t)return"0.0";let n=Number(t);return Number.isFinite(n)?n.toFixed(1):"0.0"}return"0.0"}function $e(e){let t=document.createElement("span");return t.className="chip",t.textContent=String(e||""),t}function Pe(e){if(!(e!=null&&e.addedAt))return!1;let t=new Date(e.addedAt).getTime();if(!Number.isFinite(t))return!1;let n=y().cfg||{},r=Number(n.newDays||30);return Date.now()-t<=r*24*60*60*1e3}function oe(){try{return localStorage.getItem("useTmdb")==="1"}catch{return!1}}var ve=_(()=>{J()});function rr(){try{z=new Set(JSON.parse(localStorage.getItem(Qt)||"[]"))}catch{z=new Set}}function en(){try{localStorage.setItem(Qt,JSON.stringify(Array.from(z.values())))}catch{}}function st(e){var r,o;if(!e)return"";let t=e.type==="tv"||e.libraryType==="show"?"show":"movie",n=((r=e.ids)==null?void 0:r.imdb)||((o=e.ids)==null?void 0:o.tmdb)||String(e.ratingKey||"");return n?`${t}:${n}`:""}function tn(e){return z.has(st(e))}function or(){return z.size}function it(e){let t=st(e);if(!t)return;z.has(t)?z.delete(t):z.add(t),en(),ct();let n=document.getElementById("watchlistPanel");n&&!n.hidden&&De()}function ct(){let e=document.getElementById("watchlistCount");e&&(e.textContent=String(or()))}function Xt(){let e=document.getElementById("watchlistPanel");e&&(e.hidden=!1,e.setAttribute("aria-hidden","false"),De(),document.dispatchEvent(new CustomEvent("watchlist:open")))}function Zt(){let e=document.getElementById("watchlistPanel");e&&(e.hidden=!0,e.setAttribute("aria-hidden","true"),document.dispatchEvent(new CustomEvent("watchlist:close"))),at(!1)}function ar(){z.clear(),en(),ct(),De()}function sr(){let e=nn(),t=JSON.stringify(e,null,2),n=new Blob([t],{type:"application/json"}),r=document.createElement("a");r.href=URL.createObjectURL(n),r.download="watchlist.json",document.body.append(r),r.click(),r.remove(),setTimeout(()=>URL.revokeObjectURL(r.href),1e3)}function nn(){let e=y(),t=(e.movies||[]).concat(e.shows||[]),n=new Map(t.map(r=>[st(r),r]));return Array.from(z.values()).map(r=>n.get(r)).filter(Boolean)}function De(){let e=document.getElementById("watchlistItems"),t=document.getElementById("watchlistEmpty");if(!e||!t)return;let n=nn();if(n.length===0){e.replaceChildren(),t.hidden=!1;return}t.hidden=!0;let r=document.createDocumentFragment();n.forEach(o=>{let a=document.createElement("li");a.className="watchlist-item";let s=document.createElement("span");s.className="title",s.textContent=o.title||"";let i=document.createElement("button");i.textContent="Entfernen",i.addEventListener("click",()=>{it(o),De()});let c=document.createElement("button");c.textContent="\xD6ffnen",c.addEventListener("click",()=>{var f,g;let l=o.type==="tv"?"show":"movie",d=((f=o.ids)==null?void 0:f.imdb)||((g=o.ids)==null?void 0:g.tmdb)||String(o.ratingKey||"");d&&(location.hash=`#/${l}/${d}`)}),a.append(s,c,i),r.append(a)}),e.replaceChildren(r)}function rn(){rr(),ct();let e=document.getElementById("openWatchlist"),t=document.getElementById("watchlistToggle"),n=document.getElementById("closeWatchlist"),r=document.getElementById("clearWatchlist"),o=document.getElementById("exportWatchlist");e&&e.addEventListener("click",()=>{Xt(),at(!0)}),t&&t.addEventListener("click",()=>{let a=document.getElementById("watchlistPanel");a&&!a.hidden?Zt():(Xt(),at(!0))}),n&&n.addEventListener("click",()=>{Zt()}),r&&r.addEventListener("click",()=>{ar()}),o&&o.addEventListener("click",()=>{sr()})}function at(e){let t=document.getElementById("watchlistToggle");t&&t.setAttribute("aria-expanded",e?"true":"false")}var Qt,z,lt=_(()=>{J();Qt="watchlist:v1",z=new Set});function an(e,t){let n=ir(e,t);if(!n)return;let r=Array.isArray(e)&&!dt(e)?e||[]:Array.isArray(t)?t:[];n.replaceChildren(),(r||[]).forEach((o,a)=>n.append(cr(o,a)))}function dt(e){return e instanceof Element||typeof e=="string"}function ir(e,t){if(dt(e)){if(e instanceof Element)return e;if(typeof e=="string")return document.querySelector(e)}if(dt(t)){if(t instanceof Element)return t;if(typeof t=="string")return document.querySelector(t)}return document.getElementById("seasonsAccordion")}function cr(e,t){j(e);let n=document.createElement("article");n.className="season-card";let r=document.createElement("div");r.className="season-head";let o=document.createElement("div");o.className="season-thumb";let a=new Image;a.loading="lazy",a.decoding="async",a.src=e.thumbFile||"",a.alt=e.title||`Staffel ${e.seasonNumber||t+1}`,o.append(a);let s=document.createElement("div"),i=document.createElement("div");i.className="season-title",i.textContent=e.title||`Staffel ${e.seasonNumber||t+1}`;let c=document.createElement("div");c.className="season-sub";let l=e.year||e.releaseYear||"",d=Array.isArray(e.episodes)?e.episodes.length:e.episodeCount||0;c.textContent=[l,d?`${d} Episoden`:""].filter(Boolean).join(" \u2022 "),s.append(i,c);let f=document.createElement("div");f.className="chev",f.textContent="\u203A",r.append(o,s,f);let g=document.createElement("div");return g.className="season-body",(e.episodes||[]).forEach(u=>{j(u),g.append(lr(u))}),r.addEventListener("click",()=>n.classList.toggle("open")),n.append(r,g),n}function lr(e){var g;let t=document.createElement("div");t.className="episode";let n=document.createElement("div");n.className="ep-title";let r=e.seasonNumber!=null?Number(e.seasonNumber):null,o=e.episodeNumber!=null?Number(e.episodeNumber):null,a=e.seasonEpisode&&String(e.seasonEpisode).toUpperCase()||(Number.isFinite(r)&&Number.isFinite(o)?`S${String(r).padStart(2,"0")}E${String(o).padStart(2,"0")}`:"");n.textContent=`${a?a+" \u2022 ":""}${e.title||""}`;let s=document.createElement("div");s.className="badges";let i=Number((g=e.audienceRating)!=null?g:e.rating);if(Number.isFinite(i)){let u=document.createElement("span");u.className="badge",u.textContent=`${i.toFixed(1)}`,s.append(u)}let c=document.createElement("div");c.className="ep-meta";let l=e.durationMin||(e.duration?Math.round(Number(e.duration)/6e4):null),d=e.durationHuman||(l?`${l} min`:null),f=e.originallyAvailableAt||e.date||"";return c.textContent=[d,f].filter(Boolean).join(" \u2022 "),t.append(n,s,c),t}var sn=_(()=>{ue()});function ye(e){if(e==null||typeof e!="object")return e;if(typeof structuredClone=="function")try{return structuredClone(e)}catch{}try{return JSON.parse(JSON.stringify(e))}catch{}if(Array.isArray(e))return e.map(n=>ye(n));let t={};for(let n of Object.keys(e))t[n]=ye(e[n]);return t}function je(e){if(!e||typeof e!="object")return null;let t=ye(e);return t.type==="show"&&(t.type="tv"),t.type||(t.type="movie"),t}function Re(e){if(!e||typeof e!="object")return null;let t=ye(e);return t.type!=="tv"&&(t.type="tv"),ut(t),t}function dr(e){if(!e||typeof e!="object")return null;let t=ye(e);return ut(t),t}function cn(e){let t=Array.isArray(e==null?void 0:e.seasons)?e.seasons:[],n=t.some(o=>Array.isArray(o==null?void 0:o.episodes)&&o.episodes.length),r=Array.isArray(e==null?void 0:e.cast)?e.cast:Array.isArray(e==null?void 0:e.roles)?e.roles:[];return!t.length||!n||!r.length}function ln(e,t){if(!e)return e;if(t&&typeof t=="object"){let n=dr(t);Object.assign(e,n)}return ut(e),e}function ut(e){if(!e||typeof e!="object")return;ft(e),e.genres=ht(e.genres);let t=hr(e.cast||e.roles||[]);e.cast=t,e.roles=t,e.seasons=Array.isArray(e.seasons)?e.seasons.map(ur).filter(Boolean):[];let n=Number(e.seasonCount);e.seasonCount=Number.isFinite(n)&&n>0?n:e.seasons.length}function ur(e){if(!e||typeof e!="object")return null;let t={...e};return ft(t),t.genres=ht(t.genres),t.episodes=Array.isArray(t.episodes)?t.episodes.map(fr).filter(Boolean):[],t}function fr(e){if(!e||typeof e!="object")return null;let t={...e};return ft(t),t.genres=ht(t.genres),t}function ft(e){j(e)}function ht(e){if(!Array.isArray(e))return[];let t=new Set,n=[];return e.forEach(r=>{let o=null;if(typeof r=="string"){let a=r.trim();a&&(o={tag:a})}else if(r&&typeof r=="object"){let a=String(r.tag||r.title||r.name||r.label||"").trim();a&&(o={...r,tag:a})}o&&!t.has(o.tag)&&(t.add(o.tag),n.push(o))}),n}function hr(e){return Array.isArray(e)?e.map(t=>{if(!t)return null;if(typeof t=="string"){let n=t.trim();return n?{tag:n}:null}if(typeof t=="object"){let n=String(t.tag||t.name||t.role||"").trim();return n?{...t,tag:n}:{...t}}return null}).filter(Boolean):[]}var dn=_(()=>{ue()});function vr(){if($)return $;let e=document.getElementById("modal-root-v2");if(!e)return null;if(V=e,e.classList.add("modalv2-overlay"),e.hasAttribute("hidden")||e.setAttribute("hidden",""),e.dataset.modalv2Ready||(e.innerHTML=`
      <div class="modalv2-backdrop" data-modalv2-backdrop="1"></div>
      <div class="modalv2-dialog" role="dialog" aria-modal="true">
        <div class="modalv2-scroll" data-modalv2-scroll></div>
      </div>
    `,e.dataset.modalv2Ready="1",e.addEventListener("click",yr)),N=e.querySelector(".modalv2-dialog"),N&&!N.hasAttribute("tabindex")&&N.setAttribute("tabindex","-1"),Z=e.querySelector("[data-modalv2-scroll]"),Z&&!$){let t=Z.querySelector(".modalv2");t?$=t:($=document.createElement("div"),$.className="modalv2",$.setAttribute("hidden",""),Z.appendChild($))}return $}function yr(e){if(!V)return;let t=e.target;(t===V||t&&t.dataset&&t.dataset.modalv2Backdrop)&&pt()}function fn(){return N?Array.from(N.querySelectorAll('a[href], button:not([disabled]), textarea, input, select, [tabindex]:not([tabindex="-1"])')).filter(t=>t.hasAttribute("disabled")||t.getAttribute("aria-hidden")==="true"||t.hasAttribute("hidden")?!1:t.offsetParent!==null):[]}function wr(){N&&(se&&N.removeEventListener("keydown",se),se=e=>{if(e.key!=="Tab")return;let t=fn();if(!t.length)return;let n=t[0],r=t[t.length-1];e.shiftKey?document.activeElement===n&&(e.preventDefault(),r.focus()):document.activeElement===r&&(e.preventDefault(),n.focus())},N.addEventListener("keydown",se))}function Er(){!N||!se||(N.removeEventListener("keydown",se),se=null)}function Sr(){he||(he=e=>{e.key==="Escape"&&(e.preventDefault(),pt())},window.addEventListener("keydown",he))}function Ar(){he&&(window.removeEventListener("keydown",he),he=null)}function He(){let e=vr();return!e||!V?null:(V.hidden=!1,V.setAttribute("aria-hidden","false"),document.body.classList.add("modalv2-open"),Z&&(Z.scrollTop=0),wr(),Sr(),document.dispatchEvent(new CustomEvent("modal:open")),e)}function gt(){if(!N)return;let e=N.querySelector("#v2Close"),t=fn(),n=e&&!e.hasAttribute("hidden")?e:t[0];if(n||(n=N),n){let r=()=>{try{n.focus()}catch{}};(window.requestAnimationFrame||setTimeout)(r,0)}}function kr(e){var r;let t=((r=e==null?void 0:e.tmdb)==null?void 0:r.poster)||(e==null?void 0:e.tmdbPoster),n=(e==null?void 0:e.poster)||(e==null?void 0:e.thumbFile)||(e==null?void 0:e.art)||"";return oe()&&t?t:n}function hn(e){let t=(e==null?void 0:e.runtimeMin)||(e==null?void 0:e.durationMin)||(e!=null&&e.duration?Math.round(Number(e.duration)/6e4):null);return Number.isFinite(t)?(e==null?void 0:e.type)==="tv"?`~${t} min/Ep`:`${t} min`:""}function Cr(e){var n;let t=Number((n=e==null?void 0:e.rating)!=null?n:e==null?void 0:e.audienceRating);return Number.isFinite(t)?`\u2605 ${R(t)}`:""}function gn(e){return(e==null?void 0:e.studio)||(e==null?void 0:e.network)||(e==null?void 0:e.studioName)||""}function xr(e){let t=[e==null?void 0:e.originallyAvailableAt,e==null?void 0:e.releaseDate,e==null?void 0:e.premiereDate,e==null?void 0:e.firstAired,e==null?void 0:e.airDate];for(let r of t){let o=r==null?"":String(r).trim();if(!o)continue;let a=new Date(o);if(Number.isFinite(a.getTime()))try{return a.toLocaleDateString("de-DE",{year:"numeric",month:"2-digit",day:"2-digit"})}catch{}let s=o.match(/^\d{4}-\d{2}-\d{2}/);if(s&&s[0])return s[0];if(o.length>=4)return o.slice(0,10)}let n=K(e);return n?String(n):""}function ae(e){return Array.isArray(e)?e.map(t=>t?typeof t=="string"?t:t.tag||t.title||t.name||"":"").filter(Boolean):[]}function Tr(e){let n=(Array.isArray(e==null?void 0:e.genres)?e.genres:[]).map(r=>r?typeof r=="string"?r:r.tag||r.title||r.name||"":"").filter(Boolean);return Array.from(new Set(n))}function Ir(e){let t=[];return Pe(e)&&t.push("Neu"),(e==null?void 0:e.type)==="tv"&&Number.isFinite(Number(e==null?void 0:e.seasonCount))&&t.push(`Staffeln: ${e.seasonCount}`),((e==null?void 0:e.genres)||[]).map(r=>r?typeof r=="string"?r:r.tag||r.title||r.name||"":"").filter(Boolean).forEach(r=>t.push(r)),t}function Nr(e){return(Array.isArray(e==null?void 0:e.cast)?e.cast:Array.isArray(e==null?void 0:e.roles)?e.roles:[]).map(n=>{var i,c,l;if(!n)return null;if(typeof n=="string"){let d=String(n).trim();return d?{name:d,role:"",thumb:"",tmdbProfile:"",raw:null}:null}let r=String(n.tag||n.name||n.role||"").trim();if(!r)return null;let o=(()=>{let d=String(n.role||"").trim();return d?d.toLowerCase()===r.toLowerCase()?"":d:""})(),a=[(i=n==null?void 0:n.tmdb)==null?void 0:i.profile,(c=n==null?void 0:n.tmdb)==null?void 0:c.profile_path,(l=n==null?void 0:n.tmdb)==null?void 0:l.profilePath,n==null?void 0:n.tmdbProfile,n==null?void 0:n.profile,n==null?void 0:n.profile_path,n==null?void 0:n.profilePath].find(d=>typeof d=="string"&&d.trim()),s=[n==null?void 0:n.thumb,n==null?void 0:n.photo,n==null?void 0:n.image].find(d=>typeof d=="string"&&d.trim())||"";return{name:r,role:o,thumb:s,tmdbProfile:a?String(a).trim():"",raw:n}}).filter(Boolean)}function Lr(e){let t=String(e||"").trim();if(!t)return"";if(/^https?:\/\//i.test(t))return t;if(t.startsWith("//"))return`https:${t}`;let n=t.startsWith("/")?t:`/${t}`;return`${gr}${pr}${n}`}function Br(e){let t=String(e||"").trim();return t?/^https?:\/\//i.test(t)||t.startsWith("data:")?t:t.startsWith("//")?`https:${t}`:t:""}function Fr(e,t){var o,a,s;if(!e)return"";let n=e.raw||{};if(t){let i=[e.tmdbProfile,(o=n==null?void 0:n.tmdb)==null?void 0:o.profile,(a=n==null?void 0:n.tmdb)==null?void 0:a.profile_path,(s=n==null?void 0:n.tmdb)==null?void 0:s.profilePath,n==null?void 0:n.tmdbProfile,n==null?void 0:n.profile,n==null?void 0:n.profile_path,n==null?void 0:n.profilePath];for(let c of i){let l=Lr(c);if(l)return l}}let r=[e.thumb,n==null?void 0:n.thumb,n==null?void 0:n.photo,n==null?void 0:n.image];for(let i of r){let c=Br(i);if(c)return c}return""}function Mr(e){let t=String(e||"").trim();if(!t)return"?";let r=t.split(/\s+/).slice(0,2).map(o=>o.charAt(0)).filter(Boolean);return r.length?r.join("").toUpperCase():t.charAt(0).toUpperCase()}function _r(e){let t=e.querySelector(".v2-tabs");if(!t)return;let n=Array.from(t.querySelectorAll("button[data-t]")),r=s=>{n.forEach(i=>{let c=i.dataset.t===s;i.classList.toggle("active",c),i.setAttribute("aria-selected",c?"true":"false"),i.tabIndex=c?0:-1;let l=e.querySelector(`.v2-pane[data-pane="${i.dataset.t}"]`);l&&(l.hidden=!c,l.setAttribute("aria-hidden",l.hidden?"true":"false"))})},o=(s,i)=>{if(!n.length)return;let c=n.indexOf(s),l=i>0?0:n.length-1,d=c===-1?l:(c+i+n.length)%n.length,f=n[d];f&&(f.focus(),r(f.dataset.t))};t.addEventListener("click",s=>{let i=s.target.closest("button[data-t]");i&&(s.preventDefault(),r(i.dataset.t))}),t.addEventListener("keydown",s=>{let i=s.target.closest("button[data-t]");if(i)switch(s.key){case"ArrowLeft":case"ArrowUp":s.preventDefault(),o(i,-1);break;case"ArrowRight":case"ArrowDown":s.preventDefault(),o(i,1);break;case"Home":s.preventDefault(),n[0]&&(n[0].focus(),r(n[0].dataset.t));break;case"End":if(s.preventDefault(),n.length){let c=n[n.length-1];c.focus(),r(c.dataset.t)}break;default:break}});let a=n.find(s=>s.classList.contains("active"))||n[0];a&&r(a.dataset.t)}function $r(e,t){let n=e.querySelector(".v2-cast");if(!n)return;n.innerHTML='<div class="v2-cast-scroll"></div>';let r=n.querySelector(".v2-cast-scroll");if(!r)return;let o=Array.isArray(t)?t.slice(0,12):[];if(!o.length){r.innerHTML='<span class="modalv2-loading">Keine Besetzungsdaten verf\xFCgbar.</span>',r.removeAttribute("role");return}r.setAttribute("role","list");let a=oe();o.forEach(s=>{let i=s&&typeof s=="object"&&"name"in s?s:(()=>{let u=String(s||"").trim();return u?{name:u,role:"",thumb:"",tmdbProfile:"",raw:null}:null})();if(!i||!i.name)return;let c=document.createElement("article");c.className="v2-cast-card",c.tabIndex=0,c.setAttribute("role","listitem");let l=String(i.role||"").trim();c.setAttribute("aria-label",l?`${i.name} \u2013 ${l}`:i.name);let d=document.createElement("div");d.className="v2-cast-avatar";let f=Fr(i,a);if(f){d.classList.add("has-image");let u=document.createElement("img");u.src=f,u.alt=i.name,u.loading="lazy",u.decoding="async",d.appendChild(u)}else{let u=document.createElement("span");u.className="v2-cast-initials",u.textContent=Mr(i.name),u.setAttribute("aria-hidden","true"),d.appendChild(u)}let g=document.createElement("p");if(g.className="v2-cast-name",g.textContent=i.name,c.append(d,g),l){let u=document.createElement("p");u.className="v2-cast-role",u.textContent=l,c.append(u)}else c.classList.add("v2-cast-card--no-role");r.appendChild(c)}),r.children.length||(r.innerHTML='<span class="modalv2-loading">Keine Besetzungsdaten verf\xFCgbar.</span>',r.removeAttribute("role"))}function Pr(e,t){let n=e.querySelector(".v2-overview");if(!n)return;let r=typeof t=="string"?t:"";if(!r){n.textContent="";return}let o=document.createElement("p");o.className="v2-overview-text line-clamp line-clamp-5",o.textContent=r;let a=document.createElement("button");a.type="button",a.className="v2-overview-toggle";let s=l=>{o.classList.toggle("is-expanded",l),a.setAttribute("aria-expanded",String(l)),a.textContent=l?"Weniger anzeigen":"Mehr anzeigen"};a.addEventListener("click",()=>{let l=a.getAttribute("aria-expanded")==="true";s(!l)}),n.replaceChildren(o,a),s(!1),(typeof requestAnimationFrame=="function"?requestAnimationFrame:l=>setTimeout(l,0))(()=>{o.scrollHeight>o.clientHeight+1||(o.classList.add("is-expanded"),a.hidden=!0)})}function Dr(e,t){let n=e.querySelector(".v2-details");if(!n)return;n.replaceChildren();let r=document.createElement("div");r.className="v2-details-grid";let o=[],a=xr(t);a&&o.push(["Ver\xF6ffentlichung",a]);let s=hn(t);s&&o.push(["Laufzeit",s]);let i=gn(t);i&&o.push(["Studio",i]);let c=((t==null?void 0:t.contentRating)||"").trim();c&&o.push(["Freigabe",c]);let l=w=>{if(w instanceof Number)return l(w.valueOf());if(typeof w=="number")return Number.isFinite(w)?R(w):"";if(typeof w=="string"){let T=w.trim();if(!T)return"";let x=Number(T);return Number.isFinite(x)?R(x):""}return""},d=l(t==null?void 0:t.rating),f=l(t==null?void 0:t.audienceRating),g=l(t==null?void 0:t.userRating);if(d?(o.push(["Bewertung",`\u2605 ${d}`]),f&&f!==d&&o.push(["Publikum",`\u2605 ${f}`])):f&&o.push(["Bewertung",`\u2605 ${f}`]),g&&o.push(["Eigene Wertung",`\u2605 ${g}`]),(t==null?void 0:t.type)==="tv"){let w=Number(t==null?void 0:t.seasonCount),T=Number.isFinite(w)?w:Array.isArray(t==null?void 0:t.seasons)?t.seasons.length:null;Number.isFinite(T)&&T>0&&o.push(["Staffeln",String(T)]);let x=Array.isArray(t==null?void 0:t.seasons)?t.seasons.reduce((B,L)=>{if(!L)return B;let E=Array.isArray(L.episodes)?L.episodes.length:0;return B+(Number.isFinite(E)?E:0)},0):null;Number.isFinite(x)&&x>0&&o.push(["Episoden",String(x)])}let u=ae(t==null?void 0:t.countries);u.length&&o.push(["L\xE4nder",u.join(", ")]);let b=ae(t==null?void 0:t.collections);b.length&&o.push(["Sammlungen",b.join(", ")]);let v=ae(t==null?void 0:t.labels);if(v.length&&o.push(["Labels",v.join(", ")]),t!=null&&t.editionTitle&&o.push(["Edition",t.editionTitle]),t!=null&&t.originalTitle&&t.originalTitle!==t.title&&o.push(["Originaltitel",t.originalTitle]),o.length){let w=document.createElement("section");w.className="v2-details-section",w.dataset.section="general";let T=document.createElement("h3");T.className="v2-details-heading",T.textContent="Allgemein";let x=document.createElement("dl");x.className="v2-details-list",o.forEach(([B,L])=>{if(!B||!L)return;let E=document.createElement("dt");E.textContent=B;let F=document.createElement("dd");F.textContent=L,x.append(E,F)}),x.childElementCount&&(w.append(T,x),r.append(w))}let A=Tr(t);if(A.length){let w=document.createElement("section");w.className="v2-details-section",w.dataset.section="genres";let T=document.createElement("h3");T.className="v2-details-heading",T.textContent="Genres";let x=document.createElement("div");x.className="v2-chip-group",A.forEach(B=>{let L=document.createElement("span");L.className="chip",L.textContent=B,x.appendChild(L)}),w.append(T,x),r.append(w)}let C=[],M=ae(t==null?void 0:t.directors);M.length&&C.push(["Regie",M.join(", ")]);let D=ae(t==null?void 0:t.writers);D.length&&C.push(["Drehbuch",D.join(", ")]);let Q=ae(t==null?void 0:t.producers);Q.length&&C.push(["Produktion",Q.join(", ")]);let Ie=ae((t==null?void 0:t.creators)||(t==null?void 0:t.showrunners));if((t==null?void 0:t.type)==="tv"&&Ie.length&&C.push(["Creator",Ie.join(", ")]),C.length){let w=document.createElement("section");w.className="v2-details-section",w.dataset.section="crew";let T=document.createElement("h3");T.className="v2-details-heading",T.textContent="Credits";let x=document.createElement("dl");x.className="v2-details-list",C.forEach(([B,L])=>{if(!B||!L)return;let E=document.createElement("dt");E.textContent=B;let F=document.createElement("dd");F.textContent=L,x.append(E,F)}),x.childElementCount&&(w.append(T,x),r.append(w))}if(r.childElementCount)n.appendChild(r);else{let w=document.createElement("p");w.className="v2-details-empty",w.textContent="Keine zus\xE4tzlichen Details verf\xFCgbar.",n.appendChild(w)}}function jr(e,t){let n=e.querySelector(".v2-seasons");if(!n)return;let r=Array.isArray(t==null?void 0:t.seasons)?t.seasons:[];if(!r.length){n.innerHTML='<p class="modalv2-loading">Keine Staffel-Informationen verf\xFCgbar.</p>';return}n.innerHTML="",an(n,r)}function Rr(e,t){var l,d;let n=e.querySelector("#v2Tmdb"),r=e.querySelector("#v2Imdb"),o=e.querySelector("#v2Trailer"),a=((l=t==null?void 0:t.ids)==null?void 0:l.tmdb)||(t==null?void 0:t.tmdbId),s=((d=t==null?void 0:t.ids)==null?void 0:d.imdb)||(t==null?void 0:t.imdbId),i=(t==null?void 0:t.trailer)||(t==null?void 0:t.trailerUrl),c=(t==null?void 0:t.type)==="tv"?"tv":"movie";n&&(a?(n.hidden=!1,n.href=`https://www.themoviedb.org/${c}/${a}`):(n.hidden=!0,n.removeAttribute("href"))),r&&(s?(r.hidden=!1,r.href=`https://www.imdb.com/title/${s}/`):(r.hidden=!0,r.removeAttribute("href"))),o&&(i?(o.hidden=!1,o.onclick=()=>window.open(i,"_blank","noopener")):(o.hidden=!0,o.onclick=null))}function Hr(e,t){let n=e.querySelector(".v2-title");n&&(n.textContent=(t==null?void 0:t.title)||(t==null?void 0:t.name)||"");let r=((t==null?void 0:t.tagline)||"").trim(),o=e.querySelector(".v2-meta"),a=e.querySelector(".v2-subline"),s=K(t),i=hn(t),c=Cr(t),l=gn(t),d=[s,i,c,l].filter(Boolean);if(a){let v=d.join(" \u2022 ");a.textContent=r||v,a.hidden=!(r||v)}o&&(o.textContent=r&&d.length?d.join(" \u2022 "):"",o.hidden=!(r&&d.length));let f=e.querySelector(".v2-chips");f&&(f.replaceChildren(),Ir(t).forEach(v=>{let A=document.createElement("span");A.className="chip",A.textContent=v,f.appendChild(A)}),f.hidden=!f.childElementCount);let g=e.querySelector(".v2-facts"),u=e.querySelector(".v2-facts-list");if(g&&u){let v=[];s&&v.push(["Jahr",s]);let A=((t==null?void 0:t.contentRating)||"").trim();A&&v.push(["Freigabe",A]),i&&v.push(["Laufzeit",i]),c&&v.push(["Bewertung",c]),l&&v.push(["Studio",l]),u.replaceChildren(),v.forEach(([C,M])=>{let D=document.createElement("dt");D.textContent=C;let Q=document.createElement("dd");Q.textContent=M,u.append(D,Q)}),g.hidden=!v.length}let b=e.querySelector(".v2-poster img");if(b){let v=kr(t);b.src=v||"",b.alt=t!=null&&t.title?`Poster: ${t.title}`:"",b.loading="lazy",b.decoding="async",b.classList.remove("is-ready"),v?(b.addEventListener("load",un,{once:!0}),b.addEventListener("error",un,{once:!0})):b.classList.add("is-ready")}}function un(e){var t;(t=e.currentTarget)==null||t.classList.add("is-ready")}function qr(e="Details werden geladen \u2026"){let t=He();if(!t)return;t.hidden=!1;let n=document.createElement("div");n.className="modalv2-loading",n.textContent=String(e||"Details werden geladen \u2026"),t.replaceChildren(n)}function pn(e){let t=He();if(!t)return;t.hidden=!1;let n=(e==null?void 0:e.type)==="tv";t.innerHTML=`
    <section class="v2-layout">
      <aside class="v2-side">
        <div class="v2-poster"><img alt=""></div>
        <div class="v2-facts" aria-label="Schnellinfos" hidden>
          <h3 class="v2-facts-title">Schnellinfos</h3>
          <dl class="v2-facts-list"></dl>
        </div>
      </aside>
      <div class="v2-info">
        <header class="v2-head">
          <div class="v2-titlebar">
            <div class="v2-title-wrap">
              <h2 class="v2-title" id="modalV2Title"></h2>
              <div class="v2-subline"></div>
              <div class="v2-meta"></div>
            </div>
            <div class="v2-actions" aria-label="Externe Aktionen">
              <button class="v2-icon-btn" id="v2Close" type="button" aria-label="Schlie\xDFen">
                <svg class="v2-icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                  <path d="M6 6l12 12M6 18L18 6" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"></path>
                </svg>
              </button>
              <a class="v2-icon-btn" id="v2Tmdb" target="_blank" rel="noopener noreferrer" aria-label="Auf TMDB \xF6ffnen" hidden>
                <svg class="v2-icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                  <path d="M4 9h16v10a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V9z" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linejoin="round"></path>
                  <path d="M4 9V7a2 2 0 0 1 2-2h1l2 4 2-4 2 4 2-4h1a2 2 0 0 1 2 2v2" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"></path>
                </svg>
              </a>
              <a class="v2-icon-btn" id="v2Imdb" target="_blank" rel="noopener noreferrer" aria-label="Auf IMDb \xF6ffnen" hidden>
                <svg class="v2-icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                  <path d="M12 4l2.4 4.9 5.4.8-3.9 3.8.9 5.4-4.8-2.5-4.8 2.5.9-5.4-3.9-3.8 5.4-.8z" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linejoin="round"></path>
                </svg>
              </a>
              <button class="v2-icon-btn" id="v2Trailer" type="button" aria-label="Trailer abspielen" hidden>
                <svg class="v2-icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                  <path d="M9 6l8 6-8 6V6z" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linejoin="round" stroke-linecap="round"></path>
                </svg>
              </button>
            </div>
          </div>
          <div class="v2-chips" aria-label="Attribute"></div>
        </header>
        <nav class="v2-tabs" aria-label="Details Navigation" role="tablist">
          <button type="button" data-t="overview" class="active" id="v2TabOverview" role="tab" aria-controls="v2PaneOverview" aria-selected="true">\xDCberblick</button>
          <button type="button" data-t="details" id="v2TabDetails" role="tab" aria-controls="v2PaneDetails" aria-selected="false">Details</button>
          ${n?'<button type="button" data-t="seasons" id="v2TabSeasons" role="tab" aria-controls="v2PaneSeasons" aria-selected="false">Staffeln</button>':""}
          <button type="button" data-t="cast" id="v2TabCast" role="tab" aria-controls="v2PaneCast" aria-selected="false">Cast</button>
        </nav>
        <section class="v2-body">
          <div class="v2-pane v2-overview" data-pane="overview" id="v2PaneOverview" role="tabpanel" aria-labelledby="v2TabOverview"></div>
          <div class="v2-pane v2-details" data-pane="details" id="v2PaneDetails" role="tabpanel" aria-labelledby="v2TabDetails" hidden></div>
          ${n?'<div class="v2-pane v2-seasons" data-pane="seasons" id="v2PaneSeasons" role="tabpanel" aria-labelledby="v2TabSeasons" hidden></div>':""}
          <div class="v2-pane v2-cast" data-pane="cast" id="v2PaneCast" role="tabpanel" aria-labelledby="v2TabCast" hidden></div>
        </section>
      </div>
    </section>
  `,Hr(t,e),Rr(t,e),Pr(t,(e==null?void 0:e.overview)||(e==null?void 0:e.summary)||""),Dr(t,e),(e==null?void 0:e.type)==="tv"&&jr(t,e),$r(t,Nr(e)),_r(t);let r=t.querySelector("#v2Close");r&&r.addEventListener("click",pt),N&&N.setAttribute("aria-labelledby","modalV2Title"),gt()}async function Ee(e){let t=++X;fe=document.activeElement instanceof HTMLElement?document.activeElement:null;let n=He();if(!n)return;let r=Kr(e);if(t===X){if(!r){n.hidden=!1;let o=document.createElement("div");o.className="modalv2-loading",o.textContent="Film konnte nicht geladen werden.",n.replaceChildren(o),ge=null,we=null,gt();return}ge=r,we="movie",pn(r)}}async function Se(e){let t=++X;fe=document.activeElement instanceof HTMLElement?document.activeElement:null;let n=zr(e),r=He();if(!r||t!==X)return;if(!n){r.hidden=!1;let a=document.createElement("div");a.className="modalv2-loading",a.textContent="Seriendetails konnten nicht geladen werden.",r.replaceChildren(a),ge=null,we=null,gt();return}ge=n,we="show";let o=n;if(cn(o)){if(qr(),t!==X)return;let a=null;try{a=await Jt(o)}catch{a=null}if(t!==X)return;a&&(ln(o,a),ge=o)}t===X&&pn(o)}function pt(){if(X++,!!V){if(V.hidden=!0,V.setAttribute("aria-hidden","true"),document.body.classList.remove("modalv2-open"),Er(),Ar(),$&&($.innerHTML="",$.setAttribute("hidden","")),Z&&(Z.scrollTop=0),fe&&typeof fe.focus=="function")try{fe.focus()}catch{}fe=null,ge=null,we=null,document.dispatchEvent(new CustomEvent("modal:close"))}}function Kr(e){if(e==="demo")return je(br);if(e&&typeof e=="object")return je(e);let t=e==null?"":String(e).trim();if(!t)return null;let n=y(),o=(Array.isArray(n==null?void 0:n.movies)?n.movies:[]).find(a=>bn(a,t));return o?je(o):null}function zr(e){if(e==="demo")return Re(mr);if(e&&typeof e=="object")return Re(e);let t=e==null?"":String(e).trim();if(!t)return null;let n=y(),o=(Array.isArray(n==null?void 0:n.shows)?n.shows:[]).find(a=>bn(a,t));return o?Re(o):null}function bn(e,t){var r,o;if(!e)return!1;let n=String(t||"").trim();return n?!!((r=e==null?void 0:e.ids)!=null&&r.imdb&&String(e.ids.imdb)===n||(o=e==null?void 0:e.ids)!=null&&o.tmdb&&String(e.ids.tmdb)===n||(e==null?void 0:e.ratingKey)!=null&&String(e.ratingKey)===n):!1}var gr,pr,V,N,Z,$,fe,se,he,X,we,ge,br,mr,bt=_(()=>{sn();ve();J();ue();dn();gr="https://image.tmdb.org/t/p/",pr="w185",V=null,N=null,Z=null,$=null,fe=null,se=null,he=null,X=0,we=null,ge=null,br={type:"movie",title:"Lumen: Der Aufbruch",tagline:"Eine cineastische Demo f\xFCr das neue Modal",overview:"Die Crew der Lumen wagt den Sprung in unerforschte Welten und enth\xFCllt dabei eine Energiequelle, die alles ver\xE4ndern k\xF6nnte. Zwischen Loyalit\xE4t, Intrigen und berauschenden Bildern entfaltet sich ein Abenteuer, das f\xFCr das Cinematic-Layout entworfen wurde.",summary:"Die Crew der Lumen entdeckt eine Energiequelle, die das Schicksal der Menschheit ver\xE4ndern k\xF6nnte.",runtimeMin:142,contentRating:"FSK 12",studio:"Aurora Pictures",rating:8.4,audienceRating:8,userRating:8.7,originallyAvailableAt:"2024-05-17",countries:[{tag:"Deutschland"},{tag:"Kanada"}],genres:[{tag:"Science-Fiction"},{tag:"Drama"},{tag:"Abenteuer"}],cast:[{name:"Mara Lenz",role:"Captain Alys Vega",tmdbProfile:"/3rxeQHiuCYaXJqfyUG8yt0YdHtH.jpg"},{name:"Tariq Benassi",role:"Navigator Elian Soh",tmdbProfile:"/wGl8DCycJ2U0FvJbLABd8R4FS3X.jpg"},{name:"Hannah Ko",role:"Wissenschaftlerin Dr. Mira Han",tmdbProfile:"/hJuDvwzS0SPlsE6MN4pF2UYDGtt.jpg"}],directors:[{tag:"Jonas Falk"}],writers:[{tag:"Lea Winter"}],producers:[{tag:"Studio Atlas"}],labels:[{tag:"Dolby Atmos"},{tag:"4K"}],collections:[{tag:"Aurora-Saga"}],trailer:"https://www.youtube.com/watch?v=dQw4w9WgXcQ",tmdbPoster:"https://image.tmdb.org/t/p/w500/2lUYbD2C3XSuwqMUbDVDQuz9mqz.jpg",ids:{tmdb:"demo-lumen",imdb:"tt0000001"},addedAt:"2024-06-01T12:00:00Z"},mr={type:"tv",title:"Aurora Station",tagline:"Neue Horizonte in Serie",overview:"Die Besatzung der Aurora Station sch\xFCtzt eine Au\xDFenposten an der Grenze des bekannten Raums. Jede Episode verbindet kosmische R\xE4tsel mit pers\xF6nlichen Geschichten \u2013 perfekt geeignet, um das Cinematic-Modal auszuprobieren.",summary:"Ein orbitaler Au\xDFenposten ringt um Hoffnung und Zusammenhalt, w\xE4hrend eine fremde Macht erwacht.",contentRating:"TV-14",studio:"Nebula Network",originallyAvailableAt:"2023-09-14",seasonCount:2,genres:[{tag:"Science-Fiction"},{tag:"Drama"}],countries:[{tag:"USA"},{tag:"Island"}],creators:[{tag:"Elina S\xF8rensen"}],cast:[{name:"Noah Adler",role:"Commander Ivar Hale",tmdbProfile:"/4MqUjb1SYrzHmFSVoKHSKP5MGGm.jpg"},{name:"Sofia Idris",role:"Ingenieurin Kaia Rhee",tmdbProfile:"/tHMgWz6EpRdbgoMJ2JfzFzjg3QB.jpg"},{name:"Helena Ruiz",role:"Strategin Tala Voss",tmdbProfile:"/ziEuG1ESSofxDCspotYlrwz3Tq.png"}],seasons:[{title:"Staffel 1",seasonNumber:1,year:2023,thumbFile:"https://image.tmdb.org/t/p/w300/4dO2YpC8S9nLmQAXoJLRV8LZRxn.jpg",episodes:[{title:"Kapitel Eins: Erwachen",seasonNumber:1,episodeNumber:1,durationMin:54,originallyAvailableAt:"2023-09-14",audienceRating:8.6},{title:"Kapitel Zwei: Grenzwelten",seasonNumber:1,episodeNumber:2,durationMin:52,originallyAvailableAt:"2023-09-21",audienceRating:8.2}]},{title:"Staffel 2",seasonNumber:2,year:2024,thumbFile:"https://image.tmdb.org/t/p/w300/bSL4hY8SgdKzac8AUbWQm74y87C.jpg",episodes:[{title:"Kapitel Dreizehn: Resonanz",seasonNumber:2,episodeNumber:1,durationMin:56,originallyAvailableAt:"2024-02-08",audienceRating:8.9},{title:"Kapitel Vierzehn: Echo",seasonNumber:2,episodeNumber:2,durationMin:55,originallyAvailableAt:"2024-02-15",audienceRating:8.7}]}],tmdbPoster:"https://image.tmdb.org/t/p/w500/a4I481szRmycyreQTLrRe4f4YJe.jpg",ids:{tmdb:"demo-aurora-station",imdb:"tt0000002"}}});var wn={};Je(wn,{renderGrid:()=>P});function Or(e){let t=k("article","card");t.style.contentVisibility="auto",t.dataset.kind=(e==null?void 0:e.type)==="tv"?"show":"movie",t.tabIndex=0,t.setAttribute("role","button"),e!=null&&e.title&&t.setAttribute("aria-label",e.title);let n=k("div","card__media"),r=new Image;r.loading="lazy",r.decoding="async",r.className="card__img",r.alt=(e==null?void 0:e.title)||"";let o=yn(e);o&&(r.src=o);let a=k("div","card__media-gradient");a.setAttribute("aria-hidden","true");let s=Xr(e),i=k("div","card__badges");s.forEach(C=>{C instanceof HTMLElement&&i.append(C)}),n.append(r,a),i.childElementCount&&n.append(i);let c=to(e);if(c>0){let C=k("div","card__progress"),M=document.createElement("span");M.style.width=`${Math.max(0,Math.min(100,c))}%`,C.append(M),n.append(C)}let l=k("div","card__body"),d=document.createElement("h3");d.className="card__title",d.textContent=(e==null?void 0:e.title)||"",e!=null&&e.title&&d.setAttribute("title",e.title);let f=k("div","card__meta"),g=Qr(e);f.textContent=g.join(" \u2022 "),l.append(d,f);let u=k("div","card__actions"),b=k("div","card__chips"),v=re(e==null?void 0:e.genres);ot(b,v,3);let A=document.createElement("button");return A.type="button",A.className="card__primary",mn(A,e),A.addEventListener("click",C=>{C.stopPropagation(),it(e),mn(A,e)}),u.append(b,A),t.append(n,l,u),t.addEventListener("click",()=>vn(e)),t.addEventListener("keydown",C=>{C.target===t&&(C.key==="Enter"||C.key===" ")&&(C.preventDefault(),vn(e))}),t}function Vr(e){return(e&&e.collections||[]).map(t=>t&&(t.tag||t.title||t.name||"")).filter(Boolean)}function Ur(e,t){let n=(t||[]).slice().sort((f,g)=>{let u=Number(K(f))||0,b=Number(K(g))||0;return u!==b?u-b:(f.title||"").localeCompare(g.title||"","de")}),r=n.map(f=>Number(K(f))||0).filter(Boolean),o=r.length?Math.min(...r):"",a=n.map(f=>new Date(f.addedAt||0).getTime()).filter(Number.isFinite),s=a.length?new Date(Math.max(...a)).toISOString():null,i=n.map(f=>{var g;return Number((g=f.rating)!=null?g:f.audienceRating)}).filter(Number.isFinite),c=i.length?i.reduce((f,g)=>f+g,0)/i.length:null,l=n.find(f=>f.thumbFile)||n[0]||null,d=Array.from(new Set(n.flatMap(f=>re(f.genres)))).slice(0,4);return{isCollectionGroup:!0,type:"collection",title:e,collectionName:e,items:n,itemCount:n.length,year:o||"",addedAt:s,rating:c,posterItem:l,genres:d}}function Wr(e){let t=document.getElementById("groupCollections"),n=document.getElementById("collectionFilter"),r=n&&n.value;if(!t||!t.checked||r)return e;let o=new Map;e.forEach(s=>{Vr(s).forEach(i=>{o.has(i)||o.set(i,[]),o.get(i).push(s)})});let a=[];return o.forEach((s,i)=>{a.push(Ur(i,s))}),a.sort((s,i)=>s.title.localeCompare(i.title,"de")),a}function Jr(e){let t=k("article","card card--collection");t.style.contentVisibility="auto",t.dataset.kind="collection",t.tabIndex=0,t.setAttribute("role","button"),e!=null&&e.title&&t.setAttribute("aria-label",e.title);let n=k("div","card__media"),r=e.posterItem||{},o=new Image;o.loading="lazy",o.decoding="async",o.className="card__img",o.alt=(e==null?void 0:e.title)||"";let a=yn(r);a&&(o.src=a);let s=k("div","card__media-gradient");s.setAttribute("aria-hidden","true");let i=Zr(e),c=k("div","card__badges");i.forEach(v=>{v instanceof HTMLElement&&c.append(v)}),n.append(o,s),c.childElementCount&&n.append(c);let l=k("div","card__body"),d=document.createElement("h3");d.className="card__title",d.textContent=e.title||"",e!=null&&e.title&&d.setAttribute("title",e.title);let f=k("div","card__meta"),g=[e.year,`${e.itemCount} Titel`];Number.isFinite(e.rating)&&g.push(`\u2605 ${R(e.rating)}`),f.textContent=g.filter(Boolean).join(" \u2022 "),l.append(d,f);let u=k("div","card__actions"),b=k("div","card__chips");return ot(b,e.genres||[],3),u.append(b),t.append(n,l,u),t.addEventListener("click",()=>{let v=document.getElementById("collectionFilter");v&&(v.value=e.collectionName||e.title||"",v.dispatchEvent(new Event("change",{bubbles:!0})))}),t.addEventListener("keydown",v=>{if(v.target===t&&(v.key==="Enter"||v.key===" ")){v.preventDefault();let A=document.getElementById("collectionFilter");A&&(A.value=e.collectionName||e.title||"",A.dispatchEvent(new Event("change",{bubbles:!0})))}}),t}function P(e){let{movies:t,shows:n,filtered:r}=y(),o=(e==="shows"?n:t)||[],a=Array.isArray(r)?r:o,s=Wr(a),i=document.getElementById("grid");if(!i)return;Gr(i);let c=document.createDocumentFragment();s.forEach(d=>c.append(d.isCollectionGroup?Jr(d):Or(d))),i.replaceChildren(c),Yr(i);let l=document.getElementById("empty");l&&(l.hidden=s.length>0)}function Gr(e){e&&(e.classList.remove("is-entering","is-ready"),e.classList.add("is-leaving"))}function Yr(e){e&&(e.classList.remove("is-leaving"),e.classList.add("is-entering"),requestAnimationFrame(()=>{e.classList.add("is-ready"),setTimeout(()=>e.classList.remove("is-entering","is-ready"),240)}))}function yn(e){var r;if(!e)return"";let t=oe()&&(((r=e==null?void 0:e.tmdb)==null?void 0:r.poster)||(e==null?void 0:e.tmdbPoster)),n=(e==null?void 0:e.thumbFile)||(e==null?void 0:e.poster)||(e==null?void 0:e.art)||(e==null?void 0:e.thumb)||"";return t||n||""}function Xr(e){var o;let t=[];Pe(e)&&t.push(Ae("Neu"));let n=String((e==null?void 0:e.contentRating)||"").trim();n&&t.push(Ae(n));let r=Number((o=e==null?void 0:e.rating)!=null?o:e==null?void 0:e.audienceRating);return Number.isFinite(r)&&t.push(Ae(`\u2605 ${R(r)}`)),t.slice(0,3)}function Zr(e){let t=[];return Number.isFinite(e==null?void 0:e.itemCount)&&e.itemCount>0&&t.push(Ae(`${e.itemCount} Titel`)),e!=null&&e.year&&t.push(Ae(String(e.year))),t}function Ae(e){let t=document.createElement("span");return t.className="badge",t.textContent=String(e||""),t}function mn(e,t){if(!e)return;let n=tn(t);e.textContent=n?"Gemerkt":"Merken",e.classList.toggle("active",n),e.setAttribute("aria-pressed",n?"true":"false")}function Qr(e){var s;let t=[],n=K(e);n&&t.push(String(n));let r=eo(e);r&&t.push(r);let o=Number((s=e==null?void 0:e.rating)!=null?s:e==null?void 0:e.audienceRating);Number.isFinite(o)&&t.push(`\u2605 ${R(o)}`);let a=(e==null?void 0:e.studio)||(e==null?void 0:e.network)||"";return a&&t.push(a),t}function eo(e){var r,o;let t=(o=(r=e==null?void 0:e.runtimeMin)!=null?r:e==null?void 0:e.durationMin)!=null?o:e!=null&&e.duration?Math.round(Number(e.duration)/6e4):null,n=Number(t);return!Number.isFinite(n)||n<=0?"":(e==null?void 0:e.type)==="tv"?`~${n} min/Ep`:`${n} min`}function to(e){var r;let t=Number((r=e==null?void 0:e.viewOffset)!=null?r:e==null?void 0:e.viewoffset),n=Number(e==null?void 0:e.duration);return!Number.isFinite(t)||!Number.isFinite(n)||n<=0?0:Math.max(1,Math.min(100,Math.round(t/n*100)))}function no(e){var n,r;if(!e)return"";let t=((n=e==null?void 0:e.ids)==null?void 0:n.imdb)||((r=e==null?void 0:e.ids)==null?void 0:r.tmdb);return t?String(t):e!=null&&e.ratingKey?String(e.ratingKey):""}function ro(e,t){if(!e||!t)return;let n=`#/${e}/${t}`;try{if(history&&typeof history.pushState=="function"){location.hash===n&&typeof history.replaceState=="function"?history.replaceState(null,"",n):history.pushState(null,"",n);return}}catch{}try{window.__skipNextHashNavigation=!0}catch{}location.hash=n}function vn(e){if(!e)return;let t=(e==null?void 0:e.type)==="tv"?"show":"movie",n=no(e);n&&ro(t,n),t==="show"?Se(e):Ee(e)}var mt=_(()=>{J();qe();Ne();ve();lt();bt()});var kt={};Je(kt,{applyFilters:()=>pe,computeFacets:()=>Et,initFilters:()=>At,renderFacets:()=>St,updateFiltersAndGrid:()=>Ce});function ke(e){return e.year?e.year:e.originallyAvailableAt?String(e.originallyAvailableAt).slice(0,4):""}function yt(e){return(e&&e.collections||[]).map(t=>t&&(t.tag||t.title||t.name||"")).filter(Boolean)}function oo(e){if(!(e!=null&&e.addedAt))return!1;let t=new Date(e.addedAt).getTime();if(!Number.isFinite(t))return!1;let n=y().cfg||{},r=Number(n.newDays||30);return Date.now()-t<=r*24*60*60*1e3}function En(e){return String(e||"").toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")}function ao(e,t){let n=En(t.query||""),r=!!t.onlyNew,o=Number(t.yearFrom)||null,a=Number(t.yearTo)||null,s=t.genres||new Set,i=t.collection||"";if(n&&!En([e.title,e.originalTitle,e.summary,e.studio,re(e.genres).join(" "),(e.roles||[]).map(d=>d&&(d.tag||d.role||d.name)).join(" "),yt(e).join(" ")].filter(Boolean).join(" ")).includes(n)||r&&!oo(e))return!1;let c=Number(ke(e))||null;if(o&&(!c||c<o)||a&&(!c||c>a))return!1;if(s.size){let l=new Set(re(e.genres));for(let d of s)if(!l.has(d))return!1}return!(i&&!new Set(yt(e)).has(i))}function so(e,t){let n=e.slice();switch(t){case"year-desc":n.sort((r,o)=>(Number(ke(o))||0)-(Number(ke(r))||0)||String(r.title||"").localeCompare(String(o.title||""),"de"));break;case"year-asc":n.sort((r,o)=>(Number(ke(r))||0)-(Number(ke(o))||0)||String(r.title||"").localeCompare(String(o.title||""),"de"));break;case"title-desc":n.sort((r,o)=>String(o.title||"").localeCompare(String(r.title||""),"de"));break;case"added-desc":n.sort((r,o)=>new Date(o.addedAt||0)-new Date(r.addedAt||0));break;case"title-asc":default:n.sort((r,o)=>String(r.title||"").localeCompare(String(o.title||""),"de"))}return n}function Et(e,t){let n=new Set,r=new Set,o=new Set,a=i=>(i||[]).forEach(c=>{re(c.genres).forEach(d=>n.add(d));let l=c.year||(c.originallyAvailableAt?String(c.originallyAvailableAt).slice(0,4):"");l&&r.add(Number(l)),yt(c).forEach(d=>o.add(d))});a(e),a(t);let s=[...r].sort((i,c)=>i-c);return{genres:[...n].sort(),years:s,collections:[...o].sort((i,c)=>i.localeCompare(c,"de"))}}function St(e){let t=I("#yearFrom"),n=I("#yearTo");t&&t.replaceChildren(new Option("Ab Jahr",""),...e.years.map(a=>new Option(String(a),String(a)))),n&&n.replaceChildren(new Option("Bis Jahr",""),...e.years.map(a=>new Option(String(a),String(a))));let r=I("#collectionFilter");r&&r.replaceChildren(new Option("Alle Collections",""),...e.collections.map(a=>new Option(a,a)));let o=I("#genreFilters");if(o){let a=e.genres.map(s=>{let i=document.createElement("button");return i.type="button",i.className="chip",i.textContent=s,i.dataset.name=s,i});o.replaceChildren(...a),wt()}}function io(){var c,l,d,f,g;let e=document.getElementById("search")||document.getElementById("q"),t=((e==null?void 0:e.value)||"").trim(),n=((c=I("#onlyNew"))==null?void 0:c.checked)||!1,r=((l=I("#yearFrom"))==null?void 0:l.value)||"",o=((d=I("#yearTo"))==null?void 0:d.value)||"",a=((f=I("#collectionFilter"))==null?void 0:f.value)||"",s=((g=I("#sort"))==null?void 0:g.value)||"title-asc",i=new Set;return document.querySelectorAll("#genreFilters .chip.active").forEach(u=>i.add(u.dataset.name)),{query:t,onlyNew:n,yearFrom:r,yearTo:o,collection:a,genres:i,sort:s}}function pe(){let e=y(),n=e.view==="shows"?e.shows:e.movies,r=io(),o=(n||[]).filter(s=>ao(s,r)),a=so(o,r.sort);return ee({filtered:a}),a}function co(){vt||(vt=Promise.resolve().then(()=>(mt(),wn))),vt.then(e=>{let t=e&&e.renderGrid;typeof t=="function"&&t(y().view)}).catch(console.error)}function Ce(){let e=pe();return co(),lo(e),e}function lo(e){try{let n={items:Array.isArray(e)?e.slice():[],view:y().view};window.dispatchEvent(new CustomEvent("filters:updated",{detail:n}))}catch{}}function wt(){let e=document.getElementById("genreFilters");if(!e)return;let t=e.querySelectorAll(".chip.active").length;e.dataset.state=t>0?"active":"empty",e.dataset.count=String(t)}function At(){let e=I("#sort");e&&e.options.length===0&&[["title-asc","Titel A\u2013Z"],["title-desc","Titel Z\u2013A"],["year-desc","Jahr \u2193"],["year-asc","Jahr \u2191"],["added-desc","Zuletzt hinzugef\xFCgt"]].forEach(([o,a])=>e.add(new Option(a,o)));let t=(o,a="input")=>{let s=I(o);s&&(s.addEventListener(a,()=>{Ce()}),a==="input"&&s instanceof HTMLInputElement&&s.type==="search"&&s.addEventListener("search",()=>{Ce()}))};t("#search"),t("#q"),t("#onlyNew","change"),t("#yearFrom","change"),t("#yearTo","change"),t("#collectionFilter","change"),t("#sort","change"),t("#groupCollections","change");let n=I("#yearReset");n&&n.addEventListener("click",()=>{let o=I("#yearFrom"),a=I("#yearTo");o&&(o.value=""),a&&(a.value=""),Ce()});let r=I("#genreFilters");r&&(r.addEventListener("click",o=>{let a=o.target;a instanceof HTMLElement&&a.classList.contains("chip")&&(a.classList.toggle("active"),wt(),Ce())}),wt())}var vt,qe=_(()=>{J();Ne();ve();vt=null});var me={};Je(me,{clearCache:()=>ho,hydrateOptional:()=>Tt,validateToken:()=>wo});function uo(){try{return new Map(JSON.parse(localStorage.getItem("tmdbCache")||"[]"))}catch{return new Map}}function fo(){try{localStorage.setItem("tmdbCache",JSON.stringify(Array.from(ie.entries())))}catch{}}function ho(){try{localStorage.removeItem("tmdbCache"),ie=new Map}catch{}}function go(e){try{let t=localStorage.getItem("tmdbToken");if(t)return{kind:"bearer",value:t}}catch{}return e!=null&&e.tmdbApiKey?{kind:"apikey",value:String(e.tmdbApiKey)}:{kind:"none",value:""}}function po(e){var s,i;let t=e.type==="tv"?"tv":"movie",n=((s=e==null?void 0:e.ids)==null?void 0:s.imdb)||"",r=((i=e==null?void 0:e.ids)==null?void 0:i.tmdb)||"",o=(e.title||"").toLowerCase(),a=String(e.year||"").slice(0,4);return[t,n,r,o,a].filter(Boolean).join("|")}function Ct(e,t){if(!t||t.kind==="none")return{url:e,init:{}};if(t.kind==="bearer")return{url:e,init:{headers:{Authorization:`Bearer ${t.value}`,Accept:"application/json"}}};let n=e.includes("?")?"&":"?";return{url:`${e}${n}api_key=${encodeURIComponent(t.value)}`,init:{headers:{Accept:"application/json"}}}}async function ze(e,t){let{url:n,init:r}=Ct(e,t),o=await fetch(n,r);if(!o.ok)throw new Error("HTTP "+o.status);return o.json()}function bo(e){return e!=null&&e.file_path?Ke+Sn+e.file_path:""}function mo(e){return e!=null&&e.file_path?Ke+An+e.file_path:""}async function xt(e,t,n,r){let o=await ze(`${be}/${e}/${t}?language=${encodeURIComponent(n||"de-DE")}`,r),a=await ze(`${be}/${e}/${t}/images`,r).catch(()=>({posters:[],backdrops:[]})),s=bo((a.posters||[])[0])||(o.poster_path?Ke+Sn+o.poster_path:""),i=mo((a.backdrops||[])[0])||(o.backdrop_path?Ke+An+o.backdrop_path:"");return{id:o.id,poster:s,backdrop:i,url:`https://www.themoviedb.org/${e}/${o.id}`}}async function vo(e,t,n,r,o){let a=encodeURIComponent(t||""),s=n?`&year=${encodeURIComponent(String(n))}`:"",c=((await ze(`${be}/search/${e}?query=${a}${s}&language=${encodeURIComponent(r||"de-DE")}`,o)).results||[])[0];if(!c)throw new Error("not found");return xt(e,c.id,r,o)}async function yo(e,t,n){var s,i;let r=e.type==="tv"?"tv":"movie",o=po(e);if(ie.has(o))return ie.get(o);let a;try{if((s=e==null?void 0:e.ids)!=null&&s.tmdb)a=await xt(r,e.ids.tmdb,t.lang,n);else if((i=e==null?void 0:e.ids)!=null&&i.imdb){let c=await ze(`${be}/find/${e.ids.imdb}?external_source=imdb_id&language=${encodeURIComponent(t.lang||"de-DE")}`,n),l=r==="movie"?(c.movie_results||[])[0]:(c.tv_results||[])[0];if(l)a=await xt(r,l.id,t.lang,n);else throw new Error("not found")}else a=await vo(r,e.title,e.year,t.lang,n)}catch{a=null}return ie.set(o,a),fo(),a}async function Tt(e,t,n={}){try{ie=ie||uo();let r=go(n);if(!r.value)return;let o=(e||[]).concat(t||[]),a=0,s=40,i=async()=>{let c=o.slice(a,a+4);a+=4,await Promise.all(c.map(async l=>{let d=await yo(l,n,r);d&&(l.tmdb={id:d.id,poster:d.poster,backdrop:d.backdrop,url:d.url},l.ids=l.ids||{},!l.ids.tmdb&&d.id&&(l.ids.tmdb=String(d.id)))}));try{window.dispatchEvent(new CustomEvent("tmdb:chunk",{detail:{updated:c.length,index:a}}))}catch{}if(a<Math.min(o.length,s))(window.requestIdleCallback||setTimeout)(i,250);else try{window.dispatchEvent(new CustomEvent("tmdb:done",{detail:{total:Math.min(o.length,s)}}))}catch{}};i()}catch{}}async function wo(e){let t=String(e||"").trim();if(!t)throw new Error("empty");let n=/^[a-f0-9]{32}$/i.test(t),r=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+$/.test(t),o=a=>{try{let s=a.split(".")[1],c=atob((l=>l+"=".repeat((4-l.length%4)%4))(s.replace(/-/g,"+").replace(/_/g,"/")));return JSON.parse(c)}catch{return null}};if(n){let{url:a,init:s}=Ct(`${be}/configuration`,{kind:"apikey",value:t});return(await fetch(a,s)).ok?{ok:!0,as:"apikey",hint:"v3Key"}:{ok:!1,as:"apikey",hint:"looksV3"}}if(r){let a=o(t);if(a&&typeof a=="object"){let c=String(a.iss||"");if(c&&!/themoviedb\.org/i.test(c))return{ok:!1,as:"bearer",hint:"issMismatch"}}let{url:s,init:i}=Ct(`${be}/trending/movie/day`,{kind:"bearer",value:t});try{if((await fetch(s,i)).ok)return{ok:!0,as:"bearer",hint:null}}catch{}return{ok:!0,as:"bearer",hint:"structOnly"}}return{ok:!1,as:"bearer",hint:null}}var be,Ke,Sn,An,ie,ce=_(()=>{be="https://api.themoviedb.org/3",Ke="https://image.tmdb.org/t/p/",Sn="w342",An="w780"});J();Ne();var q,Le,Be,G;function Ye(){if(!q&&(q=I("#loaderOverlay"),!q)){q=k("div","loader-overlay"),q.id="loaderOverlay",q.hidden=!0;let e=k("div","loader");Be=k("div","msg",""),Le=k("div","bar"),e.append(Be,Le),q.append(e),document.body.append(q)}}function $t(){Ye(),q.hidden=!1}function le(e,t){Ye(),Be&&(Be.textContent=e||""),Le&&(Le.style.width=(t||0)+"%")}function Fe(){Ye(),q.hidden=!0}function Pt(e=18){let t=I("#grid");if(t){G=k("div","skeleton");for(let n=0;n<e;n++)G.append(k("div","skel"));t.replaceChildren(G)}}function Xe(){G&&G.parentElement&&G.parentElement.removeChild(G),G=null}ue();qe();mt();bt();ce();lt();J();ue();Qe();function Cn(){let e=document.getElementById("openDebug");e&&e.addEventListener("click",()=>{Eo()})}function Eo(){var t,n,r,o;let e=document.getElementById("debugOverlay");e||(e=document.createElement("div"),e.id="debugOverlay",e.className="debug-overlay",e.innerHTML=`
      <div class="debug-dialog">
        <div class="debug-header"><h2>Debug</h2></div>
        <div class="debug-body">
          <pre id="debugPre" class="debug-pre"></pre>
          <div class="debug-cache-controls">
            <h3>Cache-Verwaltung</h3>
            <div id="cacheStats" class="cache-stats"></div>
            <div class="cache-buttons">
              <button id="debugClearExpired" class="btn">Abgelaufene l\xF6schen</button>
              <button id="debugClearAll" class="btn">Alles l\xF6schen</button>
            </div>
          </div>
        </div>
        <div class="debug-actions">
          <button id="debugCopy" class="btn">Copy report</button>
          <button id="debugClose" class="btn">Schlie\xDFen</button>
        </div>
      </div>`,document.body.append(e)),e.hidden=!1,It(),e.addEventListener("click",a=>{a.target===e&&kn()}),(t=document.getElementById("debugClose"))==null||t.addEventListener("click",kn,{once:!0}),(n=document.getElementById("debugCopy"))==null||n.addEventListener("click",So,{once:!0}),(r=document.getElementById("debugClearExpired"))==null||r.addEventListener("click",()=>{Me(),It()},{once:!0}),(o=document.getElementById("debugClearAll"))==null||o.addEventListener("click",()=>{confirm("Wirklich den gesamten Cache l\xF6schen?")&&(Rt(),It())},{once:!0})}function kn(){let e=document.getElementById("debugOverlay");e&&(e.hidden=!0)}function It(){let e=document.getElementById("debugPre");if(!e)return;let t=y(),n=Gt(),r=t.cfg||{},o=Ze(),a={view:t.view,counts:{movies:(t.movies||[]).length,shows:(t.shows||[]).length,filtered:(t.filtered||[]).length},dataSources:n,cache:o,tmdb:{enabled:!!r.tmdbEnabled,lang:r.lang,tokenPresent:!!(localStorage.getItem("tmdbToken")||r.tmdbApiKey)},useTmdbImages:localStorage.getItem("useTmdb")==="1",reduceMotion:localStorage.getItem("prefReduceMotion")==="1",locationHash:location.hash,userAgent:navigator.userAgent};e.textContent=JSON.stringify(a,null,2);let s=document.getElementById("cacheStats");s&&o&&(s.innerHTML=`
      <p>Eintr\xE4ge gesamt: <strong>${o.totalEntries}</strong></p>
      <p>G\xFCltig: <strong>${o.validEntries}</strong> | Abgelaufen: <strong>${o.expiredEntries}</strong></p>
      <p>Gr\xF6\xDFe: <strong>${o.totalSizeMB} MB</strong></p>
    `)}function So(){var n;let e=document.getElementById("debugPre");if(!e)return;let t=e.textContent||"";(n=navigator.clipboard)==null||n.writeText(t).catch(()=>{try{let r=document.createElement("textarea");r.value=t,document.body.append(r),r.select(),document.execCommand("copy"),r.remove()}catch{}})}ve();var H=null;function Ve(){H||(H=document.createElement("div"),H.id="errorContainer",H.className="error-container",H.setAttribute("role","alert"),H.setAttribute("aria-live","polite"),document.body.appendChild(H)),window.addEventListener("unhandledrejection",e=>{var t;Oe("Ein unerwarteter Fehler ist aufgetreten",(t=e.reason)==null?void 0:t.message),e.preventDefault()}),window.addEventListener("error",e=>{var t;Oe("Ein Fehler ist aufgetreten",(t=e.error)==null?void 0:t.message)})}function Oe(e,t="",n=5e3){H||Ve();let r=document.createElement("div");return r.className="error-toast",r.innerHTML=`
    <div class="error-toast-content">
      <div class="error-toast-icon">\u26A0\uFE0F</div>
      <div class="error-toast-text">
        <div class="error-toast-title">${Nt(e)}</div>
        ${t?`<div class="error-toast-message">${Nt(t)}</div>`:""}
      </div>
      <button class="error-toast-close" aria-label="Schlie\xDFen">\xD7</button>
    </div>
  `,r.querySelector(".error-toast-close").addEventListener("click",()=>{r.classList.add("error-toast-exit"),setTimeout(()=>r.remove(),300)}),H.appendChild(r),n>0&&setTimeout(()=>{r.parentNode&&(r.classList.add("error-toast-exit"),setTimeout(()=>r.remove(),300))},n),requestAnimationFrame(()=>{r.classList.add("error-toast-show")}),r}function xn(e,t){H||Ve();let n=document.createElement("div");n.className="error-toast error-toast-retryable",n.innerHTML=`
    <div class="error-toast-content">
      <div class="error-toast-icon">\u26A0\uFE0F</div>
      <div class="error-toast-text">
        <div class="error-toast-title">${Nt(e)}</div>
      </div>
      <button class="error-toast-retry">Erneut versuchen</button>
      <button class="error-toast-close" aria-label="Schlie\xDFen">\xD7</button>
    </div>
  `;let r=n.querySelector(".error-toast-retry"),o=n.querySelector(".error-toast-close");return r.addEventListener("click",async()=>{n.remove();try{await t()}catch{}}),o.addEventListener("click",()=>{n.classList.add("error-toast-exit"),setTimeout(()=>n.remove(),300)}),H.appendChild(n),requestAnimationFrame(()=>{n.classList.add("error-toast-show")}),n}function Nt(e){let t=document.createElement("div");return t.textContent=e,t.innerHTML}var Te=null,U=null;function xe(e,t=!0){let n=document.getElementById("footerMeta");if(n){let o=n.querySelector("#footerStatus");o?o.textContent=e:n.textContent=e,n.dataset.state=t?"loading":"ready"}let r=document.getElementById("grid");r&&r.setAttribute("aria-busy",t?"true":"false")}async function ko(){Ve(),Ho(),$t(),xe("Initialisiere \u2026",!0),le("Initialisiere \u2026",8),Pt(18);let e=await fetch("config.json").then(n=>n.json()).catch(n=>(Oe("Konfiguration konnte nicht geladen werden","Verwende Standardeinstellungen"),{startView:"movies",tmdbEnabled:!1}));ee({cfg:e,view:e.startView||"movies"});try{xe("Filme laden \u2026",!0),le("Filme laden \u2026",25);let n=await tt();xe("Serien laden \u2026",!0),le("Serien laden \u2026",45);let r=await nt();xe("Filter vorbereiten \u2026",!0),le("Filter vorbereiten \u2026",60);let o=Et(n,r);ee({movies:n,shows:r,facets:o}),xe("Ansicht aufbauen \u2026",!0),le("Ansicht aufbauen \u2026",85),Xe(),Ft(),St(o),At(),pe(),Co(!0),P(y().view),xo(),Fe(),e.tmdbEnabled&&(window.requestIdleCallback||setTimeout)(()=>{var a;return(a=Tt)==null?void 0:a(n,r,e)},400),rn(),Ro(e),qo(),Ko(),zo(),Oo(),W(),Cn()}catch(n){throw Fe(),Xe(),xn("Fehler beim Laden der Daten",()=>window.location.reload()),n}let t;window.addEventListener("tmdb:chunk",()=>{t||(t=requestAnimationFrame(()=>{t=null;try{localStorage.getItem("useTmdb")==="1"&&(P(y().view),W())}catch{}}))}),window.addEventListener("tmdb:done",()=>{try{localStorage.getItem("useTmdb")==="1"&&(P(y().view),W())}catch{}})}var Lt=null,Bt="";window.addEventListener("hashchange",()=>{if(window.__skipNextHashNavigation){try{window.__skipNextHashNavigation=!1,Bt=location.hash||""}catch{}return}let e=location.hash||"";Lt&&clearTimeout(Lt),Lt=setTimeout(()=>{if(e===Bt)return;Bt=e;let t=e;if(/^#\/(movies|shows)$/.test(t)){let i=t.includes("shows")?"shows":"movies";ee({view:i});let c=pe();Ft(),P(i),W(c);return}let n=t.match(/^#\/(movie|show)\/(.+)/);if(!n)return;let[,r,o]=n,s=((r==="movie"?y().movies:y().shows)||[]).find(i=>{var c,l;return((c=i==null?void 0:i.ids)==null?void 0:c.imdb)===o||((l=i==null?void 0:i.ids)==null?void 0:l.tmdb)===o||String(i==null?void 0:i.ratingKey)===o});s&&(r==="show"?Se(s):Ee(s))},50)});function Ft(){let e=document.getElementById("libraryTabs");if(!e)return;let t=Array.from(e.querySelectorAll("[data-lib]")),n=y().view==="shows"?"shows":"movies";t.forEach(r=>{let o=r.dataset.lib==="series"?"shows":"movies",a=n===o;r.classList.toggle("is-active",a),r.setAttribute("aria-pressed",a?"true":"false"),r.dataset.bound!=="true"&&(r.addEventListener("click",()=>{let s=r.dataset.lib==="series"?"shows":"movies";if(y().view===s)return;ee({view:s});try{window.__skipNextHashNavigation=!0}catch{}location.hash=s==="movies"?"#/movies":"#/shows",Ft();let i=pe();P(s),W(i)}),r.dataset.bound="true")})}function Co(e=!1){let t=document.getElementById("heroStats");if(!t)return;let n=y(),r=(n.movies||[]).length,o=(n.shows||[]).length,a=t.querySelector('[data-stat="movies"]'),s=t.querySelector('[data-stat="shows"]');!a||!s||(e?(Tn(a,r),Tn(s,o)):(a.textContent=String(r),s.textContent=String(o)))}function Tn(e,t){if(!e)return;let n=Number(e.textContent)||0,r=Number(t)||0;if(n===r){e.textContent=String(r);return}let o=480,a=performance.now();function s(i){let c=Math.min(1,(i-a)/o),l=Math.round(n+(r-n)*(c<.5?2*c*c:-1+(4-2*c)*c));e.textContent=String(l),c<1?requestAnimationFrame(s):e.textContent=String(r)}requestAnimationFrame(s)}function xo(){let e=document.getElementById("footerMeta");if(!e)return;let t=document.getElementById("footerStatus"),n=y(),r=n.movies||[],o=n.shows||[],a=r.concat(o).map(l=>new Date(l.addedAt||0).getTime()).filter(Number.isFinite),i=(a.length?new Date(Math.max(...a)):new Date).toISOString().slice(0,10);t&&(t.textContent=`Stand: ${i}`),e.dataset.state="ready";let c=document.getElementById("grid");c&&c.setAttribute("aria-busy","false")}function W(e){let t=document.getElementById("hero"),n=document.getElementById("heroTitle"),r=document.getElementById("heroSubtitle"),o=document.getElementById("heroCta");if(!t||!n||!r||!o)return;To();let a=Io(e);if(!a){Te=null,n.textContent=U.title,r.textContent=U.subtitle,r.dataset.taglinePaused="0",delete r.dataset.heroBound,r.classList.remove("is-fading"),o.textContent=U.cta,o.disabled=!0,o.setAttribute("aria-disabled","true"),o.removeAttribute("aria-label"),o.onclick=null,t.style.backgroundImage="",t.classList.remove("has-poster"),t.dataset.heroKind="",t.dataset.heroId="";return}Te=a;let s=a.type==="tv"?"show":"movie",i=$o(a);n.textContent=a.title||U.title,r.textContent=Lo(a),r.dataset.taglinePaused="1",r.dataset.heroBound="1",r.classList.remove("is-fading");let c=s==="show"?"Serien-Details \xF6ffnen":"Film-Details \xF6ffnen";o.textContent=c,o.disabled=!1,o.setAttribute("aria-disabled","false"),o.setAttribute("aria-label",a.title?`${c}: ${a.title}`:c),o.onclick=()=>Po(a,s,i),t.dataset.heroKind=s,t.dataset.heroId=i||"";let l=jo(a);l?(t.style.backgroundImage=`url(${l})`,t.classList.add("has-poster")):(t.style.backgroundImage="",t.classList.remove("has-poster"))}window.__heroRefresh=W;function To(){var e,t,n;U||(U={title:((e=document.getElementById("heroTitle"))==null?void 0:e.textContent)||"",subtitle:((t=document.getElementById("heroSubtitle"))==null?void 0:t.textContent)||"",cta:((n=document.getElementById("heroCta"))==null?void 0:n.textContent)||""})}function Io(e){if(Array.isArray(e)){let r=e.filter(Nn);return r.length?In(r):null}let n=No().filter(Nn);return n.length?In(n):null}function In(e){if(e.length===1)return e[0];let t=Math.floor(Math.random()*e.length),n=e[t];return Te&&e.length>1&&n===Te&&e.find(o=>o!==Te)||n}function No(){let e=y(),t=e.view==="shows"?"shows":"movies",r=(Array.isArray(e.filtered)&&e.filtered.length?e.filtered:null)||(t==="shows"?e.shows:e.movies)||[];return Array.isArray(r)?r:[]}function Nn(e){return!!e&&typeof e=="object"&&!e.isCollectionGroup&&e.type!=="collection"}function Lo(e){var i;let t=[],n=K(e);n&&t.push(String(n));let r=Bo(e);r&&t.push(r);let o=Number((i=e==null?void 0:e.rating)!=null?i:e==null?void 0:e.audienceRating);Number.isFinite(o)&&t.push(`\u2605 ${R(o)}`);let a=Fo(e,2);a.length&&t.push(a.join(", "));let s=Mo(e);return s?t.length?`${t.join(" \u2022 ")} \u2014 ${s}`:s:t.length?t.join(" \u2022 "):(U==null?void 0:U.subtitle)||""}function Bo(e){var r,o;let t=(o=(r=e==null?void 0:e.runtimeMin)!=null?r:e==null?void 0:e.durationMin)!=null?o:e!=null&&e.duration?Math.round(Number(e.duration)/6e4):null,n=Number(t);return!Number.isFinite(n)||n<=0?"":(e==null?void 0:e.type)==="tv"?`~${n} min/Ep`:`${n} min`}function Fo(e,t=3){let n=Array.isArray(e==null?void 0:e.genres)?e.genres:[],r=[];return n.forEach(a=>{if(!a)return;if(typeof a=="string"){r.push(a);return}let s=a.tag||a.title||a.name||a.label||"";s&&r.push(s)}),Array.from(new Set(r)).slice(0,Math.max(0,t))}function Mo(e){let t=[e==null?void 0:e.tagline,e==null?void 0:e.summary,e==null?void 0:e.plot,e==null?void 0:e.overview];for(let n of t){if(typeof n!="string")continue;let r=n.trim();if(r)return _o(r,220)}return""}function _o(e,t){let n=String(e||"").trim();return n?n.length<=t?n:`${n.slice(0,Math.max(0,t-1)).trimEnd()}\u2026`:""}function $o(e){var t,n;return e?(t=e==null?void 0:e.ids)!=null&&t.imdb?String(e.ids.imdb):(n=e==null?void 0:e.ids)!=null&&n.tmdb?String(e.ids.tmdb):(e==null?void 0:e.ratingKey)!=null?String(e.ratingKey):"":""}function Po(e,t,n){n&&Do(t,n),t==="show"?Se(e):Ee(e)}function Do(e,t){if(!e||!t)return;let n=`#/${e}/${t}`;try{if(history&&typeof history.pushState=="function"){location.hash===n&&typeof history.replaceState=="function"?history.replaceState(null,"",n):history.pushState(null,"",n);return}}catch{}try{window.__skipNextHashNavigation=!0}catch{}location.hash=n}function jo(e){var a,s,i,c,l;if(!e)return"";let t=oe(),n=[(a=e==null?void 0:e.tmdb)==null?void 0:a.backdrop,(s=e==null?void 0:e.tmdb)==null?void 0:s.backdrop_path,(i=e==null?void 0:e.tmdb)==null?void 0:i.backdropPath,(c=e==null?void 0:e.tmdb)==null?void 0:c.background,(l=e==null?void 0:e.tmdb)==null?void 0:l.art],r=[e==null?void 0:e.art,e==null?void 0:e.background,e==null?void 0:e.thumbBackground,e==null?void 0:e.coverArt,e==null?void 0:e.thumb,e==null?void 0:e.thumbFile];if(t){let d=n.find(Ln);if(d)return d}return r.find(Ln)||""}function Ln(e){return typeof e=="string"&&e.trim().length>0}window.addEventListener("filters:updated",e=>{let t=e==null?void 0:e.detail,n=Array.isArray(t==null?void 0:t.items)?t.items:null;W(n)});ko();window.addEventListener("load",()=>{try{Fe()}catch{}});function Ro(e){let t=document.getElementById("settingsOverlay"),n=t==null?void 0:t.querySelector(".settings-dialog"),r=document.getElementById("settingsBtn"),o=document.getElementById("openSettings"),a=document.getElementById("headerSettingsBtn"),s=document.getElementById("settingsClose2"),i=document.getElementById("tmdbTokenInput"),c=document.getElementById("tmdbSave"),l=document.getElementById("tmdbTest"),d=document.getElementById("tmdbStatus"),f=document.getElementById("tmdbClearCache"),g=document.getElementById("tmdbStatusBadge"),u=document.getElementById("prefReduceMotion"),b=document.getElementById("useTmdbSetting"),v=document.getElementById("resetFilters");t&&t.hidden&&t.setAttribute("aria-hidden","true");let A=null,C="",M=!1,D=new Map,Q='a[href], button:not([disabled]), input:not([disabled]), select:not([disabled]), textarea:not([disabled]), [tabindex]:not([tabindex="-1"])';function Ie(){return t?Array.from(t.querySelectorAll(Q)).filter(h=>!h.hasAttribute("disabled")&&h.getAttribute("aria-hidden")!=="true"):[]}function w(){n&&typeof n.focus=="function"?n.focus({preventScroll:!0}):t&&typeof t.focus=="function"&&t.focus({preventScroll:!0})}function T(h){if(!t)return;let S=Array.from(document.body.children).filter(p=>p!==t);h?S.forEach(p=>{D.has(p)||D.set(p,{ariaHidden:p.hasAttribute("aria-hidden")?p.getAttribute("aria-hidden"):null,inert:p.hasAttribute("inert")}),p.setAttribute("aria-hidden","true"),p.setAttribute("inert","")}):(S.forEach(p=>{let m=D.get(p);m?(m.ariaHidden===null||m.ariaHidden===void 0?p.removeAttribute("aria-hidden"):p.setAttribute("aria-hidden",m.ariaHidden),m.inert?p.setAttribute("inert",""):p.removeAttribute("inert"),D.delete(p)):(p.removeAttribute("aria-hidden"),p.removeAttribute("inert"))}),D.clear())}function x(){!t||M||(M=!0,t.hidden=!1,t.setAttribute("aria-hidden","false"),A=document.activeElement instanceof HTMLElement?document.activeElement:null,C=document.body.style.overflow,document.body.style.overflow="hidden",T(!0),Bn(),requestAnimationFrame(w),document.dispatchEvent(new CustomEvent("settings:open")))}function B(){!t||!M||(M=!1,t.hidden=!0,t.setAttribute("aria-hidden","true"),T(!1),document.body.style.overflow=C,A&&typeof A.focus=="function"&&A.focus(),A=null,document.dispatchEvent(new CustomEvent("settings:close")))}function L(h){if(!M)return;if(h.key==="Escape"){h.preventDefault(),B();return}if(h.key!=="Tab")return;let S=Ie();if(!S.length){h.preventDefault(),w();return}let p=S[0],m=S[S.length-1],O=document.activeElement;h.shiftKey?(O===p||!t.contains(O))&&(h.preventDefault(),m.focus()):O===m&&(h.preventDefault(),p.focus())}r&&r.addEventListener("click",x),o&&o.addEventListener("click",()=>{x()}),a&&a.addEventListener("click",x),s&&s.addEventListener("click",B),t&&t.addEventListener("click",h=>{h.target===t&&B()}),t&&t.addEventListener("keydown",L);function E(h="",S=""){if(d){d.textContent=h,d.dataset.kind=S,g&&(g.dataset.kind=S||"",g.title=h||"");try{if(S==="error"&&e&&e.tmdbApiKey){let p=String(localStorage.getItem("tmdbToken")||"").trim(),m=String((i==null?void 0:i.value)||"").trim();if(p&&m){try{localStorage.removeItem("tmdbToken")}catch{}i&&(i.value=""),F(!0);let O="Ung\xFCltiger Token entfernt. Verwende API Key aus config.json.";d.textContent=O,d.dataset.kind="info",g&&(g.dataset.kind="info",g.title=O)}}}catch{}}}function F(h){if(b&&(b.disabled=!h,b.title=b.disabled?"Nur verf\xFCgbar mit g\xFCltigem Token oder API Key.":"",!h&&b.checked)){try{localStorage.setItem("useTmdb","0")}catch{}b.checked=!1,P(y().view)}}function Bn(){let h="";try{i&&(i.value=h=localStorage.getItem("tmdbToken")||"")}catch{}try{u&&(u.checked=localStorage.getItem("prefReduceMotion")==="1")}catch{}try{b&&(b.checked=localStorage.getItem("useTmdb")==="1",b.disabled=!h,b.title=b.disabled?"Nur verf\xFCgbar mit g\xFCltigem Token.":"")}catch{}try{F(!!h||!!(e&&e.tmdbApiKey))}catch{}E("",""),h||E("Kein Token hinterlegt. TMDB ist deaktiviert.","info"),e!=null&&e.tmdbEnabled||E("Hinweis: TMDB in config.json deaktiviert (tmdbEnabled=false).","info"),h?(async()=>{var S;E("Pr\xFCfe Token...","pending");try{let p=await Promise.resolve().then(()=>(ce(),me)),m=await((S=p.validateToken)==null?void 0:S.call(p,h));m&&m.ok?(F(!0),m.as==="bearer"?E("Token g\xFCltig (v4 Bearer).","success"):m.as==="apikey"&&E('API Key g\xFCltig (v3). Tipp: dauerhaft in site/config.json unter "tmdbApiKey" eintragen.',"success")):(F(!1),(m==null?void 0:m.hint)==="looksV3"?E('Eingegebener Wert sieht wie ein v3 API Key aus. Bitte in config.json als "tmdbApiKey" eintragen oder v4 Bearer Token verwenden.',"error"):E("Token ung\xFCltig oder keine Berechtigung (401).","error"))}catch{E("Pr\xFCfung fehlgeschlagen. Netzwerk/Browser-Konsole pr\xFCfen.","error")}})():F(!!(e&&e.tmdbApiKey))}c&&c.addEventListener("click",async()=>{var S;let h=String((i==null?void 0:i.value)||"").trim();try{localStorage.setItem("tmdbToken",h)}catch{}if(!h){E("Kein Token hinterlegt. TMDB ist deaktiviert.","info"),F(!!(e&&e.tmdbApiKey));return}E("Pr\xFCfe Token...","pending");try{let p=await Promise.resolve().then(()=>(ce(),me)),m=await((S=p.validateToken)==null?void 0:S.call(p,h));m&&m.ok?(F(!0),m.as==="bearer"?E("Token g\xFCltig (v4 Bearer).","success"):m.as==="apikey"&&E('API Key g\xFCltig (v3). Tipp: dauerhaft in site/config.json unter "tmdbApiKey" eintragen.',"success")):(F(!1),(m==null?void 0:m.hint)==="looksV3"?E('Eingegebener Wert sieht wie ein v3 API Key aus. Bitte in config.json als "tmdbApiKey" eintragen oder v4 Bearer Token verwenden.',"error"):E("Token ung\xFCltig oder keine Berechtigung (401).","error"))}catch{E("Pr\xFCfung fehlgeschlagen. Netzwerk/Browser-Konsole pr\xFCfen.","error")}}),l&&l.addEventListener("click",async()=>{var S;let h=String((i==null?void 0:i.value)||"").trim();if(!h){E("Bitte Token eingeben.","error");return}E("Pr\xFCfe Token...","pending");try{let p=await Promise.resolve().then(()=>(ce(),me)),m=await((S=p.validateToken)==null?void 0:S.call(p,h));m&&m.ok?m.as==="bearer"?E("Token g\xFCltig (v4 Bearer).","success"):m.as==="apikey"&&E('API Key g\xFCltig (v3). Tipp: dauerhaft in site/config.json unter "tmdbApiKey" eintragen.',"success"):(m==null?void 0:m.hint)==="looksV3"?E('Eingegebener Wert sieht wie ein v3 API Key aus. Dieser funktioniert hier nicht als Bearer. Bitte in config.json als "tmdbApiKey" eintragen oder v4 Bearer Token verwenden.',"error"):E("Token ung\xFCltig oder keine Berechtigung (401).","error")}catch{E("Pr\xFCfung fehlgeschlagen. Netzwerk/Browser-Konsole pr\xFCfen.","error")}}),f&&f.addEventListener("click",()=>{Promise.resolve().then(()=>(ce(),me)).then(h=>{var S;return(S=h.clearCache)==null?void 0:S.call(h)})}),u&&u.addEventListener("change",()=>{try{localStorage.setItem("prefReduceMotion",u.checked?"1":"0")}catch{}Mt(u.checked)}),b&&b.addEventListener("change",()=>{try{localStorage.setItem("useTmdb",b.checked?"1":"0")}catch{}b.checked&&!window.__tmdbHydrationStarted&&(window.__tmdbHydrationStarted=1,Promise.resolve().then(()=>(ce(),me)).then(h=>{var p;let S=y();(p=h.hydrateOptional)==null||p.call(h,S.movies,S.shows,S.cfg)}).catch(()=>{}),setTimeout(()=>{b.checked&&P(y().view)},1200),setTimeout(()=>{b.checked&&P(y().view)},3e3)),P(y().view),W()}),v&&v.addEventListener("click",()=>{let h=document.getElementById("search");h&&(h.value="");let S=document.getElementById("q");S&&(S.value="");let p=document.getElementById("onlyNew");p&&(p.checked=!1);let m=document.getElementById("yearFrom"),O=document.getElementById("yearTo");m&&(m.value=""),O&&(O.value="");let _t=document.getElementById("collectionFilter");_t&&(_t.value=""),document.querySelectorAll("#genreFilters .chip.active").forEach(We=>We.classList.remove("active"));let Ue=document.getElementById("genreFilters");Ue&&(Ue.dataset.state="empty",Ue.dataset.count="0"),Promise.resolve().then(()=>(qe(),kt)).then(We=>{let Fn=We.applyFilters();P(y().view),W(Fn)})})}function Mt(e){var t,n;try{let r=document.body;r?((t=document.documentElement)==null||t.classList.remove("reduce-motion","reduced-motion"),r.classList.remove("reduced-motion"),r.classList.toggle("reduce-motion",e)):((n=document.documentElement)==null||n.classList.toggle("reduce-motion",e),window.addEventListener("DOMContentLoaded",()=>Mt(e),{once:!0}))}catch{}}function Ho(){try{let e=localStorage.getItem("prefReduceMotion")==="1";Mt(e)}catch{}}function qo(){let e=document.getElementById("toggleAdvanced"),t=document.getElementById("advancedFilters");if(!e||!t)return;let n=!1,r=0,o=()=>{n=!1,r&&(clearTimeout(r),r=0),t.dataset.state==="closing"?(t.dataset.state="closed",t.hidden=!0,t.style.removeProperty("--advanced-max")):t.dataset.state==="open"?t.style.removeProperty("--advanced-max"):t.dataset.state==="expanding"&&(t.dataset.state="open",t.style.removeProperty("--advanced-max"))},a=()=>{r&&clearTimeout(r),r=window.setTimeout(o,320)};t.addEventListener("transitionend",c=>{c.target!==t||c.propertyName!=="max-height"||o()});let s=()=>{n||(n=!0,t.hidden=!1,t.dataset.state="expanding",t.setAttribute("aria-hidden","false"),t.style.setProperty("--advanced-max","0px"),requestAnimationFrame(()=>{let c=t.scrollHeight;t.style.setProperty("--advanced-max",c+"px"),t.dataset.state="open",a()}))},i=()=>{if(n)return;n=!0;let c=t.scrollHeight;t.style.setProperty("--advanced-max",c+"px"),t.dataset.state="closing",t.setAttribute("aria-hidden","true"),requestAnimationFrame(()=>{t.style.setProperty("--advanced-max","0px"),a()})};e.addEventListener("click",()=>{e.getAttribute("aria-expanded")==="true"?(e.setAttribute("aria-expanded","false"),i()):(e.setAttribute("aria-expanded","true"),s())})}function Ko(){let e=document.getElementById("siteLogo");e&&e.addEventListener("error",()=>{e.classList.add("logo-missing");let a=document.querySelector(".site-header__brand-text .site-header__label");a&&a.classList.remove("sr-only")});let t=document.getElementById("heroSubtitle"),n=["Offline st\xF6bern & Wunschlisten teilen","Filter. Finden. Freuen.","Filme & Serien \u2013 stressfrei sichtbar","Schneller als jeder SMB-Share","Merkliste zuerst, Streit sp\xE4ter"],r=0;t&&(t.textContent=n[r]);function o(){!t||t.dataset.taglinePaused==="1"||(t.classList.add("is-fading"),setTimeout(()=>{if(!t||t.dataset.taglinePaused==="1"){t&&t.classList.remove("is-fading");return}r=(r+1)%n.length,t.textContent=n[r],t.classList.remove("is-fading")},280))}t&&(t.dataset.taglinePaused="0",window.__taglineTicker||(window.__taglineTicker=setInterval(o,6e3),setTimeout(o,3e3)))}function zo(){let e=document.getElementById("scrollProgress");if(!e)return;let t=()=>{let n=document.documentElement.scrollTop||document.body.scrollTop||0,r=document.documentElement.scrollHeight-document.documentElement.clientHeight||1,o=Math.max(0,Math.min(100,n/r*100));e.style.width=o+"%"};addEventListener("scroll",t,{passive:!0}),t()}function Oo(){let e=document.getElementById("scrollTop");if(!e)return;let t=()=>{let n=window.scrollY||0;e.style.display=n>300?"block":"none"};addEventListener("scroll",t,{passive:!0}),t(),e.addEventListener("click",()=>window.scrollTo({top:0,behavior:"smooth"}))}
//# sourceMappingURL=main.js.map
