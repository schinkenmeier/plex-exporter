var Jn=Object.defineProperty;var j=(e,t)=>()=>(e&&(t=e(e=0)),t);var at=(e,t)=>{for(var n in t)Jn(e,n,{get:t[n],enumerable:!0})};function ie(e){Object.assign(st,e),Gn.forEach(t=>t(st))}var st,Gn,E,te=j(()=>{st={view:"movies",movies:[],shows:[],facets:{},filtered:[],cfg:{}},Gn=new Set,E=()=>st});function I(e,t,n){let r=document.createElement(e);return t&&(r.className=t),n!=null&&(r.textContent=n),r}var F,je=j(()=>{F=(e,t=document)=>t.querySelector(e)});function Gt(e,t,n=864e5){try{let r=ce+e,o={value:t,timestamp:Date.now(),ttl:n};localStorage.setItem(r,JSON.stringify(o)),Yn()}catch(r){if(r.name==="QuotaExceededError"){Zt();try{let o=ce+e,a={value:t,timestamp:Date.now(),ttl:n};localStorage.setItem(o,JSON.stringify(a))}catch{}}}}function Yt(e){try{let t=ce+e,n=localStorage.getItem(t);if(!n)return null;let r=JSON.parse(n),o=Date.now();return r.timestamp+r.ttl<o?(localStorage.removeItem(t),null):r.value}catch{return null}}function Xt(){try{Object.keys(localStorage).forEach(t=>{t.startsWith(ce)&&localStorage.removeItem(t)})}catch{}}function Ve(){try{let e=Object.keys(localStorage),t=Date.now(),n=0;e.forEach(r=>{if(r.startsWith(ce))try{let o=JSON.parse(localStorage.getItem(r));o.timestamp+o.ttl<t&&(localStorage.removeItem(r),n++)}catch{localStorage.removeItem(r),n++}}),n>0}catch{}}function lt(){try{let t=Object.keys(localStorage).filter(i=>i.startsWith(ce)),n=Date.now(),r=0,o=0,a=0;return t.forEach(i=>{let s=localStorage.getItem(i);r+=s.length*2;try{let c=JSON.parse(s);c.timestamp+c.ttl>=n?o++:a++}catch{a++}}),{totalEntries:t.length,validEntries:o,expiredEntries:a,totalSize:r,totalSizeMB:(r/1024/1024).toFixed(2)}}catch{return null}}function Yn(){try{let e=lt();e&&e.totalSize>5242880&&Zt(.3)}catch{}}function Zt(e=.3){try{let t=Object.keys(localStorage),n=[];t.forEach(o=>{if(o.startsWith(ce))try{let a=JSON.parse(localStorage.getItem(o));n.push({key:o,timestamp:a.timestamp})}catch{n.push({key:o,timestamp:0})}}),n.sort((o,a)=>o.timestamp-a.timestamp);let r=Math.ceil(n.length*e);for(let o=0;o<r;o++)localStorage.removeItem(n[o].key)}catch{}}var ce,Xn,dt=j(()=>{ce="plex_cache_";Xn=null;typeof window!="undefined"&&typeof window.document!="undefined"&&window===globalThis&&(Ve(),Xn=setInterval(Ve,5*60*1e3))});async function ut(e,t=2,n=!0){if(n){let o=Yt(e);if(o!==null)return o}let r=null;for(let o=0;o<=t;o++){try{let a=await fetch(e,{cache:"no-store"});if(a&&a.ok){let i=await a.json();return n&&i&&Gt(e,i,Zn),i}if(a&&a.status===404)return null;r=new Error(`HTTP ${a.status}: ${a.statusText}`)}catch(a){r=a}if(o<t){let a=Math.min(1e3*Math.pow(2,o),5e3);await new Promise(i=>setTimeout(i,a))}}return null}function nr(e){try{let t=document.getElementById(e);if(t&&t.textContent)return JSON.parse(t.textContent)}catch{}return null}function rr(e){try{let t=window.__PLEX_EXPORTER__;return(t&&Array.isArray(t[e])?t[e]:null)||null}catch{return null}}function or(e){try{return(Array.isArray(window[e])?window[e]:null)||null}catch{return null}}async function nn(e,t){let n=await ut(e);if(Array.isArray(n)&&n.length)return ve(t==null?void 0:t.label,`primary:${e}`),n;if(t!=null&&t.embedId){let r=nr(t.embedId);if(Array.isArray(r)&&r.length)return ve(t==null?void 0:t.label,`embedded:${t.embedId}`),r}if(t!=null&&t.exportKey){let r=rr(t.exportKey);if(Array.isArray(r)&&r.length)return ve(t==null?void 0:t.label,`globalBag:${t.exportKey}`),r}if(t!=null&&t.globalVar){let r=or(t.globalVar);if(Array.isArray(r)&&r.length)return ve(t==null?void 0:t.label,`window:${t.globalVar}`),r}for(let r of(t==null?void 0:t.altUrls)||[]){let o=await ut(r);if(Array.isArray(o)&&o.length)return ve(t==null?void 0:t.label,`alt:${r}`),o}return ve(t==null?void 0:t.label,"empty"),Array.isArray(n)?n:[]}function ar(e,t){let n=e==null?"":String(e).trim();if(!n)return"";if(n.startsWith("//")||n.startsWith("/")||tr.test(n))return n;let r=n.replace(/\\/g,"/"),o=t?t.endsWith("/")?t:`${t}/`:"",a=u=>u.split("/").map(b=>{if(!b)return"";try{return encodeURIComponent(decodeURIComponent(b))}catch{return encodeURIComponent(b)}}).join("/"),s=r.replace(/^\/+/,"").split("/"),c=[];for(let u of s)if(!(!u||u===".")){if(u===".."){c.length&&c.pop();continue}c.push(u)}let l=c.join("/");if(l.startsWith("data/"))return a(l);let d=c;if(o&&d.length){let u=o.replace(/\/+$/,"").split("/").pop();u&&d[0]===u&&(d=d.slice(1))}let f=d.join("/"),h=a(f);return`${o}${h}`}function rn(e,t){var o,a;if(!e||typeof e!="object")return e;let n=(a=(o=e.thumbFile)!=null?o:e.thumb)!=null?a:"",r=ar(n,t);if(r)e.thumbFile=r,e.thumb=r;else if(n){let i=String(n);e.thumbFile=i,e.thumb==null&&(e.thumb=i)}return e}function sr(e){return rn(e,Qn)}function U(e){return rn(e,er)}function on(e){return!e||typeof e!="object"||(U(e),Array.isArray(e.seasons)&&e.seasons.forEach(an)),e}function an(e){return!e||typeof e!="object"||(U(e),Array.isArray(e.episodes)&&e.episodes.forEach(t=>U(t))),e}function ir(e){return Array.isArray(e)?(e.forEach(t=>{t&&typeof t=="object"&&sr(t)}),e):[]}function cr(e){return Array.isArray(e)?(e.forEach(t=>{t&&typeof t=="object"&&on(t)}),e):[]}async function ft(){try{let e=await nn("data/movies/movies.json",{label:"movies",embedId:"movies-json",exportKey:"movies",globalVar:"__PLEX_MOVIES__",altUrls:["movies/movies.json","data/movies.json","Filme/movies.json","movies.json"]});return re.movies=0,ir(e)}catch(e){if(re.movies<tn)return re.movies++,await new Promise(t=>setTimeout(t,1e3*re.movies)),ft();throw e}}async function ht(){try{let e=await nn("data/series/series_index.json",{label:"shows",embedId:"series-json",exportKey:"shows",globalVar:"__PLEX_SHOWS__",altUrls:["series/series_index.json","data/shows.json","data/series.json","Serien/series.json","series/series.json","series.json","shows.json"]});return re.shows=0,cr(e)}catch(e){if(re.shows<tn)return re.shows++,await new Promise(t=>setTimeout(t,1e3*re.shows)),ht();throw e}}async function sn(e){if(!e)return null;let t=lr(e),n=dr(t);if(n!==void 0)return n;let r=ur(e),o=null;for(let a of r)try{let i=await ut(a);if(i&&typeof i=="object"){let s=fr(i);return Qt(t,s,e),ln(s)}}catch(i){o=i}return Qt(t,null,e),null}function ve(e,t){if(e)try{en[e]=t}catch{}}function cn(){return{...en}}function lr(e){let t=[];(e==null?void 0:e.ratingKey)!==void 0&&(e==null?void 0:e.ratingKey)!==null&&(e==null?void 0:e.ratingKey)!==""&&t.push(`rk:${String(e.ratingKey)}`);let n=Ue(e==null?void 0:e.href);return n&&t.push(`href:${n}`),t}function Ue(e){return e?String(e).trim().replace(/^\.\//,"").replace(/^\/+/,""):""}function dr(e){for(let t of e)if(le.has(t)){let n=le.get(t);return n?ln(n):null}}function Qt(e,t,n){let r=t;e.forEach(c=>{le.set(c,r)});let o=n==null?void 0:n.ratingKey;o!=null&&le.set(`rk:${String(o)}`,r);let a=t&&typeof t=="object"?t.ratingKey:void 0;a!=null&&le.set(`rk:${String(a)}`,r);let i=Ue(n==null?void 0:n.href);i&&le.set(`href:${i}`,r);let s=t&&typeof t=="object"?Ue(t.href):"";s&&le.set(`href:${s}`,r)}function ur(e){let t=new Set,n=Ue(e==null?void 0:e.href);if(n)if(/^https?:/i.test(n))t.add(n);else{n.startsWith("data/")?t.add(n):t.add(`data/${n}`);let o=n.replace(/^data\//,"");o.startsWith("series/")||t.add(`data/series/${o}`);let a=o.replace(/^series\//,"").replace(/^details\//,"").replace(/\.json$/,"");a&&t.add(`data/series/details/${a}.json`)}let r=e==null?void 0:e.ratingKey;return r!=null&&t.add(`data/series/details/${String(r)}.json`),Array.from(t)}function fr(e){if(!e||typeof e!="object")return null;let t={...e};U(t),t.genres=gt(t.genres);let n=pr(t.cast||t.roles||[]);return t.cast=n,t.roles=n,t.seasons=Array.isArray(t.seasons)?t.seasons.map(hr).filter(Boolean):[],t.seasonCount=Number.isFinite(t.seasonCount)?t.seasonCount:t.seasons.length,on(t),t}function hr(e){if(!e||typeof e!="object")return null;let t={...e};return U(t),t.genres=gt(t.genres),t.episodes=Array.isArray(t.episodes)?t.episodes.map(gr).filter(Boolean):[],an(t),t}function gr(e){if(!e||typeof e!="object")return null;let t={...e};return U(t),t.genres=gt(t.genres),t}function gt(e){if(!Array.isArray(e))return[];let t=new Set,n=[];return e.forEach(r=>{let o=null;if(typeof r=="string"){let a=r.trim();a&&(o={tag:a})}else if(r&&typeof r=="object"){let a=String(r.tag||r.title||r.name||r.label||"").trim();a&&(o={...r,tag:a})}o&&!t.has(o.tag)&&(t.add(o.tag),n.push(o))}),n}function pr(e){return Array.isArray(e)?e.map(t=>{if(!t)return null;if(typeof t=="string"){let n=t.trim();return n?{tag:n}:null}if(typeof t=="object"){let n=String(t.tag||t.name||t.role||"").trim();return n?{...t,tag:n}:{...t}}return null}).filter(Boolean):[]}function ln(e){if(e==null)return e;try{return structuredClone(e)}catch{}try{return JSON.parse(JSON.stringify(e))}catch{}return e}var en,le,re,tn,Zn,Qn,er,tr,ye=j(()=>{dt();en={movies:null,shows:null},le=new Map,re={movies:0,shows:0},tn=3,Zn=1e3*60*30,Qn="data/movies/",er="data/series/",tr=/^[a-z][a-z0-9+.-]*:/i});function de(e){let t=new Set,n=[];return(e||[]).forEach(r=>{let o="";typeof r=="string"?o=r:r&&typeof r=="object"&&(o=r.tag||r.title||r.name||"");let a=String(o||"").trim();a&&!t.has(a)&&(t.add(a),n.push(a))}),n}function pt(e,t,n=3){if(!e)return;let r=(t||[]).filter(Boolean);if(r.length>n){let o=r.slice(0,n),a=r.slice(n),i=o.map(c=>We(c)),s=We(`+ ${a.length}`);s.classList.add("more","card__chip--more"),s.setAttribute("data-more",a.length),s.setAttribute("title",`${a.length} weitere Genres: ${a.join(", ")}`),s._extraChips=a.map(c=>We(c)),i.push(s),e.replaceChildren(...i)}else{let o=r.map(a=>We(a));e.replaceChildren(...o)}mr(e)}function mr(e=document){try{e.querySelectorAll(".chip.more, .card__chip--more").forEach(t=>{t.dataset.bound||(t.dataset.bound="1",t.addEventListener("click",n=>{n.stopPropagation();let r=t.closest(".card");if(r)r.click();else{let o=t._extraChips||[];try{o.forEach(a=>t.before(a))}catch{}t.remove()}}))})}catch{}}function Y(e){return e!=null&&e.year?e.year:e!=null&&e.originallyAvailableAt?String(e.originallyAvailableAt).slice(0,4):""}function W(e){if(e instanceof Number)return W(e.valueOf());if(typeof e=="number")return Number.isFinite(e)?e.toFixed(1):"0.0";if(typeof e=="string"){let t=e.trim();if(!t)return"0.0";let n=Number(t);return Number.isFinite(n)?n.toFixed(1):"0.0"}return"0.0"}function We(e){let t=document.createElement("span");return t.className="chip",t.textContent=String(e||""),t}function Je(e){if(!(e!=null&&e.addedAt))return!1;let t=new Date(e.addedAt).getTime();if(!Number.isFinite(t))return!1;let n=E().cfg||{},r=Number(n.newDays||30);return Date.now()-t<=r*24*60*60*1e3}function ue(){try{return localStorage.getItem("useTmdb")==="1"}catch{return!1}}var Le=j(()=>{te()});function vr(){try{X=new Set(JSON.parse(localStorage.getItem(fn)||"[]"))}catch{X=new Set}}function hn(){try{localStorage.setItem(fn,JSON.stringify(Array.from(X.values())))}catch{}}function mt(e){var r,o;if(!e)return"";let t=e.type==="tv"||e.libraryType==="show"?"show":"movie",n=((r=e.ids)==null?void 0:r.imdb)||((o=e.ids)==null?void 0:o.tmdb)||String(e.ratingKey||"");return n?`${t}:${n}`:""}function gn(e){return X.has(mt(e))}function yr(){return X.size}function vt(e){let t=mt(e);if(!t)return;X.has(t)?X.delete(t):X.add(t),hn(),yt();let n=document.getElementById("watchlistPanel");n&&!n.hidden&&Ge()}function yt(){let e=document.getElementById("watchlistCount");e&&(e.textContent=String(yr()))}function dn(){let e=document.getElementById("watchlistPanel");e&&(e.hidden=!1,e.setAttribute("aria-hidden","false"),Ge(),document.dispatchEvent(new CustomEvent("watchlist:open")))}function un(){let e=document.getElementById("watchlistPanel");e&&(e.hidden=!0,e.setAttribute("aria-hidden","true"),document.dispatchEvent(new CustomEvent("watchlist:close"))),bt(!1)}function wr(){X.clear(),hn(),yt(),Ge()}function Er(){let e=pn(),t=JSON.stringify(e,null,2),n=new Blob([t],{type:"application/json"}),r=document.createElement("a");r.href=URL.createObjectURL(n),r.download="watchlist.json",document.body.append(r),r.click(),r.remove(),setTimeout(()=>URL.revokeObjectURL(r.href),1e3)}function pn(){let e=E(),t=(e.movies||[]).concat(e.shows||[]),n=new Map(t.map(r=>[mt(r),r]));return Array.from(X.values()).map(r=>n.get(r)).filter(Boolean)}function Ge(){let e=document.getElementById("watchlistItems"),t=document.getElementById("watchlistEmpty");if(!e||!t)return;let n=pn();if(n.length===0){e.replaceChildren(),t.hidden=!1;return}t.hidden=!0;let r=document.createDocumentFragment();n.forEach(o=>{let a=document.createElement("li");a.className="watchlist-item";let i=document.createElement("span");i.className="title",i.textContent=o.title||"";let s=document.createElement("button");s.textContent="Entfernen",s.addEventListener("click",()=>{vt(o),Ge()});let c=document.createElement("button");c.textContent="\xD6ffnen",c.addEventListener("click",()=>{var f,h;let l=o.type==="tv"?"show":"movie",d=((f=o.ids)==null?void 0:f.imdb)||((h=o.ids)==null?void 0:h.tmdb)||String(o.ratingKey||"");d&&(location.hash=`#/${l}/${d}`)}),a.append(i,c,s),r.append(a)}),e.replaceChildren(r)}function bn(){vr(),yt();let e=document.getElementById("openWatchlist"),t=document.getElementById("watchlistToggle"),n=document.getElementById("closeWatchlist"),r=document.getElementById("clearWatchlist"),o=document.getElementById("exportWatchlist");e&&e.addEventListener("click",()=>{dn(),bt(!0)}),t&&t.addEventListener("click",()=>{let a=document.getElementById("watchlistPanel");a&&!a.hidden?un():(dn(),bt(!0))}),n&&n.addEventListener("click",()=>{un()}),r&&r.addEventListener("click",()=>{wr()}),o&&o.addEventListener("click",()=>{Er()})}function bt(e){let t=document.getElementById("watchlistToggle");t&&t.setAttribute("aria-expanded",e?"true":"false")}var fn,X,wt=j(()=>{te();fn="watchlist:v1",X=new Set});function vn(e,t){let n=Sr(e,t);if(!n)return;let r=Array.isArray(e)&&!Et(e)?e||[]:Array.isArray(t)?t:[];n.replaceChildren(),(r||[]).forEach((o,a)=>n.append(Ar(o,a)))}function Et(e){return e instanceof Element||typeof e=="string"}function Sr(e,t){if(Et(e)){if(e instanceof Element)return e;if(typeof e=="string")return document.querySelector(e)}if(Et(t)){if(t instanceof Element)return t;if(typeof t=="string")return document.querySelector(t)}return document.getElementById("seasonsAccordion")}function Ar(e,t){U(e);let n=document.createElement("article");n.className="season-card";let r=document.createElement("div");r.className="season-head";let o=document.createElement("div");o.className="season-thumb";let a=new Image;a.loading="lazy",a.decoding="async",a.src=e.thumbFile||"",a.alt=e.title||`Staffel ${e.seasonNumber||t+1}`,o.append(a);let i=document.createElement("div"),s=document.createElement("div");s.className="season-title",s.textContent=e.title||`Staffel ${e.seasonNumber||t+1}`;let c=document.createElement("div");c.className="season-sub";let l=e.year||e.releaseYear||"",d=Array.isArray(e.episodes)?e.episodes.length:e.episodeCount||0;c.textContent=[l,d?`${d} Episoden`:""].filter(Boolean).join(" \u2022 "),i.append(s,c);let f=document.createElement("div");f.className="chev",f.textContent="\u203A",r.append(o,i,f);let h=document.createElement("div");return h.className="season-body",(e.episodes||[]).forEach(u=>{U(u),h.append(kr(u))}),r.addEventListener("click",()=>n.classList.toggle("open")),n.append(r,h),n}function kr(e){var h;let t=document.createElement("div");t.className="episode";let n=document.createElement("div");n.className="ep-title";let r=e.seasonNumber!=null?Number(e.seasonNumber):null,o=e.episodeNumber!=null?Number(e.episodeNumber):null,a=e.seasonEpisode&&String(e.seasonEpisode).toUpperCase()||(Number.isFinite(r)&&Number.isFinite(o)?`S${String(r).padStart(2,"0")}E${String(o).padStart(2,"0")}`:"");n.textContent=`${a?a+" \u2022 ":""}${e.title||""}`;let i=document.createElement("div");i.className="badges";let s=Number((h=e.audienceRating)!=null?h:e.rating);if(Number.isFinite(s)){let u=document.createElement("span");u.className="badge",u.textContent=`${s.toFixed(1)}`,i.append(u)}let c=document.createElement("div");c.className="ep-meta";let l=e.durationMin||(e.duration?Math.round(Number(e.duration)/6e4):null),d=e.durationHuman||(l?`${l} min`:null),f=e.originallyAvailableAt||e.date||"";return c.textContent=[d,f].filter(Boolean).join(" \u2022 "),t.append(n,i,c),t}var yn=j(()=>{ye()});function Ne(e){if(e==null||typeof e!="object")return e;if(typeof structuredClone=="function")try{return structuredClone(e)}catch{}try{return JSON.parse(JSON.stringify(e))}catch{}if(Array.isArray(e))return e.map(n=>Ne(n));let t={};for(let n of Object.keys(e))t[n]=Ne(e[n]);return t}function Ye(e){if(!e||typeof e!="object")return null;let t=Ne(e);return t.type==="show"&&(t.type="tv"),t.type||(t.type="movie"),t}function Xe(e){if(!e||typeof e!="object")return null;let t=Ne(e);return t.type!=="tv"&&(t.type="tv"),St(t),t}function xr(e){if(!e||typeof e!="object")return null;let t=Ne(e);return St(t),t}function wn(e){let t=Array.isArray(e==null?void 0:e.seasons)?e.seasons:[],n=t.some(o=>Array.isArray(o==null?void 0:o.episodes)&&o.episodes.length),r=Array.isArray(e==null?void 0:e.cast)?e.cast:Array.isArray(e==null?void 0:e.roles)?e.roles:[];return!t.length||!n||!r.length}function En(e,t){if(!e)return e;if(t&&typeof t=="object"){let n=xr(t);Object.assign(e,n)}return St(e),e}function St(e){if(!e||typeof e!="object")return;At(e),e.genres=kt(e.genres);let t=Ir(e.cast||e.roles||[]);e.cast=t,e.roles=t,e.seasons=Array.isArray(e.seasons)?e.seasons.map(Cr).filter(Boolean):[];let n=Number(e.seasonCount);e.seasonCount=Number.isFinite(n)&&n>0?n:e.seasons.length}function Cr(e){if(!e||typeof e!="object")return null;let t={...e};return At(t),t.genres=kt(t.genres),t.episodes=Array.isArray(t.episodes)?t.episodes.map(Tr).filter(Boolean):[],t}function Tr(e){if(!e||typeof e!="object")return null;let t={...e};return At(t),t.genres=kt(t.genres),t}function At(e){U(e)}function kt(e){if(!Array.isArray(e))return[];let t=new Set,n=[];return e.forEach(r=>{let o=null;if(typeof r=="string"){let a=r.trim();a&&(o={tag:a})}else if(r&&typeof r=="object"){let a=String(r.tag||r.title||r.name||r.label||"").trim();a&&(o={...r,tag:a})}o&&!t.has(o.tag)&&(t.add(o.tag),n.push(o))}),n}function Ir(e){return Array.isArray(e)?e.map(t=>{if(!t)return null;if(typeof t=="string"){let n=t.trim();return n?{tag:n}:null}if(typeof t=="object"){let n=String(t.tag||t.name||t.role||"").trim();return n?{...t,tag:n}:{...t}}return null}).filter(Boolean):[]}var Sn=j(()=>{ye()});function _r(){if(q)return q;let e=document.getElementById("modal-root-v2");if(!e)return null;if(Z=e,e.classList.add("modalv2-overlay"),e.hasAttribute("hidden")||e.setAttribute("hidden",""),e.dataset.modalv2Ready||(e.innerHTML=`
      <div class="modalv2-backdrop" data-modalv2-backdrop="1"></div>
      <div class="modalv2-dialog" role="dialog" aria-modal="true">
        <div class="modalv2-scroll" data-modalv2-scroll></div>
      </div>
    `,e.dataset.modalv2Ready="1",e.addEventListener("click",Mr)),H=e.querySelector(".modalv2-dialog"),H&&!H.hasAttribute("tabindex")&&H.setAttribute("tabindex","-1"),ae=e.querySelector("[data-modalv2-scroll]"),ae&&!q){let t=ae.querySelector(".modalv2");t?q=t:(q=document.createElement("div"),q.className="modalv2",q.setAttribute("hidden",""),ae.appendChild(q))}return q}function Mr(e){if(!Z)return;let t=e.target;(t===Z||t&&t.dataset&&t.dataset.modalv2Backdrop)&&Ct()}function kn(){return H?Array.from(H.querySelectorAll('a[href], button:not([disabled]), textarea, input, select, [tabindex]:not([tabindex="-1"])')).filter(t=>t.hasAttribute("disabled")||t.getAttribute("aria-hidden")==="true"||t.hasAttribute("hidden")?!1:t.offsetParent!==null):[]}function Hr(){H&&(he&&H.removeEventListener("keydown",he),he=e=>{if(e.key!=="Tab")return;let t=kn();if(!t.length)return;let n=t[0],r=t[t.length-1];e.shiftKey?document.activeElement===n&&(e.preventDefault(),r.focus()):document.activeElement===r&&(e.preventDefault(),n.focus())},H.addEventListener("keydown",he))}function Dr(){!H||!he||(H.removeEventListener("keydown",he),he=null)}function Rr(){Ee||(Ee=e=>{e.key==="Escape"&&(e.preventDefault(),Ct())},window.addEventListener("keydown",Ee))}function $r(){Ee&&(window.removeEventListener("keydown",Ee),Ee=null)}function Ze(){let e=_r();return!e||!Z?null:(Z.hidden=!1,Z.setAttribute("aria-hidden","false"),document.body.classList.add("modalv2-open"),ae&&(ae.scrollTop=0),Hr(),Rr(),document.dispatchEvent(new CustomEvent("modal:open")),e)}function xt(){if(!H)return;let e=H.querySelector("#v2Close"),t=kn(),n=e&&!e.hasAttribute("hidden")?e:t[0];if(n||(n=H),n){let r=()=>{try{n.focus()}catch{}};(window.requestAnimationFrame||setTimeout)(r,0)}}function Pr(e){var r;let t=((r=e==null?void 0:e.tmdb)==null?void 0:r.poster)||(e==null?void 0:e.tmdbPoster),n=(e==null?void 0:e.poster)||(e==null?void 0:e.thumbFile)||(e==null?void 0:e.art)||"";return ue()&&t?t:n}function xn(e){let t=(e==null?void 0:e.runtimeMin)||(e==null?void 0:e.durationMin)||(e!=null&&e.duration?Math.round(Number(e.duration)/6e4):null);return Number.isFinite(t)?(e==null?void 0:e.type)==="tv"?`~${t} min/Ep`:`${t} min`:""}function Or(e){var n;let t=Number((n=e==null?void 0:e.rating)!=null?n:e==null?void 0:e.audienceRating);return Number.isFinite(t)?`\u2605 ${W(t)}`:""}function Cn(e){return(e==null?void 0:e.studio)||(e==null?void 0:e.network)||(e==null?void 0:e.studioName)||""}function jr(e){let t=[e==null?void 0:e.originallyAvailableAt,e==null?void 0:e.releaseDate,e==null?void 0:e.premiereDate,e==null?void 0:e.firstAired,e==null?void 0:e.airDate];for(let r of t){let o=r==null?"":String(r).trim();if(!o)continue;let a=new Date(o);if(Number.isFinite(a.getTime()))try{return a.toLocaleDateString("de-DE",{year:"numeric",month:"2-digit",day:"2-digit"})}catch{}let i=o.match(/^\d{4}-\d{2}-\d{2}/);if(i&&i[0])return i[0];if(o.length>=4)return o.slice(0,10)}let n=Y(e);return n?String(n):""}function fe(e){return Array.isArray(e)?e.map(t=>t?typeof t=="string"?t:t.tag||t.title||t.name||"":"").filter(Boolean):[]}function qr(e){let n=(Array.isArray(e==null?void 0:e.genres)?e.genres:[]).map(r=>r?typeof r=="string"?r:r.tag||r.title||r.name||"":"").filter(Boolean);return Array.from(new Set(n))}function zr(e){let t=[];return Je(e)&&t.push("Neu"),(e==null?void 0:e.type)==="tv"&&Number.isFinite(Number(e==null?void 0:e.seasonCount))&&t.push(`Staffeln: ${e.seasonCount}`),((e==null?void 0:e.genres)||[]).map(r=>r?typeof r=="string"?r:r.tag||r.title||r.name||"":"").filter(Boolean).forEach(r=>t.push(r)),t}function Kr(e){return(Array.isArray(e==null?void 0:e.cast)?e.cast:Array.isArray(e==null?void 0:e.roles)?e.roles:[]).map(n=>{var s,c,l;if(!n)return null;if(typeof n=="string"){let d=String(n).trim();return d?{name:d,role:"",thumb:"",tmdbProfile:"",raw:null}:null}let r=String(n.tag||n.name||n.role||"").trim();if(!r)return null;let o=(()=>{let d=String(n.role||"").trim();return d?d.toLowerCase()===r.toLowerCase()?"":d:""})(),a=[(s=n==null?void 0:n.tmdb)==null?void 0:s.profile,(c=n==null?void 0:n.tmdb)==null?void 0:c.profile_path,(l=n==null?void 0:n.tmdb)==null?void 0:l.profilePath,n==null?void 0:n.tmdbProfile,n==null?void 0:n.profile,n==null?void 0:n.profile_path,n==null?void 0:n.profilePath].find(d=>typeof d=="string"&&d.trim()),i=[n==null?void 0:n.thumb,n==null?void 0:n.photo,n==null?void 0:n.image].find(d=>typeof d=="string"&&d.trim())||"";return{name:r,role:o,thumb:i,tmdbProfile:a?String(a).trim():"",raw:n}}).filter(Boolean)}function Vr(e){let t=String(e||"").trim();if(!t)return"";if(/^https?:\/\//i.test(t))return t;if(t.startsWith("//"))return`https:${t}`;let n=t.startsWith("/")?t:`/${t}`;return`${Lr}${Nr}${n}`}function Ur(e){let t=String(e||"").trim();return t?/^https?:\/\//i.test(t)||t.startsWith("data:")?t:t.startsWith("//")?`https:${t}`:t:""}function Wr(e,t){var o,a,i;if(!e)return"";let n=e.raw||{};if(t){let s=[e.tmdbProfile,(o=n==null?void 0:n.tmdb)==null?void 0:o.profile,(a=n==null?void 0:n.tmdb)==null?void 0:a.profile_path,(i=n==null?void 0:n.tmdb)==null?void 0:i.profilePath,n==null?void 0:n.tmdbProfile,n==null?void 0:n.profile,n==null?void 0:n.profile_path,n==null?void 0:n.profilePath];for(let c of s){let l=Vr(c);if(l)return l}}let r=[e.thumb,n==null?void 0:n.thumb,n==null?void 0:n.photo,n==null?void 0:n.image];for(let s of r){let c=Ur(s);if(c)return c}return""}function Jr(e){let t=String(e||"").trim();if(!t)return"?";let r=t.split(/\s+/).slice(0,2).map(o=>o.charAt(0)).filter(Boolean);return r.length?r.join("").toUpperCase():t.charAt(0).toUpperCase()}function Gr(e){let t=e.querySelector(".v2-tabs");if(!t)return;let n=Array.from(t.querySelectorAll("button[data-t]")),r=i=>{n.forEach(s=>{let c=s.dataset.t===i;s.classList.toggle("active",c),s.setAttribute("aria-selected",c?"true":"false"),s.tabIndex=c?0:-1;let l=e.querySelector(`.v2-pane[data-pane="${s.dataset.t}"]`);l&&(l.hidden=!c,l.setAttribute("aria-hidden",l.hidden?"true":"false"))})},o=(i,s)=>{if(!n.length)return;let c=n.indexOf(i),l=s>0?0:n.length-1,d=c===-1?l:(c+s+n.length)%n.length,f=n[d];f&&(f.focus(),r(f.dataset.t))};t.addEventListener("click",i=>{let s=i.target.closest("button[data-t]");s&&(i.preventDefault(),r(s.dataset.t))}),t.addEventListener("keydown",i=>{let s=i.target.closest("button[data-t]");if(s)switch(i.key){case"ArrowLeft":case"ArrowUp":i.preventDefault(),o(s,-1);break;case"ArrowRight":case"ArrowDown":i.preventDefault(),o(s,1);break;case"Home":i.preventDefault(),n[0]&&(n[0].focus(),r(n[0].dataset.t));break;case"End":if(i.preventDefault(),n.length){let c=n[n.length-1];c.focus(),r(c.dataset.t)}break;default:break}});let a=n.find(i=>i.classList.contains("active"))||n[0];a&&r(a.dataset.t)}function Yr(e,t){let n=e.querySelector(".v2-cast");if(!n)return;n.innerHTML='<div class="v2-cast-scroll"></div>';let r=n.querySelector(".v2-cast-scroll");if(!r)return;let o=Array.isArray(t)?t.slice(0,12):[];if(!o.length){r.innerHTML='<span class="modalv2-loading">Keine Besetzungsdaten verf\xFCgbar.</span>',r.removeAttribute("role");return}r.setAttribute("role","list");let a=ue();o.forEach(i=>{let s=i&&typeof i=="object"&&"name"in i?i:(()=>{let u=String(i||"").trim();return u?{name:u,role:"",thumb:"",tmdbProfile:"",raw:null}:null})();if(!s||!s.name)return;let c=document.createElement("article");c.className="v2-cast-card",c.tabIndex=0,c.setAttribute("role","listitem");let l=String(s.role||"").trim();c.setAttribute("aria-label",l?`${s.name} \u2013 ${l}`:s.name);let d=document.createElement("div");d.className="v2-cast-avatar";let f=Wr(s,a);if(f){d.classList.add("has-image");let u=document.createElement("img");u.src=f,u.alt=s.name,u.loading="lazy",u.decoding="async",d.appendChild(u)}else{let u=document.createElement("span");u.className="v2-cast-initials",u.textContent=Jr(s.name),u.setAttribute("aria-hidden","true"),d.appendChild(u)}let h=document.createElement("p");if(h.className="v2-cast-name",h.textContent=s.name,c.append(d,h),l){let u=document.createElement("p");u.className="v2-cast-role",u.textContent=l,c.append(u)}else c.classList.add("v2-cast-card--no-role");r.appendChild(c)}),r.children.length||(r.innerHTML='<span class="modalv2-loading">Keine Besetzungsdaten verf\xFCgbar.</span>',r.removeAttribute("role"))}function Xr(e,t){let n=e.querySelector(".v2-overview");if(!n)return;let r=typeof t=="string"?t:"";if(!r){n.textContent="";return}let o=document.createElement("p");o.className="v2-overview-text line-clamp line-clamp-5",o.textContent=r;let a=document.createElement("button");a.type="button",a.className="v2-overview-toggle";let i=l=>{o.classList.toggle("is-expanded",l),a.setAttribute("aria-expanded",String(l)),a.textContent=l?"Weniger anzeigen":"Mehr anzeigen"};a.addEventListener("click",()=>{let l=a.getAttribute("aria-expanded")==="true";i(!l)}),n.replaceChildren(o,a),i(!1),(typeof requestAnimationFrame=="function"?requestAnimationFrame:l=>setTimeout(l,0))(()=>{o.scrollHeight>o.clientHeight+1||(o.classList.add("is-expanded"),a.hidden=!0)})}function Zr(e,t){let n=e.querySelector(".v2-details");if(!n)return;n.replaceChildren();let r=document.createElement("div");r.className="v2-details-grid";let o=[],a=jr(t);a&&o.push(["Ver\xF6ffentlichung",a]);let i=xn(t);i&&o.push(["Laufzeit",i]);let s=Cn(t);s&&o.push(["Studio",s]);let c=((t==null?void 0:t.contentRating)||"").trim();c&&o.push(["Freigabe",c]);let l=w=>{if(w instanceof Number)return l(w.valueOf());if(typeof w=="number")return Number.isFinite(w)?W(w):"";if(typeof w=="string"){let N=w.trim();if(!N)return"";let T=Number(N);return Number.isFinite(T)?W(T):""}return""},d=l(t==null?void 0:t.rating),f=l(t==null?void 0:t.audienceRating),h=l(t==null?void 0:t.userRating);if(d?(o.push(["Bewertung",`\u2605 ${d}`]),f&&f!==d&&o.push(["Publikum",`\u2605 ${f}`])):f&&o.push(["Bewertung",`\u2605 ${f}`]),h&&o.push(["Eigene Wertung",`\u2605 ${h}`]),(t==null?void 0:t.type)==="tv"){let w=Number(t==null?void 0:t.seasonCount),N=Number.isFinite(w)?w:Array.isArray(t==null?void 0:t.seasons)?t.seasons.length:null;Number.isFinite(N)&&N>0&&o.push(["Staffeln",String(N)]);let T=Array.isArray(t==null?void 0:t.seasons)?t.seasons.reduce((_,B)=>{if(!B)return _;let O=Array.isArray(B.episodes)?B.episodes.length:0;return _+(Number.isFinite(O)?O:0)},0):null;Number.isFinite(T)&&T>0&&o.push(["Episoden",String(T)])}let u=fe(t==null?void 0:t.countries);u.length&&o.push(["L\xE4nder",u.join(", ")]);let b=fe(t==null?void 0:t.collections);b.length&&o.push(["Sammlungen",b.join(", ")]);let v=fe(t==null?void 0:t.labels);if(v.length&&o.push(["Labels",v.join(", ")]),t!=null&&t.editionTitle&&o.push(["Edition",t.editionTitle]),t!=null&&t.originalTitle&&t.originalTitle!==t.title&&o.push(["Originaltitel",t.originalTitle]),o.length){let w=document.createElement("section");w.className="v2-details-section",w.dataset.section="general";let N=document.createElement("h3");N.className="v2-details-heading",N.textContent="Allgemein";let T=document.createElement("dl");T.className="v2-details-list",o.forEach(([_,B])=>{if(!_||!B)return;let O=document.createElement("dt");O.textContent=_;let A=document.createElement("dd");A.textContent=B,T.append(O,A)}),T.childElementCount&&(w.append(N,T),r.append(w))}let x=qr(t);if(x.length){let w=document.createElement("section");w.className="v2-details-section",w.dataset.section="genres";let N=document.createElement("h3");N.className="v2-details-heading",N.textContent="Genres";let T=document.createElement("div");T.className="v2-chip-group",x.forEach(_=>{let B=document.createElement("span");B.className="chip",B.textContent=_,T.appendChild(B)}),w.append(N,T),r.append(w)}let C=[],P=fe(t==null?void 0:t.directors);P.length&&C.push(["Regie",P.join(", ")]);let D=fe(t==null?void 0:t.writers);D.length&&C.push(["Drehbuch",D.join(", ")]);let $=fe(t==null?void 0:t.producers);$.length&&C.push(["Produktion",$.join(", ")]);let be=fe((t==null?void 0:t.creators)||(t==null?void 0:t.showrunners));if((t==null?void 0:t.type)==="tv"&&be.length&&C.push(["Creator",be.join(", ")]),C.length){let w=document.createElement("section");w.className="v2-details-section",w.dataset.section="crew";let N=document.createElement("h3");N.className="v2-details-heading",N.textContent="Credits";let T=document.createElement("dl");T.className="v2-details-list",C.forEach(([_,B])=>{if(!_||!B)return;let O=document.createElement("dt");O.textContent=_;let A=document.createElement("dd");A.textContent=B,T.append(O,A)}),T.childElementCount&&(w.append(N,T),r.append(w))}if(r.childElementCount)n.appendChild(r);else{let w=document.createElement("p");w.className="v2-details-empty",w.textContent="Keine zus\xE4tzlichen Details verf\xFCgbar.",n.appendChild(w)}}function Qr(e,t){let n=e.querySelector(".v2-seasons");if(!n)return;let r=Array.isArray(t==null?void 0:t.seasons)?t.seasons:[];if(!r.length){n.innerHTML='<p class="modalv2-loading">Keine Staffel-Informationen verf\xFCgbar.</p>';return}n.innerHTML="",vn(n,r)}function eo(e,t){var l,d;let n=e.querySelector("#v2Tmdb"),r=e.querySelector("#v2Imdb"),o=e.querySelector("#v2Trailer"),a=((l=t==null?void 0:t.ids)==null?void 0:l.tmdb)||(t==null?void 0:t.tmdbId),i=((d=t==null?void 0:t.ids)==null?void 0:d.imdb)||(t==null?void 0:t.imdbId),s=(t==null?void 0:t.trailer)||(t==null?void 0:t.trailerUrl),c=(t==null?void 0:t.type)==="tv"?"tv":"movie";n&&(a?(n.hidden=!1,n.href=`https://www.themoviedb.org/${c}/${a}`):(n.hidden=!0,n.removeAttribute("href"))),r&&(i?(r.hidden=!1,r.href=`https://www.imdb.com/title/${i}/`):(r.hidden=!0,r.removeAttribute("href"))),o&&(s?(o.hidden=!1,o.onclick=()=>window.open(s,"_blank","noopener")):(o.hidden=!0,o.onclick=null))}function to(e,t){let n=e.querySelector(".v2-title");n&&(n.textContent=(t==null?void 0:t.title)||(t==null?void 0:t.name)||"");let r=((t==null?void 0:t.tagline)||"").trim(),o=e.querySelector(".v2-meta"),a=e.querySelector(".v2-subline"),i=Y(t),s=xn(t),c=Or(t),l=Cn(t),d=[i,s,c,l].filter(Boolean);if(a){let v=d.join(" \u2022 ");a.textContent=r||v,a.hidden=!(r||v)}o&&(o.textContent=r&&d.length?d.join(" \u2022 "):"",o.hidden=!(r&&d.length));let f=e.querySelector(".v2-chips");f&&(f.replaceChildren(),zr(t).forEach(v=>{let x=document.createElement("span");x.className="chip",x.textContent=v,f.appendChild(x)}),f.hidden=!f.childElementCount);let h=e.querySelector(".v2-facts"),u=e.querySelector(".v2-facts-list");if(h&&u){let v=[];i&&v.push(["Jahr",i]);let x=((t==null?void 0:t.contentRating)||"").trim();x&&v.push(["Freigabe",x]),s&&v.push(["Laufzeit",s]),c&&v.push(["Bewertung",c]),l&&v.push(["Studio",l]),u.replaceChildren(),v.forEach(([C,P])=>{let D=document.createElement("dt");D.textContent=C;let $=document.createElement("dd");$.textContent=P,u.append(D,$)}),h.hidden=!v.length}let b=e.querySelector(".v2-poster img");if(b){let v=Pr(t);b.src=v||"",b.alt=t!=null&&t.title?`Poster: ${t.title}`:"",b.loading="lazy",b.decoding="async",b.classList.remove("is-ready"),v?(b.addEventListener("load",An,{once:!0}),b.addEventListener("error",An,{once:!0})):b.classList.add("is-ready")}}function An(e){var t;(t=e.currentTarget)==null||t.classList.add("is-ready")}function no(e="Details werden geladen \u2026"){let t=Ze();if(!t)return;t.hidden=!1;let n=document.createElement("div");n.className="modalv2-loading",n.textContent=String(e||"Details werden geladen \u2026"),t.replaceChildren(n)}function Tn(e){let t=Ze();if(!t)return;t.hidden=!1;let n=(e==null?void 0:e.type)==="tv";t.innerHTML=`
    <section class="v2-layout">
      <aside class="v2-side">
        <div class="v2-poster"><img alt=""></div>
        <div class="v2-facts" aria-label="Schnellinfos" hidden>
          <h3 class="v2-facts-title">Schnellinfos</h3>
          <dl class="v2-facts-list"></dl>
        </div>
      </aside>
      <div class="v2-info">
        <header class="v2-head">
          <div class="v2-titlebar">
            <div class="v2-title-wrap">
              <h2 class="v2-title" id="modalV2Title"></h2>
              <div class="v2-subline"></div>
              <div class="v2-meta"></div>
            </div>
            <div class="v2-actions" aria-label="Externe Aktionen">
              <button class="v2-icon-btn" id="v2Close" type="button" aria-label="Schlie\xDFen">
                <svg class="v2-icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                  <path d="M6 6l12 12M6 18L18 6" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"></path>
                </svg>
              </button>
              <a class="v2-icon-btn" id="v2Tmdb" target="_blank" rel="noopener noreferrer" aria-label="Auf TMDB \xF6ffnen" hidden>
                <svg class="v2-icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                  <path d="M4 9h16v10a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V9z" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linejoin="round"></path>
                  <path d="M4 9V7a2 2 0 0 1 2-2h1l2 4 2-4 2 4 2-4h1a2 2 0 0 1 2 2v2" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"></path>
                </svg>
              </a>
              <a class="v2-icon-btn" id="v2Imdb" target="_blank" rel="noopener noreferrer" aria-label="Auf IMDb \xF6ffnen" hidden>
                <svg class="v2-icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                  <path d="M12 4l2.4 4.9 5.4.8-3.9 3.8.9 5.4-4.8-2.5-4.8 2.5.9-5.4-3.9-3.8 5.4-.8z" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linejoin="round"></path>
                </svg>
              </a>
              <button class="v2-icon-btn" id="v2Trailer" type="button" aria-label="Trailer abspielen" hidden>
                <svg class="v2-icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                  <path d="M9 6l8 6-8 6V6z" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linejoin="round" stroke-linecap="round"></path>
                </svg>
              </button>
            </div>
          </div>
          <div class="v2-chips" aria-label="Attribute"></div>
        </header>
        <nav class="v2-tabs" aria-label="Details Navigation" role="tablist">
          <button type="button" data-t="overview" class="active" id="v2TabOverview" role="tab" aria-controls="v2PaneOverview" aria-selected="true">\xDCberblick</button>
          <button type="button" data-t="details" id="v2TabDetails" role="tab" aria-controls="v2PaneDetails" aria-selected="false">Details</button>
          ${n?'<button type="button" data-t="seasons" id="v2TabSeasons" role="tab" aria-controls="v2PaneSeasons" aria-selected="false">Staffeln</button>':""}
          <button type="button" data-t="cast" id="v2TabCast" role="tab" aria-controls="v2PaneCast" aria-selected="false">Cast</button>
        </nav>
        <section class="v2-body">
          <div class="v2-pane v2-overview" data-pane="overview" id="v2PaneOverview" role="tabpanel" aria-labelledby="v2TabOverview"></div>
          <div class="v2-pane v2-details" data-pane="details" id="v2PaneDetails" role="tabpanel" aria-labelledby="v2TabDetails" hidden></div>
          ${n?'<div class="v2-pane v2-seasons" data-pane="seasons" id="v2PaneSeasons" role="tabpanel" aria-labelledby="v2TabSeasons" hidden></div>':""}
          <div class="v2-pane v2-cast" data-pane="cast" id="v2PaneCast" role="tabpanel" aria-labelledby="v2TabCast" hidden></div>
        </section>
      </div>
    </section>
  `,to(t,e),eo(t,e),Xr(t,(e==null?void 0:e.overview)||(e==null?void 0:e.summary)||""),Zr(t,e),(e==null?void 0:e.type)==="tv"&&Qr(t,e),Yr(t,Kr(e)),Gr(t);let r=t.querySelector("#v2Close");r&&r.addEventListener("click",Ct),H&&H.setAttribute("aria-labelledby","modalV2Title"),xt()}async function Fe(e){let t=++oe;we=document.activeElement instanceof HTMLElement?document.activeElement:null;let n=Ze();if(!n)return;let r=ro(e);if(t===oe){if(!r){n.hidden=!1;let o=document.createElement("div");o.className="modalv2-loading",o.textContent="Film konnte nicht geladen werden.",n.replaceChildren(o),Se=null,Be=null,xt();return}Se=r,Be="movie",Tn(r)}}async function _e(e){let t=++oe;we=document.activeElement instanceof HTMLElement?document.activeElement:null;let n=oo(e),r=Ze();if(!r||t!==oe)return;if(!n){r.hidden=!1;let a=document.createElement("div");a.className="modalv2-loading",a.textContent="Seriendetails konnten nicht geladen werden.",r.replaceChildren(a),Se=null,Be=null,xt();return}Se=n,Be="show";let o=n;if(wn(o)){if(no(),t!==oe)return;let a=null;try{a=await sn(o)}catch{a=null}if(t!==oe)return;a&&(En(o,a),Se=o)}t===oe&&Tn(o)}function Ct(){if(oe++,!!Z){if(Z.hidden=!0,Z.setAttribute("aria-hidden","true"),document.body.classList.remove("modalv2-open"),Dr(),$r(),q&&(q.innerHTML="",q.setAttribute("hidden","")),ae&&(ae.scrollTop=0),we&&typeof we.focus=="function")try{we.focus()}catch{}we=null,Se=null,Be=null,document.dispatchEvent(new CustomEvent("modal:close"))}}function ro(e){if(e==="demo")return Ye(Br);if(e&&typeof e=="object")return Ye(e);let t=e==null?"":String(e).trim();if(!t)return null;let n=E(),o=(Array.isArray(n==null?void 0:n.movies)?n.movies:[]).find(a=>In(a,t));return o?Ye(o):null}function oo(e){if(e==="demo")return Xe(Fr);if(e&&typeof e=="object")return Xe(e);let t=e==null?"":String(e).trim();if(!t)return null;let n=E(),o=(Array.isArray(n==null?void 0:n.shows)?n.shows:[]).find(a=>In(a,t));return o?Xe(o):null}function In(e,t){var r,o;if(!e)return!1;let n=String(t||"").trim();return n?!!((r=e==null?void 0:e.ids)!=null&&r.imdb&&String(e.ids.imdb)===n||(o=e==null?void 0:e.ids)!=null&&o.tmdb&&String(e.ids.tmdb)===n||(e==null?void 0:e.ratingKey)!=null&&String(e.ratingKey)===n):!1}var Lr,Nr,Z,H,ae,q,we,he,Ee,oe,Be,Se,Br,Fr,Tt=j(()=>{yn();Le();te();ye();Sn();Lr="https://image.tmdb.org/t/p/",Nr="w185",Z=null,H=null,ae=null,q=null,we=null,he=null,Ee=null,oe=0,Be=null,Se=null,Br={type:"movie",title:"Lumen: Der Aufbruch",tagline:"Eine cineastische Demo f\xFCr das neue Modal",overview:"Die Crew der Lumen wagt den Sprung in unerforschte Welten und enth\xFCllt dabei eine Energiequelle, die alles ver\xE4ndern k\xF6nnte. Zwischen Loyalit\xE4t, Intrigen und berauschenden Bildern entfaltet sich ein Abenteuer, das f\xFCr das Cinematic-Layout entworfen wurde.",summary:"Die Crew der Lumen entdeckt eine Energiequelle, die das Schicksal der Menschheit ver\xE4ndern k\xF6nnte.",runtimeMin:142,contentRating:"FSK 12",studio:"Aurora Pictures",rating:8.4,audienceRating:8,userRating:8.7,originallyAvailableAt:"2024-05-17",countries:[{tag:"Deutschland"},{tag:"Kanada"}],genres:[{tag:"Science-Fiction"},{tag:"Drama"},{tag:"Abenteuer"}],cast:[{name:"Mara Lenz",role:"Captain Alys Vega",tmdbProfile:"/3rxeQHiuCYaXJqfyUG8yt0YdHtH.jpg"},{name:"Tariq Benassi",role:"Navigator Elian Soh",tmdbProfile:"/wGl8DCycJ2U0FvJbLABd8R4FS3X.jpg"},{name:"Hannah Ko",role:"Wissenschaftlerin Dr. Mira Han",tmdbProfile:"/hJuDvwzS0SPlsE6MN4pF2UYDGtt.jpg"}],directors:[{tag:"Jonas Falk"}],writers:[{tag:"Lea Winter"}],producers:[{tag:"Studio Atlas"}],labels:[{tag:"Dolby Atmos"},{tag:"4K"}],collections:[{tag:"Aurora-Saga"}],trailer:"https://www.youtube.com/watch?v=dQw4w9WgXcQ",tmdbPoster:"https://image.tmdb.org/t/p/w500/2lUYbD2C3XSuwqMUbDVDQuz9mqz.jpg",ids:{tmdb:"demo-lumen",imdb:"tt0000001"},addedAt:"2024-06-01T12:00:00Z"},Fr={type:"tv",title:"Aurora Station",tagline:"Neue Horizonte in Serie",overview:"Die Besatzung der Aurora Station sch\xFCtzt eine Au\xDFenposten an der Grenze des bekannten Raums. Jede Episode verbindet kosmische R\xE4tsel mit pers\xF6nlichen Geschichten \u2013 perfekt geeignet, um das Cinematic-Modal auszuprobieren.",summary:"Ein orbitaler Au\xDFenposten ringt um Hoffnung und Zusammenhalt, w\xE4hrend eine fremde Macht erwacht.",contentRating:"TV-14",studio:"Nebula Network",originallyAvailableAt:"2023-09-14",seasonCount:2,genres:[{tag:"Science-Fiction"},{tag:"Drama"}],countries:[{tag:"USA"},{tag:"Island"}],creators:[{tag:"Elina S\xF8rensen"}],cast:[{name:"Noah Adler",role:"Commander Ivar Hale",tmdbProfile:"/4MqUjb1SYrzHmFSVoKHSKP5MGGm.jpg"},{name:"Sofia Idris",role:"Ingenieurin Kaia Rhee",tmdbProfile:"/tHMgWz6EpRdbgoMJ2JfzFzjg3QB.jpg"},{name:"Helena Ruiz",role:"Strategin Tala Voss",tmdbProfile:"/ziEuG1ESSofxDCspotYlrwz3Tq.png"}],seasons:[{title:"Staffel 1",seasonNumber:1,year:2023,thumbFile:"https://image.tmdb.org/t/p/w300/4dO2YpC8S9nLmQAXoJLRV8LZRxn.jpg",episodes:[{title:"Kapitel Eins: Erwachen",seasonNumber:1,episodeNumber:1,durationMin:54,originallyAvailableAt:"2023-09-14",audienceRating:8.6},{title:"Kapitel Zwei: Grenzwelten",seasonNumber:1,episodeNumber:2,durationMin:52,originallyAvailableAt:"2023-09-21",audienceRating:8.2}]},{title:"Staffel 2",seasonNumber:2,year:2024,thumbFile:"https://image.tmdb.org/t/p/w300/bSL4hY8SgdKzac8AUbWQm74y87C.jpg",episodes:[{title:"Kapitel Dreizehn: Resonanz",seasonNumber:2,episodeNumber:1,durationMin:56,originallyAvailableAt:"2024-02-08",audienceRating:8.9},{title:"Kapitel Vierzehn: Echo",seasonNumber:2,episodeNumber:2,durationMin:55,originallyAvailableAt:"2024-02-15",audienceRating:8.7}]}],tmdbPoster:"https://image.tmdb.org/t/p/w500/a4I481szRmycyreQTLrRe4f4YJe.jpg",ids:{tmdb:"demo-aurora-station",imdb:"tt0000002"}}});var Fn={};at(Fn,{renderGrid:()=>z});function ao(e){let t=I("article","card");t.style.contentVisibility="auto",t.dataset.kind=(e==null?void 0:e.type)==="tv"?"show":"movie",t.tabIndex=0,t.setAttribute("role","button"),e!=null&&e.title&&t.setAttribute("aria-label",e.title);let n=I("div","card__media"),r=new Image;r.loading="lazy",r.decoding="async",r.className="card__img",r.alt=(e==null?void 0:e.title)||"";let o=Bn(e);o&&(r.src=o);let a=I("div","card__media-gradient");a.setAttribute("aria-hidden","true");let i=ho(e),s=I("div","card__badges");i.forEach(C=>{C instanceof HTMLElement&&s.append(C)}),n.append(r,a),s.childElementCount&&n.append(s);let c=mo(e);if(c>0){let C=I("div","card__progress"),P=document.createElement("span");P.style.width=`${Math.max(0,Math.min(100,c))}%`,C.append(P),n.append(C)}let l=I("div","card__body"),d=document.createElement("h3");d.className="card__title",d.textContent=(e==null?void 0:e.title)||"",e!=null&&e.title&&d.setAttribute("title",e.title);let f=I("div","card__meta"),h=po(e);f.textContent=h.join(" \u2022 "),l.append(d,f);let u=I("div","card__actions"),b=I("div","card__chips"),v=de(e==null?void 0:e.genres);pt(b,v,3);let x=document.createElement("button");return x.type="button",x.className="card__primary",Ln(x,e),x.addEventListener("click",C=>{C.stopPropagation(),vt(e),Ln(x,e)}),u.append(b,x),t.append(n,l,u),t.addEventListener("click",()=>Nn(e)),t.addEventListener("keydown",C=>{C.target===t&&(C.key==="Enter"||C.key===" ")&&(C.preventDefault(),Nn(e))}),t}function so(e){return(e&&e.collections||[]).map(t=>t&&(t.tag||t.title||t.name||"")).filter(Boolean)}function io(e,t){let n=(t||[]).slice().sort((f,h)=>{let u=Number(Y(f))||0,b=Number(Y(h))||0;return u!==b?u-b:(f.title||"").localeCompare(h.title||"","de")}),r=n.map(f=>Number(Y(f))||0).filter(Boolean),o=r.length?Math.min(...r):"",a=n.map(f=>new Date(f.addedAt||0).getTime()).filter(Number.isFinite),i=a.length?new Date(Math.max(...a)).toISOString():null,s=n.map(f=>{var h;return Number((h=f.rating)!=null?h:f.audienceRating)}).filter(Number.isFinite),c=s.length?s.reduce((f,h)=>f+h,0)/s.length:null,l=n.find(f=>f.thumbFile)||n[0]||null,d=Array.from(new Set(n.flatMap(f=>de(f.genres)))).slice(0,4);return{isCollectionGroup:!0,type:"collection",title:e,collectionName:e,items:n,itemCount:n.length,year:o||"",addedAt:i,rating:c,posterItem:l,genres:d}}function co(e){let t=document.getElementById("groupCollections"),n=document.getElementById("collectionFilter"),r=n&&n.value;if(!t||!t.checked||r)return e;let o=new Map;e.forEach(i=>{so(i).forEach(s=>{o.has(s)||o.set(s,[]),o.get(s).push(i)})});let a=[];return o.forEach((i,s)=>{a.push(io(s,i))}),a.sort((i,s)=>i.title.localeCompare(s.title,"de")),a}function lo(e){let t=I("article","card card--collection");t.style.contentVisibility="auto",t.dataset.kind="collection",t.tabIndex=0,t.setAttribute("role","button"),e!=null&&e.title&&t.setAttribute("aria-label",e.title);let n=I("div","card__media"),r=e.posterItem||{},o=new Image;o.loading="lazy",o.decoding="async",o.className="card__img",o.alt=(e==null?void 0:e.title)||"";let a=Bn(r);a&&(o.src=a);let i=I("div","card__media-gradient");i.setAttribute("aria-hidden","true");let s=go(e),c=I("div","card__badges");s.forEach(v=>{v instanceof HTMLElement&&c.append(v)}),n.append(o,i),c.childElementCount&&n.append(c);let l=I("div","card__body"),d=document.createElement("h3");d.className="card__title",d.textContent=e.title||"",e!=null&&e.title&&d.setAttribute("title",e.title);let f=I("div","card__meta"),h=[e.year,`${e.itemCount} Titel`];Number.isFinite(e.rating)&&h.push(`\u2605 ${W(e.rating)}`),f.textContent=h.filter(Boolean).join(" \u2022 "),l.append(d,f);let u=I("div","card__actions"),b=I("div","card__chips");return pt(b,e.genres||[],3),u.append(b),t.append(n,l,u),t.addEventListener("click",()=>{let v=document.getElementById("collectionFilter");v&&(v.value=e.collectionName||e.title||"",v.dispatchEvent(new Event("change",{bubbles:!0})))}),t.addEventListener("keydown",v=>{if(v.target===t&&(v.key==="Enter"||v.key===" ")){v.preventDefault();let x=document.getElementById("collectionFilter");x&&(x.value=e.collectionName||e.title||"",x.dispatchEvent(new Event("change",{bubbles:!0})))}}),t}function z(e){let{movies:t,shows:n,filtered:r}=E(),o=(e==="shows"?n:t)||[],a=Array.isArray(r)?r:o,i=co(a),s=document.getElementById("grid");if(!s)return;uo(s);let c=document.createDocumentFragment();i.forEach(d=>c.append(d.isCollectionGroup?lo(d):ao(d))),s.replaceChildren(c),fo(s);let l=document.getElementById("empty");l&&(l.hidden=i.length>0)}function uo(e){e&&(e.classList.remove("is-entering","is-ready"),e.classList.add("is-leaving"))}function fo(e){e&&(e.classList.remove("is-leaving"),e.classList.add("is-entering"),requestAnimationFrame(()=>{e.classList.add("is-ready"),setTimeout(()=>e.classList.remove("is-entering","is-ready"),240)}))}function Bn(e){var r;if(!e)return"";let t=ue()&&(((r=e==null?void 0:e.tmdb)==null?void 0:r.poster)||(e==null?void 0:e.tmdbPoster)),n=(e==null?void 0:e.thumbFile)||(e==null?void 0:e.poster)||(e==null?void 0:e.art)||(e==null?void 0:e.thumb)||"";return t||n||""}function ho(e){var o;let t=[];Je(e)&&t.push(Me("Neu"));let n=String((e==null?void 0:e.contentRating)||"").trim();n&&t.push(Me(n));let r=Number((o=e==null?void 0:e.rating)!=null?o:e==null?void 0:e.audienceRating);return Number.isFinite(r)&&t.push(Me(`\u2605 ${W(r)}`)),t.slice(0,3)}function go(e){let t=[];return Number.isFinite(e==null?void 0:e.itemCount)&&e.itemCount>0&&t.push(Me(`${e.itemCount} Titel`)),e!=null&&e.year&&t.push(Me(String(e.year))),t}function Me(e){let t=document.createElement("span");return t.className="badge",t.textContent=String(e||""),t}function Ln(e,t){if(!e)return;let n=gn(t);e.textContent=n?"Gemerkt":"Merken",e.classList.toggle("active",n),e.setAttribute("aria-pressed",n?"true":"false")}function po(e){var i;let t=[],n=Y(e);n&&t.push(String(n));let r=bo(e);r&&t.push(r);let o=Number((i=e==null?void 0:e.rating)!=null?i:e==null?void 0:e.audienceRating);Number.isFinite(o)&&t.push(`\u2605 ${W(o)}`);let a=(e==null?void 0:e.studio)||(e==null?void 0:e.network)||"";return a&&t.push(a),t}function bo(e){var r,o;let t=(o=(r=e==null?void 0:e.runtimeMin)!=null?r:e==null?void 0:e.durationMin)!=null?o:e!=null&&e.duration?Math.round(Number(e.duration)/6e4):null,n=Number(t);return!Number.isFinite(n)||n<=0?"":(e==null?void 0:e.type)==="tv"?`~${n} min/Ep`:`${n} min`}function mo(e){var r;let t=Number((r=e==null?void 0:e.viewOffset)!=null?r:e==null?void 0:e.viewoffset),n=Number(e==null?void 0:e.duration);return!Number.isFinite(t)||!Number.isFinite(n)||n<=0?0:Math.max(1,Math.min(100,Math.round(t/n*100)))}function vo(e){var n,r;if(!e)return"";let t=((n=e==null?void 0:e.ids)==null?void 0:n.imdb)||((r=e==null?void 0:e.ids)==null?void 0:r.tmdb);return t?String(t):e!=null&&e.ratingKey?String(e.ratingKey):""}function yo(e,t){if(!e||!t)return;let n=`#/${e}/${t}`;try{if(history&&typeof history.pushState=="function"){location.hash===n&&typeof history.replaceState=="function"?history.replaceState(null,"",n):history.pushState(null,"",n);return}}catch{}try{window.__skipNextHashNavigation=!0}catch{}location.hash=n}function Nn(e){if(!e)return;let t=(e==null?void 0:e.type)==="tv"?"show":"movie",n=vo(e);n&&yo(t,n),t==="show"?_e(e):Fe(e)}var It=j(()=>{te();Qe();je();Le();wt();Tt()});var Ht={};at(Ht,{applyFilters:()=>Ae,computeFacets:()=>Ft,initFilters:()=>Mt,renderFacets:()=>_t,updateFiltersAndGrid:()=>De});function He(e){return e.year?e.year:e.originallyAvailableAt?String(e.originallyAvailableAt).slice(0,4):""}function Nt(e){return(e&&e.collections||[]).map(t=>t&&(t.tag||t.title||t.name||"")).filter(Boolean)}function wo(e){if(!(e!=null&&e.addedAt))return!1;let t=new Date(e.addedAt).getTime();if(!Number.isFinite(t))return!1;let n=E().cfg||{},r=Number(n.newDays||30);return Date.now()-t<=r*24*60*60*1e3}function _n(e){return String(e||"").toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")}function Eo(e,t){let n=_n(t.query||""),r=!!t.onlyNew,o=Number(t.yearFrom)||null,a=Number(t.yearTo)||null,i=t.genres||new Set,s=t.collection||"";if(n&&!_n([e.title,e.originalTitle,e.summary,e.studio,de(e.genres).join(" "),(e.roles||[]).map(d=>d&&(d.tag||d.role||d.name)).join(" "),Nt(e).join(" ")].filter(Boolean).join(" ")).includes(n)||r&&!wo(e))return!1;let c=Number(He(e))||null;if(o&&(!c||c<o)||a&&(!c||c>a))return!1;if(i.size){let l=new Set(de(e.genres));for(let d of i)if(!l.has(d))return!1}return!(s&&!new Set(Nt(e)).has(s))}function So(e,t){let n=e.slice();switch(t){case"year-desc":n.sort((r,o)=>(Number(He(o))||0)-(Number(He(r))||0)||String(r.title||"").localeCompare(String(o.title||""),"de"));break;case"year-asc":n.sort((r,o)=>(Number(He(r))||0)-(Number(He(o))||0)||String(r.title||"").localeCompare(String(o.title||""),"de"));break;case"title-desc":n.sort((r,o)=>String(o.title||"").localeCompare(String(r.title||""),"de"));break;case"added-desc":n.sort((r,o)=>new Date(o.addedAt||0)-new Date(r.addedAt||0));break;case"title-asc":default:n.sort((r,o)=>String(r.title||"").localeCompare(String(o.title||""),"de"))}return n}function Ft(e,t){let n=new Set,r=new Set,o=new Set,a=s=>(s||[]).forEach(c=>{de(c.genres).forEach(d=>n.add(d));let l=c.year||(c.originallyAvailableAt?String(c.originallyAvailableAt).slice(0,4):"");l&&r.add(Number(l)),Nt(c).forEach(d=>o.add(d))});a(e),a(t);let i=[...r].sort((s,c)=>s-c);return{genres:[...n].sort(),years:i,collections:[...o].sort((s,c)=>s.localeCompare(c,"de"))}}function _t(e){let t=F("#yearFrom"),n=F("#yearTo");t&&t.replaceChildren(new Option("Ab Jahr",""),...e.years.map(a=>new Option(String(a),String(a)))),n&&n.replaceChildren(new Option("Bis Jahr",""),...e.years.map(a=>new Option(String(a),String(a))));let r=F("#collectionFilter");r&&r.replaceChildren(new Option("Alle Collections",""),...e.collections.map(a=>new Option(a,a)));let o=F("#genreFilters");if(o){let a=e.genres.map(i=>{let s=document.createElement("button");return s.type="button",s.className="chip",s.textContent=i,s.dataset.name=i,s});o.replaceChildren(...a),Bt()}}function Ao(){var c,l,d,f,h;let e=document.getElementById("search")||document.getElementById("q"),t=((e==null?void 0:e.value)||"").trim(),n=((c=F("#onlyNew"))==null?void 0:c.checked)||!1,r=((l=F("#yearFrom"))==null?void 0:l.value)||"",o=((d=F("#yearTo"))==null?void 0:d.value)||"",a=((f=F("#collectionFilter"))==null?void 0:f.value)||"",i=((h=F("#sort"))==null?void 0:h.value)||"title-asc",s=new Set;return document.querySelectorAll("#genreFilters .chip.active").forEach(u=>s.add(u.dataset.name)),{query:t,onlyNew:n,yearFrom:r,yearTo:o,collection:a,genres:s,sort:i}}function Ae(){let e=E(),n=e.view==="shows"?e.shows:e.movies,r=Ao(),o=(n||[]).filter(i=>Eo(i,r)),a=So(o,r.sort);return ie({filtered:a}),a}function ko(){Lt||(Lt=Promise.resolve().then(()=>(It(),Fn))),Lt.then(e=>{let t=e&&e.renderGrid;typeof t=="function"&&t(E().view)}).catch(console.error)}function De(){let e=Ae();return ko(),xo(e),e}function xo(e){try{let n={items:Array.isArray(e)?e.slice():[],view:E().view};window.dispatchEvent(new CustomEvent("filters:updated",{detail:n}))}catch{}}function Bt(){let e=document.getElementById("genreFilters");if(!e)return;let t=e.querySelectorAll(".chip.active").length;e.dataset.state=t>0?"active":"empty",e.dataset.count=String(t)}function Mt(){let e=F("#sort");e&&e.options.length===0&&[["title-asc","Titel A\u2013Z"],["title-desc","Titel Z\u2013A"],["year-desc","Jahr \u2193"],["year-asc","Jahr \u2191"],["added-desc","Zuletzt hinzugef\xFCgt"]].forEach(([o,a])=>e.add(new Option(a,o)));let t=(o,a="input")=>{let i=F(o);i&&(i.addEventListener(a,()=>{De()}),a==="input"&&i instanceof HTMLInputElement&&i.type==="search"&&i.addEventListener("search",()=>{De()}))};t("#search"),t("#q"),t("#onlyNew","change"),t("#yearFrom","change"),t("#yearTo","change"),t("#collectionFilter","change"),t("#sort","change"),t("#groupCollections","change");let n=F("#yearReset");n&&n.addEventListener("click",()=>{let o=F("#yearFrom"),a=F("#yearTo");o&&(o.value=""),a&&(a.value=""),De()});let r=F("#genreFilters");r&&(r.addEventListener("click",o=>{let a=o.target;a instanceof HTMLElement&&a.classList.contains("chip")&&(a.classList.toggle("active"),Bt(),De())}),Bt())}var Lt,Qe=j(()=>{te();je();Le();Lt=null});var xe={};at(xe,{clearCache:()=>Io,hydrateOptional:()=>$t,validateToken:()=>Ho});function Co(){try{return new Map(JSON.parse(localStorage.getItem("tmdbCache")||"[]"))}catch{return new Map}}function To(){try{localStorage.setItem("tmdbCache",JSON.stringify(Array.from(ge.entries())))}catch{}}function Io(){try{localStorage.removeItem("tmdbCache"),ge=new Map}catch{}}function Lo(e){try{let t=localStorage.getItem("tmdbToken");if(t)return{kind:"bearer",value:t}}catch{}return e!=null&&e.tmdbApiKey?{kind:"apikey",value:String(e.tmdbApiKey)}:{kind:"none",value:""}}function No(e){var i,s;let t=e.type==="tv"?"tv":"movie",n=((i=e==null?void 0:e.ids)==null?void 0:i.imdb)||"",r=((s=e==null?void 0:e.ids)==null?void 0:s.tmdb)||"",o=(e.title||"").toLowerCase(),a=String(e.year||"").slice(0,4);return[t,n,r,o,a].filter(Boolean).join("|")}function Dt(e,t){if(!t||t.kind==="none")return{url:e,init:{}};if(t.kind==="bearer")return{url:e,init:{headers:{Authorization:`Bearer ${t.value}`,Accept:"application/json"}}};let n=e.includes("?")?"&":"?";return{url:`${e}${n}api_key=${encodeURIComponent(t.value)}`,init:{headers:{Accept:"application/json"}}}}async function tt(e,t){let{url:n,init:r}=Dt(e,t),o=await fetch(n,r);if(!o.ok)throw new Error("HTTP "+o.status);return o.json()}function Bo(e){return e!=null&&e.file_path?et+Mn+e.file_path:""}function Fo(e){return e!=null&&e.file_path?et+Hn+e.file_path:""}async function Rt(e,t,n,r){let o=await tt(`${ke}/${e}/${t}?language=${encodeURIComponent(n||"de-DE")}`,r),a=await tt(`${ke}/${e}/${t}/images`,r).catch(()=>({posters:[],backdrops:[]})),i=Bo((a.posters||[])[0])||(o.poster_path?et+Mn+o.poster_path:""),s=Fo((a.backdrops||[])[0])||(o.backdrop_path?et+Hn+o.backdrop_path:"");return{id:o.id,poster:i,backdrop:s,url:`https://www.themoviedb.org/${e}/${o.id}`}}async function _o(e,t,n,r,o){let a=encodeURIComponent(t||""),i=n?`&year=${encodeURIComponent(String(n))}`:"",c=((await tt(`${ke}/search/${e}?query=${a}${i}&language=${encodeURIComponent(r||"de-DE")}`,o)).results||[])[0];if(!c)throw new Error("not found");return Rt(e,c.id,r,o)}async function Mo(e,t,n){var i,s;let r=e.type==="tv"?"tv":"movie",o=No(e);if(ge.has(o))return ge.get(o);let a;try{if((i=e==null?void 0:e.ids)!=null&&i.tmdb)a=await Rt(r,e.ids.tmdb,t.lang,n);else if((s=e==null?void 0:e.ids)!=null&&s.imdb){let c=await tt(`${ke}/find/${e.ids.imdb}?external_source=imdb_id&language=${encodeURIComponent(t.lang||"de-DE")}`,n),l=r==="movie"?(c.movie_results||[])[0]:(c.tv_results||[])[0];if(l)a=await Rt(r,l.id,t.lang,n);else throw new Error("not found")}else a=await _o(r,e.title,e.year,t.lang,n)}catch{a=null}return ge.set(o,a),To(),a}async function $t(e,t,n={}){try{ge=ge||Co();let r=Lo(n);if(!r.value)return;let o=(e||[]).concat(t||[]),a=0,i=40,s=async()=>{let c=o.slice(a,a+4);a+=4,await Promise.all(c.map(async l=>{let d=await Mo(l,n,r);d&&(l.tmdb={id:d.id,poster:d.poster,backdrop:d.backdrop,url:d.url},l.ids=l.ids||{},!l.ids.tmdb&&d.id&&(l.ids.tmdb=String(d.id)))}));try{window.dispatchEvent(new CustomEvent("tmdb:chunk",{detail:{updated:c.length,index:a}}))}catch{}if(a<Math.min(o.length,i))(window.requestIdleCallback||setTimeout)(s,250);else try{window.dispatchEvent(new CustomEvent("tmdb:done",{detail:{total:Math.min(o.length,i)}}))}catch{}};s()}catch{}}async function Ho(e){let t=String(e||"").trim();if(!t)throw new Error("empty");let n=/^[a-f0-9]{32}$/i.test(t),r=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+$/.test(t),o=a=>{try{let i=a.split(".")[1],c=atob((l=>l+"=".repeat((4-l.length%4)%4))(i.replace(/-/g,"+").replace(/_/g,"/")));return JSON.parse(c)}catch{return null}};if(n){let{url:a,init:i}=Dt(`${ke}/configuration`,{kind:"apikey",value:t});return(await fetch(a,i)).ok?{ok:!0,as:"apikey",hint:"v3Key"}:{ok:!1,as:"apikey",hint:"looksV3"}}if(r){let a=o(t);if(a&&typeof a=="object"){let c=String(a.iss||"");if(c&&!/themoviedb\.org/i.test(c))return{ok:!1,as:"bearer",hint:"issMismatch"}}let{url:i,init:s}=Dt(`${ke}/trending/movie/day`,{kind:"bearer",value:t});try{if((await fetch(i,s)).ok)return{ok:!0,as:"bearer",hint:null}}catch{}return{ok:!0,as:"bearer",hint:"structOnly"}}return{ok:!1,as:"bearer",hint:null}}var ke,et,Mn,Hn,ge,pe=j(()=>{ke="https://api.themoviedb.org/3",et="https://image.tmdb.org/t/p/",Mn="w342",Hn="w780"});te();je();var G,qe,ze,ne;function it(){if(!G&&(G=F("#loaderOverlay"),!G)){G=I("div","loader-overlay"),G.id="loaderOverlay",G.hidden=!0;let e=I("div","loader");ze=I("div","msg",""),qe=I("div","bar"),e.append(ze,qe),G.append(e),document.body.append(G)}}function Wt(){it(),G.hidden=!1}function me(e,t){it(),ze&&(ze.textContent=e||""),qe&&(qe.style.width=(t||0)+"%")}function Ke(){it(),G.hidden=!0}function Jt(e=18){let t=F("#grid");if(t){ne=I("div","skeleton");for(let n=0;n<e;n++)ne.append(I("div","skel"));t.replaceChildren(ne)}}function ct(){ne&&ne.parentElement&&ne.parentElement.removeChild(ne),ne=null}ye();Qe();It();Tt();pe();wt();te();ye();dt();function Rn(){let e=document.getElementById("openDebug");e&&e.addEventListener("click",()=>{Do()})}function Do(){var t,n,r,o;let e=document.getElementById("debugOverlay");e||(e=document.createElement("div"),e.id="debugOverlay",e.className="debug-overlay",e.innerHTML=`
      <div class="debug-dialog">
        <div class="debug-header"><h2>Debug</h2></div>
        <div class="debug-body">
          <pre id="debugPre" class="debug-pre"></pre>
          <div class="debug-cache-controls">
            <h3>Cache-Verwaltung</h3>
            <div id="cacheStats" class="cache-stats"></div>
            <div class="cache-buttons">
              <button id="debugClearExpired" class="btn">Abgelaufene l\xF6schen</button>
              <button id="debugClearAll" class="btn">Alles l\xF6schen</button>
            </div>
          </div>
        </div>
        <div class="debug-actions">
          <button id="debugCopy" class="btn">Copy report</button>
          <button id="debugClose" class="btn">Schlie\xDFen</button>
        </div>
      </div>`,document.body.append(e)),e.hidden=!1,Pt(),e.addEventListener("click",a=>{a.target===e&&Dn()}),(t=document.getElementById("debugClose"))==null||t.addEventListener("click",Dn,{once:!0}),(n=document.getElementById("debugCopy"))==null||n.addEventListener("click",Ro,{once:!0}),(r=document.getElementById("debugClearExpired"))==null||r.addEventListener("click",()=>{Ve(),Pt()},{once:!0}),(o=document.getElementById("debugClearAll"))==null||o.addEventListener("click",()=>{confirm("Wirklich den gesamten Cache l\xF6schen?")&&(Xt(),Pt())},{once:!0})}function Dn(){let e=document.getElementById("debugOverlay");e&&(e.hidden=!0)}function Pt(){let e=document.getElementById("debugPre");if(!e)return;let t=E(),n=cn(),r=t.cfg||{},o=lt(),a={view:t.view,counts:{movies:(t.movies||[]).length,shows:(t.shows||[]).length,filtered:(t.filtered||[]).length},dataSources:n,cache:o,tmdb:{enabled:!!r.tmdbEnabled,lang:r.lang,tokenPresent:!!(localStorage.getItem("tmdbToken")||r.tmdbApiKey)},useTmdbImages:localStorage.getItem("useTmdb")==="1",reduceMotion:localStorage.getItem("prefReduceMotion")==="1",locationHash:location.hash,userAgent:navigator.userAgent};e.textContent=JSON.stringify(a,null,2);let i=document.getElementById("cacheStats");i&&o&&(i.innerHTML=`
      <p>Eintr\xE4ge gesamt: <strong>${o.totalEntries}</strong></p>
      <p>G\xFCltig: <strong>${o.validEntries}</strong> | Abgelaufen: <strong>${o.expiredEntries}</strong></p>
      <p>Gr\xF6\xDFe: <strong>${o.totalSizeMB} MB</strong></p>
    `)}function Ro(){var n;let e=document.getElementById("debugPre");if(!e)return;let t=e.textContent||"";(n=navigator.clipboard)==null||n.writeText(t).catch(()=>{try{let r=document.createElement("textarea");r.value=t,document.body.append(r),r.select(),document.execCommand("copy"),r.remove()}catch{}})}Le();var J=null;function rt(){J||(J=document.createElement("div"),J.id="errorContainer",J.className="error-container",J.setAttribute("role","alert"),J.setAttribute("aria-live","polite"),document.body.appendChild(J)),window.addEventListener("unhandledrejection",e=>{var t;nt("Ein unerwarteter Fehler ist aufgetreten",(t=e.reason)==null?void 0:t.message),e.preventDefault()}),window.addEventListener("error",e=>{var t;nt("Ein Fehler ist aufgetreten",(t=e.error)==null?void 0:t.message)})}function nt(e,t="",n=5e3){J||rt();let r=document.createElement("div");return r.className="error-toast",r.innerHTML=`
    <div class="error-toast-content">
      <div class="error-toast-icon">\u26A0\uFE0F</div>
      <div class="error-toast-text">
        <div class="error-toast-title">${Ot(e)}</div>
        ${t?`<div class="error-toast-message">${Ot(t)}</div>`:""}
      </div>
      <button class="error-toast-close" aria-label="Schlie\xDFen">\xD7</button>
    </div>
  `,r.querySelector(".error-toast-close").addEventListener("click",()=>{r.classList.add("error-toast-exit"),setTimeout(()=>r.remove(),300)}),J.appendChild(r),n>0&&setTimeout(()=>{r.parentNode&&(r.classList.add("error-toast-exit"),setTimeout(()=>r.remove(),300))},n),requestAnimationFrame(()=>{r.classList.add("error-toast-show")}),r}function $n(e,t){J||rt();let n=document.createElement("div");n.className="error-toast error-toast-retryable",n.innerHTML=`
    <div class="error-toast-content">
      <div class="error-toast-icon">\u26A0\uFE0F</div>
      <div class="error-toast-text">
        <div class="error-toast-title">${Ot(e)}</div>
      </div>
      <button class="error-toast-retry">Erneut versuchen</button>
      <button class="error-toast-close" aria-label="Schlie\xDFen">\xD7</button>
    </div>
  `;let r=n.querySelector(".error-toast-retry"),o=n.querySelector(".error-toast-close");return r.addEventListener("click",async()=>{n.remove();try{await t()}catch{}}),o.addEventListener("click",()=>{n.classList.add("error-toast-exit"),setTimeout(()=>n.remove(),300)}),J.appendChild(n),requestAnimationFrame(()=>{n.classList.add("error-toast-show")}),n}function Ot(e){let t=document.createElement("div");return t.textContent=e,t.innerHTML}var R=null,Pn=typeof HTMLElement!="undefined"&&"inert"in HTMLElement.prototype,On=["a[href]","area[href]","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])","iframe","object","embed","[contenteditable]","[tabindex]"].join(",");function jn(){R=document.getElementById("filterBar"),R&&(document.addEventListener("modal:open",jt),document.addEventListener("modal:close",qt),document.addEventListener("settings:open",jt),document.addEventListener("settings:close",qt),document.addEventListener("watchlist:open",jt),document.addEventListener("watchlist:close",qt))}function jt(){R&&(R.classList.add("filters--hidden"),document.body.classList.add("filter-bar-hidden"),R.setAttribute("aria-hidden","true"),Pn?R.setAttribute("inert",""):Po())}function qt(){if(!R)return;let e=document.querySelector('.modalv2-overlay[aria-hidden="false"]'),t=document.querySelector('.settings-overlay[aria-hidden="false"]'),n=document.querySelector('.watchlist-panel[aria-hidden="false"]');e||t||n||(R.classList.remove("filters--hidden"),document.body.classList.remove("filter-bar-hidden"),R.setAttribute("aria-hidden","false"),Pn?R.removeAttribute("inert"):Oo())}function Po(){R&&R.querySelectorAll(On).forEach(e=>{e.dataset.filterBarPrevTabindex===void 0&&(e.hasAttribute("tabindex")?e.dataset.filterBarPrevTabindex=e.getAttribute("tabindex"):e.dataset.filterBarPrevTabindex="",e.setAttribute("tabindex","-1"))})}function Oo(){R&&R.querySelectorAll(On).forEach(e=>{if(e.dataset.filterBarPrevTabindex===void 0)return;let t=e.dataset.filterBarPrevTabindex;delete e.dataset.filterBarPrevTabindex,t===""?e.removeAttribute("tabindex"):e.setAttribute("tabindex",t)})}var L={HAS_HERO:"has-hero",HERO_HIDDEN:"hero-hidden",FILTERS_HIDDEN:"filters-hidden"},Re=50,qn=200,jo="cubic-bezier(0.18, 0.67, 0.32, 1)",qo=360;function zn({heroEl:e,filterEl:t,headerEl:n,mainEl:r,advancedToggle:o,advancedPanel:a,reduceMotionFlag:i=!1}){if(!e||!t)return null;let s=L.HAS_HERO,c=0,l="down",d=0,f=0,h=!1,u=i,b=!1,v=null,x=null,C=["input:not([disabled])","select:not([disabled])","textarea:not([disabled])","button:not([disabled])",'[tabindex]:not([tabindex="-1"])'].join(",");function P(){document.documentElement.style.setProperty("--ease-ui",jo),document.documentElement.style.setProperty("--dur-ui",`${qo}ms`),D(),Oe(L.HAS_HERO,!0),$(),window.addEventListener("scroll",_,{passive:!0}),be(),w(),N(),T()}function D(){e&&(d=e.scrollHeight||e.offsetHeight||0,document.documentElement.style.setProperty("--hero-h",`${d}px`)),t&&(f=t.scrollHeight||t.offsetHeight||0,document.documentElement.style.setProperty("--filters-h",`${f}px`))}function $(){"IntersectionObserver"in window&&(v=new IntersectionObserver(p=>{p.forEach(k=>{!k.isIntersecting&&l==="down"?s===L.HAS_HERO&&M(L.HERO_HIDDEN):k.isIntersecting&&l==="up"&&(s===L.HERO_HIDDEN||s===L.FILTERS_HIDDEN)&&M(L.HAS_HERO)})},{rootMargin:`-${Re}px 0px 0px 0px`,threshold:0}),v.observe(e))}function be(){if(!("ResizeObserver"in window)){window.addEventListener("resize",()=>{requestAnimationFrame(D)},{passive:!0});return}x=new ResizeObserver(()=>{requestAnimationFrame(D)}),e&&x.observe(e),t&&x.observe(t)}function w(){if(!t)return;let p=null,k=()=>{p&&(clearTimeout(p),p=null)},V=()=>{t.contains(document.activeElement)||(h=!1)};t.addEventListener("focusin",()=>{k(),h=!0}),t.addEventListener("focusout",()=>{k(),p=setTimeout(V,100)}),t.addEventListener("input",()=>{k(),h=!0,p=setTimeout(()=>{t.contains(document.activeElement)||(h=!1)},1500)}),t.addEventListener("change",()=>{k(),h=!0,p=setTimeout(()=>{t.contains(document.activeElement)||(h=!1)},1500)})}function N(){if(!a)return;new MutationObserver(()=>{let k=a.dataset.state||"closed";(k==="open"||k==="expanding")&&s===L.FILTERS_HIDDEN&&M(L.HERO_HIDDEN)}).observe(a,{attributes:!0,attributeFilter:["data-state"]})}function T(){let p=window.matchMedia("(prefers-reduced-motion: reduce)"),k=()=>{u=p.matches||i,document.body.classList.toggle("reduce-motion",u)};p.addEventListener&&p.addEventListener("change",k),k()}function _(){b||(b=!0,requestAnimationFrame(()=>{B(),b=!1}))}function B(){let p=window.scrollY||window.pageYOffset||0;p>c?l="down":p<c&&(l="up"),c=p,l==="down"?O(p):A(p)}function O(p){if(s===L.HAS_HERO&&p>=Re)M(L.HERO_HIDDEN);else if(s===L.HERO_HIDDEN){let k=Re+qn,V=!h&&!y();p>=k&&V&&M(L.FILTERS_HIDDEN)}}function A(p){if(s===L.FILTERS_HIDDEN){let k=Re+qn;p<k-80&&M(L.HERO_HIDDEN)}else s===L.HERO_HIDDEN&&p<Re-20&&M(L.HAS_HERO)}function M(p){s!==p&&(s=p,Oe(p))}function Oe(p,k=!1){let V=document.body;switch(V.classList.remove(L.HAS_HERO,L.HERO_HIDDEN,L.FILTERS_HIDDEN),V.classList.add(p),p){case L.HAS_HERO:g(k);break;case L.HERO_HIDDEN:S(k);break;case L.FILTERS_HIDDEN:m(k);break}}function g(p){e&&(e.classList.remove("is-hidden","is-collapsing"),e.removeAttribute("aria-hidden"),e.style.opacity="",e.style.transform=""),t&&(t.classList.remove("is-hidden","is-collapsing"),t.removeAttribute("aria-hidden"),Ce(t))}function S(p){e&&(e.classList.add("is-hidden"),e.classList.remove("is-collapsing"),e.setAttribute("aria-hidden","true"),e.style.opacity="",e.style.transform=""),t&&(t.classList.remove("is-hidden","is-collapsing"),t.classList.add("is-sticky"),t.removeAttribute("aria-hidden"),Ce(t))}function m(p){e&&(e.classList.add("is-hidden"),e.setAttribute("aria-hidden","true"),e.style.opacity="0",e.style.transform=""),t&&(t.classList.add("is-hidden"),t.classList.remove("is-sticky"),t.setAttribute("aria-hidden","true"),t.contains(document.activeElement)&&document.activeElement.blur(),K(t))}function y(){if(!a)return!1;let p=a.dataset.state||"closed";return p==="open"||p==="expanding"}function K(p){p&&("inert"in HTMLElement.prototype?p.inert=!0:p.querySelectorAll(C).forEach(k=>{k.dataset.originalTabindex||(k.dataset.originalTabindex=k.getAttribute("tabindex")||""),k.setAttribute("tabindex","-1")}))}function Ce(p){p&&("inert"in HTMLElement.prototype?p.inert=!1:p.querySelectorAll(C).forEach(k=>{let V=k.dataset.originalTabindex;V!==void 0&&(V===""?k.removeAttribute("tabindex"):k.setAttribute("tabindex",V),delete k.dataset.originalTabindex)}))}function Te(p){p?(window.addEventListener("scroll",_,{passive:!0}),v&&e&&v.observe(e),B()):(M(L.HAS_HERO),window.removeEventListener("scroll",_),v&&v.disconnect())}function Ie(p){u=p,document.body.classList.toggle("reduce-motion",p)}function ot(){return s}return P(),{setEnabled:Te,setReduceMotion:Ie,getState:ot}}var Pe=null,Q=null,se=null;function $e(e,t=!0){let n=document.getElementById("footerMeta");if(n){let o=n.querySelector("#footerStatus");o?o.textContent=e:n.textContent=e,n.dataset.state=t?"loading":"ready"}let r=document.getElementById("grid");r&&r.setAttribute("aria-busy",t?"true":"false")}async function zo(){rt(),aa(),Wt(),$e("Initialisiere \u2026",!0),me("Initialisiere \u2026",8),Jt(18);let e=await fetch("config.json").then(n=>n.json()).catch(n=>(nt("Konfiguration konnte nicht geladen werden","Verwende Standardeinstellungen"),{startView:"movies",tmdbEnabled:!1}));ie({cfg:e,view:e.startView||"movies"});try{$e("Filme laden \u2026",!0),me("Filme laden \u2026",25);let n=await ft();$e("Serien laden \u2026",!0),me("Serien laden \u2026",45);let r=await ht();$e("Filter vorbereiten \u2026",!0),me("Filter vorbereiten \u2026",60);let o=Ft(n,r);ie({movies:n,shows:r,facets:o}),$e("Ansicht aufbauen \u2026",!0),me("Ansicht aufbauen \u2026",85),ct(),Vt(),_t(o),Mt(),Ae(),Ko(!0),z(E().view),Vo(),Ke(),e.tmdbEnabled&&(window.requestIdleCallback||setTimeout)(()=>{var a;return(a=$t)==null?void 0:a(n,r,e)},400),bn(),oa(e),sa(),ia(),ca(),la(),jn(),da(),ee(),Rn()}catch(n){throw Ke(),ct(),$n("Fehler beim Laden der Daten",()=>window.location.reload()),n}let t;window.addEventListener("tmdb:chunk",()=>{t||(t=requestAnimationFrame(()=>{t=null;try{localStorage.getItem("useTmdb")==="1"&&(z(E().view),ee())}catch{}}))}),window.addEventListener("tmdb:done",()=>{try{localStorage.getItem("useTmdb")==="1"&&(z(E().view),ee())}catch{}})}var zt=null,Kt="";window.addEventListener("hashchange",()=>{if(window.__skipNextHashNavigation){try{window.__skipNextHashNavigation=!1,Kt=location.hash||""}catch{}return}let e=location.hash||"";zt&&clearTimeout(zt),zt=setTimeout(()=>{if(e===Kt)return;Kt=e;let t=e;if(/^#\/(movies|shows)$/.test(t)){let s=t.includes("shows")?"shows":"movies";ie({view:s});let c=Ae();Vt(),z(s),ee(c);return}let n=t.match(/^#\/(movie|show)\/(.+)/);if(!n)return;let[,r,o]=n,i=((r==="movie"?E().movies:E().shows)||[]).find(s=>{var c,l;return((c=s==null?void 0:s.ids)==null?void 0:c.imdb)===o||((l=s==null?void 0:s.ids)==null?void 0:l.tmdb)===o||String(s==null?void 0:s.ratingKey)===o});i&&(r==="show"?_e(i):Fe(i))},50)});function Vt(){let e=document.getElementById("libraryTabs");if(!e)return;let t=Array.from(e.querySelectorAll("[data-lib]")),n=E().view==="shows"?"shows":"movies";t.forEach(r=>{let o=r.dataset.lib==="series"?"shows":"movies",a=n===o;r.classList.toggle("is-active",a),r.setAttribute("aria-pressed",a?"true":"false"),r.dataset.bound!=="true"&&(r.addEventListener("click",()=>{let i=r.dataset.lib==="series"?"shows":"movies";if(E().view===i)return;ie({view:i});try{window.__skipNextHashNavigation=!0}catch{}location.hash=i==="movies"?"#/movies":"#/shows",Vt();let s=Ae();z(i),ee(s)}),r.dataset.bound="true")})}function Ko(e=!1){let t=document.getElementById("heroStats");if(!t)return;let n=E(),r=(n.movies||[]).length,o=(n.shows||[]).length,a=t.querySelector('[data-stat="movies"]'),i=t.querySelector('[data-stat="shows"]');!a||!i||(e?(Kn(a,r),Kn(i,o)):(a.textContent=String(r),i.textContent=String(o)))}function Kn(e,t){if(!e)return;let n=Number(e.textContent)||0,r=Number(t)||0;if(n===r){e.textContent=String(r);return}let o=480,a=performance.now();function i(s){let c=Math.min(1,(s-a)/o),l=Math.round(n+(r-n)*(c<.5?2*c*c:-1+(4-2*c)*c));e.textContent=String(l),c<1?requestAnimationFrame(i):e.textContent=String(r)}requestAnimationFrame(i)}function Vo(){let e=document.getElementById("footerMeta");if(!e)return;let t=document.getElementById("footerStatus"),n=E(),r=n.movies||[],o=n.shows||[],a=r.concat(o).map(l=>new Date(l.addedAt||0).getTime()).filter(Number.isFinite),s=(a.length?new Date(Math.max(...a)):new Date).toISOString().slice(0,10);t&&(t.textContent=`Stand: ${s}`),e.dataset.state="ready";let c=document.getElementById("grid");c&&c.setAttribute("aria-busy","false")}function ee(e){let t=document.getElementById("hero"),n=document.getElementById("heroTitle"),r=document.getElementById("heroSubtitle"),o=document.getElementById("heroCta");if(!t||!n||!r||!o)return;Uo();let a=Wo(e);if(!a){Pe=null,n.textContent=Q.title,r.textContent=Q.subtitle,r.dataset.taglinePaused="0",delete r.dataset.heroBound,r.classList.remove("is-fading"),o.textContent=Q.cta,o.disabled=!0,o.setAttribute("aria-disabled","true"),o.removeAttribute("aria-label"),o.onclick=null,t.style.backgroundImage="",t.classList.remove("has-poster"),t.dataset.heroKind="",t.dataset.heroId="";return}Pe=a;let i=a.type==="tv"?"show":"movie",s=ea(a);n.textContent=a.title||Q.title,r.textContent=Go(a),r.dataset.taglinePaused="1",r.dataset.heroBound="1",r.classList.remove("is-fading");let c=i==="show"?"Serien-Details \xF6ffnen":"Film-Details \xF6ffnen";o.textContent=c,o.disabled=!1,o.setAttribute("aria-disabled","false"),o.setAttribute("aria-label",a.title?`${c}: ${a.title}`:c),o.onclick=()=>ta(a,i,s),t.dataset.heroKind=i,t.dataset.heroId=s||"";let l=ra(a);l?(t.style.backgroundImage=`url(${l})`,t.classList.add("has-poster")):(t.style.backgroundImage="",t.classList.remove("has-poster"))}window.__heroRefresh=ee;function Uo(){var e,t,n;Q||(Q={title:((e=document.getElementById("heroTitle"))==null?void 0:e.textContent)||"",subtitle:((t=document.getElementById("heroSubtitle"))==null?void 0:t.textContent)||"",cta:((n=document.getElementById("heroCta"))==null?void 0:n.textContent)||""})}function Wo(e){if(Array.isArray(e)){let r=e.filter(Un);return r.length?Vn(r):null}let n=Jo().filter(Un);return n.length?Vn(n):null}function Vn(e){if(e.length===1)return e[0];let t=Math.floor(Math.random()*e.length),n=e[t];return Pe&&e.length>1&&n===Pe&&e.find(o=>o!==Pe)||n}function Jo(){let e=E(),t=e.view==="shows"?"shows":"movies",r=(Array.isArray(e.filtered)&&e.filtered.length?e.filtered:null)||(t==="shows"?e.shows:e.movies)||[];return Array.isArray(r)?r:[]}function Un(e){return!!e&&typeof e=="object"&&!e.isCollectionGroup&&e.type!=="collection"}function Go(e){var s;let t=[],n=Y(e);n&&t.push(String(n));let r=Yo(e);r&&t.push(r);let o=Number((s=e==null?void 0:e.rating)!=null?s:e==null?void 0:e.audienceRating);Number.isFinite(o)&&t.push(`\u2605 ${W(o)}`);let a=Xo(e,2);a.length&&t.push(a.join(", "));let i=Zo(e);return i?t.length?`${t.join(" \u2022 ")} \u2014 ${i}`:i:t.length?t.join(" \u2022 "):(Q==null?void 0:Q.subtitle)||""}function Yo(e){var r,o;let t=(o=(r=e==null?void 0:e.runtimeMin)!=null?r:e==null?void 0:e.durationMin)!=null?o:e!=null&&e.duration?Math.round(Number(e.duration)/6e4):null,n=Number(t);return!Number.isFinite(n)||n<=0?"":(e==null?void 0:e.type)==="tv"?`~${n} min/Ep`:`${n} min`}function Xo(e,t=3){let n=Array.isArray(e==null?void 0:e.genres)?e.genres:[],r=[];return n.forEach(a=>{if(!a)return;if(typeof a=="string"){r.push(a);return}let i=a.tag||a.title||a.name||a.label||"";i&&r.push(i)}),Array.from(new Set(r)).slice(0,Math.max(0,t))}function Zo(e){let t=[e==null?void 0:e.tagline,e==null?void 0:e.summary,e==null?void 0:e.plot,e==null?void 0:e.overview];for(let n of t){if(typeof n!="string")continue;let r=n.trim();if(r)return Qo(r,220)}return""}function Qo(e,t){let n=String(e||"").trim();return n?n.length<=t?n:`${n.slice(0,Math.max(0,t-1)).trimEnd()}\u2026`:""}function ea(e){var t,n;return e?(t=e==null?void 0:e.ids)!=null&&t.imdb?String(e.ids.imdb):(n=e==null?void 0:e.ids)!=null&&n.tmdb?String(e.ids.tmdb):(e==null?void 0:e.ratingKey)!=null?String(e.ratingKey):"":""}function ta(e,t,n){n&&na(t,n),t==="show"?_e(e):Fe(e)}function na(e,t){if(!e||!t)return;let n=`#/${e}/${t}`;try{if(history&&typeof history.pushState=="function"){location.hash===n&&typeof history.replaceState=="function"?history.replaceState(null,"",n):history.pushState(null,"",n);return}}catch{}try{window.__skipNextHashNavigation=!0}catch{}location.hash=n}function ra(e){var a,i,s,c,l;if(!e)return"";let t=ue(),n=[(a=e==null?void 0:e.tmdb)==null?void 0:a.backdrop,(i=e==null?void 0:e.tmdb)==null?void 0:i.backdrop_path,(s=e==null?void 0:e.tmdb)==null?void 0:s.backdropPath,(c=e==null?void 0:e.tmdb)==null?void 0:c.background,(l=e==null?void 0:e.tmdb)==null?void 0:l.art],r=[e==null?void 0:e.art,e==null?void 0:e.background,e==null?void 0:e.thumbBackground,e==null?void 0:e.coverArt,e==null?void 0:e.thumb,e==null?void 0:e.thumbFile];if(t){let d=n.find(Wn);if(d)return d}return r.find(Wn)||""}function Wn(e){return typeof e=="string"&&e.trim().length>0}window.addEventListener("filters:updated",e=>{let t=e==null?void 0:e.detail,n=Array.isArray(t==null?void 0:t.items)?t.items:null;ee(n)});zo();window.addEventListener("load",()=>{try{Ke()}catch{}});function oa(e){let t=document.getElementById("settingsOverlay"),n=t==null?void 0:t.querySelector(".settings-dialog"),r=document.getElementById("settingsBtn"),o=document.getElementById("openSettings"),a=document.getElementById("headerSettingsBtn"),i=document.getElementById("settingsClose2"),s=document.getElementById("tmdbTokenInput"),c=document.getElementById("tmdbSave"),l=document.getElementById("tmdbTest"),d=document.getElementById("tmdbStatus"),f=document.getElementById("tmdbClearCache"),h=document.getElementById("tmdbStatusBadge"),u=document.getElementById("prefReduceMotion"),b=document.getElementById("useTmdbSetting"),v=document.getElementById("resetFilters"),x=document.getElementById("scrollOrchestratorToggle");t&&t.hidden&&t.setAttribute("aria-hidden","true");let C=null,P="",D=!1,$=new Map,be='a[href], button:not([disabled]), input:not([disabled]), select:not([disabled]), textarea:not([disabled]), [tabindex]:not([tabindex="-1"])';function w(){return t?Array.from(t.querySelectorAll(be)).filter(g=>!g.hasAttribute("disabled")&&g.getAttribute("aria-hidden")!=="true"):[]}function N(){n&&typeof n.focus=="function"?n.focus({preventScroll:!0}):t&&typeof t.focus=="function"&&t.focus({preventScroll:!0})}function T(g){if(!t)return;let S=Array.from(document.body.children).filter(m=>m!==t);g?S.forEach(m=>{$.has(m)||$.set(m,{ariaHidden:m.hasAttribute("aria-hidden")?m.getAttribute("aria-hidden"):null,inert:m.hasAttribute("inert")}),m.setAttribute("aria-hidden","true"),m.setAttribute("inert","")}):(S.forEach(m=>{let y=$.get(m);y?(y.ariaHidden===null||y.ariaHidden===void 0?m.removeAttribute("aria-hidden"):m.setAttribute("aria-hidden",y.ariaHidden),y.inert?m.setAttribute("inert",""):m.removeAttribute("inert"),$.delete(m)):(m.removeAttribute("aria-hidden"),m.removeAttribute("inert"))}),$.clear())}function _(){!t||D||(D=!0,t.hidden=!1,t.setAttribute("aria-hidden","false"),C=document.activeElement instanceof HTMLElement?document.activeElement:null,P=document.body.style.overflow,document.body.style.overflow="hidden",T(!0),Oe(),requestAnimationFrame(N),document.dispatchEvent(new CustomEvent("settings:open")))}function B(){!t||!D||(D=!1,t.hidden=!0,t.setAttribute("aria-hidden","true"),T(!1),document.body.style.overflow=P,C&&typeof C.focus=="function"&&C.focus(),C=null,document.dispatchEvent(new CustomEvent("settings:close")))}function O(g){if(!D)return;if(g.key==="Escape"){g.preventDefault(),B();return}if(g.key!=="Tab")return;let S=w();if(!S.length){g.preventDefault(),N();return}let m=S[0],y=S[S.length-1],K=document.activeElement;g.shiftKey?(K===m||!t.contains(K))&&(g.preventDefault(),y.focus()):K===y&&(g.preventDefault(),m.focus())}r&&r.addEventListener("click",_),o&&o.addEventListener("click",()=>{_()}),a&&a.addEventListener("click",_),i&&i.addEventListener("click",B),t&&t.addEventListener("click",g=>{g.target===t&&B()}),t&&t.addEventListener("keydown",O);function A(g="",S=""){if(d){d.textContent=g,d.dataset.kind=S,h&&(h.dataset.kind=S||"",h.title=g||"");try{if(S==="error"&&e&&e.tmdbApiKey){let m=String(localStorage.getItem("tmdbToken")||"").trim(),y=String((s==null?void 0:s.value)||"").trim();if(m&&y){try{localStorage.removeItem("tmdbToken")}catch{}s&&(s.value=""),M(!0);let K="Ung\xFCltiger Token entfernt. Verwende API Key aus config.json.";d.textContent=K,d.dataset.kind="info",h&&(h.dataset.kind="info",h.title=K)}}}catch{}}}function M(g){if(b&&(b.disabled=!g,b.title=b.disabled?"Nur verf\xFCgbar mit g\xFCltigem Token oder API Key.":"",!g&&b.checked)){try{localStorage.setItem("useTmdb","0")}catch{}b.checked=!1,z(E().view)}}function Oe(){let g="";try{s&&(s.value=g=localStorage.getItem("tmdbToken")||"")}catch{}try{u&&(u.checked=localStorage.getItem("prefReduceMotion")==="1")}catch{}try{x&&(x.checked=localStorage.getItem("scrollOrchestratorEnabled")!=="0")}catch{}try{b&&(b.checked=localStorage.getItem("useTmdb")==="1",b.disabled=!g,b.title=b.disabled?"Nur verf\xFCgbar mit g\xFCltigem Token.":"")}catch{}try{M(!!g||!!(e&&e.tmdbApiKey))}catch{}A("",""),g||A("Kein Token hinterlegt. TMDB ist deaktiviert.","info"),e!=null&&e.tmdbEnabled||A("Hinweis: TMDB in config.json deaktiviert (tmdbEnabled=false).","info"),g?(async()=>{var S;A("Pr\xFCfe Token...","pending");try{let m=await Promise.resolve().then(()=>(pe(),xe)),y=await((S=m.validateToken)==null?void 0:S.call(m,g));y&&y.ok?(M(!0),y.as==="bearer"?A("Token g\xFCltig (v4 Bearer).","success"):y.as==="apikey"&&A('API Key g\xFCltig (v3). Tipp: dauerhaft in site/config.json unter "tmdbApiKey" eintragen.',"success")):(M(!1),(y==null?void 0:y.hint)==="looksV3"?A('Eingegebener Wert sieht wie ein v3 API Key aus. Bitte in config.json als "tmdbApiKey" eintragen oder v4 Bearer Token verwenden.',"error"):A("Token ung\xFCltig oder keine Berechtigung (401).","error"))}catch{A("Pr\xFCfung fehlgeschlagen. Netzwerk/Browser-Konsole pr\xFCfen.","error")}})():M(!!(e&&e.tmdbApiKey))}c&&c.addEventListener("click",async()=>{var S;let g=String((s==null?void 0:s.value)||"").trim();try{localStorage.setItem("tmdbToken",g)}catch{}if(!g){A("Kein Token hinterlegt. TMDB ist deaktiviert.","info"),M(!!(e&&e.tmdbApiKey));return}A("Pr\xFCfe Token...","pending");try{let m=await Promise.resolve().then(()=>(pe(),xe)),y=await((S=m.validateToken)==null?void 0:S.call(m,g));y&&y.ok?(M(!0),y.as==="bearer"?A("Token g\xFCltig (v4 Bearer).","success"):y.as==="apikey"&&A('API Key g\xFCltig (v3). Tipp: dauerhaft in site/config.json unter "tmdbApiKey" eintragen.',"success")):(M(!1),(y==null?void 0:y.hint)==="looksV3"?A('Eingegebener Wert sieht wie ein v3 API Key aus. Bitte in config.json als "tmdbApiKey" eintragen oder v4 Bearer Token verwenden.',"error"):A("Token ung\xFCltig oder keine Berechtigung (401).","error"))}catch{A("Pr\xFCfung fehlgeschlagen. Netzwerk/Browser-Konsole pr\xFCfen.","error")}}),l&&l.addEventListener("click",async()=>{var S;let g=String((s==null?void 0:s.value)||"").trim();if(!g){A("Bitte Token eingeben.","error");return}A("Pr\xFCfe Token...","pending");try{let m=await Promise.resolve().then(()=>(pe(),xe)),y=await((S=m.validateToken)==null?void 0:S.call(m,g));y&&y.ok?y.as==="bearer"?A("Token g\xFCltig (v4 Bearer).","success"):y.as==="apikey"&&A('API Key g\xFCltig (v3). Tipp: dauerhaft in site/config.json unter "tmdbApiKey" eintragen.',"success"):(y==null?void 0:y.hint)==="looksV3"?A('Eingegebener Wert sieht wie ein v3 API Key aus. Dieser funktioniert hier nicht als Bearer. Bitte in config.json als "tmdbApiKey" eintragen oder v4 Bearer Token verwenden.',"error"):A("Token ung\xFCltig oder keine Berechtigung (401).","error")}catch{A("Pr\xFCfung fehlgeschlagen. Netzwerk/Browser-Konsole pr\xFCfen.","error")}}),f&&f.addEventListener("click",()=>{Promise.resolve().then(()=>(pe(),xe)).then(g=>{var S;return(S=g.clearCache)==null?void 0:S.call(g)})}),u&&u.addEventListener("change",()=>{try{localStorage.setItem("prefReduceMotion",u.checked?"1":"0")}catch{}Ut(u.checked),se&&se.setReduceMotion&&se.setReduceMotion(u.checked)}),b&&b.addEventListener("change",()=>{try{localStorage.setItem("useTmdb",b.checked?"1":"0")}catch{}b.checked&&!window.__tmdbHydrationStarted&&(window.__tmdbHydrationStarted=1,Promise.resolve().then(()=>(pe(),xe)).then(g=>{var m;let S=E();(m=g.hydrateOptional)==null||m.call(g,S.movies,S.shows,S.cfg)}).catch(()=>{}),setTimeout(()=>{b.checked&&z(E().view)},1200),setTimeout(()=>{b.checked&&z(E().view)},3e3)),z(E().view),ee()}),v&&v.addEventListener("click",()=>{let g=document.getElementById("search");g&&(g.value="");let S=document.getElementById("q");S&&(S.value="");let m=document.getElementById("onlyNew");m&&(m.checked=!1);let y=document.getElementById("yearFrom"),K=document.getElementById("yearTo");y&&(y.value=""),K&&(K.value="");let Ce=document.getElementById("collectionFilter");Ce&&(Ce.value=""),document.querySelectorAll("#genreFilters .chip.active").forEach(Ie=>Ie.classList.remove("active"));let Te=document.getElementById("genreFilters");Te&&(Te.dataset.state="empty",Te.dataset.count="0"),Promise.resolve().then(()=>(Qe(),Ht)).then(Ie=>{let ot=Ie.applyFilters();z(E().view),ee(ot)})}),x&&x.addEventListener("change",()=>{let g=x.checked;try{localStorage.setItem("scrollOrchestratorEnabled",g?"1":"0")}catch{}se&&se.setEnabled?se.setEnabled(g):g&&(B(),window.location.reload())})}function Ut(e){var t,n;try{let r=document.body;r?((t=document.documentElement)==null||t.classList.remove("reduce-motion","reduced-motion"),r.classList.remove("reduced-motion"),r.classList.toggle("reduce-motion",e)):((n=document.documentElement)==null||n.classList.toggle("reduce-motion",e),window.addEventListener("DOMContentLoaded",()=>Ut(e),{once:!0}))}catch{}}function aa(){try{let e=localStorage.getItem("prefReduceMotion")==="1";Ut(e)}catch{}}function sa(){let e=document.getElementById("toggleAdvanced"),t=document.getElementById("advancedFilters");if(!e||!t)return;let n=!1,r=0,o=()=>{n=!1,r&&(clearTimeout(r),r=0),t.dataset.state==="closing"?(t.dataset.state="closed",t.hidden=!0,t.style.removeProperty("--advanced-max")):t.dataset.state==="open"?t.style.removeProperty("--advanced-max"):t.dataset.state==="expanding"&&(t.dataset.state="open",t.style.removeProperty("--advanced-max"))},a=()=>{r&&clearTimeout(r),r=window.setTimeout(o,320)};t.addEventListener("transitionend",c=>{c.target!==t||c.propertyName!=="max-height"||o()});let i=()=>{n||(n=!0,t.hidden=!1,t.dataset.state="expanding",t.setAttribute("aria-hidden","false"),t.style.setProperty("--advanced-max","0px"),requestAnimationFrame(()=>{let c=t.scrollHeight;t.style.setProperty("--advanced-max",c+"px"),t.dataset.state="open",a()}))},s=()=>{if(n)return;n=!0;let c=t.scrollHeight;t.style.setProperty("--advanced-max",c+"px"),t.dataset.state="closing",t.setAttribute("aria-hidden","true"),requestAnimationFrame(()=>{t.style.setProperty("--advanced-max","0px"),a()})};e.addEventListener("click",()=>{e.getAttribute("aria-expanded")==="true"?(e.setAttribute("aria-expanded","false"),s()):(e.setAttribute("aria-expanded","true"),i())})}function ia(){let e=document.getElementById("siteLogo");e&&e.addEventListener("error",()=>{e.classList.add("logo-missing");let a=document.querySelector(".site-header__brand-text .site-header__label");a&&a.classList.remove("sr-only")});let t=document.getElementById("heroSubtitle"),n=["Offline st\xF6bern & Wunschlisten teilen","Filter. Finden. Freuen.","Filme & Serien \u2013 stressfrei sichtbar","Schneller als jeder SMB-Share","Merkliste zuerst, Streit sp\xE4ter"],r=0;t&&(t.textContent=n[r]);function o(){!t||t.dataset.taglinePaused==="1"||(t.classList.add("is-fading"),setTimeout(()=>{if(!t||t.dataset.taglinePaused==="1"){t&&t.classList.remove("is-fading");return}r=(r+1)%n.length,t.textContent=n[r],t.classList.remove("is-fading")},280))}t&&(t.dataset.taglinePaused="0",window.__taglineTicker||(window.__taglineTicker=setInterval(o,6e3),setTimeout(o,3e3)))}function ca(){let e=document.getElementById("scrollProgress");if(!e)return;let t=()=>{let n=document.documentElement.scrollTop||document.body.scrollTop||0,r=document.documentElement.scrollHeight-document.documentElement.clientHeight||1,o=Math.max(0,Math.min(100,n/r*100));e.style.width=o+"%"};addEventListener("scroll",t,{passive:!0}),t()}function la(){let e=document.getElementById("scrollTop");if(!e)return;let t=()=>{let n=window.scrollY||0;e.style.display=n>300?"block":"none"};addEventListener("scroll",t,{passive:!0}),t(),e.addEventListener("click",()=>window.scrollTo({top:0,behavior:"smooth"}))}function da(){let e=document.getElementById("hero"),t=document.getElementById("filterBar"),n=document.querySelector(".site-header"),r=document.getElementById("main"),o=document.getElementById("toggleAdvanced"),a=document.getElementById("advancedFilters");if(!e||!t)return;let i=localStorage.getItem("prefReduceMotion")==="1";localStorage.getItem("scrollOrchestratorEnabled")!=="0"&&(se=zn({heroEl:e,filterEl:t,headerEl:n,mainEl:r,advancedToggle:o,advancedPanel:a,reduceMotionFlag:i}))}window.__scrollOrchestrator=()=>se;
//# sourceMappingURL=main.js.map
