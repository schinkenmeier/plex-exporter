var Mn=Object.defineProperty;var F=(e,t)=>()=>(e&&(t=e(e=0)),t);var Ye=(e,t)=>{for(var n in t)Mn(e,n,{get:t[n],enumerable:!0})};function te(e){Object.assign(Xe,e),Rn.forEach(t=>t(Xe))}var Xe,Rn,y,Y=F(()=>{Xe={view:"movies",movies:[],shows:[],facets:{},filtered:[],cfg:{}},Rn=new Set,y=()=>Xe});function x(e,t,n){let r=document.createElement(e);return t&&(r.className=t),n!=null&&(r.textContent=n),r}var I,Be=F(()=>{I=(e,t=document)=>t.querySelector(e)});function Ot(e,t,n=864e5){try{let r=ne+e,o={value:t,timestamp:Date.now(),ttl:n};localStorage.setItem(r,JSON.stringify(o)),Dn()}catch(r){if(r.name==="QuotaExceededError"){qt();try{let o=ne+e,a={value:t,timestamp:Date.now(),ttl:n};localStorage.setItem(o,JSON.stringify(a))}catch{}}}}function Pt(e){try{let t=ne+e,n=localStorage.getItem(t);if(!n)return null;let r=JSON.parse(n),o=Date.now();return r.timestamp+r.ttl<o?(localStorage.removeItem(t),null):r.value}catch{return null}}function jt(){try{Object.keys(localStorage).forEach(t=>{t.startsWith(ne)&&localStorage.removeItem(t)})}catch{}}function Me(){try{let e=Object.keys(localStorage),t=Date.now(),n=0;e.forEach(r=>{if(r.startsWith(ne))try{let o=JSON.parse(localStorage.getItem(r));o.timestamp+o.ttl<t&&(localStorage.removeItem(r),n++)}catch{localStorage.removeItem(r),n++}}),n>0}catch{}}function et(){try{let t=Object.keys(localStorage).filter(s=>s.startsWith(ne)),n=Date.now(),r=0,o=0,a=0;return t.forEach(s=>{let i=localStorage.getItem(s);r+=i.length*2;try{let c=JSON.parse(i);c.timestamp+c.ttl>=n?o++:a++}catch{a++}}),{totalEntries:t.length,validEntries:o,expiredEntries:a,totalSize:r,totalSizeMB:(r/1024/1024).toFixed(2)}}catch{return null}}function Dn(){try{let e=et();e&&e.totalSize>5242880&&qt(.3)}catch{}}function qt(e=.3){try{let t=Object.keys(localStorage),n=[];t.forEach(o=>{if(o.startsWith(ne))try{let a=JSON.parse(localStorage.getItem(o));n.push({key:o,timestamp:a.timestamp})}catch{n.push({key:o,timestamp:0})}}),n.sort((o,a)=>o.timestamp-a.timestamp);let r=Math.ceil(n.length*e);for(let o=0;o<r;o++)localStorage.removeItem(n[o].key)}catch{}}var ne,$n,tt=F(()=>{ne="plex_cache_";$n=null;typeof window!="undefined"&&typeof window.document!="undefined"&&window===globalThis&&(Me(),$n=setInterval(Me,5*60*1e3))});async function nt(e,t=2,n=!0){if(n){let o=Pt(e);if(o!==null)return o}let r=null;for(let o=0;o<=t;o++){try{let a=await fetch(e,{cache:"no-store"});if(a&&a.ok){let s=await a.json();return n&&s&&Ot(e,s,On),s}if(a&&a.status===404)return null;r=new Error(`HTTP ${a.status}: ${a.statusText}`)}catch(a){r=a}if(o<t){let a=Math.min(1e3*Math.pow(2,o),5e3);await new Promise(s=>setTimeout(s,a))}}return null}function zn(e){try{let t=document.getElementById(e);if(t&&t.textContent)return JSON.parse(t.textContent)}catch{}return null}function Kn(e){try{let t=window.__PLEX_EXPORTER__;return(t&&Array.isArray(t[e])?t[e]:null)||null}catch{return null}}function Wn(e){try{return(Array.isArray(window[e])?window[e]:null)||null}catch{return null}}async function Vt(e,t){let n=await nt(e);if(Array.isArray(n)&&n.length)return fe(t==null?void 0:t.label,`primary:${e}`),n;if(t!=null&&t.embedId){let r=zn(t.embedId);if(Array.isArray(r)&&r.length)return fe(t==null?void 0:t.label,`embedded:${t.embedId}`),r}if(t!=null&&t.exportKey){let r=Kn(t.exportKey);if(Array.isArray(r)&&r.length)return fe(t==null?void 0:t.label,`globalBag:${t.exportKey}`),r}if(t!=null&&t.globalVar){let r=Wn(t.globalVar);if(Array.isArray(r)&&r.length)return fe(t==null?void 0:t.label,`window:${t.globalVar}`),r}for(let r of(t==null?void 0:t.altUrls)||[]){let o=await nt(r);if(Array.isArray(o)&&o.length)return fe(t==null?void 0:t.label,`alt:${r}`),o}return fe(t==null?void 0:t.label,"empty"),Array.isArray(n)?n:[]}function Vn(e,t){let n=e==null?"":String(e).trim();if(!n)return"";if(n.startsWith("//")||n.startsWith("/")||qn.test(n))return n;let r=n.replace(/\\/g,"/"),o=t?t.endsWith("/")?t:`${t}/`:"",a=u=>u.split("/").map(b=>{if(!b)return"";try{return encodeURIComponent(decodeURIComponent(b))}catch{return encodeURIComponent(b)}}).join("/"),i=r.replace(/^\/+/,"").split("/"),c=[];for(let u of i)if(!(!u||u===".")){if(u===".."){c.length&&c.pop();continue}c.push(u)}let l=c.join("/");if(l.startsWith("data/"))return a(l);let d=c;if(o&&d.length){let u=o.replace(/\/+$/,"").split("/").pop();u&&d[0]===u&&(d=d.slice(1))}let f=d.join("/"),g=a(f);return`${o}${g}`}function Ut(e,t){var o,a;if(!e||typeof e!="object")return e;let n=(a=(o=e.thumbFile)!=null?o:e.thumb)!=null?a:"",r=Vn(n,t);if(r)e.thumbFile=r,e.thumb=r;else if(n){let s=String(n);e.thumbFile=s,e.thumb==null&&(e.thumb=s)}return e}function Un(e){return Ut(e,Pn)}function D(e){return Ut(e,jn)}function Jt(e){return!e||typeof e!="object"||(D(e),Array.isArray(e.seasons)&&e.seasons.forEach(Gt)),e}function Gt(e){return!e||typeof e!="object"||(D(e),Array.isArray(e.episodes)&&e.episodes.forEach(t=>D(t))),e}function Jn(e){return Array.isArray(e)?(e.forEach(t=>{t&&typeof t=="object"&&Un(t)}),e):[]}function Gn(e){return Array.isArray(e)?(e.forEach(t=>{t&&typeof t=="object"&&Jt(t)}),e):[]}async function rt(){try{let e=await Vt("data/movies/movies.json",{label:"movies",embedId:"movies-json",exportKey:"movies",globalVar:"__PLEX_MOVIES__",altUrls:["movies/movies.json","data/movies.json","Filme/movies.json","movies.json"]});return Z.movies=0,Jn(e)}catch(e){if(Z.movies<Wt)return Z.movies++,await new Promise(t=>setTimeout(t,1e3*Z.movies)),rt();throw e}}async function ot(){try{let e=await Vt("data/series/series_index.json",{label:"shows",embedId:"series-json",exportKey:"shows",globalVar:"__PLEX_SHOWS__",altUrls:["series/series_index.json","data/shows.json","data/series.json","Serien/series.json","series/series.json","series.json","shows.json"]});return Z.shows=0,Gn(e)}catch(e){if(Z.shows<Wt)return Z.shows++,await new Promise(t=>setTimeout(t,1e3*Z.shows)),ot();throw e}}async function Yt(e){if(!e)return null;let t=Yn(e),n=Xn(t);if(n!==void 0)return n;let r=Zn(e),o=null;for(let a of r)try{let s=await nt(a);if(s&&typeof s=="object"){let i=Qn(s);return zt(t,i,e),Zt(i)}}catch(s){o=s}return zt(t,null,e),null}function fe(e,t){if(e)try{Kt[e]=t}catch{}}function Xt(){return{...Kt}}function Yn(e){let t=[];(e==null?void 0:e.ratingKey)!==void 0&&(e==null?void 0:e.ratingKey)!==null&&(e==null?void 0:e.ratingKey)!==""&&t.push(`rk:${String(e.ratingKey)}`);let n=Re(e==null?void 0:e.href);return n&&t.push(`href:${n}`),t}function Re(e){return e?String(e).trim().replace(/^\.\//,"").replace(/^\/+/,""):""}function Xn(e){for(let t of e)if(re.has(t)){let n=re.get(t);return n?Zt(n):null}}function zt(e,t,n){let r=t;e.forEach(c=>{re.set(c,r)});let o=n==null?void 0:n.ratingKey;o!=null&&re.set(`rk:${String(o)}`,r);let a=t&&typeof t=="object"?t.ratingKey:void 0;a!=null&&re.set(`rk:${String(a)}`,r);let s=Re(n==null?void 0:n.href);s&&re.set(`href:${s}`,r);let i=t&&typeof t=="object"?Re(t.href):"";i&&re.set(`href:${i}`,r)}function Zn(e){let t=new Set,n=Re(e==null?void 0:e.href);if(n)if(/^https?:/i.test(n))t.add(n);else{n.startsWith("data/")?t.add(n):t.add(`data/${n}`);let o=n.replace(/^data\//,"");o.startsWith("series/")||t.add(`data/series/${o}`);let a=o.replace(/^series\//,"").replace(/^details\//,"").replace(/\.json$/,"");a&&t.add(`data/series/details/${a}.json`)}let r=e==null?void 0:e.ratingKey;return r!=null&&t.add(`data/series/details/${String(r)}.json`),Array.from(t)}function Qn(e){if(!e||typeof e!="object")return null;let t={...e};D(t),t.genres=at(t.genres);let n=nr(t.cast||t.roles||[]);return t.cast=n,t.roles=n,t.seasons=Array.isArray(t.seasons)?t.seasons.map(er).filter(Boolean):[],t.seasonCount=Number.isFinite(t.seasonCount)?t.seasonCount:t.seasons.length,Jt(t),t}function er(e){if(!e||typeof e!="object")return null;let t={...e};return D(t),t.genres=at(t.genres),t.episodes=Array.isArray(t.episodes)?t.episodes.map(tr).filter(Boolean):[],Gt(t),t}function tr(e){if(!e||typeof e!="object")return null;let t={...e};return D(t),t.genres=at(t.genres),t}function at(e){if(!Array.isArray(e))return[];let t=new Set,n=[];return e.forEach(r=>{let o=null;if(typeof r=="string"){let a=r.trim();a&&(o={tag:a})}else if(r&&typeof r=="object"){let a=String(r.tag||r.title||r.name||r.label||"").trim();a&&(o={...r,tag:a})}o&&!t.has(o.tag)&&(t.add(o.tag),n.push(o))}),n}function nr(e){return Array.isArray(e)?e.map(t=>{if(!t)return null;if(typeof t=="string"){let n=t.trim();return n?{tag:n}:null}if(typeof t=="object"){let n=String(t.tag||t.name||t.role||"").trim();return n?{...t,tag:n}:{...t}}return null}).filter(Boolean):[]}function Zt(e){if(e==null)return e;try{return structuredClone(e)}catch{}try{return JSON.parse(JSON.stringify(e))}catch{}return e}var Kt,re,Z,Wt,On,Pn,jn,qn,he=F(()=>{tt();Kt={movies:null,shows:null},re=new Map,Z={movies:0,shows:0},Wt=3,On=1e3*60*30,Pn="data/movies/",jn="data/series/",qn=/^[a-z][a-z0-9+.-]*:/i});function oe(e){let t=new Set,n=[];return(e||[]).forEach(r=>{let o="";typeof r=="string"?o=r:r&&typeof r=="object"&&(o=r.tag||r.title||r.name||"");let a=String(o||"").trim();a&&!t.has(a)&&(t.add(a),n.push(a))}),n}function st(e,t,n=3){if(!e)return;let r=(t||[]).filter(Boolean);if(r.length>n){let o=r.slice(0,n),a=r.slice(n),s=o.map(c=>De(c)),i=De(`+ ${a.length}`);i.classList.add("more","card__chip--more"),i.setAttribute("data-more",a.length),i.setAttribute("title",`${a.length} weitere Genres: ${a.join(", ")}`),i._extraChips=a.map(c=>De(c)),s.push(i),e.replaceChildren(...s)}else{let o=r.map(a=>De(a));e.replaceChildren(...o)}or(e)}function or(e=document){try{e.querySelectorAll(".chip.more, .card__chip--more").forEach(t=>{t.dataset.bound||(t.dataset.bound="1",t.addEventListener("click",n=>{n.stopPropagation();let r=t.closest(".card");if(r)r.click();else{let o=t._extraChips||[];try{o.forEach(a=>t.before(a))}catch{}t.remove()}}))})}catch{}}function z(e){return e!=null&&e.year?e.year:e!=null&&e.originallyAvailableAt?String(e.originallyAvailableAt).slice(0,4):""}function $(e){if(e instanceof Number)return $(e.valueOf());if(typeof e=="number")return Number.isFinite(e)?e.toFixed(1):"0.0";if(typeof e=="string"){let t=e.trim();if(!t)return"0.0";let n=Number(t);return Number.isFinite(n)?n.toFixed(1):"0.0"}return"0.0"}function De(e){let t=document.createElement("span");return t.className="chip",t.textContent=String(e||""),t}function $e(e){if(!(e!=null&&e.addedAt))return!1;let t=new Date(e.addedAt).getTime();if(!Number.isFinite(t))return!1;let n=y().cfg||{},r=Number(n.newDays||30);return Date.now()-t<=r*24*60*60*1e3}function ae(){try{return localStorage.getItem("useTmdb")==="1"}catch{return!1}}var we=F(()=>{Y()});function ar(){try{K=new Set(JSON.parse(localStorage.getItem(tn)||"[]"))}catch{K=new Set}}function nn(){try{localStorage.setItem(tn,JSON.stringify(Array.from(K.values())))}catch{}}function ct(e){var r,o;if(!e)return"";let t=e.type==="tv"||e.libraryType==="show"?"show":"movie",n=((r=e.ids)==null?void 0:r.imdb)||((o=e.ids)==null?void 0:o.tmdb)||String(e.ratingKey||"");return n?`${t}:${n}`:""}function rn(e){return K.has(ct(e))}function sr(){return K.size}function lt(e){let t=ct(e);if(!t)return;K.has(t)?K.delete(t):K.add(t),nn(),dt();let n=document.getElementById("watchlistPanel");n&&!n.hidden&&Oe()}function dt(){let e=document.getElementById("watchlistCount");e&&(e.textContent=String(sr()))}function Qt(){let e=document.getElementById("watchlistPanel");e&&(e.hidden=!1,e.setAttribute("aria-hidden","false"),Oe(),document.dispatchEvent(new CustomEvent("watchlist:open")))}function en(){let e=document.getElementById("watchlistPanel");e&&(e.hidden=!0,e.setAttribute("aria-hidden","true"),document.dispatchEvent(new CustomEvent("watchlist:close"))),it(!1)}function ir(){K.clear(),nn(),dt(),Oe()}function cr(){let e=on(),t=JSON.stringify(e,null,2),n=new Blob([t],{type:"application/json"}),r=document.createElement("a");r.href=URL.createObjectURL(n),r.download="watchlist.json",document.body.append(r),r.click(),r.remove(),setTimeout(()=>URL.revokeObjectURL(r.href),1e3)}function on(){let e=y(),t=(e.movies||[]).concat(e.shows||[]),n=new Map(t.map(r=>[ct(r),r]));return Array.from(K.values()).map(r=>n.get(r)).filter(Boolean)}function Oe(){let e=document.getElementById("watchlistItems"),t=document.getElementById("watchlistEmpty");if(!e||!t)return;let n=on();if(n.length===0){e.replaceChildren(),t.hidden=!1;return}t.hidden=!0;let r=document.createDocumentFragment();n.forEach(o=>{let a=document.createElement("li");a.className="watchlist-item";let s=document.createElement("span");s.className="title",s.textContent=o.title||"";let i=document.createElement("button");i.textContent="Entfernen",i.addEventListener("click",()=>{lt(o),Oe()});let c=document.createElement("button");c.textContent="\xD6ffnen",c.addEventListener("click",()=>{var f,g;let l=o.type==="tv"?"show":"movie",d=((f=o.ids)==null?void 0:f.imdb)||((g=o.ids)==null?void 0:g.tmdb)||String(o.ratingKey||"");d&&(location.hash=`#/${l}/${d}`)}),a.append(s,c,i),r.append(a)}),e.replaceChildren(r)}function an(){ar(),dt();let e=document.getElementById("openWatchlist"),t=document.getElementById("watchlistToggle"),n=document.getElementById("closeWatchlist"),r=document.getElementById("clearWatchlist"),o=document.getElementById("exportWatchlist");e&&e.addEventListener("click",()=>{Qt(),it(!0)}),t&&t.addEventListener("click",()=>{let a=document.getElementById("watchlistPanel");a&&!a.hidden?en():(Qt(),it(!0))}),n&&n.addEventListener("click",()=>{en()}),r&&r.addEventListener("click",()=>{ir()}),o&&o.addEventListener("click",()=>{cr()})}function it(e){let t=document.getElementById("watchlistToggle");t&&t.setAttribute("aria-expanded",e?"true":"false")}var tn,K,ut=F(()=>{Y();tn="watchlist:v1",K=new Set});function cn(e,t){let n=lr(e,t);if(!n)return;let r=Array.isArray(e)&&!ft(e)?e||[]:Array.isArray(t)?t:[];n.replaceChildren(),(r||[]).forEach((o,a)=>n.append(dr(o,a)))}function ft(e){return e instanceof Element||typeof e=="string"}function lr(e,t){if(ft(e)){if(e instanceof Element)return e;if(typeof e=="string")return document.querySelector(e)}if(ft(t)){if(t instanceof Element)return t;if(typeof t=="string")return document.querySelector(t)}return document.getElementById("seasonsAccordion")}function dr(e,t){D(e);let n=document.createElement("article");n.className="season-card";let r=document.createElement("div");r.className="season-head";let o=document.createElement("div");o.className="season-thumb";let a=new Image;a.loading="lazy",a.decoding="async",a.src=e.thumbFile||"",a.alt=e.title||`Staffel ${e.seasonNumber||t+1}`,o.append(a);let s=document.createElement("div"),i=document.createElement("div");i.className="season-title",i.textContent=e.title||`Staffel ${e.seasonNumber||t+1}`;let c=document.createElement("div");c.className="season-sub";let l=e.year||e.releaseYear||"",d=Array.isArray(e.episodes)?e.episodes.length:e.episodeCount||0;c.textContent=[l,d?`${d} Episoden`:""].filter(Boolean).join(" \u2022 "),s.append(i,c);let f=document.createElement("div");f.className="chev",f.textContent="\u203A",r.append(o,s,f);let g=document.createElement("div");return g.className="season-body",(e.episodes||[]).forEach(u=>{D(u),g.append(ur(u))}),r.addEventListener("click",()=>n.classList.toggle("open")),n.append(r,g),n}function ur(e){var g;let t=document.createElement("div");t.className="episode";let n=document.createElement("div");n.className="ep-title";let r=e.seasonNumber!=null?Number(e.seasonNumber):null,o=e.episodeNumber!=null?Number(e.episodeNumber):null,a=e.seasonEpisode&&String(e.seasonEpisode).toUpperCase()||(Number.isFinite(r)&&Number.isFinite(o)?`S${String(r).padStart(2,"0")}E${String(o).padStart(2,"0")}`:"");n.textContent=`${a?a+" \u2022 ":""}${e.title||""}`;let s=document.createElement("div");s.className="badges";let i=Number((g=e.audienceRating)!=null?g:e.rating);if(Number.isFinite(i)){let u=document.createElement("span");u.className="badge",u.textContent=`${i.toFixed(1)}`,s.append(u)}let c=document.createElement("div");c.className="ep-meta";let l=e.durationMin||(e.duration?Math.round(Number(e.duration)/6e4):null),d=e.durationHuman||(l?`${l} min`:null),f=e.originallyAvailableAt||e.date||"";return c.textContent=[d,f].filter(Boolean).join(" \u2022 "),t.append(n,s,c),t}var ln=F(()=>{he()});function Ee(e){if(e==null||typeof e!="object")return e;if(typeof structuredClone=="function")try{return structuredClone(e)}catch{}try{return JSON.parse(JSON.stringify(e))}catch{}if(Array.isArray(e))return e.map(n=>Ee(n));let t={};for(let n of Object.keys(e))t[n]=Ee(e[n]);return t}function Pe(e){if(!e||typeof e!="object")return null;let t=Ee(e);return t.type==="show"&&(t.type="tv"),t.type||(t.type="movie"),t}function je(e){if(!e||typeof e!="object")return null;let t=Ee(e);return t.type!=="tv"&&(t.type="tv"),ht(t),t}function fr(e){if(!e||typeof e!="object")return null;let t=Ee(e);return ht(t),t}function dn(e){let t=Array.isArray(e==null?void 0:e.seasons)?e.seasons:[],n=t.some(o=>Array.isArray(o==null?void 0:o.episodes)&&o.episodes.length),r=Array.isArray(e==null?void 0:e.cast)?e.cast:Array.isArray(e==null?void 0:e.roles)?e.roles:[];return!t.length||!n||!r.length}function un(e,t){if(!e)return e;if(t&&typeof t=="object"){let n=fr(t);Object.assign(e,n)}return ht(e),e}function ht(e){if(!e||typeof e!="object")return;gt(e),e.genres=pt(e.genres);let t=pr(e.cast||e.roles||[]);e.cast=t,e.roles=t,e.seasons=Array.isArray(e.seasons)?e.seasons.map(hr).filter(Boolean):[];let n=Number(e.seasonCount);e.seasonCount=Number.isFinite(n)&&n>0?n:e.seasons.length}function hr(e){if(!e||typeof e!="object")return null;let t={...e};return gt(t),t.genres=pt(t.genres),t.episodes=Array.isArray(t.episodes)?t.episodes.map(gr).filter(Boolean):[],t}function gr(e){if(!e||typeof e!="object")return null;let t={...e};return gt(t),t.genres=pt(t.genres),t}function gt(e){D(e)}function pt(e){if(!Array.isArray(e))return[];let t=new Set,n=[];return e.forEach(r=>{let o=null;if(typeof r=="string"){let a=r.trim();a&&(o={tag:a})}else if(r&&typeof r=="object"){let a=String(r.tag||r.title||r.name||r.label||"").trim();a&&(o={...r,tag:a})}o&&!t.has(o.tag)&&(t.add(o.tag),n.push(o))}),n}function pr(e){return Array.isArray(e)?e.map(t=>{if(!t)return null;if(typeof t=="string"){let n=t.trim();return n?{tag:n}:null}if(typeof t=="object"){let n=String(t.tag||t.name||t.role||"").trim();return n?{...t,tag:n}:{...t}}return null}).filter(Boolean):[]}var fn=F(()=>{he()});function wr(){if(H)return H;let e=document.getElementById("modal-root-v2");if(!e)return null;if(V=e,e.classList.add("modalv2-overlay"),e.hasAttribute("hidden")||e.setAttribute("hidden",""),e.dataset.modalv2Ready||(e.innerHTML=`
      <div class="modalv2-backdrop" data-modalv2-backdrop="1"></div>
      <div class="modalv2-dialog" role="dialog" aria-modal="true">
        <div class="modalv2-scroll" data-modalv2-scroll></div>
      </div>
    `,e.dataset.modalv2Ready="1",e.addEventListener("click",Er)),N=e.querySelector(".modalv2-dialog"),N&&!N.hasAttribute("tabindex")&&N.setAttribute("tabindex","-1"),ee=e.querySelector("[data-modalv2-scroll]"),ee&&!H){let t=ee.querySelector(".modalv2");t?H=t:(H=document.createElement("div"),H.className="modalv2",H.setAttribute("hidden",""),ee.appendChild(H))}return H}function Er(e){if(!V)return;let t=e.target;(t===V||t&&t.dataset&&t.dataset.modalv2Backdrop)&&mt()}function gn(){return N?Array.from(N.querySelectorAll('a[href], button:not([disabled]), textarea, input, select, [tabindex]:not([tabindex="-1"])')).filter(t=>t.hasAttribute("disabled")||t.getAttribute("aria-hidden")==="true"||t.hasAttribute("hidden")?!1:t.offsetParent!==null):[]}function Sr(){N&&(ie&&N.removeEventListener("keydown",ie),ie=e=>{if(e.key!=="Tab")return;let t=gn();if(!t.length)return;let n=t[0],r=t[t.length-1];e.shiftKey?document.activeElement===n&&(e.preventDefault(),r.focus()):document.activeElement===r&&(e.preventDefault(),n.focus())},N.addEventListener("keydown",ie))}function Ar(){!N||!ie||(N.removeEventListener("keydown",ie),ie=null)}function kr(){pe||(pe=e=>{e.key==="Escape"&&(e.preventDefault(),mt())},window.addEventListener("keydown",pe))}function xr(){pe&&(window.removeEventListener("keydown",pe),pe=null)}function qe(){let e=wr();return!e||!V?null:(V.hidden=!1,V.setAttribute("aria-hidden","false"),document.body.classList.add("modalv2-open"),ee&&(ee.scrollTop=0),Sr(),kr(),document.dispatchEvent(new CustomEvent("modal:open")),e)}function bt(){if(!N)return;let e=N.querySelector("#v2Close"),t=gn(),n=e&&!e.hasAttribute("hidden")?e:t[0];if(n||(n=N),n){let r=()=>{try{n.focus()}catch{}};(window.requestAnimationFrame||setTimeout)(r,0)}}function Cr(e){var r;let t=((r=e==null?void 0:e.tmdb)==null?void 0:r.poster)||(e==null?void 0:e.tmdbPoster),n=(e==null?void 0:e.poster)||(e==null?void 0:e.thumbFile)||(e==null?void 0:e.art)||"";return ae()&&t?t:n}function pn(e){let t=(e==null?void 0:e.runtimeMin)||(e==null?void 0:e.durationMin)||(e!=null&&e.duration?Math.round(Number(e.duration)/6e4):null);return Number.isFinite(t)?(e==null?void 0:e.type)==="tv"?`~${t} min/Ep`:`${t} min`:""}function Tr(e){var n;let t=Number((n=e==null?void 0:e.rating)!=null?n:e==null?void 0:e.audienceRating);return Number.isFinite(t)?`\u2605 ${$(t)}`:""}function bn(e){return(e==null?void 0:e.studio)||(e==null?void 0:e.network)||(e==null?void 0:e.studioName)||""}function Ir(e){let t=[e==null?void 0:e.originallyAvailableAt,e==null?void 0:e.releaseDate,e==null?void 0:e.premiereDate,e==null?void 0:e.firstAired,e==null?void 0:e.airDate];for(let r of t){let o=r==null?"":String(r).trim();if(!o)continue;let a=new Date(o);if(Number.isFinite(a.getTime()))try{return a.toLocaleDateString("de-DE",{year:"numeric",month:"2-digit",day:"2-digit"})}catch{}let s=o.match(/^\d{4}-\d{2}-\d{2}/);if(s&&s[0])return s[0];if(o.length>=4)return o.slice(0,10)}let n=z(e);return n?String(n):""}function se(e){return Array.isArray(e)?e.map(t=>t?typeof t=="string"?t:t.tag||t.title||t.name||"":"").filter(Boolean):[]}function Lr(e){let n=(Array.isArray(e==null?void 0:e.genres)?e.genres:[]).map(r=>r?typeof r=="string"?r:r.tag||r.title||r.name||"":"").filter(Boolean);return Array.from(new Set(n))}function Nr(e){let t=[];return $e(e)&&t.push("Neu"),(e==null?void 0:e.type)==="tv"&&Number.isFinite(Number(e==null?void 0:e.seasonCount))&&t.push(`Staffeln: ${e.seasonCount}`),((e==null?void 0:e.genres)||[]).map(r=>r?typeof r=="string"?r:r.tag||r.title||r.name||"":"").filter(Boolean).forEach(r=>t.push(r)),t}function Br(e){return(Array.isArray(e==null?void 0:e.cast)?e.cast:Array.isArray(e==null?void 0:e.roles)?e.roles:[]).map(n=>{var i,c,l;if(!n)return null;if(typeof n=="string"){let d=String(n).trim();return d?{name:d,role:"",thumb:"",tmdbProfile:"",raw:null}:null}let r=String(n.tag||n.name||n.role||"").trim();if(!r)return null;let o=(()=>{let d=String(n.role||"").trim();return d?d.toLowerCase()===r.toLowerCase()?"":d:""})(),a=[(i=n==null?void 0:n.tmdb)==null?void 0:i.profile,(c=n==null?void 0:n.tmdb)==null?void 0:c.profile_path,(l=n==null?void 0:n.tmdb)==null?void 0:l.profilePath,n==null?void 0:n.tmdbProfile,n==null?void 0:n.profile,n==null?void 0:n.profile_path,n==null?void 0:n.profilePath].find(d=>typeof d=="string"&&d.trim()),s=[n==null?void 0:n.thumb,n==null?void 0:n.photo,n==null?void 0:n.image].find(d=>typeof d=="string"&&d.trim())||"";return{name:r,role:o,thumb:s,tmdbProfile:a?String(a).trim():"",raw:n}}).filter(Boolean)}function Fr(e){let t=String(e||"").trim();if(!t)return"";if(/^https?:\/\//i.test(t))return t;if(t.startsWith("//"))return`https:${t}`;let n=t.startsWith("/")?t:`/${t}`;return`${br}${mr}${n}`}function Hr(e){let t=String(e||"").trim();return t?/^https?:\/\//i.test(t)||t.startsWith("data:")?t:t.startsWith("//")?`https:${t}`:t:""}function _r(e,t){var o,a,s;if(!e)return"";let n=e.raw||{};if(t){let i=[e.tmdbProfile,(o=n==null?void 0:n.tmdb)==null?void 0:o.profile,(a=n==null?void 0:n.tmdb)==null?void 0:a.profile_path,(s=n==null?void 0:n.tmdb)==null?void 0:s.profilePath,n==null?void 0:n.tmdbProfile,n==null?void 0:n.profile,n==null?void 0:n.profile_path,n==null?void 0:n.profilePath];for(let c of i){let l=Fr(c);if(l)return l}}let r=[e.thumb,n==null?void 0:n.thumb,n==null?void 0:n.photo,n==null?void 0:n.image];for(let i of r){let c=Hr(i);if(c)return c}return""}function Mr(e){let t=String(e||"").trim();if(!t)return"?";let r=t.split(/\s+/).slice(0,2).map(o=>o.charAt(0)).filter(Boolean);return r.length?r.join("").toUpperCase():t.charAt(0).toUpperCase()}function Rr(e){let t=e.querySelector(".v2-tabs");if(!t)return;let n=Array.from(t.querySelectorAll("button[data-t]")),r=s=>{n.forEach(i=>{let c=i.dataset.t===s;i.classList.toggle("active",c),i.setAttribute("aria-selected",c?"true":"false"),i.tabIndex=c?0:-1;let l=e.querySelector(`.v2-pane[data-pane="${i.dataset.t}"]`);l&&(l.hidden=!c,l.setAttribute("aria-hidden",l.hidden?"true":"false"))})},o=(s,i)=>{if(!n.length)return;let c=n.indexOf(s),l=i>0?0:n.length-1,d=c===-1?l:(c+i+n.length)%n.length,f=n[d];f&&(f.focus(),r(f.dataset.t))};t.addEventListener("click",s=>{let i=s.target.closest("button[data-t]");i&&(s.preventDefault(),r(i.dataset.t))}),t.addEventListener("keydown",s=>{let i=s.target.closest("button[data-t]");if(i)switch(s.key){case"ArrowLeft":case"ArrowUp":s.preventDefault(),o(i,-1);break;case"ArrowRight":case"ArrowDown":s.preventDefault(),o(i,1);break;case"Home":s.preventDefault(),n[0]&&(n[0].focus(),r(n[0].dataset.t));break;case"End":if(s.preventDefault(),n.length){let c=n[n.length-1];c.focus(),r(c.dataset.t)}break;default:break}});let a=n.find(s=>s.classList.contains("active"))||n[0];a&&r(a.dataset.t)}function Dr(e,t){let n=e.querySelector(".v2-cast");if(!n)return;n.innerHTML='<div class="v2-cast-scroll"></div>';let r=n.querySelector(".v2-cast-scroll");if(!r)return;let o=Array.isArray(t)?t.slice(0,12):[];if(!o.length){r.innerHTML='<span class="modalv2-loading">Keine Besetzungsdaten verf\xFCgbar.</span>',r.removeAttribute("role");return}r.setAttribute("role","list");let a=ae();o.forEach(s=>{let i=s&&typeof s=="object"&&"name"in s?s:(()=>{let u=String(s||"").trim();return u?{name:u,role:"",thumb:"",tmdbProfile:"",raw:null}:null})();if(!i||!i.name)return;let c=document.createElement("article");c.className="v2-cast-card",c.tabIndex=0,c.setAttribute("role","listitem");let l=String(i.role||"").trim();c.setAttribute("aria-label",l?`${i.name} \u2013 ${l}`:i.name);let d=document.createElement("div");d.className="v2-cast-avatar";let f=_r(i,a);if(f){d.classList.add("has-image");let u=document.createElement("img");u.src=f,u.alt=i.name,u.loading="lazy",u.decoding="async",d.appendChild(u)}else{let u=document.createElement("span");u.className="v2-cast-initials",u.textContent=Mr(i.name),u.setAttribute("aria-hidden","true"),d.appendChild(u)}let g=document.createElement("p");if(g.className="v2-cast-name",g.textContent=i.name,c.append(d,g),l){let u=document.createElement("p");u.className="v2-cast-role",u.textContent=l,c.append(u)}else c.classList.add("v2-cast-card--no-role");r.appendChild(c)}),r.children.length||(r.innerHTML='<span class="modalv2-loading">Keine Besetzungsdaten verf\xFCgbar.</span>',r.removeAttribute("role"))}function $r(e,t){let n=e.querySelector(".v2-overview");if(!n)return;let r=typeof t=="string"?t:"";if(!r){n.textContent="";return}let o=document.createElement("p");o.className="v2-overview-text line-clamp line-clamp-5",o.textContent=r;let a=document.createElement("button");a.type="button",a.className="v2-overview-toggle";let s=l=>{o.classList.toggle("is-expanded",l),a.setAttribute("aria-expanded",String(l)),a.textContent=l?"Weniger anzeigen":"Mehr anzeigen"};a.addEventListener("click",()=>{let l=a.getAttribute("aria-expanded")==="true";s(!l)}),n.replaceChildren(o,a),s(!1),(typeof requestAnimationFrame=="function"?requestAnimationFrame:l=>setTimeout(l,0))(()=>{o.scrollHeight>o.clientHeight+1||(o.classList.add("is-expanded"),a.hidden=!0)})}function Or(e,t){let n=e.querySelector(".v2-details");if(!n)return;n.replaceChildren();let r=document.createElement("div");r.className="v2-details-grid";let o=[],a=Ir(t);a&&o.push(["Ver\xF6ffentlichung",a]);let s=pn(t);s&&o.push(["Laufzeit",s]);let i=bn(t);i&&o.push(["Studio",i]);let c=((t==null?void 0:t.contentRating)||"").trim();c&&o.push(["Freigabe",c]);let l=w=>{if(w instanceof Number)return l(w.valueOf());if(typeof w=="number")return Number.isFinite(w)?$(w):"";if(typeof w=="string"){let T=w.trim();if(!T)return"";let C=Number(T);return Number.isFinite(C)?$(C):""}return""},d=l(t==null?void 0:t.rating),f=l(t==null?void 0:t.audienceRating),g=l(t==null?void 0:t.userRating);if(d?(o.push(["Bewertung",`\u2605 ${d}`]),f&&f!==d&&o.push(["Publikum",`\u2605 ${f}`])):f&&o.push(["Bewertung",`\u2605 ${f}`]),g&&o.push(["Eigene Wertung",`\u2605 ${g}`]),(t==null?void 0:t.type)==="tv"){let w=Number(t==null?void 0:t.seasonCount),T=Number.isFinite(w)?w:Array.isArray(t==null?void 0:t.seasons)?t.seasons.length:null;Number.isFinite(T)&&T>0&&o.push(["Staffeln",String(T)]);let C=Array.isArray(t==null?void 0:t.seasons)?t.seasons.reduce((B,L)=>{if(!L)return B;let j=Array.isArray(L.episodes)?L.episodes.length:0;return B+(Number.isFinite(j)?j:0)},0):null;Number.isFinite(C)&&C>0&&o.push(["Episoden",String(C)])}let u=se(t==null?void 0:t.countries);u.length&&o.push(["L\xE4nder",u.join(", ")]);let b=se(t==null?void 0:t.collections);b.length&&o.push(["Sammlungen",b.join(", ")]);let v=se(t==null?void 0:t.labels);if(v.length&&o.push(["Labels",v.join(", ")]),t!=null&&t.editionTitle&&o.push(["Edition",t.editionTitle]),t!=null&&t.originalTitle&&t.originalTitle!==t.title&&o.push(["Originaltitel",t.originalTitle]),o.length){let w=document.createElement("section");w.className="v2-details-section",w.dataset.section="general";let T=document.createElement("h3");T.className="v2-details-heading",T.textContent="Allgemein";let C=document.createElement("dl");C.className="v2-details-list",o.forEach(([B,L])=>{if(!B||!L)return;let j=document.createElement("dt");j.textContent=B;let S=document.createElement("dd");S.textContent=L,C.append(j,S)}),C.childElementCount&&(w.append(T,C),r.append(w))}let k=Lr(t);if(k.length){let w=document.createElement("section");w.className="v2-details-section",w.dataset.section="genres";let T=document.createElement("h3");T.className="v2-details-heading",T.textContent="Genres";let C=document.createElement("div");C.className="v2-chip-group",k.forEach(B=>{let L=document.createElement("span");L.className="chip",L.textContent=B,C.appendChild(L)}),w.append(T,C),r.append(w)}let A=[],P=se(t==null?void 0:t.directors);P.length&&A.push(["Regie",P.join(", ")]);let M=se(t==null?void 0:t.writers);M.length&&A.push(["Drehbuch",M.join(", ")]);let R=se(t==null?void 0:t.producers);R.length&&A.push(["Produktion",R.join(", ")]);let Ne=se((t==null?void 0:t.creators)||(t==null?void 0:t.showrunners));if((t==null?void 0:t.type)==="tv"&&Ne.length&&A.push(["Creator",Ne.join(", ")]),A.length){let w=document.createElement("section");w.className="v2-details-section",w.dataset.section="crew";let T=document.createElement("h3");T.className="v2-details-heading",T.textContent="Credits";let C=document.createElement("dl");C.className="v2-details-list",A.forEach(([B,L])=>{if(!B||!L)return;let j=document.createElement("dt");j.textContent=B;let S=document.createElement("dd");S.textContent=L,C.append(j,S)}),C.childElementCount&&(w.append(T,C),r.append(w))}if(r.childElementCount)n.appendChild(r);else{let w=document.createElement("p");w.className="v2-details-empty",w.textContent="Keine zus\xE4tzlichen Details verf\xFCgbar.",n.appendChild(w)}}function Pr(e,t){let n=e.querySelector(".v2-seasons");if(!n)return;let r=Array.isArray(t==null?void 0:t.seasons)?t.seasons:[];if(!r.length){n.innerHTML='<p class="modalv2-loading">Keine Staffel-Informationen verf\xFCgbar.</p>';return}n.innerHTML="",cn(n,r)}function jr(e,t){var l,d;let n=e.querySelector("#v2Tmdb"),r=e.querySelector("#v2Imdb"),o=e.querySelector("#v2Trailer"),a=((l=t==null?void 0:t.ids)==null?void 0:l.tmdb)||(t==null?void 0:t.tmdbId),s=((d=t==null?void 0:t.ids)==null?void 0:d.imdb)||(t==null?void 0:t.imdbId),i=(t==null?void 0:t.trailer)||(t==null?void 0:t.trailerUrl),c=(t==null?void 0:t.type)==="tv"?"tv":"movie";n&&(a?(n.hidden=!1,n.href=`https://www.themoviedb.org/${c}/${a}`):(n.hidden=!0,n.removeAttribute("href"))),r&&(s?(r.hidden=!1,r.href=`https://www.imdb.com/title/${s}/`):(r.hidden=!0,r.removeAttribute("href"))),o&&(i?(o.hidden=!1,o.onclick=()=>window.open(i,"_blank","noopener")):(o.hidden=!0,o.onclick=null))}function qr(e,t){let n=e.querySelector(".v2-title");n&&(n.textContent=(t==null?void 0:t.title)||(t==null?void 0:t.name)||"");let r=((t==null?void 0:t.tagline)||"").trim(),o=e.querySelector(".v2-meta"),a=e.querySelector(".v2-subline"),s=z(t),i=pn(t),c=Tr(t),l=bn(t),d=[s,i,c,l].filter(Boolean);if(a){let v=d.join(" \u2022 ");a.textContent=r||v,a.hidden=!(r||v)}o&&(o.textContent=r&&d.length?d.join(" \u2022 "):"",o.hidden=!(r&&d.length));let f=e.querySelector(".v2-chips");f&&(f.replaceChildren(),Nr(t).forEach(v=>{let k=document.createElement("span");k.className="chip",k.textContent=v,f.appendChild(k)}),f.hidden=!f.childElementCount);let g=e.querySelector(".v2-facts"),u=e.querySelector(".v2-facts-list");if(g&&u){let v=[];s&&v.push(["Jahr",s]);let k=((t==null?void 0:t.contentRating)||"").trim();k&&v.push(["Freigabe",k]),i&&v.push(["Laufzeit",i]),c&&v.push(["Bewertung",c]),l&&v.push(["Studio",l]),u.replaceChildren(),v.forEach(([A,P])=>{let M=document.createElement("dt");M.textContent=A;let R=document.createElement("dd");R.textContent=P,u.append(M,R)}),g.hidden=!v.length}let b=e.querySelector(".v2-poster img");if(b){let v=Cr(t);b.src=v||"",b.alt=t!=null&&t.title?`Poster: ${t.title}`:"",b.loading="lazy",b.decoding="async",b.classList.remove("is-ready"),v?(b.addEventListener("load",hn,{once:!0}),b.addEventListener("error",hn,{once:!0})):b.classList.add("is-ready")}}function hn(e){var t;(t=e.currentTarget)==null||t.classList.add("is-ready")}function zr(e="Details werden geladen \u2026"){let t=qe();if(!t)return;t.hidden=!1;let n=document.createElement("div");n.className="modalv2-loading",n.textContent=String(e||"Details werden geladen \u2026"),t.replaceChildren(n)}function mn(e){let t=qe();if(!t)return;t.hidden=!1;let n=(e==null?void 0:e.type)==="tv";t.innerHTML=`
    <section class="v2-layout">
      <aside class="v2-side">
        <div class="v2-poster"><img alt=""></div>
        <div class="v2-facts" aria-label="Schnellinfos" hidden>
          <h3 class="v2-facts-title">Schnellinfos</h3>
          <dl class="v2-facts-list"></dl>
        </div>
      </aside>
      <div class="v2-info">
        <header class="v2-head">
          <div class="v2-titlebar">
            <div class="v2-title-wrap">
              <h2 class="v2-title" id="modalV2Title"></h2>
              <div class="v2-subline"></div>
              <div class="v2-meta"></div>
            </div>
            <div class="v2-actions" aria-label="Externe Aktionen">
              <button class="v2-icon-btn" id="v2Close" type="button" aria-label="Schlie\xDFen">
                <svg class="v2-icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                  <path d="M6 6l12 12M6 18L18 6" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"></path>
                </svg>
              </button>
              <a class="v2-icon-btn" id="v2Tmdb" target="_blank" rel="noopener noreferrer" aria-label="Auf TMDB \xF6ffnen" hidden>
                <svg class="v2-icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                  <path d="M4 9h16v10a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V9z" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linejoin="round"></path>
                  <path d="M4 9V7a2 2 0 0 1 2-2h1l2 4 2-4 2 4 2-4h1a2 2 0 0 1 2 2v2" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"></path>
                </svg>
              </a>
              <a class="v2-icon-btn" id="v2Imdb" target="_blank" rel="noopener noreferrer" aria-label="Auf IMDb \xF6ffnen" hidden>
                <svg class="v2-icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                  <path d="M12 4l2.4 4.9 5.4.8-3.9 3.8.9 5.4-4.8-2.5-4.8 2.5.9-5.4-3.9-3.8 5.4-.8z" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linejoin="round"></path>
                </svg>
              </a>
              <button class="v2-icon-btn" id="v2Trailer" type="button" aria-label="Trailer abspielen" hidden>
                <svg class="v2-icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                  <path d="M9 6l8 6-8 6V6z" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linejoin="round" stroke-linecap="round"></path>
                </svg>
              </button>
            </div>
          </div>
          <div class="v2-chips" aria-label="Attribute"></div>
        </header>
        <nav class="v2-tabs" aria-label="Details Navigation" role="tablist">
          <button type="button" data-t="overview" class="active" id="v2TabOverview" role="tab" aria-controls="v2PaneOverview" aria-selected="true">\xDCberblick</button>
          <button type="button" data-t="details" id="v2TabDetails" role="tab" aria-controls="v2PaneDetails" aria-selected="false">Details</button>
          ${n?'<button type="button" data-t="seasons" id="v2TabSeasons" role="tab" aria-controls="v2PaneSeasons" aria-selected="false">Staffeln</button>':""}
          <button type="button" data-t="cast" id="v2TabCast" role="tab" aria-controls="v2PaneCast" aria-selected="false">Cast</button>
        </nav>
        <section class="v2-body">
          <div class="v2-pane v2-overview" data-pane="overview" id="v2PaneOverview" role="tabpanel" aria-labelledby="v2TabOverview"></div>
          <div class="v2-pane v2-details" data-pane="details" id="v2PaneDetails" role="tabpanel" aria-labelledby="v2TabDetails" hidden></div>
          ${n?'<div class="v2-pane v2-seasons" data-pane="seasons" id="v2PaneSeasons" role="tabpanel" aria-labelledby="v2TabSeasons" hidden></div>':""}
          <div class="v2-pane v2-cast" data-pane="cast" id="v2PaneCast" role="tabpanel" aria-labelledby="v2TabCast" hidden></div>
        </section>
      </div>
    </section>
  `,qr(t,e),jr(t,e),$r(t,(e==null?void 0:e.overview)||(e==null?void 0:e.summary)||""),Or(t,e),(e==null?void 0:e.type)==="tv"&&Pr(t,e),Dr(t,Br(e)),Rr(t);let r=t.querySelector("#v2Close");r&&r.addEventListener("click",mt),N&&N.setAttribute("aria-labelledby","modalV2Title"),bt()}async function Ae(e){let t=++Q;ge=document.activeElement instanceof HTMLElement?document.activeElement:null;let n=qe();if(!n)return;let r=Kr(e);if(t===Q){if(!r){n.hidden=!1;let o=document.createElement("div");o.className="modalv2-loading",o.textContent="Film konnte nicht geladen werden.",n.replaceChildren(o),be=null,Se=null,bt();return}be=r,Se="movie",mn(r)}}async function ke(e){let t=++Q;ge=document.activeElement instanceof HTMLElement?document.activeElement:null;let n=Wr(e),r=qe();if(!r||t!==Q)return;if(!n){r.hidden=!1;let a=document.createElement("div");a.className="modalv2-loading",a.textContent="Seriendetails konnten nicht geladen werden.",r.replaceChildren(a),be=null,Se=null,bt();return}be=n,Se="show";let o=n;if(dn(o)){if(zr(),t!==Q)return;let a=null;try{a=await Yt(o)}catch{a=null}if(t!==Q)return;a&&(un(o,a),be=o)}t===Q&&mn(o)}function mt(){if(Q++,!!V){if(V.hidden=!0,V.setAttribute("aria-hidden","true"),document.body.classList.remove("modalv2-open"),Ar(),xr(),H&&(H.innerHTML="",H.setAttribute("hidden","")),ee&&(ee.scrollTop=0),ge&&typeof ge.focus=="function")try{ge.focus()}catch{}ge=null,be=null,Se=null,document.dispatchEvent(new CustomEvent("modal:close"))}}function Kr(e){if(e==="demo")return Pe(vr);if(e&&typeof e=="object")return Pe(e);let t=e==null?"":String(e).trim();if(!t)return null;let n=y(),o=(Array.isArray(n==null?void 0:n.movies)?n.movies:[]).find(a=>vn(a,t));return o?Pe(o):null}function Wr(e){if(e==="demo")return je(yr);if(e&&typeof e=="object")return je(e);let t=e==null?"":String(e).trim();if(!t)return null;let n=y(),o=(Array.isArray(n==null?void 0:n.shows)?n.shows:[]).find(a=>vn(a,t));return o?je(o):null}function vn(e,t){var r,o;if(!e)return!1;let n=String(t||"").trim();return n?!!((r=e==null?void 0:e.ids)!=null&&r.imdb&&String(e.ids.imdb)===n||(o=e==null?void 0:e.ids)!=null&&o.tmdb&&String(e.ids.tmdb)===n||(e==null?void 0:e.ratingKey)!=null&&String(e.ratingKey)===n):!1}var br,mr,V,N,ee,H,ge,ie,pe,Q,Se,be,vr,yr,vt=F(()=>{ln();we();Y();he();fn();br="https://image.tmdb.org/t/p/",mr="w185",V=null,N=null,ee=null,H=null,ge=null,ie=null,pe=null,Q=0,Se=null,be=null,vr={type:"movie",title:"Lumen: Der Aufbruch",tagline:"Eine cineastische Demo f\xFCr das neue Modal",overview:"Die Crew der Lumen wagt den Sprung in unerforschte Welten und enth\xFCllt dabei eine Energiequelle, die alles ver\xE4ndern k\xF6nnte. Zwischen Loyalit\xE4t, Intrigen und berauschenden Bildern entfaltet sich ein Abenteuer, das f\xFCr das Cinematic-Layout entworfen wurde.",summary:"Die Crew der Lumen entdeckt eine Energiequelle, die das Schicksal der Menschheit ver\xE4ndern k\xF6nnte.",runtimeMin:142,contentRating:"FSK 12",studio:"Aurora Pictures",rating:8.4,audienceRating:8,userRating:8.7,originallyAvailableAt:"2024-05-17",countries:[{tag:"Deutschland"},{tag:"Kanada"}],genres:[{tag:"Science-Fiction"},{tag:"Drama"},{tag:"Abenteuer"}],cast:[{name:"Mara Lenz",role:"Captain Alys Vega",tmdbProfile:"/3rxeQHiuCYaXJqfyUG8yt0YdHtH.jpg"},{name:"Tariq Benassi",role:"Navigator Elian Soh",tmdbProfile:"/wGl8DCycJ2U0FvJbLABd8R4FS3X.jpg"},{name:"Hannah Ko",role:"Wissenschaftlerin Dr. Mira Han",tmdbProfile:"/hJuDvwzS0SPlsE6MN4pF2UYDGtt.jpg"}],directors:[{tag:"Jonas Falk"}],writers:[{tag:"Lea Winter"}],producers:[{tag:"Studio Atlas"}],labels:[{tag:"Dolby Atmos"},{tag:"4K"}],collections:[{tag:"Aurora-Saga"}],trailer:"https://www.youtube.com/watch?v=dQw4w9WgXcQ",tmdbPoster:"https://image.tmdb.org/t/p/w500/2lUYbD2C3XSuwqMUbDVDQuz9mqz.jpg",ids:{tmdb:"demo-lumen",imdb:"tt0000001"},addedAt:"2024-06-01T12:00:00Z"},yr={type:"tv",title:"Aurora Station",tagline:"Neue Horizonte in Serie",overview:"Die Besatzung der Aurora Station sch\xFCtzt eine Au\xDFenposten an der Grenze des bekannten Raums. Jede Episode verbindet kosmische R\xE4tsel mit pers\xF6nlichen Geschichten \u2013 perfekt geeignet, um das Cinematic-Modal auszuprobieren.",summary:"Ein orbitaler Au\xDFenposten ringt um Hoffnung und Zusammenhalt, w\xE4hrend eine fremde Macht erwacht.",contentRating:"TV-14",studio:"Nebula Network",originallyAvailableAt:"2023-09-14",seasonCount:2,genres:[{tag:"Science-Fiction"},{tag:"Drama"}],countries:[{tag:"USA"},{tag:"Island"}],creators:[{tag:"Elina S\xF8rensen"}],cast:[{name:"Noah Adler",role:"Commander Ivar Hale",tmdbProfile:"/4MqUjb1SYrzHmFSVoKHSKP5MGGm.jpg"},{name:"Sofia Idris",role:"Ingenieurin Kaia Rhee",tmdbProfile:"/tHMgWz6EpRdbgoMJ2JfzFzjg3QB.jpg"},{name:"Helena Ruiz",role:"Strategin Tala Voss",tmdbProfile:"/ziEuG1ESSofxDCspotYlrwz3Tq.png"}],seasons:[{title:"Staffel 1",seasonNumber:1,year:2023,thumbFile:"https://image.tmdb.org/t/p/w300/4dO2YpC8S9nLmQAXoJLRV8LZRxn.jpg",episodes:[{title:"Kapitel Eins: Erwachen",seasonNumber:1,episodeNumber:1,durationMin:54,originallyAvailableAt:"2023-09-14",audienceRating:8.6},{title:"Kapitel Zwei: Grenzwelten",seasonNumber:1,episodeNumber:2,durationMin:52,originallyAvailableAt:"2023-09-21",audienceRating:8.2}]},{title:"Staffel 2",seasonNumber:2,year:2024,thumbFile:"https://image.tmdb.org/t/p/w300/bSL4hY8SgdKzac8AUbWQm74y87C.jpg",episodes:[{title:"Kapitel Dreizehn: Resonanz",seasonNumber:2,episodeNumber:1,durationMin:56,originallyAvailableAt:"2024-02-08",audienceRating:8.9},{title:"Kapitel Vierzehn: Echo",seasonNumber:2,episodeNumber:2,durationMin:55,originallyAvailableAt:"2024-02-15",audienceRating:8.7}]}],tmdbPoster:"https://image.tmdb.org/t/p/w500/a4I481szRmycyreQTLrRe4f4YJe.jpg",ids:{tmdb:"demo-aurora-station",imdb:"tt0000002"}}});var Sn={};Ye(Sn,{renderGrid:()=>_});function Vr(e){let t=x("article","card");t.style.contentVisibility="auto",t.dataset.kind=(e==null?void 0:e.type)==="tv"?"show":"movie",t.tabIndex=0,t.setAttribute("role","button"),e!=null&&e.title&&t.setAttribute("aria-label",e.title);let n=x("div","card__media"),r=new Image;r.loading="lazy",r.decoding="async",r.className="card__img",r.alt=(e==null?void 0:e.title)||"";let o=En(e);o&&(r.src=o);let a=x("div","card__media-gradient");a.setAttribute("aria-hidden","true");let s=Qr(e),i=x("div","card__badges");s.forEach(A=>{A instanceof HTMLElement&&i.append(A)}),n.append(r,a),i.childElementCount&&n.append(i);let c=ro(e);if(c>0){let A=x("div","card__progress"),P=document.createElement("span");P.style.width=`${Math.max(0,Math.min(100,c))}%`,A.append(P),n.append(A)}let l=x("div","card__body"),d=document.createElement("h3");d.className="card__title",d.textContent=(e==null?void 0:e.title)||"",e!=null&&e.title&&d.setAttribute("title",e.title);let f=x("div","card__meta"),g=to(e);f.textContent=g.join(" \u2022 "),l.append(d,f);let u=x("div","card__actions"),b=x("div","card__chips"),v=oe(e==null?void 0:e.genres);st(b,v,3);let k=document.createElement("button");return k.type="button",k.className="card__primary",yn(k,e),k.addEventListener("click",A=>{A.stopPropagation(),lt(e),yn(k,e)}),u.append(b,k),t.append(n,l,u),t.addEventListener("click",()=>wn(e)),t.addEventListener("keydown",A=>{A.target===t&&(A.key==="Enter"||A.key===" ")&&(A.preventDefault(),wn(e))}),t}function Ur(e){return(e&&e.collections||[]).map(t=>t&&(t.tag||t.title||t.name||"")).filter(Boolean)}function Jr(e,t){let n=(t||[]).slice().sort((f,g)=>{let u=Number(z(f))||0,b=Number(z(g))||0;return u!==b?u-b:(f.title||"").localeCompare(g.title||"","de")}),r=n.map(f=>Number(z(f))||0).filter(Boolean),o=r.length?Math.min(...r):"",a=n.map(f=>new Date(f.addedAt||0).getTime()).filter(Number.isFinite),s=a.length?new Date(Math.max(...a)).toISOString():null,i=n.map(f=>{var g;return Number((g=f.rating)!=null?g:f.audienceRating)}).filter(Number.isFinite),c=i.length?i.reduce((f,g)=>f+g,0)/i.length:null,l=n.find(f=>f.thumbFile)||n[0]||null,d=Array.from(new Set(n.flatMap(f=>oe(f.genres)))).slice(0,4);return{isCollectionGroup:!0,type:"collection",title:e,collectionName:e,items:n,itemCount:n.length,year:o||"",addedAt:s,rating:c,posterItem:l,genres:d}}function Gr(e){let t=document.getElementById("groupCollections"),n=document.getElementById("collectionFilter"),r=n&&n.value;if(!t||!t.checked||r)return e;let o=new Map;e.forEach(s=>{Ur(s).forEach(i=>{o.has(i)||o.set(i,[]),o.get(i).push(s)})});let a=[];return o.forEach((s,i)=>{a.push(Jr(i,s))}),a.sort((s,i)=>s.title.localeCompare(i.title,"de")),a}function Yr(e){let t=x("article","card card--collection");t.style.contentVisibility="auto",t.dataset.kind="collection",t.tabIndex=0,t.setAttribute("role","button"),e!=null&&e.title&&t.setAttribute("aria-label",e.title);let n=x("div","card__media"),r=e.posterItem||{},o=new Image;o.loading="lazy",o.decoding="async",o.className="card__img",o.alt=(e==null?void 0:e.title)||"";let a=En(r);a&&(o.src=a);let s=x("div","card__media-gradient");s.setAttribute("aria-hidden","true");let i=eo(e),c=x("div","card__badges");i.forEach(v=>{v instanceof HTMLElement&&c.append(v)}),n.append(o,s),c.childElementCount&&n.append(c);let l=x("div","card__body"),d=document.createElement("h3");d.className="card__title",d.textContent=e.title||"",e!=null&&e.title&&d.setAttribute("title",e.title);let f=x("div","card__meta"),g=[e.year,`${e.itemCount} Titel`];Number.isFinite(e.rating)&&g.push(`\u2605 ${$(e.rating)}`),f.textContent=g.filter(Boolean).join(" \u2022 "),l.append(d,f);let u=x("div","card__actions"),b=x("div","card__chips");return st(b,e.genres||[],3),u.append(b),t.append(n,l,u),t.addEventListener("click",()=>{let v=document.getElementById("collectionFilter");v&&(v.value=e.collectionName||e.title||"",v.dispatchEvent(new Event("change",{bubbles:!0})))}),t.addEventListener("keydown",v=>{if(v.target===t&&(v.key==="Enter"||v.key===" ")){v.preventDefault();let k=document.getElementById("collectionFilter");k&&(k.value=e.collectionName||e.title||"",k.dispatchEvent(new Event("change",{bubbles:!0})))}}),t}function _(e){let{movies:t,shows:n,filtered:r}=y(),o=(e==="shows"?n:t)||[],a=Array.isArray(r)?r:o,s=Gr(a),i=document.getElementById("grid");if(!i)return;Xr(i);let c=document.createDocumentFragment();s.forEach(d=>c.append(d.isCollectionGroup?Yr(d):Vr(d))),i.replaceChildren(c),Zr(i);let l=document.getElementById("empty");l&&(l.hidden=s.length>0)}function Xr(e){e&&(e.classList.remove("is-entering","is-ready"),e.classList.add("is-leaving"))}function Zr(e){e&&(e.classList.remove("is-leaving"),e.classList.add("is-entering"),requestAnimationFrame(()=>{e.classList.add("is-ready"),setTimeout(()=>e.classList.remove("is-entering","is-ready"),240)}))}function En(e){var r;if(!e)return"";let t=ae()&&(((r=e==null?void 0:e.tmdb)==null?void 0:r.poster)||(e==null?void 0:e.tmdbPoster)),n=(e==null?void 0:e.thumbFile)||(e==null?void 0:e.poster)||(e==null?void 0:e.art)||(e==null?void 0:e.thumb)||"";return t||n||""}function Qr(e){var o;let t=[];$e(e)&&t.push(xe("Neu"));let n=String((e==null?void 0:e.contentRating)||"").trim();n&&t.push(xe(n));let r=Number((o=e==null?void 0:e.rating)!=null?o:e==null?void 0:e.audienceRating);return Number.isFinite(r)&&t.push(xe(`\u2605 ${$(r)}`)),t.slice(0,3)}function eo(e){let t=[];return Number.isFinite(e==null?void 0:e.itemCount)&&e.itemCount>0&&t.push(xe(`${e.itemCount} Titel`)),e!=null&&e.year&&t.push(xe(String(e.year))),t}function xe(e){let t=document.createElement("span");return t.className="badge",t.textContent=String(e||""),t}function yn(e,t){if(!e)return;let n=rn(t);e.textContent=n?"Gemerkt":"Merken",e.classList.toggle("active",n),e.setAttribute("aria-pressed",n?"true":"false")}function to(e){var s;let t=[],n=z(e);n&&t.push(String(n));let r=no(e);r&&t.push(r);let o=Number((s=e==null?void 0:e.rating)!=null?s:e==null?void 0:e.audienceRating);Number.isFinite(o)&&t.push(`\u2605 ${$(o)}`);let a=(e==null?void 0:e.studio)||(e==null?void 0:e.network)||"";return a&&t.push(a),t}function no(e){var r,o;let t=(o=(r=e==null?void 0:e.runtimeMin)!=null?r:e==null?void 0:e.durationMin)!=null?o:e!=null&&e.duration?Math.round(Number(e.duration)/6e4):null,n=Number(t);return!Number.isFinite(n)||n<=0?"":(e==null?void 0:e.type)==="tv"?`~${n} min/Ep`:`${n} min`}function ro(e){var r;let t=Number((r=e==null?void 0:e.viewOffset)!=null?r:e==null?void 0:e.viewoffset),n=Number(e==null?void 0:e.duration);return!Number.isFinite(t)||!Number.isFinite(n)||n<=0?0:Math.max(1,Math.min(100,Math.round(t/n*100)))}function oo(e){var n,r;if(!e)return"";let t=((n=e==null?void 0:e.ids)==null?void 0:n.imdb)||((r=e==null?void 0:e.ids)==null?void 0:r.tmdb);return t?String(t):e!=null&&e.ratingKey?String(e.ratingKey):""}function ao(e,t){if(!e||!t)return;let n=`#/${e}/${t}`;try{if(history&&typeof history.pushState=="function"){location.hash===n&&typeof history.replaceState=="function"?history.replaceState(null,"",n):history.pushState(null,"",n);return}}catch{}try{window.__skipNextHashNavigation=!0}catch{}location.hash=n}function wn(e){if(!e)return;let t=(e==null?void 0:e.type)==="tv"?"show":"movie",n=oo(e);n&&ao(t,n),t==="show"?ke(e):Ae(e)}var yt=F(()=>{Y();ze();Be();we();ut();vt()});var Ct={};Ye(Ct,{applyFilters:()=>me,computeFacets:()=>At,initFilters:()=>xt,renderFacets:()=>kt,updateFiltersAndGrid:()=>Te});function Ce(e){return e.year?e.year:e.originallyAvailableAt?String(e.originallyAvailableAt).slice(0,4):""}function Et(e){return(e&&e.collections||[]).map(t=>t&&(t.tag||t.title||t.name||"")).filter(Boolean)}function so(e){if(!(e!=null&&e.addedAt))return!1;let t=new Date(e.addedAt).getTime();if(!Number.isFinite(t))return!1;let n=y().cfg||{},r=Number(n.newDays||30);return Date.now()-t<=r*24*60*60*1e3}function An(e){return String(e||"").toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")}function io(e,t){let n=An(t.query||""),r=!!t.onlyNew,o=Number(t.yearFrom)||null,a=Number(t.yearTo)||null,s=t.genres||new Set,i=t.collection||"";if(n&&!An([e.title,e.originalTitle,e.summary,e.studio,oe(e.genres).join(" "),(e.roles||[]).map(d=>d&&(d.tag||d.role||d.name)).join(" "),Et(e).join(" ")].filter(Boolean).join(" ")).includes(n)||r&&!so(e))return!1;let c=Number(Ce(e))||null;if(o&&(!c||c<o)||a&&(!c||c>a))return!1;if(s.size){let l=new Set(oe(e.genres));for(let d of s)if(!l.has(d))return!1}return!(i&&!new Set(Et(e)).has(i))}function co(e,t){let n=e.slice();switch(t){case"year-desc":n.sort((r,o)=>(Number(Ce(o))||0)-(Number(Ce(r))||0)||String(r.title||"").localeCompare(String(o.title||""),"de"));break;case"year-asc":n.sort((r,o)=>(Number(Ce(r))||0)-(Number(Ce(o))||0)||String(r.title||"").localeCompare(String(o.title||""),"de"));break;case"title-desc":n.sort((r,o)=>String(o.title||"").localeCompare(String(r.title||""),"de"));break;case"added-desc":n.sort((r,o)=>new Date(o.addedAt||0)-new Date(r.addedAt||0));break;case"title-asc":default:n.sort((r,o)=>String(r.title||"").localeCompare(String(o.title||""),"de"))}return n}function At(e,t){let n=new Set,r=new Set,o=new Set,a=i=>(i||[]).forEach(c=>{oe(c.genres).forEach(d=>n.add(d));let l=c.year||(c.originallyAvailableAt?String(c.originallyAvailableAt).slice(0,4):"");l&&r.add(Number(l)),Et(c).forEach(d=>o.add(d))});a(e),a(t);let s=[...r].sort((i,c)=>i-c);return{genres:[...n].sort(),years:s,collections:[...o].sort((i,c)=>i.localeCompare(c,"de"))}}function kt(e){let t=I("#yearFrom"),n=I("#yearTo");t&&t.replaceChildren(new Option("Ab Jahr",""),...e.years.map(a=>new Option(String(a),String(a)))),n&&n.replaceChildren(new Option("Bis Jahr",""),...e.years.map(a=>new Option(String(a),String(a))));let r=I("#collectionFilter");r&&r.replaceChildren(new Option("Alle Collections",""),...e.collections.map(a=>new Option(a,a)));let o=I("#genreFilters");if(o){let a=e.genres.map(s=>{let i=document.createElement("button");return i.type="button",i.className="chip",i.textContent=s,i.dataset.name=s,i});o.replaceChildren(...a),St()}}function lo(){var c,l,d,f,g;let e=document.getElementById("search")||document.getElementById("q"),t=((e==null?void 0:e.value)||"").trim(),n=((c=I("#onlyNew"))==null?void 0:c.checked)||!1,r=((l=I("#yearFrom"))==null?void 0:l.value)||"",o=((d=I("#yearTo"))==null?void 0:d.value)||"",a=((f=I("#collectionFilter"))==null?void 0:f.value)||"",s=((g=I("#sort"))==null?void 0:g.value)||"title-asc",i=new Set;return document.querySelectorAll("#genreFilters .chip.active").forEach(u=>i.add(u.dataset.name)),{query:t,onlyNew:n,yearFrom:r,yearTo:o,collection:a,genres:i,sort:s}}function me(){let e=y(),n=e.view==="shows"?e.shows:e.movies,r=lo(),o=(n||[]).filter(s=>io(s,r)),a=co(o,r.sort);return te({filtered:a}),a}function uo(){wt||(wt=Promise.resolve().then(()=>(yt(),Sn))),wt.then(e=>{let t=e&&e.renderGrid;typeof t=="function"&&t(y().view)}).catch(console.error)}function Te(){let e=me();return uo(),fo(e),e}function fo(e){try{let n={items:Array.isArray(e)?e.slice():[],view:y().view};window.dispatchEvent(new CustomEvent("filters:updated",{detail:n}))}catch{}}function St(){let e=document.getElementById("genreFilters");if(!e)return;let t=e.querySelectorAll(".chip.active").length;e.dataset.state=t>0?"active":"empty",e.dataset.count=String(t)}function xt(){let e=I("#sort");e&&e.options.length===0&&[["title-asc","Titel A\u2013Z"],["title-desc","Titel Z\u2013A"],["year-desc","Jahr \u2193"],["year-asc","Jahr \u2191"],["added-desc","Zuletzt hinzugef\xFCgt"]].forEach(([o,a])=>e.add(new Option(a,o)));let t=(o,a="input")=>{let s=I(o);s&&(s.addEventListener(a,()=>{Te()}),a==="input"&&s instanceof HTMLInputElement&&s.type==="search"&&s.addEventListener("search",()=>{Te()}))};t("#search"),t("#q"),t("#onlyNew","change"),t("#yearFrom","change"),t("#yearTo","change"),t("#collectionFilter","change"),t("#sort","change"),t("#groupCollections","change");let n=I("#yearReset");n&&n.addEventListener("click",()=>{let o=I("#yearFrom"),a=I("#yearTo");o&&(o.value=""),a&&(a.value=""),Te()});let r=I("#genreFilters");r&&(r.addEventListener("click",o=>{let a=o.target;a instanceof HTMLElement&&a.classList.contains("chip")&&(a.classList.toggle("active"),St(),Te())}),St())}var wt,ze=F(()=>{Y();Be();we();wt=null});var ye={};Ye(ye,{clearCache:()=>po,hydrateOptional:()=>Lt,validateToken:()=>So});function ho(){try{return new Map(JSON.parse(localStorage.getItem("tmdbCache")||"[]"))}catch{return new Map}}function go(){try{localStorage.setItem("tmdbCache",JSON.stringify(Array.from(ce.entries())))}catch{}}function po(){try{localStorage.removeItem("tmdbCache"),ce=new Map}catch{}}function bo(e){try{let t=localStorage.getItem("tmdbToken");if(t)return{kind:"bearer",value:t}}catch{}return e!=null&&e.tmdbApiKey?{kind:"apikey",value:String(e.tmdbApiKey)}:{kind:"none",value:""}}function mo(e){var s,i;let t=e.type==="tv"?"tv":"movie",n=((s=e==null?void 0:e.ids)==null?void 0:s.imdb)||"",r=((i=e==null?void 0:e.ids)==null?void 0:i.tmdb)||"",o=(e.title||"").toLowerCase(),a=String(e.year||"").slice(0,4);return[t,n,r,o,a].filter(Boolean).join("|")}function Tt(e,t){if(!t||t.kind==="none")return{url:e,init:{}};if(t.kind==="bearer")return{url:e,init:{headers:{Authorization:`Bearer ${t.value}`,Accept:"application/json"}}};let n=e.includes("?")?"&":"?";return{url:`${e}${n}api_key=${encodeURIComponent(t.value)}`,init:{headers:{Accept:"application/json"}}}}async function We(e,t){let{url:n,init:r}=Tt(e,t),o=await fetch(n,r);if(!o.ok)throw new Error("HTTP "+o.status);return o.json()}function vo(e){return e!=null&&e.file_path?Ke+kn+e.file_path:""}function yo(e){return e!=null&&e.file_path?Ke+xn+e.file_path:""}async function It(e,t,n,r){let o=await We(`${ve}/${e}/${t}?language=${encodeURIComponent(n||"de-DE")}`,r),a=await We(`${ve}/${e}/${t}/images`,r).catch(()=>({posters:[],backdrops:[]})),s=vo((a.posters||[])[0])||(o.poster_path?Ke+kn+o.poster_path:""),i=yo((a.backdrops||[])[0])||(o.backdrop_path?Ke+xn+o.backdrop_path:"");return{id:o.id,poster:s,backdrop:i,url:`https://www.themoviedb.org/${e}/${o.id}`}}async function wo(e,t,n,r,o){let a=encodeURIComponent(t||""),s=n?`&year=${encodeURIComponent(String(n))}`:"",c=((await We(`${ve}/search/${e}?query=${a}${s}&language=${encodeURIComponent(r||"de-DE")}`,o)).results||[])[0];if(!c)throw new Error("not found");return It(e,c.id,r,o)}async function Eo(e,t,n){var s,i;let r=e.type==="tv"?"tv":"movie",o=mo(e);if(ce.has(o))return ce.get(o);let a;try{if((s=e==null?void 0:e.ids)!=null&&s.tmdb)a=await It(r,e.ids.tmdb,t.lang,n);else if((i=e==null?void 0:e.ids)!=null&&i.imdb){let c=await We(`${ve}/find/${e.ids.imdb}?external_source=imdb_id&language=${encodeURIComponent(t.lang||"de-DE")}`,n),l=r==="movie"?(c.movie_results||[])[0]:(c.tv_results||[])[0];if(l)a=await It(r,l.id,t.lang,n);else throw new Error("not found")}else a=await wo(r,e.title,e.year,t.lang,n)}catch{a=null}return ce.set(o,a),go(),a}async function Lt(e,t,n={}){try{ce=ce||ho();let r=bo(n);if(!r.value)return;let o=(e||[]).concat(t||[]),a=0,s=40,i=async()=>{let c=o.slice(a,a+4);a+=4,await Promise.all(c.map(async l=>{let d=await Eo(l,n,r);d&&(l.tmdb={id:d.id,poster:d.poster,backdrop:d.backdrop,url:d.url},l.ids=l.ids||{},!l.ids.tmdb&&d.id&&(l.ids.tmdb=String(d.id)))}));try{window.dispatchEvent(new CustomEvent("tmdb:chunk",{detail:{updated:c.length,index:a}}))}catch{}if(a<Math.min(o.length,s))(window.requestIdleCallback||setTimeout)(i,250);else try{window.dispatchEvent(new CustomEvent("tmdb:done",{detail:{total:Math.min(o.length,s)}}))}catch{}};i()}catch{}}async function So(e){let t=String(e||"").trim();if(!t)throw new Error("empty");let n=/^[a-f0-9]{32}$/i.test(t),r=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+$/.test(t),o=a=>{try{let s=a.split(".")[1],c=atob((l=>l+"=".repeat((4-l.length%4)%4))(s.replace(/-/g,"+").replace(/_/g,"/")));return JSON.parse(c)}catch{return null}};if(n){let{url:a,init:s}=Tt(`${ve}/configuration`,{kind:"apikey",value:t});return(await fetch(a,s)).ok?{ok:!0,as:"apikey",hint:"v3Key"}:{ok:!1,as:"apikey",hint:"looksV3"}}if(r){let a=o(t);if(a&&typeof a=="object"){let c=String(a.iss||"");if(c&&!/themoviedb\.org/i.test(c))return{ok:!1,as:"bearer",hint:"issMismatch"}}let{url:s,init:i}=Tt(`${ve}/trending/movie/day`,{kind:"bearer",value:t});try{if((await fetch(s,i)).ok)return{ok:!0,as:"bearer",hint:null}}catch{}return{ok:!0,as:"bearer",hint:"structOnly"}}return{ok:!1,as:"bearer",hint:null}}var ve,Ke,kn,xn,ce,le=F(()=>{ve="https://api.themoviedb.org/3",Ke="https://image.tmdb.org/t/p/",kn="w342",xn="w780"});Y();Be();var q,Fe,He,X;function Ze(){if(!q&&(q=I("#loaderOverlay"),!q)){q=x("div","loader-overlay"),q.id="loaderOverlay",q.hidden=!0;let e=x("div","loader");He=x("div","msg",""),Fe=x("div","bar"),e.append(He,Fe),q.append(e),document.body.append(q)}}function Dt(){Ze(),q.hidden=!1}function ue(e,t){Ze(),He&&(He.textContent=e||""),Fe&&(Fe.style.width=(t||0)+"%")}function _e(){Ze(),q.hidden=!0}function $t(e=18){let t=I("#grid");if(t){X=x("div","skeleton");for(let n=0;n<e;n++)X.append(x("div","skel"));t.replaceChildren(X)}}function Qe(){X&&X.parentElement&&X.parentElement.removeChild(X),X=null}he();ze();yt();vt();le();ut();Y();he();tt();function Tn(){let e=document.getElementById("openDebug");e&&e.addEventListener("click",()=>{Ao()})}function Ao(){var t,n,r,o;let e=document.getElementById("debugOverlay");e||(e=document.createElement("div"),e.id="debugOverlay",e.className="debug-overlay",e.innerHTML=`
      <div class="debug-dialog">
        <div class="debug-header"><h2>Debug</h2></div>
        <div class="debug-body">
          <pre id="debugPre" class="debug-pre"></pre>
          <div class="debug-cache-controls">
            <h3>Cache-Verwaltung</h3>
            <div id="cacheStats" class="cache-stats"></div>
            <div class="cache-buttons">
              <button id="debugClearExpired" class="btn">Abgelaufene l\xF6schen</button>
              <button id="debugClearAll" class="btn">Alles l\xF6schen</button>
            </div>
          </div>
        </div>
        <div class="debug-actions">
          <button id="debugCopy" class="btn">Copy report</button>
          <button id="debugClose" class="btn">Schlie\xDFen</button>
        </div>
      </div>`,document.body.append(e)),e.hidden=!1,Nt(),e.addEventListener("click",a=>{a.target===e&&Cn()}),(t=document.getElementById("debugClose"))==null||t.addEventListener("click",Cn,{once:!0}),(n=document.getElementById("debugCopy"))==null||n.addEventListener("click",ko,{once:!0}),(r=document.getElementById("debugClearExpired"))==null||r.addEventListener("click",()=>{Me(),Nt()},{once:!0}),(o=document.getElementById("debugClearAll"))==null||o.addEventListener("click",()=>{confirm("Wirklich den gesamten Cache l\xF6schen?")&&(jt(),Nt())},{once:!0})}function Cn(){let e=document.getElementById("debugOverlay");e&&(e.hidden=!0)}function Nt(){let e=document.getElementById("debugPre");if(!e)return;let t=y(),n=Xt(),r=t.cfg||{},o=et(),a={view:t.view,counts:{movies:(t.movies||[]).length,shows:(t.shows||[]).length,filtered:(t.filtered||[]).length},dataSources:n,cache:o,tmdb:{enabled:!!r.tmdbEnabled,lang:r.lang,tokenPresent:!!(localStorage.getItem("tmdbToken")||r.tmdbApiKey)},useTmdbImages:localStorage.getItem("useTmdb")==="1",reduceMotion:localStorage.getItem("prefReduceMotion")==="1",locationHash:location.hash,userAgent:navigator.userAgent};e.textContent=JSON.stringify(a,null,2);let s=document.getElementById("cacheStats");s&&o&&(s.innerHTML=`
      <p>Eintr\xE4ge gesamt: <strong>${o.totalEntries}</strong></p>
      <p>G\xFCltig: <strong>${o.validEntries}</strong> | Abgelaufen: <strong>${o.expiredEntries}</strong></p>
      <p>Gr\xF6\xDFe: <strong>${o.totalSizeMB} MB</strong></p>
    `)}function ko(){var n;let e=document.getElementById("debugPre");if(!e)return;let t=e.textContent||"";(n=navigator.clipboard)==null||n.writeText(t).catch(()=>{try{let r=document.createElement("textarea");r.value=t,document.body.append(r),r.select(),document.execCommand("copy"),r.remove()}catch{}})}we();var O=null;function Ue(){O||(O=document.createElement("div"),O.id="errorContainer",O.className="error-container",O.setAttribute("role","alert"),O.setAttribute("aria-live","polite"),document.body.appendChild(O)),window.addEventListener("unhandledrejection",e=>{var t;Ve("Ein unerwarteter Fehler ist aufgetreten",(t=e.reason)==null?void 0:t.message),e.preventDefault()}),window.addEventListener("error",e=>{var t;Ve("Ein Fehler ist aufgetreten",(t=e.error)==null?void 0:t.message)})}function Ve(e,t="",n=5e3){O||Ue();let r=document.createElement("div");return r.className="error-toast",r.innerHTML=`
    <div class="error-toast-content">
      <div class="error-toast-icon">\u26A0\uFE0F</div>
      <div class="error-toast-text">
        <div class="error-toast-title">${Bt(e)}</div>
        ${t?`<div class="error-toast-message">${Bt(t)}</div>`:""}
      </div>
      <button class="error-toast-close" aria-label="Schlie\xDFen">\xD7</button>
    </div>
  `,r.querySelector(".error-toast-close").addEventListener("click",()=>{r.classList.add("error-toast-exit"),setTimeout(()=>r.remove(),300)}),O.appendChild(r),n>0&&setTimeout(()=>{r.parentNode&&(r.classList.add("error-toast-exit"),setTimeout(()=>r.remove(),300))},n),requestAnimationFrame(()=>{r.classList.add("error-toast-show")}),r}function In(e,t){O||Ue();let n=document.createElement("div");n.className="error-toast error-toast-retryable",n.innerHTML=`
    <div class="error-toast-content">
      <div class="error-toast-icon">\u26A0\uFE0F</div>
      <div class="error-toast-text">
        <div class="error-toast-title">${Bt(e)}</div>
      </div>
      <button class="error-toast-retry">Erneut versuchen</button>
      <button class="error-toast-close" aria-label="Schlie\xDFen">\xD7</button>
    </div>
  `;let r=n.querySelector(".error-toast-retry"),o=n.querySelector(".error-toast-close");return r.addEventListener("click",async()=>{n.remove();try{await t()}catch{}}),o.addEventListener("click",()=>{n.classList.add("error-toast-exit"),setTimeout(()=>n.remove(),300)}),O.appendChild(n),requestAnimationFrame(()=>{n.classList.add("error-toast-show")}),n}function Bt(e){let t=document.createElement("div");return t.textContent=e,t.innerHTML}var xa=typeof HTMLElement!="undefined"&&"inert"in HTMLElement.prototype,Ca=["a[href]","area[href]","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])","iframe","object","embed","[contenteditable]","[tabindex]"].join(",");var Le=null,U=null,de=null;function Ie(e,t=!0){let n=document.getElementById("footerMeta");if(n){let o=n.querySelector("#footerStatus");o?o.textContent=e:n.textContent=e,n.dataset.state=t?"loading":"ready"}let r=document.getElementById("grid");r&&r.setAttribute("aria-busy",t?"true":"false")}async function Co(){Ue(),qo(),Dt(),Ie("Initialisiere \u2026",!0),ue("Initialisiere \u2026",8),$t(18);let e=await fetch("config.json").then(n=>n.json()).catch(n=>(Ve("Konfiguration konnte nicht geladen werden","Verwende Standardeinstellungen"),{startView:"movies",tmdbEnabled:!1}));te({cfg:e,view:e.startView||"movies"});try{Ie("Filme laden \u2026",!0),ue("Filme laden \u2026",25);let n=await rt();Ie("Serien laden \u2026",!0),ue("Serien laden \u2026",45);let r=await ot();Ie("Filter vorbereiten \u2026",!0),ue("Filter vorbereiten \u2026",60);let o=At(n,r);te({movies:n,shows:r,facets:o}),Ie("Ansicht aufbauen \u2026",!0),ue("Ansicht aufbauen \u2026",85),Qe(),_t(),kt(o),xt(),me(),To(!0),_(y().view),Io(),_e(),e.tmdbEnabled&&(window.requestIdleCallback||setTimeout)(()=>{var a;return(a=Lt)==null?void 0:a(n,r,e)},400),an(),jo(e),zo(),Ko(),Wo(),Vo(),J(),Tn()}catch(n){throw _e(),Qe(),In("Fehler beim Laden der Daten",()=>window.location.reload()),n}let t;window.addEventListener("tmdb:chunk",()=>{t||(t=requestAnimationFrame(()=>{t=null;try{localStorage.getItem("useTmdb")==="1"&&(_(y().view),J())}catch{}}))}),window.addEventListener("tmdb:done",()=>{try{localStorage.getItem("useTmdb")==="1"&&(_(y().view),J())}catch{}})}var Ft=null,Ht="";window.addEventListener("hashchange",()=>{if(window.__skipNextHashNavigation){try{window.__skipNextHashNavigation=!1,Ht=location.hash||""}catch{}return}let e=location.hash||"";Ft&&clearTimeout(Ft),Ft=setTimeout(()=>{if(e===Ht)return;Ht=e;let t=e;if(/^#\/(movies|shows)$/.test(t)){let i=t.includes("shows")?"shows":"movies";te({view:i});let c=me();_t(),_(i),J(c);return}let n=t.match(/^#\/(movie|show)\/(.+)/);if(!n)return;let[,r,o]=n,s=((r==="movie"?y().movies:y().shows)||[]).find(i=>{var c,l;return((c=i==null?void 0:i.ids)==null?void 0:c.imdb)===o||((l=i==null?void 0:i.ids)==null?void 0:l.tmdb)===o||String(i==null?void 0:i.ratingKey)===o});s&&(r==="show"?ke(s):Ae(s))},50)});function _t(){let e=document.getElementById("libraryTabs");if(!e)return;let t=Array.from(e.querySelectorAll("[data-lib]")),n=y().view==="shows"?"shows":"movies";t.forEach(r=>{let o=r.dataset.lib==="series"?"shows":"movies",a=n===o;r.classList.toggle("is-active",a),r.setAttribute("aria-pressed",a?"true":"false"),r.dataset.bound!=="true"&&(r.addEventListener("click",()=>{let s=r.dataset.lib==="series"?"shows":"movies";if(y().view===s)return;te({view:s});try{window.__skipNextHashNavigation=!0}catch{}location.hash=s==="movies"?"#/movies":"#/shows",_t();let i=me();_(s),J(i)}),r.dataset.bound="true")})}function To(e=!1){let t=document.getElementById("heroStats");if(!t)return;let n=y(),r=(n.movies||[]).length,o=(n.shows||[]).length,a=t.querySelector('[data-stat="movies"]'),s=t.querySelector('[data-stat="shows"]');!a||!s||(e?(Ln(a,r),Ln(s,o)):(a.textContent=String(r),s.textContent=String(o)))}function Ln(e,t){if(!e)return;let n=Number(e.textContent)||0,r=Number(t)||0;if(n===r){e.textContent=String(r);return}let o=480,a=performance.now();function s(i){let c=Math.min(1,(i-a)/o),l=Math.round(n+(r-n)*(c<.5?2*c*c:-1+(4-2*c)*c));e.textContent=String(l),c<1?requestAnimationFrame(s):e.textContent=String(r)}requestAnimationFrame(s)}function Io(){let e=document.getElementById("footerMeta");if(!e)return;let t=document.getElementById("footerStatus"),n=y(),r=n.movies||[],o=n.shows||[],a=r.concat(o).map(l=>new Date(l.addedAt||0).getTime()).filter(Number.isFinite),i=(a.length?new Date(Math.max(...a)):new Date).toISOString().slice(0,10);t&&(t.textContent=`Stand: ${i}`),e.dataset.state="ready";let c=document.getElementById("grid");c&&c.setAttribute("aria-busy","false")}function J(e){let t=document.getElementById("hero"),n=document.getElementById("heroTitle"),r=document.getElementById("heroSubtitle"),o=document.getElementById("heroCta");if(!t||!n||!r||!o)return;Lo();let a=No(e);if(!a){Le=null,n.textContent=U.title,r.textContent=U.subtitle,r.dataset.taglinePaused="0",delete r.dataset.heroBound,r.classList.remove("is-fading"),o.textContent=U.cta,o.disabled=!0,o.setAttribute("aria-disabled","true"),o.removeAttribute("aria-label"),o.onclick=null,t.style.backgroundImage="",t.classList.remove("has-poster"),t.dataset.heroKind="",t.dataset.heroId="";return}Le=a;let s=a.type==="tv"?"show":"movie",i=Do(a);n.textContent=a.title||U.title,r.textContent=Fo(a),r.dataset.taglinePaused="1",r.dataset.heroBound="1",r.classList.remove("is-fading");let c=s==="show"?"Serien-Details \xF6ffnen":"Film-Details \xF6ffnen";o.textContent=c,o.disabled=!1,o.setAttribute("aria-disabled","false"),o.setAttribute("aria-label",a.title?`${c}: ${a.title}`:c),o.onclick=()=>$o(a,s,i),t.dataset.heroKind=s,t.dataset.heroId=i||"";let l=Po(a);l?(t.style.backgroundImage=`url(${l})`,t.classList.add("has-poster")):(t.style.backgroundImage="",t.classList.remove("has-poster"))}window.__heroRefresh=J;function Lo(){var e,t,n;U||(U={title:((e=document.getElementById("heroTitle"))==null?void 0:e.textContent)||"",subtitle:((t=document.getElementById("heroSubtitle"))==null?void 0:t.textContent)||"",cta:((n=document.getElementById("heroCta"))==null?void 0:n.textContent)||""})}function No(e){if(Array.isArray(e)){let r=e.filter(Bn);return r.length?Nn(r):null}let n=Bo().filter(Bn);return n.length?Nn(n):null}function Nn(e){if(e.length===1)return e[0];let t=Math.floor(Math.random()*e.length),n=e[t];return Le&&e.length>1&&n===Le&&e.find(o=>o!==Le)||n}function Bo(){let e=y(),t=e.view==="shows"?"shows":"movies",r=(Array.isArray(e.filtered)&&e.filtered.length?e.filtered:null)||(t==="shows"?e.shows:e.movies)||[];return Array.isArray(r)?r:[]}function Bn(e){return!!e&&typeof e=="object"&&!e.isCollectionGroup&&e.type!=="collection"}function Fo(e){var i;let t=[],n=z(e);n&&t.push(String(n));let r=Ho(e);r&&t.push(r);let o=Number((i=e==null?void 0:e.rating)!=null?i:e==null?void 0:e.audienceRating);Number.isFinite(o)&&t.push(`\u2605 ${$(o)}`);let a=_o(e,2);a.length&&t.push(a.join(", "));let s=Mo(e);return s?t.length?`${t.join(" \u2022 ")} \u2014 ${s}`:s:t.length?t.join(" \u2022 "):(U==null?void 0:U.subtitle)||""}function Ho(e){var r,o;let t=(o=(r=e==null?void 0:e.runtimeMin)!=null?r:e==null?void 0:e.durationMin)!=null?o:e!=null&&e.duration?Math.round(Number(e.duration)/6e4):null,n=Number(t);return!Number.isFinite(n)||n<=0?"":(e==null?void 0:e.type)==="tv"?`~${n} min/Ep`:`${n} min`}function _o(e,t=3){let n=Array.isArray(e==null?void 0:e.genres)?e.genres:[],r=[];return n.forEach(a=>{if(!a)return;if(typeof a=="string"){r.push(a);return}let s=a.tag||a.title||a.name||a.label||"";s&&r.push(s)}),Array.from(new Set(r)).slice(0,Math.max(0,t))}function Mo(e){let t=[e==null?void 0:e.tagline,e==null?void 0:e.summary,e==null?void 0:e.plot,e==null?void 0:e.overview];for(let n of t){if(typeof n!="string")continue;let r=n.trim();if(r)return Ro(r,220)}return""}function Ro(e,t){let n=String(e||"").trim();return n?n.length<=t?n:`${n.slice(0,Math.max(0,t-1)).trimEnd()}\u2026`:""}function Do(e){var t,n;return e?(t=e==null?void 0:e.ids)!=null&&t.imdb?String(e.ids.imdb):(n=e==null?void 0:e.ids)!=null&&n.tmdb?String(e.ids.tmdb):(e==null?void 0:e.ratingKey)!=null?String(e.ratingKey):"":""}function $o(e,t,n){n&&Oo(t,n),t==="show"?ke(e):Ae(e)}function Oo(e,t){if(!e||!t)return;let n=`#/${e}/${t}`;try{if(history&&typeof history.pushState=="function"){location.hash===n&&typeof history.replaceState=="function"?history.replaceState(null,"",n):history.pushState(null,"",n);return}}catch{}try{window.__skipNextHashNavigation=!0}catch{}location.hash=n}function Po(e){var a,s,i,c,l;if(!e)return"";let t=ae(),n=[(a=e==null?void 0:e.tmdb)==null?void 0:a.backdrop,(s=e==null?void 0:e.tmdb)==null?void 0:s.backdrop_path,(i=e==null?void 0:e.tmdb)==null?void 0:i.backdropPath,(c=e==null?void 0:e.tmdb)==null?void 0:c.background,(l=e==null?void 0:e.tmdb)==null?void 0:l.art],r=[e==null?void 0:e.art,e==null?void 0:e.background,e==null?void 0:e.thumbBackground,e==null?void 0:e.coverArt,e==null?void 0:e.thumb,e==null?void 0:e.thumbFile];if(t){let d=n.find(Fn);if(d)return d}return r.find(Fn)||""}function Fn(e){return typeof e=="string"&&e.trim().length>0}window.addEventListener("filters:updated",e=>{let t=e==null?void 0:e.detail,n=Array.isArray(t==null?void 0:t.items)?t.items:null;J(n)});Co();window.addEventListener("load",()=>{try{_e()}catch{}});function jo(e){let t=document.getElementById("settingsOverlay"),n=t==null?void 0:t.querySelector(".settings-dialog"),r=document.getElementById("settingsBtn"),o=document.getElementById("openSettings"),a=document.getElementById("headerSettingsBtn"),s=document.getElementById("settingsClose2"),i=document.getElementById("tmdbTokenInput"),c=document.getElementById("tmdbSave"),l=document.getElementById("tmdbTest"),d=document.getElementById("tmdbStatus"),f=document.getElementById("tmdbClearCache"),g=document.getElementById("tmdbStatusBadge"),u=document.getElementById("prefReduceMotion"),b=document.getElementById("useTmdbSetting"),v=document.getElementById("resetFilters"),k=document.getElementById("scrollOrchestratorToggle");t&&t.hidden&&t.setAttribute("aria-hidden","true");let A=null,P="",M=!1,R=new Map,Ne='a[href], button:not([disabled]), input:not([disabled]), select:not([disabled]), textarea:not([disabled]), [tabindex]:not([tabindex="-1"])';function w(){return t?Array.from(t.querySelectorAll(Ne)).filter(h=>!h.hasAttribute("disabled")&&h.getAttribute("aria-hidden")!=="true"):[]}function T(){n&&typeof n.focus=="function"?n.focus({preventScroll:!0}):t&&typeof t.focus=="function"&&t.focus({preventScroll:!0})}function C(h){if(!t)return;let E=Array.from(document.body.children).filter(p=>p!==t);h?E.forEach(p=>{R.has(p)||R.set(p,{ariaHidden:p.hasAttribute("aria-hidden")?p.getAttribute("aria-hidden"):null,inert:p.hasAttribute("inert")}),p.setAttribute("aria-hidden","true"),p.setAttribute("inert","")}):(E.forEach(p=>{let m=R.get(p);m?(m.ariaHidden===null||m.ariaHidden===void 0?p.removeAttribute("aria-hidden"):p.setAttribute("aria-hidden",m.ariaHidden),m.inert?p.setAttribute("inert",""):p.removeAttribute("inert"),R.delete(p)):(p.removeAttribute("aria-hidden"),p.removeAttribute("inert"))}),R.clear())}function B(){!t||M||(M=!0,t.hidden=!1,t.setAttribute("aria-hidden","false"),A=document.activeElement instanceof HTMLElement?document.activeElement:null,P=document.body.style.overflow,document.body.style.overflow="hidden",C(!0),Hn(),requestAnimationFrame(T),document.dispatchEvent(new CustomEvent("settings:open")))}function L(){!t||!M||(M=!1,t.hidden=!0,t.setAttribute("aria-hidden","true"),C(!1),document.body.style.overflow=P,A&&typeof A.focus=="function"&&A.focus(),A=null,document.dispatchEvent(new CustomEvent("settings:close")))}function j(h){if(!M)return;if(h.key==="Escape"){h.preventDefault(),L();return}if(h.key!=="Tab")return;let E=w();if(!E.length){h.preventDefault(),T();return}let p=E[0],m=E[E.length-1],W=document.activeElement;h.shiftKey?(W===p||!t.contains(W))&&(h.preventDefault(),m.focus()):W===m&&(h.preventDefault(),p.focus())}r&&r.addEventListener("click",B),o&&o.addEventListener("click",()=>{B()}),a&&a.addEventListener("click",B),s&&s.addEventListener("click",L),t&&t.addEventListener("click",h=>{h.target===t&&L()}),t&&t.addEventListener("keydown",j);function S(h="",E=""){if(d){d.textContent=h,d.dataset.kind=E,g&&(g.dataset.kind=E||"",g.title=h||"");try{if(E==="error"&&e&&e.tmdbApiKey){let p=String(localStorage.getItem("tmdbToken")||"").trim(),m=String((i==null?void 0:i.value)||"").trim();if(p&&m){try{localStorage.removeItem("tmdbToken")}catch{}i&&(i.value=""),G(!0);let W="Ung\xFCltiger Token entfernt. Verwende API Key aus config.json.";d.textContent=W,d.dataset.kind="info",g&&(g.dataset.kind="info",g.title=W)}}}catch{}}}function G(h){if(b&&(b.disabled=!h,b.title=b.disabled?"Nur verf\xFCgbar mit g\xFCltigem Token oder API Key.":"",!h&&b.checked)){try{localStorage.setItem("useTmdb","0")}catch{}b.checked=!1,_(y().view)}}function Hn(){let h="";try{i&&(i.value=h=localStorage.getItem("tmdbToken")||"")}catch{}try{u&&(u.checked=localStorage.getItem("prefReduceMotion")==="1")}catch{}try{k&&(k.checked=localStorage.getItem("scrollOrchestratorEnabled")!=="0")}catch{}try{b&&(b.checked=localStorage.getItem("useTmdb")==="1",b.disabled=!h,b.title=b.disabled?"Nur verf\xFCgbar mit g\xFCltigem Token.":"")}catch{}try{G(!!h||!!(e&&e.tmdbApiKey))}catch{}S("",""),h||S("Kein Token hinterlegt. TMDB ist deaktiviert.","info"),e!=null&&e.tmdbEnabled||S("Hinweis: TMDB in config.json deaktiviert (tmdbEnabled=false).","info"),h?(async()=>{var E;S("Pr\xFCfe Token...","pending");try{let p=await Promise.resolve().then(()=>(le(),ye)),m=await((E=p.validateToken)==null?void 0:E.call(p,h));m&&m.ok?(G(!0),m.as==="bearer"?S("Token g\xFCltig (v4 Bearer).","success"):m.as==="apikey"&&S('API Key g\xFCltig (v3). Tipp: dauerhaft in site/config.json unter "tmdbApiKey" eintragen.',"success")):(G(!1),(m==null?void 0:m.hint)==="looksV3"?S('Eingegebener Wert sieht wie ein v3 API Key aus. Bitte in config.json als "tmdbApiKey" eintragen oder v4 Bearer Token verwenden.',"error"):S("Token ung\xFCltig oder keine Berechtigung (401).","error"))}catch{S("Pr\xFCfung fehlgeschlagen. Netzwerk/Browser-Konsole pr\xFCfen.","error")}})():G(!!(e&&e.tmdbApiKey))}c&&c.addEventListener("click",async()=>{var E;let h=String((i==null?void 0:i.value)||"").trim();try{localStorage.setItem("tmdbToken",h)}catch{}if(!h){S("Kein Token hinterlegt. TMDB ist deaktiviert.","info"),G(!!(e&&e.tmdbApiKey));return}S("Pr\xFCfe Token...","pending");try{let p=await Promise.resolve().then(()=>(le(),ye)),m=await((E=p.validateToken)==null?void 0:E.call(p,h));m&&m.ok?(G(!0),m.as==="bearer"?S("Token g\xFCltig (v4 Bearer).","success"):m.as==="apikey"&&S('API Key g\xFCltig (v3). Tipp: dauerhaft in site/config.json unter "tmdbApiKey" eintragen.',"success")):(G(!1),(m==null?void 0:m.hint)==="looksV3"?S('Eingegebener Wert sieht wie ein v3 API Key aus. Bitte in config.json als "tmdbApiKey" eintragen oder v4 Bearer Token verwenden.',"error"):S("Token ung\xFCltig oder keine Berechtigung (401).","error"))}catch{S("Pr\xFCfung fehlgeschlagen. Netzwerk/Browser-Konsole pr\xFCfen.","error")}}),l&&l.addEventListener("click",async()=>{var E;let h=String((i==null?void 0:i.value)||"").trim();if(!h){S("Bitte Token eingeben.","error");return}S("Pr\xFCfe Token...","pending");try{let p=await Promise.resolve().then(()=>(le(),ye)),m=await((E=p.validateToken)==null?void 0:E.call(p,h));m&&m.ok?m.as==="bearer"?S("Token g\xFCltig (v4 Bearer).","success"):m.as==="apikey"&&S('API Key g\xFCltig (v3). Tipp: dauerhaft in site/config.json unter "tmdbApiKey" eintragen.',"success"):(m==null?void 0:m.hint)==="looksV3"?S('Eingegebener Wert sieht wie ein v3 API Key aus. Dieser funktioniert hier nicht als Bearer. Bitte in config.json als "tmdbApiKey" eintragen oder v4 Bearer Token verwenden.',"error"):S("Token ung\xFCltig oder keine Berechtigung (401).","error")}catch{S("Pr\xFCfung fehlgeschlagen. Netzwerk/Browser-Konsole pr\xFCfen.","error")}}),f&&f.addEventListener("click",()=>{Promise.resolve().then(()=>(le(),ye)).then(h=>{var E;return(E=h.clearCache)==null?void 0:E.call(h)})}),u&&u.addEventListener("change",()=>{try{localStorage.setItem("prefReduceMotion",u.checked?"1":"0")}catch{}Mt(u.checked),de&&de.setReduceMotion&&de.setReduceMotion(u.checked)}),b&&b.addEventListener("change",()=>{try{localStorage.setItem("useTmdb",b.checked?"1":"0")}catch{}b.checked&&!window.__tmdbHydrationStarted&&(window.__tmdbHydrationStarted=1,Promise.resolve().then(()=>(le(),ye)).then(h=>{var p;let E=y();(p=h.hydrateOptional)==null||p.call(h,E.movies,E.shows,E.cfg)}).catch(()=>{}),setTimeout(()=>{b.checked&&_(y().view)},1200),setTimeout(()=>{b.checked&&_(y().view)},3e3)),_(y().view),J()}),v&&v.addEventListener("click",()=>{let h=document.getElementById("search");h&&(h.value="");let E=document.getElementById("q");E&&(E.value="");let p=document.getElementById("onlyNew");p&&(p.checked=!1);let m=document.getElementById("yearFrom"),W=document.getElementById("yearTo");m&&(m.value=""),W&&(W.value="");let Rt=document.getElementById("collectionFilter");Rt&&(Rt.value=""),document.querySelectorAll("#genreFilters .chip.active").forEach(Ge=>Ge.classList.remove("active"));let Je=document.getElementById("genreFilters");Je&&(Je.dataset.state="empty",Je.dataset.count="0"),Promise.resolve().then(()=>(ze(),Ct)).then(Ge=>{let _n=Ge.applyFilters();_(y().view),J(_n)})}),k&&k.addEventListener("change",()=>{let h=k.checked;try{localStorage.setItem("scrollOrchestratorEnabled",h?"1":"0")}catch{}de&&de.setEnabled?de.setEnabled(h):h&&(L(),window.location.reload())})}function Mt(e){var t,n;try{let r=document.body;r?((t=document.documentElement)==null||t.classList.remove("reduce-motion","reduced-motion"),r.classList.remove("reduced-motion"),r.classList.toggle("reduce-motion",e)):((n=document.documentElement)==null||n.classList.toggle("reduce-motion",e),window.addEventListener("DOMContentLoaded",()=>Mt(e),{once:!0}))}catch{}}function qo(){try{let e=localStorage.getItem("prefReduceMotion")==="1";Mt(e)}catch{}}function zo(){let e=document.getElementById("toggleAdvanced"),t=document.getElementById("advancedFilters");if(!e||!t)return;let n=!1,r=0,o=()=>{n=!1,r&&(clearTimeout(r),r=0),t.dataset.state==="closing"?(t.dataset.state="closed",t.hidden=!0,t.style.removeProperty("--advanced-max")):t.dataset.state==="open"?t.style.removeProperty("--advanced-max"):t.dataset.state==="expanding"&&(t.dataset.state="open",t.style.removeProperty("--advanced-max"))},a=()=>{r&&clearTimeout(r),r=window.setTimeout(o,320)};t.addEventListener("transitionend",c=>{c.target!==t||c.propertyName!=="max-height"||o()});let s=()=>{n||(n=!0,t.hidden=!1,t.dataset.state="expanding",t.setAttribute("aria-hidden","false"),t.style.setProperty("--advanced-max","0px"),requestAnimationFrame(()=>{let c=t.scrollHeight;t.style.setProperty("--advanced-max",c+"px"),t.dataset.state="open",a()}))},i=()=>{if(n)return;n=!0;let c=t.scrollHeight;t.style.setProperty("--advanced-max",c+"px"),t.dataset.state="closing",t.setAttribute("aria-hidden","true"),requestAnimationFrame(()=>{t.style.setProperty("--advanced-max","0px"),a()})};e.addEventListener("click",()=>{e.getAttribute("aria-expanded")==="true"?(e.setAttribute("aria-expanded","false"),i()):(e.setAttribute("aria-expanded","true"),s())})}function Ko(){let e=document.getElementById("siteLogo");e&&e.addEventListener("error",()=>{e.classList.add("logo-missing");let a=document.querySelector(".site-header__brand-text .site-header__label");a&&a.classList.remove("sr-only")});let t=document.getElementById("heroSubtitle"),n=["Offline st\xF6bern & Wunschlisten teilen","Filter. Finden. Freuen.","Filme & Serien \u2013 stressfrei sichtbar","Schneller als jeder SMB-Share","Merkliste zuerst, Streit sp\xE4ter"],r=0;t&&(t.textContent=n[r]);function o(){!t||t.dataset.taglinePaused==="1"||(t.classList.add("is-fading"),setTimeout(()=>{if(!t||t.dataset.taglinePaused==="1"){t&&t.classList.remove("is-fading");return}r=(r+1)%n.length,t.textContent=n[r],t.classList.remove("is-fading")},280))}t&&(t.dataset.taglinePaused="0",window.__taglineTicker||(window.__taglineTicker=setInterval(o,6e3),setTimeout(o,3e3)))}function Wo(){let e=document.getElementById("scrollProgress");if(!e)return;let t=()=>{let n=document.documentElement.scrollTop||document.body.scrollTop||0,r=document.documentElement.scrollHeight-document.documentElement.clientHeight||1,o=Math.max(0,Math.min(100,n/r*100));e.style.width=o+"%"};addEventListener("scroll",t,{passive:!0}),t()}function Vo(){let e=document.getElementById("scrollTop");if(!e)return;let t=()=>{let n=window.scrollY||0;e.style.display=n>300?"block":"none"};addEventListener("scroll",t,{passive:!0}),t(),e.addEventListener("click",()=>window.scrollTo({top:0,behavior:"smooth"}))}window.__scrollOrchestrator=()=>de;
//# sourceMappingURL=main.js.map
